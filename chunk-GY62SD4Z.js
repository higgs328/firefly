import{a as I}from"./chunk-H5YAFDFO.js";import{a as c}from"./chunk-JYGVIFB2.js";import{a as M}from"./chunk-EMABSAM2.js";import{a as u}from"./chunk-LQEFWCY6.js";import{a as G}from"./chunk-H25DKJGS.js";import{a as O}from"./chunk-K75TK42V.js";import{d as m}from"./chunk-OLOKUDVI.js";import{a as R}from"./chunk-IR6XCBC4.js";import{c as l}from"./chunk-VIEK2X23.js";import{a as b}from"./chunk-PEW2PLAN.js";import{a as v}from"./chunk-CX5IFQZJ.js";import{a}from"./chunk-QGVBCWUY.js";import{h as P,j as w}from"./chunk-MYO4NP2N.js";import{e as y}from"./chunk-NFIPKH6V.js";import{l as x}from"./chunk-5QEXLALV.js";import{b as h}from"./chunk-YOFFGXOB.js";import{g}from"./chunk-XRGPJ3QY.js";function j(e){return e?.type==="media"}function C(e,o){let t=w(o);return j(e)&&!!e.portalItem&&t!=null&&t>P.PORTAL_ITEM}function T(e,o,t){if(!e||e.type==="control-points")return e;let{coords:r}=e;if(r?.rings[0]?.length!==5)return null;let[n,p,s,d]=r.rings[0],{spatialReference:f}=r;return new c({controlPoints:[{mapPoint:new l({x:n[0],y:n[1],spatialReference:f}),sourcePoint:m(0,t)},{mapPoint:new l({x:p[0],y:p[1],spatialReference:f}),sourcePoint:m(0,0)},{mapPoint:new l({x:s[0],y:s[1],spatialReference:f}),sourcePoint:m(o,0)},{mapPoint:new l({x:d[0],y:d[1],spatialReference:f}),sourcePoint:m(o,t)}],width:o,height:t})}function S(e,o,t){return{enabled:!C(t?.layer,t?.origin),ignoreOrigin:!0}}var U={json:{name:"url",type:String,write:{overridePolicy:S}}},$={readOnly:!0,json:{read:!1,write:{target:"mediaType",overridePolicy:S}}},W={types:{key:"type",base:u,typeMap:{"control-points":c,corners:M,"extent-and-rotation":I}},json:{types:{key:"type",base:u,typeMap:{"control-points":c}},write:{overridePolicy:()=>({enabled:!0,ignoreOrigin:!0})}}};var i=class extends O.NumericIdentifiableMixin(G(R)){constructor(e){super(e),this.georeference=null,this.opacity=1}readGeoreference(e){return c.fromJSON(e)}writeGeoreference(e,o,t,r){let n=r?.resources?.pendingOperations,p=()=>{let s=T(this.georeference,this.contentWidth,this.contentHeight);if(s){if(e.type!=="control-points"&&g.getLogger(this).warn(`only georeference of type 'control-points' may be persisted. The georeference of type '${e.type}' has been automatically converted.`),s.controlPoints?.length!==4&&r?.messages)return void r.messages.push(new h("property:unsupported","only 'control-points' georeference with 4 control points may be persisted."));o[t]=s.write({},r)}};if(e.type!=="control-points"&&!this.loaded&&n)return o[t]={},void n.push(this.load().then(p));p()}get contentWidth(){return 0}get contentHeight(){return 0}toSource(e){let{georeference:o,contentWidth:t,contentHeight:r}=this;if(e==null||o==null||t===0||r===0)return null;let n=o.toSourceNormalized(e);return n==null?null:(n.x*=t,n.y*=r,n)}};a([y(W)],i.prototype,"georeference",void 0),a([b("georeference")],i.prototype,"readGeoreference",null),a([v("georeference")],i.prototype,"writeGeoreference",null),a([y({json:{read:!1,write:!1}})],i.prototype,"opacity",void 0),i=a([x("esri.layers.support.MediaElementBase")],i);var pe=i;export{C as a,U as b,$ as c,pe as d};
