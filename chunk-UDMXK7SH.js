import{q as m}from"./chunk-ZEWUF6OQ.js";import{a as g}from"./chunk-ZQ2SHTTW.js";import{a as _}from"./chunk-K75TK42V.js";import{a as o}from"./chunk-5XCFNEYX.js";import{a as y}from"./chunk-GQL2MBZT.js";import{a,j as p}from"./chunk-TG45K3WR.js";import{a as r}from"./chunk-QGVBCWUY.js";import{e as s}from"./chunk-NFIPKH6V.js";import{l as u}from"./chunk-5QEXLALV.js";import{b as d}from"./chunk-4PTIEWMT.js";import{f as c}from"./chunk-VTHXE323.js";var n=class extends _.IdentifiableMixin(y){constructor(e,t){super(e,t),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([a(()=>this._canCreateLegend,()=>this._createLegend(),p),a(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),p)])}destroy(){this._legend=d(this._legend)}get _canCreateLegend(){let{content:e,listItem:t}=this;if(!t)return!1;let i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){let{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){let e=this.listItem?.layer;if(!e||e.type==="subtype-sublayer")return null;let t=m(e)?e:null,i=e?.parent,l=i!=null&&"type"in i&&i.type==="map-image"?t?.source:null,h="";return l&&i?{layer:i,title:h,sublayerIds:[l.mapLayerId]}:{layer:e,title:h}}get disabled(){let{listItem:e,_legend:t,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!t&&(!t.activeLayerInfos?.length||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){let{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return o("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){let{_legend:t,disabled:i,open:l}=this;return e&&!i&&l?e==="legend"&&t?o("div",{key:"legend-widget"},t.render()):typeof e=="string"?o("div",{innerHTML:e,key:e}):g(e)?o("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?o("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){let{content:e,open:t}=this;return t?Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e):null}_createLegend(){return c(this,null,function*(){if(d(this._legend),this._legend=null,!this._canCreateLegend)return;let{default:e}=yield import("./chunk-RZJ2LLPW.js"),t=new e(this._legendOptions);this._legend=t})}_attachToNode(e){e.appendChild(this)}_updateLegend(){let e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:g(e)?e:null}_getFirstWidget(){let{content:e}=this;return Array.isArray(e)?e.map(t=>this._getWidget(t)).find(t=>t):this._getWidget(e)}};r([s()],n.prototype,"_legend",void 0),r([s()],n.prototype,"_canCreateLegend",null),r([s()],n.prototype,"_legendOptions",null),r([s()],n.prototype,"_legendLayerInfo",null),r([s()],n.prototype,"className",void 0),r([s()],n.prototype,"content",void 0),r([s()],n.prototype,"disabled",null),r([s()],n.prototype,"flowEnabled",void 0),r([s()],n.prototype,"icon",null),r([s()],n.prototype,"image",void 0),r([s()],n.prototype,"listItem",void 0),r([s()],n.prototype,"open",void 0),r([s()],n.prototype,"title",null),r([s()],n.prototype,"visible",void 0),n=r([u("esri.widgets.LayerList.ListItemPanel")],n);var N=n;export{N as a};
