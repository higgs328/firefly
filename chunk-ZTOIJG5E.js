import{a as L,b as g,c as x,e as N}from"./chunk-UE2WOFQF.js";import{a as k}from"./chunk-IR6XCBC4.js";import{m as f}from"./chunk-ZQIC5NFT.js";import{a as w}from"./chunk-PEW2PLAN.js";import{f as c}from"./chunk-CCJU4DSH.js";import{a as u,c as y,e as h,i as a}from"./chunk-TG45K3WR.js";import{b as p}from"./chunk-ACP3S2CH.js";import{a as S}from"./chunk-T7DXJKX7.js";import{a as r}from"./chunk-QGVBCWUY.js";import{e as s}from"./chunk-NFIPKH6V.js";import{l as b}from"./chunk-5QEXLALV.js";import{j as v}from"./chunk-P6QFA5MM.js";import{d}from"./chunk-XRGPJ3QY.js";var n,e=n=class extends S.EventedMixin(c.JSONSupportMixin(k)){constructor(...i){super(...i),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([y(()=>this.sublayers,"after-add",({item:t})=>{t.parent=this,t.layer=this.layer},a),y(()=>this.sublayers,"after-remove",({item:t})=>{t.layer=t.parent=null},a),u(()=>this.sublayers,(t,o)=>{if(o)for(let l of o)l.layer=l.parent=null;if(t)for(let l of t)l.parent=this,l.layer=this.layer},a),u(()=>this.layer,t=>{if(this.sublayers)for(let o of this.sublayers)o.layer=t},a)])}initialize(){h(()=>this.networkLink).then(()=>h(()=>this.visible===!0)).then(()=>this.load())}load(i){if(!this.networkLink||this.networkLink.viewFormat)return;let t=i!=null?i.signal:null,o=this._fetchService(this._get("networkLink")?.href??"",t).then(l=>{let O=N(l.sublayers);this.fullExtent=f.fromJSON(O),this.sourceJSON=l;let m=v(p.ofType(n),x(n,l));this.sublayers?this.sublayers.addMany(m):this.sublayers=m,this.layer?.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(o),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(i){this._get("visible")!==i&&(this._set("visible",i),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(i,t){return!!t.visibility}_fetchService(i,t){return g(i,this.layer.outSpatialReference,this.layer.refreshInterval,t).then(o=>L(o.data))}};r([s()],e.prototype,"description",void 0),r([s({type:f})],e.prototype,"fullExtent",void 0),r([s()],e.prototype,"id",void 0),r([s({readOnly:!0,value:null})],e.prototype,"networkLink",void 0),r([s({json:{write:{allowNull:!0}}})],e.prototype,"parent",void 0),r([s({type:p.ofType(e),json:{write:{allowNull:!0}}})],e.prototype,"sublayers",void 0),r([s({value:null,json:{read:{source:"name",reader:i=>d(i)}}})],e.prototype,"title",void 0),r([s({value:!0})],e.prototype,"visible",null),r([w("visible",["visibility"])],e.prototype,"readVisible",null),r([s()],e.prototype,"sourceJSON",void 0),r([s()],e.prototype,"layer",void 0),e=n=r([b("esri.layers.support.KMLSublayer")],e);var q=e;export{q as a};
