import{a as f}from"./chunk-FDF2XGXD.js";import{b as h}from"./chunk-22XPHE6T.js";import{c as m}from"./chunk-7GIEDGLP.js";import{a as u}from"./chunk-DO7UF2F2.js";import{b as d}from"./chunk-UST6HCE7.js";import{f as p}from"./chunk-WFKZLI6F.js";import{a}from"./chunk-QGVBCWUY.js";import{e as r}from"./chunk-NFIPKH6V.js";import{l as n}from"./chunk-5QEXLALV.js";import{y as c}from"./chunk-4PTIEWMT.js";import{b as s}from"./chunk-YOFFGXOB.js";import{f as l}from"./chunk-VTHXE323.js";function g(){return l(this,null,function*(){let t=yield d("esri/widgets/Locate/t9n/Locate");return new u({title:t.currentLocation,fieldInfos:[{fieldName:"timestamp",label:t.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:t.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:t.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:t.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:t.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:t.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:t.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:t.speed,format:{places:0,digitSeparator:!0}}],actions:[m.clone()],content:[{type:"fields"}]})})}var o=class extends f{constructor(t){super(t),this._locateController=null,this.error=void 0,this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this.addHandles([p(()=>{let{graphic:t,view:e}=this;if(!t)return;e?.graphics?.includes(t)&&this._updatePopupTemplate(t)})])}destroy(){this.cancelLocate()}get state(){return this._geolocationUsable?this.view?.ready?this._locateController?"locating":this.error!=null?"error":"ready":"disabled":"feature-unsupported"}locate(){return l(this,null,function*(){if(this.cancelLocate(),this.state==="disabled")throw new s("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new s("locate:feature-unsupported-state","Cannot locate in unsecure domain.");let t=new AbortController;this._locateController=t,this.error=void 0;try{let e=yield h(this.geolocationOptions);if(yield this.updatePosition(e,t),this._locateController!==t)return null;let{graphic:i}=this;return i&&(yield this._updatePopupTemplate(i)),this._addGraphic(),this.emit("locate",{position:e}),this._locateController=null,e}catch(e){if(c(e))return null;throw t===this._locateController&&(this._locateController=null),this.error=e,this.emit("locate-error",{error:e}),e}})}cancelLocate(){this._clearGraphic(),this._locateController&&this._locateController.abort(),this._locateController=null}_updatePopupTemplate(t){return l(this,null,function*(){if(!this.popupEnabled)return;let e=yield g(),i=t!==this.graphic;this.destroyed||i||(t.popupTemplate=e)})}};a([r()],o.prototype,"_locateController",void 0),a([r()],o.prototype,"error",void 0),a([r()],o.prototype,"popupEnabled",void 0),a([r({readOnly:!0})],o.prototype,"state",null),a([r()],o.prototype,"locate",null),a([r()],o.prototype,"cancelLocate",null),o=a([n("esri.widgets.Locate.LocateViewModel")],o);var G=o;export{G as a};
