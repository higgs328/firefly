import{a as L}from"./chunk-7SLXCH6P.js";import{a as J}from"./chunk-RUNI4ZN4.js";import"./chunk-FPCHE4I2.js";import{a as j}from"./chunk-PT2T74VZ.js";import{a as z}from"./chunk-EPKVBNFW.js";import"./chunk-ISXQQRNZ.js";import{a as x}from"./chunk-GVABYWYT.js";import"./chunk-EQ3KQIXX.js";import{a as E}from"./chunk-FHBFWDFD.js";import"./chunk-EBLTZITF.js";import"./chunk-GUIIGAD3.js";import"./chunk-SFSN6ZUK.js";import"./chunk-H2NTHPNN.js";import"./chunk-BMYVPMAK.js";import"./chunk-3JGYBNJA.js";import"./chunk-ZC6EBRE4.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import{a as G}from"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-DYTVXYAV.js";import"./chunk-KVM6SHDX.js";import"./chunk-EQZWYK27.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import{a as $}from"./chunk-AXYQJCCX.js";import{a as r}from"./chunk-5XCFNEYX.js";import{a as V}from"./chunk-GQL2MBZT.js";import{b as Z}from"./chunk-EBIFNV2H.js";import"./chunk-MGGSCSBE.js";import"./chunk-Z6BYFM7E.js";import"./chunk-CFRDSUTM.js";import{o as w}from"./chunk-FB4M3WPV.js";import"./chunk-SLAWDKDA.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-3VRDAJCX.js";import"./chunk-WTB3O6DJ.js";import"./chunk-7P44K2YD.js";import"./chunk-32OAXCA4.js";import"./chunk-UST6HCE7.js";import{c as N,d as M}from"./chunk-K5T5FD5C.js";import{a as F}from"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a}from"./chunk-QGVBCWUY.js";import{H as C}from"./chunk-MYO4NP2N.js";import{e as l}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as f}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import{y as H}from"./chunk-QBWJMFH5.js";import{a as B,b as A,f as g}from"./chunk-VTHXE323.js";var p=class extends C{constructor(t){super(t)}get editedBookmark(){let{bookmark:t}=this;return t?this._get("editedBookmark")||t.clone():null}get customUrl(){return this.editedBookmark?.thumbnail?.isSecureUrl?this.editedBookmark.thumbnail.url:null}set customUrl(t){this._override("customUrl",t)}get screenshotUrl(){return this.editedBookmark?.thumbnail?.isDataURI?this.editedBookmark.thumbnail.url:null}set screenshotUrl(t){this._override("screenshotUrl",t)}get state(){return this._get("state")}set state(t){this.validationState=void 0,this.loading=void 0,this._set("state",t)}get thumbnailState(){return this.editedBookmark?.thumbnail?.url?this.editedBookmark?.thumbnail?.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(t){this._overrideIfSome("thumbnailState",t)}};a([l()],p.prototype,"bookmark",void 0),a([l({readOnly:!0})],p.prototype,"editedBookmark",null),a([l()],p.prototype,"customUrl",null),a([l()],p.prototype,"screenshotUrl",null),a([l()],p.prototype,"state",null),a([l()],p.prototype,"thumbnailState",null),a([l()],p.prototype,"validationState",void 0),a([l()],p.prototype,"loading",void 0),p=a([f("esri.widgets.Bookmarks.BookmarksUserState")],p);var U=p;var h=class extends C{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}};a([l({type:Boolean,nonNullable:!0})],h.prototype,"addBookmarkButton",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"closeButton",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"collapseButton",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"editBookmarkButton",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"filter",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"flow",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"heading",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"thumbnail",void 0),a([l({type:Boolean,nonNullable:!0})],h.prototype,"time",void 0),h=a([f("esri.widgets.Bookmarks.BookmarksVisibleElements")],h);var O=h;var c="esri-bookmarks",R=`${c}__authoring`,q=`${c}__bookmark`,m={base:c,noBookmarksHeader:`${c}__no-bookmarks-heading`,noBookmarksDescription:`${c}__no-bookmarks-description`,form:`${c}__form`,list:`${c}__list`,loader:`${c}__loader`,filterNoResults:`${c}__filter-no-results`,formContent:`${c}__form-content`,addBookmarkButton:`${c}__add-bookmark-button`,editBookmarkInput:`${c}__edit-bookmark-input`,addBookmarkInput:`${c}__add-bookmark-input`,dragEnabled:`${c}--drag-enabled`,bookmarkImage:`${c}__image`,bookmarkImageContainer:`${q}-image-container`,bookmarkContent:`${q}-content`,bookmarkContentLabel:`${q}-content-label`,authoring:R,authoringImageContainer:`${R}-image-container`,authoringRefreshThumbnailButton:`${R}-refresh-thumbnail-button`};var s=class extends G.IdentifiableMixin(V){constructor(t,e){super(t,e),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new L,this.visibleElements=new O,this._onCalciteListOrderChange=o=>{let{_lastDragDetail:i,bookmarks:n}=this,{toEl:d,fromEl:u,dragEl:k,newIndex:_}=o;if(!n.length||!u||!d||i?.newIndex===_&&i?.dragEl===k&&i?.toEl===d&&i?.fromEl===u)return;this._lastDragDetail=o;let y=Array.from(u.children).filter(b=>b?.matches("calcite-list-item")).map(b=>b.value);n.sort((b,I)=>{let S=y.indexOf(b.uid),T=y.indexOf(I.uid);return S>T?1:S<T?-1:0}),this._selectedDragBookmarkUid=k.value}}loadDependencies(){return Z({action:()=>import("./chunk-X23M5IZ6.js"),button:()=>import("./chunk-K3RCADAN.js"),"chip-group":()=>import("./chunk-4UOLIIEG.js"),chip:()=>import("./chunk-YJHYFSU4.js"),fab:()=>import("./chunk-FUL2XPUS.js"),flow:()=>import("./chunk-5V3M627Q.js"),"flow-item":()=>import("./chunk-OQ4LXJHQ.js"),icon:()=>import("./chunk-7Z2RNQA3.js"),input:()=>import("./chunk-SS6GQCI6.js"),"input-message":()=>import("./chunk-BQUCPREW.js"),label:()=>import("./chunk-S24JESVO.js"),list:()=>import("./chunk-4MPCQ5DO.js"),"list-item":()=>import("./chunk-MRM6JRFU.js"),loader:()=>import("./chunk-4Z3TWS6O.js"),notice:()=>import("./chunk-PEKK3NZO.js"),scrim:()=>import("./chunk-R5U5AYSV.js"),switch:()=>import("./chunk-IIWK5IA5.js"),table:()=>import("./chunk-BV7KFZZT.js"),"table-cell":()=>import("./chunk-6FT4GSCH.js"),"table-header":()=>import("./chunk-KTTDRTS7.js"),"table-row":()=>import("./chunk-EYWWOVSY.js")})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"bookmark"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){return r("div",{class:this.classes(m.base,E.widget,E.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new U({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(t){let{messages:e,viewModel:{state:o}}=this;return t.length||o==="loading"?null:r("div",{class:E.empty,key:"no-bookmarks"},r("calcite-icon",{icon:"bookmark",scale:"l"}),r(j,{class:this.classes(E.heading,m.noBookmarksHeader),level:this.headingLevel},e?.noBookmarksHeading),r("p",{class:m.noBookmarksDescription},e.noBookmarksDescription))}_renderEditBookmarkFlowItems(){let{_userState:t}=this,e=t?.editedBookmark;return e&&t?.state==="edit"?this._renderEditingBookmark(e):[]}_renderBookmarkItems(t){return t?t.toArray().map(e=>this._renderBookmark(e)):[]}_handleCalciteListDragEnd(t){let{fromEl:e,dragEl:o,oldIndex:i}=t;e.insertBefore(o,e.children[i])}_renderBookmarksContainer(){let{viewModel:{state:t,bookmarks:e},dragEnabled:o,messages:i,disabled:n,filterPlaceholder:d,filterText:u,visible:k,headingLevel:_,visibleElements:{closeButton:y,collapseButton:b,filter:I,heading:S,flow:T},uid:K}=this,D=e.filter(H),Q=D.length?r("calcite-list",{class:m.list,displayMode:"flat",dragEnabled:o,filterEnabled:I,filterPlaceholder:d,filterProps:J,filterText:u,group:`bookmarks-${K}`,key:"bookmark-list",label:i.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:v=>this._handleCalciteListDragEnd(v.detail),onCalciteListFilter:v=>this.filterText=v.currentTarget?.filterText??"",onCalciteListOrderChange:v=>this._onCalciteListOrderChange(v.detail)},this._renderBookmarkItems(D),I?r("div",{class:m.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},r("div",{slot:"message"},i.noBookmarksHeading),";")):null):null,P=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:y,closed:!k,collapsible:b,disabled:n,heading:S?i.widgetLabel:void 0,headingLevel:_,loading:t==="loading",selected:!this._userState?.state,onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(D),Q,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return k?T?r("calcite-flow",{key:"root-flow"},P):P:null}_renderAddBookmarkButton(){let{messages:t,_userState:e,disabled:o,viewModel:{view:i,state:n},visibleElements:{addBookmarkButton:d}}=this,u=e?.loading??!1;return i&&n!=="loading"&&d?r("calcite-fab",{appearance:"outline-fill",bind:this,class:m.addBookmarkButton,disabled:o||u,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:u,onclick:this.startAddBookmark,slot:"fab",text:t.addBookmark,textEnabled:!0,title:t.addBookmark,type:"button"}):null}_renderEditContainer(t){let{messagesCommon:e,visibleElements:{editBookmarkButton:o}}=this,i=`${e.edit} ${this._getBookmarkTitle(t)}`;return o?r("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(t),slot:"actions-end",text:i,title:i}):null}_renderBookmarkImage(t,e){return e?r("img",{alt:"",class:m.bookmarkImage,key:"bookmark-image",src:t.thumbnail?.url}):null}_renderBookmarkTimeSwitch(t){let{messages:e,viewModel:{view:o}}=this,{timeExtent:i}=t;return o?.timeExtent??i?r("calcite-label",{layout:"inline-space-between"},e.includeTimeExtent,r("calcite-switch",{checked:!!i,onCalciteSwitchChange:n=>{this._editIncludeTimeExtent=!!n.currentTarget.checked}})):null}_renderEditBookmarkTimeExtent(t){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null}_getTimeExtentStrings(t){let{visibleElements:e}=this,{timeExtent:o}=t;if(!o)return{};let{start:i,end:n}=o,d=n!=null&&(i==null||i.getTime()!==n.getTime()),u=i?this._formatDate(i):"",k=i&&e.time?this._formatTime(i):"";return d?{startDate:u,startTime:k,endDate:this._formatDate(n),endTime:e.time?this._formatTime(n):""}:{startDate:u,startTime:k}}_renderTimeExtentDescription(t){let{startDate:e,startTime:o,endDate:i,endTime:n}=this._getTimeExtentStrings(t);if(!e)return"";let d=`${e} ${o}`;return i?`${d} - ${`${i} ${n}`}`:d}_renderBookmarkTimeExtent(t,e=!1){let{messages:o}=this,{startDate:i,startTime:n,endDate:d,endTime:u}=this._getTimeExtentStrings(t),k=e?null:r("calcite-table-row",{slot:"table-header"},r("calcite-table-header",{heading:o.startDate}),d?r("calcite-table-header",{heading:o.endDate}):null);return i?r("calcite-table",{caption:o.timeExtent,scale:"s"},k,r("calcite-table-row",null,r("calcite-table-cell",null,i," ",n?[r("br",null),n]:null),d?r("calcite-table-cell",null,d,u?[r("br",null),u]:null):null)):null}_renderBookmarkActiveScrim(t,e){return this.viewModel.activeBookmark===t&&e?r("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(t,e){return this.viewModel.activeBookmark!==t||e?null:r("calcite-loader",{class:m.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(t,e){return this.viewModel.activeBookmark===t||e?null:r("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(t){let e=this.visibleElements.thumbnail&&!!t.thumbnail?.url;return r("div",{class:m.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(t,e),this._renderBookmarkImage(t,e),this._renderBookmarkActiveLoader(t,e),this._renderBookmarkImageIcon(t,e))}_focusSelectedDragEl(t,e){this._selectedDragBookmarkUid===e.uid&&(w(t),this._selectedDragBookmarkUid=null)}_renderBookmark(t){return r("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes({[m.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(t),key:t.uid,label:this._getBookmarkTitle(t),value:t.uid,onCalciteListItemSelect:()=>this._goToBookmark(t)},this._renderBookmarkThumbnail(t),this._renderBookmarkContent(t),this._renderEditContainer(t))}_renderBookmarkContent(t){return r("div",{class:m.bookmarkContent,slot:"content"},r("span",{class:m.bookmarkContentLabel},this._getBookmarkTitle(t)),this._renderBookmarkTimeExtent(t,!0))}_renderEditingBookmarkName(t){let{messages:e,_userState:o}=this,i=o?.validationState==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:m.editBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:t.name}),i?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderEditingBookmarkActions(){let{messagesCommon:t,_userState:e}=this,o=e?.bookmark;return[r("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(o),slot:"footer",type:"button",width:"full"},t.delete),r("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.save)]}_handleUrlEditInputChange(){let{_userState:t,_urlEditInputNode:e}=this,o=e?.value;if(!t?.editedBookmark||!o)return;t.validationState=void 0,t.editedBookmark.thumbnail?.isDataURI&&(t.screenshotUrl=t.editedBookmark.thumbnail?.url);let i=new x({url:o});i.isSecureUrl&&(t.customUrl=o,t.editedBookmark.thumbnail=i)}_renderEditingTimeExtent(t){let{capabilities:e,view:o}=this.viewModel,{timeExtent:i}=t;return e.time&&(o?.timeExtent??i)?r("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._renderEditBookmarkTimeExtent(t)):null}_renderEditingBookmarkImage(t){let{_userState:e}=this,o=e?.thumbnailState,i=t.thumbnail?.isSecureUrl?o==="url":t.thumbnail?.isDataURI?o==="screenshot":null;if(i)return this._renderBookmarkImage(t,i)}_renderEditingThumbnail(t){let{_userState:e,visibleElements:o}=this,i=e?.thumbnailState;return o.thumbnail&&i!=="none"?r("div",{class:m.authoringImageContainer},this._renderEditingBookmarkImage(t)):null}_renderUpdateThumbnailButton(){let{visibleElements:t,messages:e,_userState:o}=this,i=o?.thumbnailState;return t.thumbnail&&i==="screenshot"?r("calcite-button",{appearance:"outline",class:m.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"full"},e.updateThumbnail):null}_renderEditingBookmarkUrlInput(t){let{messages:e,_userState:o}=this,i=t.thumbnail?.url,n=t.thumbnail?.isSecureUrl?i:void 0,d=i&&o?.validationState==="absolute-url-required";return o?.thumbnailState==="url"?r("calcite-label",{key:"thumbnail-url-input"},r("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:"https://.*",placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e.imageUrlTooltip,type:"text",value:n,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),d?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidImageUrl):null):null}_renderThumbnailSelector(){let{visibleElements:t,messages:e,_userState:o}=this,i=o?.thumbnailState;return t.thumbnail?r("calcite-label",{key:"thumbnail-chip-group"},e.thumbnail,r("calcite-chip-group",{label:e.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:n=>this._handleThumbnailTypeSelect(n.currentTarget.selectedItems[0].value)},r("calcite-chip",{label:e.screenshot,selected:i==="screenshot",value:"screenshot"},e.screenshot),r("calcite-chip",{label:e.url,selected:i==="url",value:"url"},e.url),r("calcite-chip",{label:e.none,selected:i==="none",value:"none"},e.none))):null}_renderEditingBookmark(t){let{disabled:e,messagesCommon:o,headingLevel:i}=this;return t?r("form",{bind:this,class:m.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},r("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:e,heading:o.edit,headingLevel:i,key:"edit-bookmark-form",selected:this._userState?.state==="edit",onCalciteFlowItemBack:n=>{n.preventDefault(),this._closeEditBookmarkForm()}},r("div",{class:m.formContent},r("div",{class:m.authoring},this._renderEditingBookmarkName(t),this._renderThumbnailSelector(),this._renderEditingThumbnail(t),this._renderEditingBookmarkUrlInput(t),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(t))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){let{_userState:t,messages:e}=this,o=t?.validationState==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:m.addBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:""}),o?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderAddingBookmarkActions(){let{messagesCommon:t}=this;return[r("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.add)]}_renderAddingBookmark(){let{disabled:t,messages:e,headingLevel:o,_userState:i}=this;return i?.state==="add"?r("form",{bind:this,class:m.form,disabled:t,onsubmit:this._addBookmarkSubmitClick},r("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:t,heading:e.addBookmark,headingLevel:o,key:"add-bookmark-form",selected:this._userState?.state==="add",onCalciteFlowItemBack:n=>{n.preventDefault(),this._endAddBookmark()}},r("div",{class:m.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(t){return t?.name||this.messagesCommon.untitled}_formatDate(t){return t?M(t,A(B({},N("short-date")),{timeZone:this.viewModel.view?.timeZone??F})):""}_formatTime(t){return t?M(t,A(B({},N("long-time")),{timeZone:this.viewModel.view?.timeZone??F})):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(t){t&&(this._editIncludeTimeExtent=!!t.timeExtent,this._userState=new U({bookmark:t,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(t))}_createNewScreenshotUrl(){return g(this,null,function*(){return(yield this.viewModel.createBookmark()).thumbnail?.url??null})}_storeCurrentUrl(){let{_userState:t}=this,e=t?.editedBookmark?.thumbnail?.url;e&&(t?.editedBookmark?.thumbnail?.isSecureUrl?t.customUrl=e:t?.editedBookmark?.thumbnail?.isDataURI&&(t.screenshotUrl=e))}_handleThumbnailTypeSelect(t){return g(this,null,function*(){let{_userState:e}=this;if(!e)return;let{screenshotUrl:o,customUrl:i,editedBookmark:n}=e,d=t==="screenshot"?o??(yield this._createNewScreenshotUrl()):t==="url"&&i?i:null;this._storeCurrentUrl(),n&&d&&(n.thumbnail=new x({url:d})),e.validationState=void 0,e.thumbnailState=t})}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(t){t.preventDefault(),this._addBookmarkSubmit()}_addBookmarkSubmit(){return g(this,null,function*(){let{_addInputNode:t,_userState:e,viewModel:o,viewModel:{bookmarks:i}}=this;if(!e)return;let n=t?t.value.trim():null;if(!n)return void(e.validationState="name-required");e.loading=!0;let d=yield o.createBookmark();d.name=n,i.add(d),this._endAddBookmark()})}_editBookmarkAndClose(t,e){return g(this,null,function*(){let{viewModel:o,viewModel:{defaultEditOptions:i}}=this;yield o.editBookmark(t,B(B({},i),e)),this._closeEditBookmarkForm()})}_editBookmarkSubmit(t){t.preventDefault();let{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i,_urlEditInputNode:n}=this;if(!o?.bookmark||!o.editedBookmark)return;o.validationState=void 0,o.customUrl=void 0,o.screenshotUrl=void 0;let d=e?.value.trim();if(!d)return void(o.validationState="name-required");o.bookmark.name=d,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null);let u=o.thumbnailState;if(u==="url"&&n){let k=n.value,_=new x({url:k});if(!_.isSecureUrl)return void(o.validationState="absolute-url-required");o.bookmark.thumbnail=_}else u==="none"&&(o.bookmark.thumbnail=null);this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})}_storeEditInput(t){this._editInputNode=t}_storeAddInput(t){this._addInputNode=t}_storeUrlEditInput(t){this._urlEditInputNode=t}_deleteBookmark(t){this._closeEditBookmarkForm(),t&&(this.viewModel.bookmarks.remove(t),t.destroy())}_goToBookmark(t){this.endAddBookmark(),this.viewModel.goTo(t)}_updateThumbnail(){return g(this,null,function*(){let{_userState:t,viewModel:e}=this;t&&(t.validationState=void 0,yield e.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))})}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,w(t))}_focusEditFlowItemNode(t){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,w(t))}_focusAddFlowItemNode(t){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,w(t))}};a([l()],s.prototype,"_editIncludeTimeExtent",void 0),a([l({type:U})],s.prototype,"_userState",void 0),a([l()],s.prototype,"_focusRootFlowItem",void 0),a([l()],s.prototype,"_focusAddFlowItem",void 0),a([l()],s.prototype,"_focusEditFlowItem",void 0),a([l()],s.prototype,"defaultCreateOptions",null),a([l()],s.prototype,"defaultEditOptions",null),a([l()],s.prototype,"bookmarks",null),a([l()],s.prototype,"disabled",void 0),a([l()],s.prototype,"dragEnabled",void 0),a([l()],s.prototype,"filterPlaceholder",void 0),a([l()],s.prototype,"filterText",void 0),a([l()],s.prototype,"headingLevel",void 0),a([l()],s.prototype,"goToOverride",null),a([l()],s.prototype,"icon",null),a([l()],s.prototype,"label",null),a([l(),$("esri/widgets/Bookmarks/t9n/Bookmarks")],s.prototype,"messages",void 0),a([l(),$("esri/t9n/common")],s.prototype,"messagesCommon",void 0),a([l()],s.prototype,"uiStrings",void 0),a([l()],s.prototype,"view",null),a([l({type:L}),z(["select-bookmark","bookmark-edit","bookmark-select"])],s.prototype,"viewModel",void 0),a([l({type:O,nonNullable:!0})],s.prototype,"visibleElements",void 0),a([l()],s.prototype,"endAddBookmark",null),a([l()],s.prototype,"startAddBookmark",null),s=a([f("esri.widgets.Bookmarks")],s);var Rt=s;export{Rt as default};
