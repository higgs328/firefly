import{h as b}from"./chunk-3HZYMAA2.js";import{i as M}from"./chunk-5AFOYCWC.js";import{b as v,c as d}from"./chunk-ZM24RY22.js";import{b as y}from"./chunk-CFRDSUTM.js";import{o as w}from"./chunk-AUAZP44J.js";import{d as p}from"./chunk-KNVXE32P.js";import{b as u}from"./chunk-YOFFGXOB.js";import{a as f}from"./chunk-QBWJMFH5.js";var S=y();function C(t,e){S.append(t,e),S.detach(e)}function B(t,e,i){let o=Math.ceil(e[0]),c=Math.ceil(e[1]);if(!t.some(a=>!!a.length))return null;let r=i?.node||document.createElement("div");return i.opacity!=null&&(r.style.opacity=i.opacity.toString()),i.effectView!=null&&(r.style.filter=M(i.effectView)),C(r,()=>b(t,o,c,i)),r}function D(t,e){t=Math.ceil(t),e=Math.ceil(e);let i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";let o=i.getContext("2d");return o.clearRect(0,0,t,e),o}function I(t,e,i){return t?w(t,{responseType:"image"}).then(o=>{let c=o.data,r=c.width,a=c.height,h=r/a,n=e;if(i){let s=Math.max(r,a);n=Math.min(n,s)}return{image:c,width:h<=1?Math.ceil(n*h):n,height:h<=1?n:Math.ceil(n/h)}}):Promise.reject(new u("renderUtils: imageDataSize","href not provided."))}function V(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function $(t,e,i,o,c){switch(c){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{let r=d({r:t[e],g:t[e+1],b:t[e+2]});r.h=o.h,r.s=o.s,r.v=r.v/100*o.v;let a=v(r);t[e]=a.r,t[e+1]=a.g,t[e+2]=a.b,t[e+3]*=i[3];break}}}function H(t,e,i,o,c){return I(t,e,c).then(r=>{let a=r.width??e,h=r.height??e;if(r.image&&V(i,o)){let n=r.image.width,s=r.image.height;f("edge")&&/\.svg$/i.test(t)&&(n-=1,s-=1);let m=D(a,h);m.drawImage(r.image,0,0,n,s,0,0,a,h);let l=m.getImageData(0,0,a,h),k=[i.r/255,i.g/255,i.b/255,i.a],x=d(i);for(let g=0;g<l.data.length;g+=4)$(l.data,g,k,x,o);m.putImageData(l,0,0),t=m.canvas.toDataURL("image/png")}else{let n=p?.findCredential(t);if(n?.token){let s=t.includes("?")?"&":"?";t=`${t}${s}token=${n.token}`}}return{url:t,width:a,height:h}}).catch(()=>({url:t,width:e,height:e}))}export{C as a,B as b,H as c};
