import{a as he,b as U}from"./chunk-7TOXTKQ5.js";import"./chunk-ETLJEDNA.js";import"./chunk-AKDISSFR.js";import"./chunk-QW25UBG2.js";import"./chunk-HSKV7JWT.js";import"./chunk-JK6ANXJE.js";import"./chunk-SWT4UIOH.js";import"./chunk-E6JHCD7G.js";import"./chunk-EFTNLZSK.js";import"./chunk-Q3T7LRXL.js";import"./chunk-DYNR3EAF.js";import"./chunk-W3TWKYGN.js";import"./chunk-72TNJFVF.js";import"./chunk-OC2XJJQU.js";import{a as w}from"./chunk-UU4VF4Z7.js";import{a as ce}from"./chunk-LQ4BYGTC.js";import"./chunk-WB62I5UH.js";import{b as se,c as oe}from"./chunk-JUJYL7GW.js";import{a as ue,b as j}from"./chunk-UPZXQSRZ.js";import{a as $,b as de}from"./chunk-7GIEDGLP.js";import"./chunk-WKJYYP4U.js";import"./chunk-VP2YX4L2.js";import"./chunk-IDSQ2YJ4.js";import"./chunk-FPCHE4I2.js";import"./chunk-SJAM4JSC.js";import"./chunk-2UKYPYIL.js";import"./chunk-5C7K2G4S.js";import"./chunk-3HZYMAA2.js";import"./chunk-4A4DMQSS.js";import{a as ae,b as le,c as ne}from"./chunk-MBAHJKAN.js";import"./chunk-M3BFYJNF.js";import"./chunk-QYEHKB5C.js";import{a as re}from"./chunk-PT2T74VZ.js";import"./chunk-GTCK26BQ.js";import{a as ie}from"./chunk-AC55GQHL.js";import"./chunk-HB42CTAY.js";import"./chunk-PKVI3POI.js";import"./chunk-NQ53MXMB.js";import"./chunk-4RK2B3SZ.js";import"./chunk-F5M4APKY.js";import"./chunk-55O4EG62.js";import"./chunk-ZQ2SHTTW.js";import{a as W}from"./chunk-EPKVBNFW.js";import"./chunk-TGSXSDDB.js";import"./chunk-B3VPRADQ.js";import"./chunk-HJQNAAJT.js";import"./chunk-KP75LCOH.js";import"./chunk-ES4WUTEM.js";import"./chunk-QWX4TI27.js";import"./chunk-JJ3DE5DS.js";import"./chunk-OBYF3P4E.js";import{a as F}from"./chunk-FHBFWDFD.js";import"./chunk-KGCPVVBF.js";import"./chunk-2XCEJBGD.js";import"./chunk-UZ6PRO67.js";import"./chunk-AT3LJJPR.js";import"./chunk-APBBABYM.js";import"./chunk-PCYNPIKE.js";import"./chunk-AM4QFKZT.js";import"./chunk-DT6D5YZT.js";import"./chunk-NYVW6BKJ.js";import"./chunk-CSSRRM4C.js";import"./chunk-RVXDLN3U.js";import"./chunk-QCN4VUQF.js";import"./chunk-CJL3HAFX.js";import"./chunk-S3MATJKX.js";import"./chunk-NWJCHWGR.js";import"./chunk-FM2MN524.js";import"./chunk-XEJVICTW.js";import"./chunk-ESAKNWVF.js";import"./chunk-H26LGRNQ.js";import"./chunk-2JW3DUYT.js";import"./chunk-4JIR4MZV.js";import"./chunk-ZO3S2OWI.js";import"./chunk-63BBKXWS.js";import"./chunk-NYVDVEEV.js";import"./chunk-6OWZRPJO.js";import"./chunk-67GIWMYL.js";import"./chunk-Q5KIWWVU.js";import"./chunk-KDY6S22B.js";import"./chunk-GXPTMWWM.js";import"./chunk-KPGBL7TL.js";import"./chunk-IBQD5DMC.js";import"./chunk-XE6PIB3P.js";import"./chunk-7F42SXKP.js";import"./chunk-BZ74LSSN.js";import"./chunk-HQAEPGKI.js";import"./chunk-DLZUPWTU.js";import"./chunk-426GDO7D.js";import"./chunk-LQWT7FDD.js";import"./chunk-FVS4GVDC.js";import"./chunk-RSA5APDD.js";import"./chunk-54VKSMWS.js";import"./chunk-B3IHY5YC.js";import"./chunk-YO2CTCP5.js";import"./chunk-DETY3YIP.js";import"./chunk-6M7OOF37.js";import"./chunk-CISTQZ5X.js";import"./chunk-7XYYDAZO.js";import"./chunk-DXT3NBO5.js";import"./chunk-5AFOYCWC.js";import"./chunk-Z3MWEX65.js";import"./chunk-YB6RTOHR.js";import"./chunk-H2NTHPNN.js";import"./chunk-Z7TBAZRW.js";import"./chunk-7NTCDIVV.js";import"./chunk-EJ2UYJJS.js";import"./chunk-6HT3BT3B.js";import"./chunk-CVKHXVTW.js";import"./chunk-456M7HFK.js";import"./chunk-342NGUMP.js";import"./chunk-NIYDRLW4.js";import"./chunk-QSQIQSC6.js";import"./chunk-AYNBEMCC.js";import"./chunk-LNYBTIG7.js";import"./chunk-3WNFY6Z5.js";import"./chunk-4D3QHJI2.js";import"./chunk-E2J2V7JN.js";import"./chunk-7U52UAO2.js";import"./chunk-2WYOVBUR.js";import"./chunk-GPQCYR3E.js";import"./chunk-WDTJILD4.js";import"./chunk-P7HHUOEW.js";import"./chunk-Z6CDEQPZ.js";import"./chunk-DKNG2DCF.js";import"./chunk-RZU6EEB3.js";import"./chunk-NIRJWS2D.js";import"./chunk-H3ZWZZ2B.js";import"./chunk-VRIRKZGO.js";import"./chunk-U7BD7DJH.js";import"./chunk-LBB4AU7W.js";import"./chunk-E3OE5HRA.js";import"./chunk-TSG4MDJV.js";import"./chunk-HCW4M77K.js";import"./chunk-H4IF7PQO.js";import"./chunk-QKVTMI24.js";import"./chunk-GGYZRKBV.js";import"./chunk-I76R3PW5.js";import"./chunk-4KM76TSJ.js";import"./chunk-6RE36L2Q.js";import"./chunk-37PSR6DC.js";import"./chunk-7SDNM7YV.js";import"./chunk-4NUW747S.js";import"./chunk-T6WMVIUG.js";import"./chunk-6ZSLG6BI.js";import"./chunk-LC44KLTN.js";import"./chunk-A66JV4A6.js";import"./chunk-JBFXTI45.js";import"./chunk-Y4PJQPM4.js";import"./chunk-GNPXNHTO.js";import"./chunk-7P56QMT7.js";import"./chunk-P4JHTV62.js";import"./chunk-H25DKJGS.js";import"./chunk-JPMGMA4B.js";import"./chunk-QTO4E4UZ.js";import"./chunk-SO3JGF64.js";import"./chunk-TIWKONVC.js";import"./chunk-PRJOIHPH.js";import"./chunk-6DALCDDU.js";import"./chunk-RK6C6D6K.js";import"./chunk-CHCKIOZR.js";import"./chunk-TUF2Y2FX.js";import"./chunk-4QHB56M5.js";import"./chunk-KN5AJ2NM.js";import"./chunk-5A7AFZJT.js";import"./chunk-Z5EURZKA.js";import"./chunk-OVX6BGGA.js";import"./chunk-PBAMEKFE.js";import"./chunk-XIZ7IH6M.js";import"./chunk-JD66UCS7.js";import"./chunk-FU7RO3AR.js";import"./chunk-4YRY3D3A.js";import"./chunk-ZZ5UYT7M.js";import"./chunk-U4XVPHQU.js";import"./chunk-KLZGQ7M6.js";import"./chunk-N36GL6VL.js";import"./chunk-UX3QUEDM.js";import"./chunk-YZJDOXQC.js";import"./chunk-6ZY36ZHO.js";import"./chunk-6RHGQ4Z5.js";import"./chunk-G23ELQMS.js";import"./chunk-PZOK2JKH.js";import"./chunk-FJUYECJ6.js";import"./chunk-2SJBRRT6.js";import"./chunk-2SXWYVJN.js";import"./chunk-ELUASJOG.js";import"./chunk-KQZGMGWR.js";import"./chunk-66BPZDMW.js";import"./chunk-GAVFKWSK.js";import"./chunk-DK4DGLAO.js";import"./chunk-ZM24RY22.js";import"./chunk-7Y6S2GNA.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-PE276TWH.js";import"./chunk-BMZ3PE5Y.js";import"./chunk-EHG7JRYJ.js";import"./chunk-FNY6LFKI.js";import"./chunk-IBVI7JQ7.js";import"./chunk-2DFFQEIV.js";import"./chunk-4JY7PCV4.js";import"./chunk-BBB7KLHV.js";import"./chunk-JPC2A6ML.js";import"./chunk-OGFDJ67M.js";import"./chunk-5K6CB5PS.js";import"./chunk-J2AEVBSH.js";import"./chunk-5ODXFRPI.js";import"./chunk-E5QCV5LT.js";import"./chunk-QS3EYJPF.js";import"./chunk-HJJZ2AXH.js";import"./chunk-TPNSUEHH.js";import"./chunk-SMVNQSZ4.js";import"./chunk-Z2QGLRDB.js";import"./chunk-7IDFDPA3.js";import"./chunk-VL2YL74P.js";import"./chunk-P2AJD2R2.js";import"./chunk-UMJIJLDA.js";import"./chunk-E5NFS3KN.js";import"./chunk-HQHD6BMN.js";import"./chunk-AIKKGGPG.js";import"./chunk-RDGG4TVD.js";import"./chunk-3IQFPOUU.js";import"./chunk-I4CY6X6S.js";import"./chunk-VQ4QGNRX.js";import"./chunk-LLWQ5E4P.js";import"./chunk-GNEAU6X4.js";import"./chunk-5RH7OPHX.js";import"./chunk-JFB3F3BC.js";import"./chunk-J4JQLN5L.js";import"./chunk-4KXJ537H.js";import"./chunk-JIRULGDT.js";import"./chunk-QJGOWIJD.js";import"./chunk-DAEIFJ76.js";import"./chunk-YHWE4TIZ.js";import"./chunk-B2QMHWYJ.js";import"./chunk-QML26MQC.js";import"./chunk-RNZY2XUD.js";import"./chunk-JXPUHKCT.js";import{b as G,g as Q,h as H}from"./chunk-XR5FT7TQ.js";import"./chunk-4YTM754S.js";import"./chunk-LAX5536Z.js";import"./chunk-N3HRYLNW.js";import"./chunk-4DBMALZW.js";import"./chunk-CVWWHM2V.js";import"./chunk-6OQYVEQJ.js";import"./chunk-XNHRPKJK.js";import"./chunk-YOXOWGT6.js";import"./chunk-EFZOSMYP.js";import"./chunk-WI7F4ZKJ.js";import"./chunk-MJ7M24NH.js";import"./chunk-GJH4QFRX.js";import"./chunk-T63F7663.js";import"./chunk-O4V2VBSK.js";import"./chunk-5TKRKB5E.js";import"./chunk-XAGMDNNR.js";import"./chunk-OP2TLIUN.js";import"./chunk-T2THIR6K.js";import"./chunk-LORHDXEB.js";import"./chunk-BBBPJI4H.js";import"./chunk-45BTW5EG.js";import"./chunk-TPFBHGDM.js";import"./chunk-73NLRHJD.js";import"./chunk-PNFEUBDF.js";import"./chunk-6RCCEJDL.js";import"./chunk-PQ2TNDUX.js";import"./chunk-6X6MKRQ3.js";import"./chunk-FQFHMHYU.js";import"./chunk-SZMEI3WL.js";import"./chunk-KKVGD67U.js";import"./chunk-MYOJWRDU.js";import"./chunk-L7UKJKHG.js";import"./chunk-V2IENAEU.js";import"./chunk-QAGQFNF2.js";import"./chunk-SY7JS2VW.js";import"./chunk-WK57SDN6.js";import"./chunk-AG4V3ZUO.js";import"./chunk-YWLMJ26A.js";import"./chunk-QAWNU3UJ.js";import"./chunk-HRQT4R6X.js";import"./chunk-44BHLWQ4.js";import"./chunk-5BPM64SU.js";import"./chunk-7PAP5DT2.js";import"./chunk-OY5GEC5R.js";import"./chunk-CZAUQJCN.js";import"./chunk-5GYPON2V.js";import"./chunk-TC4RVDI6.js";import"./chunk-WDY6ALC6.js";import"./chunk-KGFXFSTP.js";import"./chunk-PMVHHMQJ.js";import"./chunk-NAFOM5UA.js";import"./chunk-B526OXED.js";import"./chunk-XPTKDFYS.js";import"./chunk-ZYTQ7T5Q.js";import"./chunk-MZC42HHY.js";import"./chunk-DREO3ZIC.js";import"./chunk-L7OBQ2MX.js";import"./chunk-2SEACSJ7.js";import"./chunk-FTMCRRWI.js";import"./chunk-L54EYG5G.js";import"./chunk-DH7A4UPK.js";import"./chunk-JLE3XOUQ.js";import"./chunk-ERHGRSXY.js";import"./chunk-AMEUMZLJ.js";import"./chunk-VU2QHSDR.js";import"./chunk-QHZWU2K5.js";import"./chunk-JMNB6CKE.js";import"./chunk-L3RS33Q4.js";import"./chunk-ZUPR4L6O.js";import"./chunk-DO7UF2F2.js";import"./chunk-ZTR6OS44.js";import"./chunk-VRTKAD2J.js";import"./chunk-DBLKLHK2.js";import"./chunk-MROWXKZJ.js";import"./chunk-4TAYW5IF.js";import"./chunk-AR2JEA37.js";import"./chunk-IPLEDIX4.js";import"./chunk-RB3POJ2P.js";import"./chunk-HV62ZNCD.js";import"./chunk-UTE3ASAZ.js";import"./chunk-2AFEAPEX.js";import"./chunk-GNGXUEWV.js";import{a as te}from"./chunk-QBI5NDCA.js";import"./chunk-NOHW2DKR.js";import"./chunk-HVJAAM3A.js";import"./chunk-ACPEJEHK.js";import"./chunk-I7B3LWNP.js";import"./chunk-YP2E5N4E.js";import"./chunk-QLMNLSCT.js";import"./chunk-P55G5ATK.js";import"./chunk-JT3K52KQ.js";import"./chunk-SPLEGG4R.js";import"./chunk-Y4TJDUGP.js";import"./chunk-6PAFOJ4W.js";import"./chunk-74SDGE57.js";import"./chunk-FRXWHX3T.js";import"./chunk-DTDQ5X42.js";import"./chunk-RX2HFR4X.js";import"./chunk-AZW7YPTQ.js";import"./chunk-NJLJX4X6.js";import"./chunk-DZHFTD24.js";import"./chunk-K57Z4J34.js";import"./chunk-VWG3KVOU.js";import"./chunk-JOEUVLAN.js";import"./chunk-JZQDGIDQ.js";import"./chunk-CZ6CGC7I.js";import"./chunk-7B6U3N62.js";import"./chunk-46WDO5LS.js";import"./chunk-G5EYK5KM.js";import"./chunk-YJKJQU3F.js";import"./chunk-OK4K3OQT.js";import"./chunk-BPWNCOXC.js";import"./chunk-VNS4CQ27.js";import"./chunk-AVMO6LCR.js";import"./chunk-TEGPMVWT.js";import"./chunk-CLQRQC3Y.js";import"./chunk-KSNU73LO.js";import"./chunk-FACEVGRE.js";import"./chunk-5XTCPT52.js";import"./chunk-YW3L7OMP.js";import{a as Y}from"./chunk-JQAW4OB5.js";import"./chunk-72MRWGPJ.js";import"./chunk-2GF6YDKP.js";import"./chunk-DDZ3KR2Q.js";import"./chunk-TC77DYTW.js";import"./chunk-F2BQ2GD6.js";import"./chunk-R3XLNYYB.js";import{b as ee}from"./chunk-2HYVVLKS.js";import"./chunk-XRTA5GHC.js";import"./chunk-Y6XW36QP.js";import"./chunk-ZXKU6WBY.js";import"./chunk-RBVFFAW6.js";import"./chunk-XQOE7Z4Q.js";import"./chunk-BMYVPMAK.js";import"./chunk-6F25LG6O.js";import"./chunk-6KRFVLII.js";import"./chunk-7QY3BMVN.js";import"./chunk-Y7GY5YIF.js";import"./chunk-LMGYHZE3.js";import"./chunk-5LG2P6MT.js";import"./chunk-GJ2QRXGN.js";import"./chunk-EM35R6FY.js";import"./chunk-HKJZ7WI6.js";import"./chunk-DJW5LMRG.js";import"./chunk-DEH76MSI.js";import"./chunk-ALWV3RJ2.js";import"./chunk-QXXXCEV5.js";import"./chunk-6B5XFA6F.js";import"./chunk-TJ6P6NLD.js";import"./chunk-NX5B6XBR.js";import"./chunk-2JABY6DU.js";import"./chunk-MPRKSQLC.js";import"./chunk-57TARQ4F.js";import"./chunk-6RBQSBA2.js";import"./chunk-CSNRCIB5.js";import"./chunk-3JGYBNJA.js";import"./chunk-TQPBYYQ3.js";import"./chunk-DA3SDKGO.js";import"./chunk-ZOEPYNM4.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-BJH4F4SM.js";import"./chunk-Z3RBZHAK.js";import"./chunk-F5AJITOA.js";import"./chunk-IHATPE6U.js";import"./chunk-PU4AK46X.js";import"./chunk-73K3NWCV.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-JAPGPEA6.js";import"./chunk-ZC6EBRE4.js";import"./chunk-ZAZJB7CV.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import{b as X}from"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-D3CUKSGS.js";import"./chunk-2TX472ZB.js";import"./chunk-7QNKS2X6.js";import"./chunk-VCCMJ6BV.js";import"./chunk-QK56OQGR.js";import"./chunk-FXCL7YYQ.js";import"./chunk-QKO56XO6.js";import"./chunk-JRGT3GTH.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-VV5G7VY5.js";import"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-POX73EYJ.js";import"./chunk-NKUXRYJG.js";import"./chunk-P33JWG3G.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-2GJBUR2F.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import"./chunk-YPMM52MU.js";import"./chunk-BBR7CJCO.js";import"./chunk-VU5W7W6Y.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-O3EGNJTY.js";import"./chunk-GHKL3NOH.js";import"./chunk-WGAOVKGR.js";import"./chunk-MDSLION2.js";import{a as f}from"./chunk-AXYQJCCX.js";import{a as i,b as K}from"./chunk-5XCFNEYX.js";import{a as R}from"./chunk-GQL2MBZT.js";import{b as N}from"./chunk-EBIFNV2H.js";import"./chunk-MGGSCSBE.js";import"./chunk-Z6BYFM7E.js";import"./chunk-CFRDSUTM.js";import{j as J}from"./chunk-FB4M3WPV.js";import"./chunk-SLAWDKDA.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-3VRDAJCX.js";import"./chunk-WTB3O6DJ.js";import{a as A}from"./chunk-7P44K2YD.js";import"./chunk-32OAXCA4.js";import{b as P}from"./chunk-UST6HCE7.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import{a as m,b as Z,c as x,j as q}from"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import{b as z}from"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as l}from"./chunk-QGVBCWUY.js";import{c as D}from"./chunk-MYO4NP2N.js";import{e as n}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as M}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import{g as L}from"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{f as T}from"./chunk-VTHXE323.js";var S=de.clone(),pe="esri-utility-network-trace",we={base:pe,featureContent:`${pe}__feature-content`},k=class extends R{constructor(e,t){super(e,t),this._utilityNetworkTraceMessages=null,this.closed=!1,this.closable=!0,this.messages=null,this.messagesCommon=null,this._handleAddNonspatialTraceLocation=s=>{this.emit("add-nso-trace-location",{featureWidget:s})},this._handleOpenFeature=s=>{this.emit("open-feature",{feature:s})},this._handleZoomToFeature=s=>{this.emit("zoom-to-feature",{featureWidget:s})}}initialize(){T(this,null,function*(){this._utilityNetworkTraceMessages=yield P("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace")})}loadDependencies(){return N({action:()=>import("./chunk-X23M5IZ6.js"),"action-bar":()=>import("./chunk-ZZCREW2O.js"),"action-group":()=>import("./chunk-WQ2GF3MJ.js"),"flow-item":()=>import("./chunk-OQ4LXJHQ.js")})}get mode(){return this._get("mode")||"show-feature-info"}set mode(e){this._set("mode",e)}render(){let{flowItems:e}=this,t=e?.toArray();return i(K,null,t?.map((s,o)=>this._renderFlowItem(s,o===e.length-1)))}_renderAddNonspatialTraceLocationAction(e){let{_utilityNetworkTraceMessages:t}=this;return i("calcite-action",{appearance:"solid",bind:this,icon:"utility-network-trace",onclick:()=>this._handleAddNonspatialTraceLocation(e),scale:"s",text:t.inputsStrings.addNonspatialOption,textEnabled:!0,title:t.inputsStrings.addNonspatialOption})}_renderFlowItem(e,t){let{messages:s,closable:o,closed:a}=this,r="graphic"in e&&!e.isTable,c=e.flowType==="feature-association",h=this._getExitMessage(e),g=s.selectFeature,v=e,b=v?v.graphic?.layer:null,B=!(b&&b.geometryType);return i("calcite-flow-item",{bind:this,closable:o,closed:a,description:this._getDrillInFlowItemDescription(e),heading:e.title??"",key:`flow-item-${e.viewModel.uid}`,selected:t,onCalciteFlowItemBack:O=>{O.preventDefault(),this._handleDrillInBackClick()}},i("calcite-action",{appearance:"transparent",bind:this,class:w.actionExit,icon:"move-up",key:"exit-action",onclick:this._handleExitClick,slot:"header-actions-start",text:h,title:h}),r?i("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-feature-action",onclick:()=>this._handleOpenFeature(e),slot:"header-actions-end",text:g,title:g}):null,this.mode==="show-feature-info"?i("calcite-action",{icon:"x",onclick:()=>{this.emit("close")},slot:"header-actions-end",text:this.messagesCommon.close}):void 0,c&&this.mode==="add-nso"?i("calcite-action-bar",{expandDisabled:!0,expanded:!0,key:"header-action-bar",scale:"s",slot:"action-bar"},i("calcite-action-group",{overlayPositioning:"fixed",scale:"s"},B?this._renderAddNonspatialTraceLocationAction(e):this._renderZoomToFeatureAction(e))):null,i("div",{class:this.classes(w.container,we.featureContent)},e.render()))}_renderZoomToFeatureAction(e){let t=this._getActionTitle(S);return i("calcite-action",{active:S.active,appearance:"solid",bind:this,"data-action-uid":S.uid,disabled:S.disabled,icon:S.icon??"question",indicator:S.indicator,key:`action-${S.uid}`,loading:S.active,onclick:()=>this._handleZoomToFeature(e),scale:"s",text:t,textEnabled:!0,title:t})}_getActionTitle(e){let{messages:t}=this,{id:s}=e,o=e.title??"";return s==="zoom-to-feature"?A(o,{messages:t}):o}_getDrillInFlowItemDescription(e){switch(e.flowType){case"feature":case"feature-association":case"feature-utility-network-associations":return e.viewModel.description??"";case"feature-relationship":return e.allItemsDescription;case"feature-utility-network-association-type":return e.description??""}}_getExitMessage(e){switch(e.flowType){case"feature":case"feature-association":return"";case"feature-relationship":return this.messages.exitRelatedRecords;case"feature-utility-network-associations":case"feature-utility-network-association-type":return this.messages.exitAssociations}}_handleDrillInBackClick(){let e=this.flowItems?.pop();e&&("showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}_handleExitClick(){this.emit("exit")}};l([n()],k.prototype,"closed",void 0),l([n()],k.prototype,"closable",void 0),l([n()],k.prototype,"flowItems",void 0),l([n(),f("esri/widgets/Features/t9n/Features")],k.prototype,"messages",void 0),l([n(),f("esri/t9n/common")],k.prototype,"messagesCommon",void 0),l([n()],k.prototype,"mode",null),k=l([M("esri.widgets.UtilityNetworkTrace.UtilityNetworkTraceFeaturesDrillIn")],k);var ge=k;var ve="selected-index",be=0,me="features-spinner",I="esri-utility-network-trace",C={base:I,blockContainer:`${I}__block-container`,blockContent:`${I}__block-content`,featureContent:`${I}__feature-content`,paddingBottom:`${I}__pad-bottom`,paddingTop:`${I}__pad-top`},u=class extends le(R){constructor(e,t){super(e,t),this._actionBarMenuNode=null,this._drillInFlowItems=new z,this._drillInWidget=new ge({flowItems:this._drillInFlowItems}),this._feature=null,this._featureMenuViewportNode=null,this._spinner=null,this._utilityNetworkTraceMessages=null,this.featureNavigationTop=!1,this.headerActions=new $,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.responsiveActionsEnabled=!1,this.viewModel=new j,this._renderAction=(s,o)=>{let a=this._getActionTitle(s),{type:r,active:c,uid:h,disabled:g,indicator:v}=s;return s.visible?i("calcite-action",{active:r==="toggle"&&s.value,appearance:"solid",bind:this,"data-action-uid":h,disabled:s.id==="zoom-to-feature"?!this.feature.geometry:g,icon:this._getActionIcon(s),indicator:v,key:`action-${o}`,loading:c,onclick:this._triggerAction,scale:"s",text:a,title:this._hideActionText?a:void 0},this._renderFallbackIcon(s)):null},this._renderAddNsoBlock=()=>{let{_utilityNetworkTraceMessages:s,messagesCommon:o}=this;return i("calcite-block",{class:C.blockContent,heading:s?.inputsStrings.addNonspatialOption,open:!this.feature},i("calcite-action",{icon:"x",onclick:()=>this.emit("close-un-trace-feature-block"),slot:"control",text:o.close}),i("calcite-notice",{icon:"information",kind:"info",open:!this.feature},i("div",{slot:"message"},s?.inputsStrings.addNonspatialHint)))},this._renderNoAssociationNotice=()=>{let{_utilityNetworkTraceMessages:s}=this;return i("calcite-notice",{class:this.classes(C.paddingBottom,C.paddingTop),icon:"exclamation-mark-triangle",kind:"danger",open:!0},i("div",{slot:"message"},s.alertsStrings.noAssociationsConfigured))},this._renderNoPopupErrorBlock=()=>{let{_utilityNetworkTraceMessages:s,messagesCommon:o}=this;return i("calcite-block",{description:void 0,heading:this.mode==="show-feature-info"?o.warning:void 0,open:!0},i("calcite-notice",{class:this.classes(C.paddingBottom,C.paddingTop),icon:"exclamation-mark-triangle",kind:"danger",open:!0},i("div",{slot:"message"},s.alertsStrings.noPopupConfigured)),this.mode==="show-feature-info"?i("calcite-action",{icon:"x",onclick:()=>this.emit("close-un-trace-feature-block"),slot:"control",text:o.close}):void 0)},this._displaySpinnerThrottled=ie(()=>this._displaySpinner(),be),this.addHandles([this._displaySpinnerThrottled,m(()=>this.viewModel?.active,s=>this._drillInWidget.closed=!s),m(()=>this.viewModel?.view,(s,o)=>this._viewChange(s,o)),m(()=>this.viewModel?.view?.ready,(s,o)=>this._viewReadyChange(s??!1,o??!1)),m(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),m(()=>this.viewModel?.screenLocation,()=>this._closeOpenActionMenu()),m(()=>this.selectedFeatureWidget,()=>this._destroyDrillInFlowItemWidgets()),m(()=>{let s=this.selectedFeatureWidget?.viewModel;return[s?.title,s?.state]},()=>this._setTitleFromFeatureWidget()),m(()=>{let s=this.selectedFeatureWidget?.viewModel;return[s?.content,s?.state]},()=>this._setContentFromFeatureWidget()),m(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),this._drillInWidget.on("close",()=>{this.emit("close")}),this._drillInWidget.on("exit",()=>this._destroyDrillInFlowItemWidgets()),this._drillInWidget.on("open-feature",({feature:s})=>this._openRelatedFeature(s)),this._drillInWidget.on("zoom-to-feature",({featureWidget:s})=>ue(this.viewModel,s)),this._drillInWidget.on("add-nso-trace-location",({featureWidget:s})=>this.emit("add-nso-trace-location",{featureWidget:s}))])}initialize(){T(this,null,function*(){this._utilityNetworkTraceMessages=yield P("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace")}),this._drillInWidget.mode=this.mode,this._drillInWidget.closable=!1}loadDependencies(){return N({action:()=>import("./chunk-X23M5IZ6.js"),"action-bar":()=>import("./chunk-ZZCREW2O.js"),"action-group":()=>import("./chunk-WQ2GF3MJ.js"),block:()=>import("./chunk-LVVNNI43.js"),flow:()=>import("./chunk-5V3M627Q.js"),"flow-item":()=>import("./chunk-OQ4LXJHQ.js"),notice:()=>import("./chunk-PEKK3NZO.js")})}destroy(){this._destroyDrillInFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),this._drillInWidget?.destroy()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;let e=this.view?.widthBreakpoint;return e==="xsmall"||e==="small"||e==="medium"}get active(){return this.viewModel.active}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get feature(){return this.viewModel.features.length?this.viewModel.features[0]:null}set feature(e){this.viewModel.features=e?[e]:[]}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get hasAssociationsPopupElement(){let e=G(this.feature?.layer)?this.feature?.layer:void 0,t=H(this.feature?.layer)?this.feature?.layer:void 0,s=e?.popupTemplate||t?.popupTemplate||null,o=s?.content;return!(Array.isArray(o)&&!o.some(a=>a instanceof te))}get hasPopupInfo(){let e=G(this.feature?.layer)?this.feature?.layer:void 0,t=H(this.feature?.layer)?this.feature?.layer:void 0;return!(!e?.popupTemplate&&!t?.popupTemplate)}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get mode(){return this._get("mode")||"add-nso"}set mode(e){this._set("mode",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){let e=Array.from(this._drillInFlowItems).at(-1);if(!e)return null;let{flowType:t}=e;return t==="feature-association"||t==="feature-relationship"?e.graphic??null:null}get selectedFeatureWidget(){let{_feature:e,headingLevel:t,_drillInFlowItems:s,timeZone:o}=this,{selectedFeatureViewModel:a}=this.viewModel,r={title:!1};return a?(e?(e.viewModel=a,e.visibleElements=r):this._feature=new ne({flowItems:s,headingLevel:t+1,timeZone:o,viewModel:a,visibleElements:r}),this._feature):null}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}open(e){this.removeHandles(ve),this.viewModel.open({features:[e]})}triggerAction(e){return this.viewModel.triggerAction(e)}render(){return i("div",{bind:this,class:this.classes(w.base,F.widget,F.panel,C.blockContainer)},this.mode==="add-nso"?this._renderAddNsoBlock():void 0,this.feature?this.hasPopupInfo?this._renderContentContainer():this._renderNoPopupErrorBlock():void 0)}_renderActionBar(){return this.viewModel.allActions?.length?i("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},i("calcite-action-group",{afterCreate:e=>this._actionBarMenuNode=e,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){let e=this.viewModel?.content;return e?typeof e=="string"?i("div",{class:ae.contentNode,innerHTML:e,key:e}):this.renderNodeContent(e):null}_renderContentContainer(){let e=[this._renderContentFeature(),this._drillInWidget.render()];return i("calcite-flow",{key:"content-container"},e)}_renderContentFeature(){let{_drillInFlowItems:e,headingLevel:t,featureNavigationTop:s}=this,{title:o,active:a}=this.viewModel,r=o||"";return i("calcite-flow-item",{bind:this,class:this.classes({[w.contentFeature]:!0}),closed:!a,collapseDirection:s?"down":"up",headingLevel:t,key:"root-flow-item",loading:this.viewModel.waitingForContents,selected:e.length===0},this.mode==="show-feature-info"?i("calcite-action",{icon:"x",onclick:()=>{this.emit("close")},slot:"header-actions-end",text:this.messagesCommon.close}):void 0,r?i(re,{class:this.classes(w.featuresHeading,F.heading),innerHTML:r,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),this.hasAssociationsPopupElement?void 0:this._renderNoAssociationNotice(),i("div",{class:this.mode==="add-nso"?this.classes(w.container,w.contentContainer):this.classes(w.container,w.contentContainer,C.featureContent)},this._renderContent()))}_renderFallbackIcon(e){let{className:t,icon:s}=e;if(s)return null;let o=oe({action:e,feature:this.selectedFeature}),a={[w.icon]:!!t,[w.actionImage]:!!o};return t&&(a[t]=!0),o||t?i("span",{"aria-hidden":"true",class:this.classes(w.icon,a),key:"icon",styles:se(o)}):null}_renderHeaderAction(e,t){let s=e.title||"";return e.visible?i("calcite-action",{active:e.type==="toggle"&&e.value,appearance:"solid",bind:this,"data-action-uid":e.uid,disabled:e.disabled||!this.feature.geometry,icon:e.icon??void 0,indicator:e.indicator,key:`header-action-${t}`,loading:e.active,onclick:this._triggerHeaderAction,slot:"header-actions-end",text:s,title:s}):null}_renderHeaderActions(){return this.headerActions.map((e,t)=>this._renderHeaderAction(e,t)).toArray()}_closeOpenActionMenu(){let{_actionBarMenuNode:e}=this;e&&(e.menuOpen=!1)}_createSpinner(e){e&&(this._spinner=new ce({view:e}),e.ui.add(this._spinner,{key:me,position:"manual",internal:!0}))}_destroyDrillInFlowItemWidgets(){this._drillInFlowItems.drain(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_destroySelectedFeatureWidget(){let{_feature:e}=this;e&&(e.viewModel=null,!e.destroyed&&e.destroy()),this._feature=null}_destroySpinner(){let{_spinner:e,view:t}=this;e&&(t?.ui?.remove(e,me),e.destroy(),this._spinner=null)}_displaySpinner(){let{_spinner:e}=this;if(!e)return;let{location:t,waitingForResult:s}=this.viewModel;s&&t?e.show({location:t}):e.hide()}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_getActionIcon(e){return e.icon?e.icon:e.image||e.className?void 0:"question"}_getActionTitle(e){let{messages:t,selectedFeature:s,messagesCommon:o}=this,{id:a}=e,r=s?.attributes,c=e.title??"",h=a==="zoom-to-feature"?A(c,{messages:t}):a==="remove-selected-feature"?A(c,{messages:o}):a==="zoom-to-clustered-features"||a==="browse-clustered-features"?A(c,{messages:t}):e.title;return h&&r?A(h,r):h??""}_hideSpinner(){let{_spinner:e}=this;e&&(e.location=null,e.hide())}_openRelatedFeature(e){return T(this,null,function*(){yield e.viewModel.updateGeometry();let t=e.graphic,s=t?.geometry;s!=null&&t!=null&&(this._destroyDrillInFlowItemWidgets(),yield this.viewModel.zoomTo({target:s}),this.open(t))})}_setContentFromFeatureWidget(){let{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_setTitleFromFeatureWidget(){let{selectedFeatureWidget:e,messagesCommon:t}=this,s=e?.viewModel;e&&(this.viewModel.title=s?.state==="error"?t?.errorMessage:s?.title||"")}_triggerAction(e){let t=e.currentTarget;if(t.disabled)return;let s=t.dataset.actionUid,{allActions:o}=this.viewModel,a=o.findIndex(c=>c.uid===s),r=o.at(a);r&&r.type==="toggle"&&(r.value=!r.value),this.viewModel.triggerAction(a)}_triggerHeaderAction(e){let t=e.currentTarget;if(t.disabled)return;let s=t.dataset.actionUid,o=this.headerActions.find(({uid:a})=>a===s);o&&!o.disabled&&(o?.type==="toggle"&&(o.value=!o.value),this.emit("trigger-header-action",{action:o}))}_viewReadyChange(e,t){e?this._wireUpView(this.viewModel?.view):t&&this.viewModel.clear()}_viewChange(e,t){e&&t&&this.viewModel.clear()}_wireUpView(e){this._destroySpinner(),e&&this._createSpinner(e)}};l([n()],u.prototype,"_drillInFlowItems",void 0),l([n()],u.prototype,"_hideActionText",null),l([n({readOnly:!0})],u.prototype,"active",null),l([n()],u.prototype,"content",null),l([n()],u.prototype,"feature",null),l([n()],u.prototype,"featureNavigationTop",void 0),l([n()],u.prototype,"goToOverride",null),l([n()],u.prototype,"hasAssociationsPopupElement",null),l([n()],u.prototype,"hasPopupInfo",null),l([n({type:$})],u.prototype,"headerActions",void 0),l([n()],u.prototype,"headingLevel",void 0),l([n()],u.prototype,"location",null),l([n(),f("esri/widgets/Features/t9n/Features")],u.prototype,"messages",void 0),l([n(),f("esri/t9n/common")],u.prototype,"messagesCommon",void 0),l([n()],u.prototype,"mode",null),l([n()],u.prototype,"promises",null),l([n()],u.prototype,"responsiveActionsEnabled",void 0),l([n({readOnly:!0})],u.prototype,"selectedFeature",null),l([n({readOnly:!0})],u.prototype,"selectedDrillInFeature",null),l([n({readOnly:!0})],u.prototype,"selectedFeatureWidget",null),l([n()],u.prototype,"timeZone",null),l([n()],u.prototype,"view",null),l([n({type:j}),W(["triggerAction","trigger-action"])],u.prototype,"viewModel",void 0),u=l([M("esri.widgets.UtilityNetworkTrace.UtilityNetworkTraceFeature")],u);var V=u;var y="esri-utility-network-trace",p={base:y,addButtonContainer:`${y}__add-button-container`,blockContainer:`${y}__block-container`,blockContent:`${y}__block-content`,clearPrompt:`${y}__reset-prompt`,doublePaddingTop:`${y}__double-pad-top`,flow:`${y}__flow`,listContainer:`${y}__list-container`,noticeContainer:`${y}__notice-container`,numberInput:`${y}__number-input`,promptDivider:`${y}__divider`};function ye(e){return{height:e+"px"}}function fe(e){return{width:e+"px"}}function Te(){return{width:"75%"}}function ke(e){return{width:"100%",height:window.getComputedStyle(e).getPropertyValue("max-height")}}function _e(e){return{display:"flex",flexDirection:e}}function Fe(e){return e instanceof X}var Se={noExtension:-2147208474},d=class extends R{constructor(e,t){super(e,t),this._activeTab="input",this._activeTrace=null,this._activeSwatch="",this._addNonspatialObjectActive=!1,this._alertRemoveModal=!1,this._assetGroupHeader="",this._assetTypeHeader="",this._confirmReset=!1,this._errorMessage="",this._swatchNode=null,this._selectToolActive=!1,this._showFeatureInfoActive=!1,this._traceHeaderForFlow="",this._traceResultsFunctions=[],this._traceResultsAssetGroup=[],this._traceResultsAssetType=[],this._traceResultsIndividual=[],this._traceResultsState="result",this._warningNoFlag=!1,this._warningNoTraceSelected=!1,this._findNonspatialFeatureWidget=new V({mode:"add-nso"}),this._individualResultNode=null,this._loadUnError=!0,this._resultDisplayField="objectid",this._resultFeatureWidget=new V({mode:"show-feature-info"}),this._resultObjectIdField="objectid",this._resultSortField="objectid",this._resultSortOrder="desc",this._showResultOptions=!1,this._symbolStartFlag=null,this._symbolBarrier=null,this._traceLocationType="starting-point",this._updatingHandles=new Y,this._warningNoBarrierAssetFound=!1,this._warningNoBarrierAssetNsoFound=!1,this._warningNoStartAssetFound=!1,this._warningNoStartAssetNsoFound=!1,this._warningNoTerminal=!1,this._wasPopupEnabled=!1,this._watchHandler=null,this.disabled=!0,this.inputSettings=[],this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new U,this._afterComponentCreate=this._afterComponentCreate.bind(this)}initialize(){this._utilityNetworkTraceInitialized(),this.addHandles([m(()=>this.view,()=>this._viewChangeHandle(),q),m(()=>this.viewModel?.resultAreaProperties,()=>this.scheduleRender()),m(()=>this._addNonspatialObjectActive,e=>{this._findNonspatialFeatureWidget.feature=null,e?this._changeCursor("crosshair"):this.view.popupEnabled=this._wasPopupEnabled}),m(()=>this._showFeatureInfoActive,e=>{e||(this._resultFeatureWidget.feature=null,this.view.popupEnabled=this._wasPopupEnabled)}),x(()=>this._findNonspatialFeatureWidget,"add-nso-trace-location",({featureWidget:e})=>{this.viewModel.addNonspatialTraceLocation(e.graphic,this._traceLocationType),this._warningNoFlag=!1,this._addNonspatialObjectActive=!1}),x(()=>this._findNonspatialFeatureWidget,"close-un-trace-feature-block",()=>{this._changeCursor("default"),this._addNonspatialObjectActive=!1,this.viewModel.cancelAddFlagByHit()}),x(()=>this._resultFeatureWidget,"close-un-trace-feature-block",()=>{this._showFeatureInfoActive=!1}),x(()=>this._resultFeatureWidget,"close",()=>{this._resetResultFeatureWidget()})])}destroy(){this._findNonspatialFeatureWidget?.destroy(),this._resultFeatureWidget?.destroy()}get defaultGraphicColor(){return this.viewModel.defaultGraphicColor}set defaultGraphicColor(e){this.viewModel.defaultGraphicColor=e}get enableResultArea(){return this.viewModel.enableResultArea}set enableResultArea(e){this.viewModel.enableResultArea=e}get flags(){return this.viewModel.flags}set flags(e){this.viewModel.flags=e}get gdbVersion(){return D(L.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this.viewModel.gdbVersion}set gdbVersion(e){D(L.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this.viewModel.gdbVersion=e}get icon(){return"utility-network-trace"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get resultAreaProperties(){return this.viewModel.resultAreaProperties}set resultAreaProperties(e){this.viewModel.resultAreaProperties=e}get selectedTraces(){return this.viewModel.selectedTraces}set selectedTraces(e){this.viewModel.selectedTraces=e}get selectOnComplete(){return this.viewModel.selectOnComplete}set selectOnComplete(e){this.viewModel.selectOnComplete=e}get showGraphicsOnComplete(){return this.viewModel.showGraphicsOnComplete}set showGraphicsOnComplete(e){this.viewModel.showGraphicsOnComplete=e}get showSelectionAttributes(){return this.viewModel.showSelectionAttributes}set showSelectionAttributes(e){this.viewModel.showSelectionAttributes=e}get utilityNetwork(){return this.viewModel.utilityNetwork}set utilityNetwork(e){this.viewModel.utilityNetwork=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}checkCanTrace(){return T(this,null,function*(){this._confirmReset=!1,this._resetResultFeatureWidget();let e=this.viewModel.checkCanTrace();e.status?(this._warningNoFlag=!1,this._warningNoTraceSelected=!1,this._warningNoTerminal=!1,this._traceResultsState="result",this.switchTab("results"),this.viewModel._activeProgress=!0,this.viewModel.removeAllResultAreaGraphics(),yield this.viewModel.callTrace(),this.viewModel._activeProgress=!1):e.issues.forEach(t=>{switch(t){case"noStartingPoints":this._warningNoFlag=!0;break;case"noTerminalSelected":this._warningNoTerminal=!0;break;default:this._warningNoTraceSelected=!0}})})}confirmReset(){this._confirmReset=!0}render(){return this._mixCustomStrings(),this._overrideFlagSymbol(),i("div",{class:this.classes(p.base,F.widget,F.panel,{[F.widgetDisabled]:this.disabled})},this._renderUtilityNetworkTrace())}loadDependencies(){return N({action:()=>import("./chunk-X23M5IZ6.js"),"action-group":()=>import("./chunk-WQ2GF3MJ.js"),"action-pad":()=>import("./chunk-D2QBOSYD.js"),block:()=>import("./chunk-LVVNNI43.js"),"block-section":()=>import("./chunk-VJ6UDM3T.js"),button:()=>import("./chunk-K3RCADAN.js"),checkbox:()=>import("./chunk-NV4IBMC5.js"),"color-picker-swatch":()=>import("./chunk-47XB5ZDY.js"),combobox:()=>import("./chunk-UQBNFKHV.js"),"combobox-item":()=>import("./chunk-L2XDWQVU.js"),"dropdown-group":()=>import("./chunk-KPY43GC2.js"),"dropdown-item":()=>import("./chunk-XJK7VSUG.js"),fab:()=>import("./chunk-5V3M627Q.js"),flow:()=>import("./chunk-FUL2XPUS.js"),"flow-item":()=>import("./chunk-OQ4LXJHQ.js"),icon:()=>import("./chunk-7Z2RNQA3.js"),"input-number":()=>import("./chunk-M6HYH3SF.js"),label:()=>import("./chunk-S24JESVO.js"),list:()=>import("./chunk-4MPCQ5DO.js"),"list-item":()=>import("./chunk-MRM6JRFU.js"),loader:()=>import("./chunk-4Z3TWS6O.js"),notice:()=>import("./chunk-PEKK3NZO.js"),option:()=>import("./chunk-MKZWVLGJ.js"),panel:()=>import("./chunk-GS5FRZ5P.js"),popover:()=>import("./chunk-J5HY7FQ5.js"),scrim:()=>import("./chunk-R5U5AYSV.js"),select:()=>import("./chunk-YZG2OI4V.js"),"split-button":()=>import("./chunk-47QWBWYN.js"),tab:()=>import("./chunk-QWEX3TQE.js"),"tab-nav":()=>import("./chunk-RAA7X62R.js"),"tab-title":()=>import("./chunk-MHNLI2TW.js"),tabs:()=>import("./chunk-E6OOE5IL.js")})}switchTab(e){this._activeTab=e}switchToFromAssetGroup(e,t,s){this._traceHeaderForFlow=t,this._traceResultsAssetGroup=e,this._traceResultsState=s}switchToFromAssetType(e,t,s){this._assetGroupHeader=t,this._traceResultsAssetType=e,this._traceResultsState=s}switchToFromFunctions(e,t){this._traceResultsFunctions=e,this._traceResultsState=t}switchToFromIndividualRecords(e,t,s){this._assetTypeHeader=t,this._traceResultsIndividual=e,this._traceResultsState=s}_renderAddNonspatialLocationBlock(){let{messages:e}=this;return i("calcite-block",{key:`${this.id}__add-spatial-location-block`,label:e.inputsStrings.addNonspatialOption,open:!0},this._findNonspatialFeatureWidget.render())}_renderAddSpatialLocationBlock(){let{messages:e,messagesCommon:t}=this;return i("calcite-block",{class:p.blockContent,heading:this._traceLocationType==="starting-point"?e.inputsStrings.headerStartingPoint:e.inputsStrings.headerBarrier,key:`${this.id}__add-nonspatial-location-block`,label:this._traceLocationType==="starting-point"?e.inputsStrings.headerStartingPoint:e.inputsStrings.headerBarrier,open:!0},i("calcite-action",{icon:"x",onclick:()=>{this.viewModel.removeClickHandler(),this.view?.popup&&(this.view.popupEnabled=this._wasPopupEnabled),this._changeCursor("default"),this._selectToolActive=!1},slot:"control",text:t.close}),i("calcite-notice",{icon:this._traceLocationType==="starting-point"?"pin-plus":"x-circle-f",kind:"info",open:!0},i("div",{slot:"message"},e.inputsStrings.addPointHint)))}_renderClearTraceResultsBlock(){let{messages:e,messagesCommon:t}=this;return i("calcite-scrim",{key:"prompt"},i("div",{class:p.clearPrompt},i("h3",{slot:"header"},e.resultsStrings.startOverButton),i("div",{slot:"content"},e.resultsStrings.startOverValidation),i("div",{class:p.promptDivider}),i("div",{styles:_e("row")},i("calcite-button",{appearance:"outline",onclick:()=>{this._confirmReset=!1},slot:"secondary",width:"full"},t.cancel),i("calcite-button",{onclick:()=>{this._confirmReset=!1,this.viewModel.reset(),this.switchTab("input")},slot:"primary",width:"full"},t.form.ok))))}_renderExecutingTraceBlock(){let{messages:e}=this;return i("calcite-loader",{label:e.alertsStrings.traceExecuting,text:e.alertsStrings.traceExecuting,type:"indeterminate"})}_renderInputBlock(){let{messages:e}=this;return i("calcite-block",{class:p.blockContainer,key:`${this.id}__inputs-block`,label:e.inputsStrings.headerTabInputs,open:!0},i("calcite-flow",{class:p.flow},i("calcite-flow-item",{key:`${this.id}__inputs-flow-item`,selected:!this._selectToolActive&&!this._addNonspatialObjectActive},this._warningNoFlag?this._renderWarningMessage("flag",!0):null,this._warningNoTerminal?this._renderWarningMessage("noTerminal",!0):null,this._warningNoTraceSelected?this._renderWarningMessage("trace",!0):null,this._renderTraceSelectorContainer(),this._renderStartFlagsContainer(),this._renderBarriersFlagsContainer(),this._warningNoFlag&&this._warningNoTraceSelected?i("div",{styles:ye(10)}):null,i("calcite-fab",{appearance:"solid",icon:"utility-network-trace",kind:"brand",onclick:()=>{this.checkCanTrace()},slot:"fab",text:e.tracingStrings.runTrace,textEnabled:!0,title:e.tracingStrings.runTrace,type:"button"}))))}_renderInputsTab(){let{messagesCommon:e}=this,t="input";return this._selectToolActive&&!this._addNonspatialObjectActive&&(t="add-spatial-location"),!this._selectToolActive&&this._addNonspatialObjectActive&&(t="add-nso-location"),this.disabled&&(t="loading"),i("calcite-tab",{key:`${this.id}__inputs-tab-item`,selected:this._activeTab==="input"},t==="loading"?i("calcite-loader",{label:e.loading,type:"indeterminate"}):null,t==="input"?this._renderInputBlock():null,t==="add-spatial-location"?this._renderAddSpatialLocationBlock():null,t==="add-nso-location"?this._renderAddNonspatialLocationBlock():null)}_renderBarriersFlagsContainer(){let{messages:e}=this,t=[],s=[];s=this.viewModel._flags.filter(a=>a.type==="barrier"),s.forEach(a=>{a.displayValue&&t.push(this._renderFlagRow(a,"barrier"))});let o=null;return this._symbolBarrier&&(o=this._getSymbolIcon(this._symbolBarrier)),i("calcite-block",{class:p.blockContent,collapsible:!0,heading:e.inputsStrings.headerBarrier+" ("+s.length+")",open:!0,overlayPositioning:"fixed"},i("div",{slot:"icon"},o||i("calcite-icon",{icon:"x-circle-f",scale:"s"})),i("div",null,e.inputsStrings.barrierPointHint),i("div",{class:p.listContainer},t),this._warningNoBarrierAssetFound?this._renderWarningMessage("noBarrierAsset",!0):null,this._warningNoBarrierAssetNsoFound?this._renderWarningMessage("noBarrierAssetNso",!0):null,i("div",{class:p.addButtonContainer},i("calcite-split-button",{appearance:"outline-fill",primaryIconStart:"select",primaryText:e.inputsStrings.addPointOption,onCalciteSplitButtonPrimaryClick:()=>{this._setupAddTraceLocation("barrier")}},i("calcite-dropdown-group",{selectionMode:"none"},i("calcite-dropdown-item",{onCalciteDropdownItemSelect:()=>{this._setupAddNonspatialObject("barrier")}},e.inputsStrings.addNonspatialOption)))))}_renderFlagRow(e,t){let{messages:s,messagesCommon:o}=this,a=[],r=!1;return e.allTerminals!=null&&e.allTerminals.terminals.length>0&&(r=!0,e.allTerminals.terminals.forEach(c=>{let h=!1;e?.selectedTerminals?.includes(c.id)&&(h=!0),a.push(i("calcite-combobox-item",{key:c.name,selected:h,textLabel:c.name,value:c.id}))})),i("calcite-block",{collapsible:e.allTerminals!==null||e.type==="barrier",heading:e.displayValue?.value??"",key:"pop"+e.globalId+e.type+e.id+t,overlayPositioning:"fixed"},i("calcite-action",{icon:"trash",label:o.remove,onclick:()=>{this.viewModel.removeFlag(e)},scale:"s",slot:"header-menu-actions",text:o.remove,textEnabled:!0}),e.mapGraphic&&e.mapPoint?i("calcite-action",{icon:"zoom-to-object",label:s.globalStrings.zoomToFeature,onclick:()=>{this.viewModel.zoomToAsset(e.details.geometry)},scale:"s",slot:"header-menu-actions",text:s.globalStrings.zoomToFeature,textEnabled:!0}):null,e.type==="barrier"?i("calcite-label",{layout:"inline",scale:"s"},i("calcite-checkbox",{checked:e.isFilterBarrier,onclick:()=>{this.viewModel.manageFilterBarrier(!e.isFilterBarrier,e)},scale:"s"}),s.inputsStrings.barrierFilter):null,r?i("calcite-combobox",{label:s.globalStrings.selectTerminalPlaceholder,maxItems:0,overlayPositioning:"fixed",placeholder:s.globalStrings.selectTerminalPlaceholder,scale:"s",selectionMode:"multiple",onCalciteComboboxChange:c=>{c.currentTarget.selectedItems.length>0?(e.selectedTerminals=[],c.currentTarget.selectedItems.forEach(h=>{this.viewModel.addTerminal(h.value,e)})):e.selectedTerminals=[]},onCalciteComboboxChipClose:c=>{c.preventDefault(),this.viewModel.removeTerminal(c.currentTarget.value,e)}},a):null)}_renderHighlightColorPicker(e,t,s){let{messages:o}=this,{graphicHandler:a}=this.viewModel,r=[],c=new RegExp(`^${e.hex}$`,"i"),h=a.highlightColor.length>he.length?5:4;for(let g of a.highlightColor)r.push(i("calcite-action",{active:c.test(g.hex),key:g.hex,label:o.resultsStrings.graphicColor,onclick:()=>{s==="aggregate"?this.viewModel.changeResultGraphicColor(g,t):this.viewModel.changeResultAreaColor(t,g)},scale:"s",text:o.resultsStrings.graphicColor},i("calcite-color-picker-swatch",{active:c.test(g.hex),color:g.hex,scale:"s"})));return i("calcite-action-pad",{expandDisabled:!0,layout:"grid",position:"start"},i("calcite-action-group",{columns:h},r))}_renderRemoveTraceContainer(e){let{messages:t}=this;return i("calcite-action",{icon:"trash",label:t.globalStrings.clearResults,onclick:()=>{this._alertRemoveModal=!0,this._activeTrace=e.trace},scale:"s",slot:"header-menu-actions",text:t.globalStrings.clearResults,textEnabled:!0})}_renderResultsTab(){let e="results";return this._showFeatureInfoActive&&(e="show-feature-info"),this.viewModel._activeProgress&&(e="executing"),this._confirmReset&&(e="clear-trace-results"),i("calcite-tab",{key:`${this.id}__results-tab-item`},e==="executing"?this._renderExecutingTraceBlock():null,e==="results"?this.viewModel.traceResults.length?this._renderResultsPanel():this._renderWarningMessage("noTraceExecuted",!1):null,e==="show-feature-info"?this._renderShowFeatureInfoBlock():null,e==="clear-trace-results"?this._renderClearTraceResultsBlock():null)}_renderResultsPanel(){let{messages:e}=this;return i("calcite-block",{class:p.blockContainer,key:`${this.id}__results-block`,label:e.resultsStrings.headerTabResults,open:!0},i("calcite-flow",{class:p.flow},this._renderTraceResults(),this._renderTraceResultFunctions(),this._renderTraceResultByAssetGroup(),this._renderTraceResultByAssetType(),this._renderTraceResultIndividual()))}_renderResultRowFunctions(e){return i("calcite-block",{collapsible:!1,heading:e.networkAttributeName+" "+e.functionType+" = "+e.result,overlayPositioning:"fixed"})}_renderResultRowAssetGroup(e){let t=this._getAssetGroupName(e[0]);return i("calcite-list-item",{key:`${t}-${e.assetGroupCode}`,label:t+" ("+e.length+")",onCalciteListItemSelect:()=>{this.switchToFromAssetType(this._groupResultsByAssetType(e),t+" ("+e.length+")","assetType")}},i("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderResultRowAssetType(e){let t=this._getAssetTypeName(e[0]);return i("calcite-list-item",{key:`${t}-${e.assetTypeCode}`,label:t+" ("+e.length+")",onCalciteListItemSelect:()=>{this._updatingHandles.addPromise(this.viewModel.queryFeaturesById(e).then(s=>{if(s?.length){this._resultObjectIdField=s[0].layer.objectIdField,this._resultDisplayField==="objectid"&&(this._resultDisplayField=s[0].layer.objectIdField),this._resultSortField==="objectid"&&(this._resultSortField=s[0].layer.objectIdField);let o=this._appendAttributes(e,s,"objectId");this.switchToFromIndividualRecords(o,t+" ("+e.length+")","records")}else this.switchToFromIndividualRecords(e,t+" ("+e.length+")","records")}))}},i("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderResultRowIndividual(e){let{messages:t}=this,s,o=null;return o=e?.details?.fields.find(({name:a})=>a===this._resultDisplayField),o?.type==="date"?s=new Date(e.details.attributes[this._resultDisplayField]).toDateString():this._resultDisplayField.toLowerCase()==="assetgroup"?s=this._getAssetGroupName(e):this._resultDisplayField.toLowerCase()==="assettype"?s=this._getAssetTypeName(e):o?.domain&&Fe(o.domain)?s=o.domain.codedValues.find(({code:r})=>r===e.details.attributes[this._resultDisplayField])?.name:s=e.details?.attributes[this._resultDisplayField]??e.objectId,s&&s!==""&&s!==null?typeof s=="string"&&(s.trim()||(s=t.resultsStrings.noValue)):s=t.resultsStrings.noValue,i("calcite-list-item",{key:e.details.uid,label:s,onCalciteListItemSelect:()=>T(this,null,function*(){this._disablePopup(),this._showFeatureInfoActive=!0;let a=Q(e.details?.layer)?e.details?.layer:null;if(a){let r=Object.keys(e.details.attributes).find(b=>b.toLowerCase()===a.subtypeField.toLowerCase())??"assetgroup",c=a.sublayers.find(b=>b.subtypeCode===e.details.attributes[r]),h=Object.keys(e.details.attributes).find(b=>b.toLowerCase()===a.objectIdField.toLowerCase())??"objectid",g=new ee;g.outFields=["*"],g.returnGeometry=!0,g.where=h+" = "+e.details.attributes[h];let v=yield c?.queryFeatures(g);v&&this._resultFeatureWidget.open(v.features[0])}else this._resultFeatureWidget.open(e.details)})},i("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderShowFeatureInfoBlock(){let{messages:e}=this;return i("calcite-block",{class:p.blockContainer,key:`${this.id}__show-feature-info-block`,label:e.resultsStrings.headerFeatureInfo,open:!0},this._resultFeatureWidget.render())}_renderStartFlagsContainer(){let{messages:e}=this,t=[],s=[];s=this.viewModel._flags.filter(a=>a.type==="starting-point"),s.forEach(a=>{a.displayValue&&t.push(this._renderFlagRow(a,"start"))});let o=null;return this._symbolStartFlag&&(o=this._getSymbolIcon(this._symbolStartFlag)),i("calcite-block",{class:p.blockContent,collapsible:!0,heading:e.inputsStrings.headerStartingPoint+" ("+s.length+")",open:!0,overlayPositioning:"fixed"},i("div",{slot:"icon"},o||i("calcite-icon",{icon:"pin",scale:"s"})),i("div",null,e.inputsStrings.startingPointHint),i("div",{class:p.listContainer},t),this._warningNoStartAssetFound?this._renderWarningMessage("noStartAsset",!0):null,this._warningNoStartAssetNsoFound?this._renderWarningMessage("noStartAssetNso",!0):null,i("div",{class:p.addButtonContainer},i("calcite-split-button",{appearance:"outline-fill",primaryIconStart:"select",primaryText:e.inputsStrings.addPointOption,onCalciteSplitButtonPrimaryClick:()=>{this._setupAddTraceLocation("starting-point")}},i("calcite-dropdown-group",{selectionMode:"none"},i("calcite-dropdown-item",{onCalciteDropdownItemSelect:()=>{this._setupAddNonspatialObject("starting-point")}},e.inputsStrings.addNonspatialOption)))))}_renderStartOverContainer(){let{messages:e}=this;return i("calcite-fab",{appearance:"solid",icon:"trash",kind:"brand",onclick:()=>{this.confirmReset()},slot:"fab",text:e.resultsStrings.startOverButton,textEnabled:!0,title:e.resultsStrings.startOverButton,type:"button"})}_renderTraceResultByAssetGroup(){let e=this._traceResultsAssetGroup,t=[];for(let s in e){let o=e[s];for(let a in o)t.push(this._renderResultRowAssetGroup(o[a]))}return i("calcite-flow-item",{heading:this._traceHeaderForFlow,key:"assetGroupResultMultiple",selected:this._traceResultsState==="assetGroup",onCalciteFlowItemBack:()=>{this.switchToFromAssetGroup([],"","result")}},i("calcite-list",{label:""},t),this._renderStartOverContainer())}_renderTraceResultByAssetType(){let e=this._traceResultsAssetType,t=[];for(let s in e)e[s].length>0&&t.push(this._renderResultRowAssetType(e[s]));return i("calcite-flow-item",{heading:this._assetGroupHeader,key:"assetTypeResult",loading:this._updatingHandles.updating,selected:this._traceResultsState==="assetType",onCalciteFlowItemBack:()=>{this.switchToFromAssetType([],"","assetGroup")}},i("calcite-list",{label:"",selectionMode:"none"},t),this._renderStartOverContainer())}_renderTraceResultFunctions(){if(this._traceResultsState!=="functions")return null;let{messages:e}=this,t=this._traceResultsFunctions,s=[];return t.forEach(o=>{s.push(this._renderResultRowFunctions(o))}),i("calcite-flow-item",{heading:e.resultsStrings.functionHeader,key:"functionResultMultiple",selected:this._traceResultsState==="functions",onCalciteFlowItemBack:()=>{this.switchToFromFunctions([],"result")}},s,this._renderStartOverContainer())}_renderTraceResultIndividual(){let{messages:e}=this,t=this._traceResultsIndividual;t.sort(this._compare(this._resultSortField,this._resultSortOrder));let s=[];return t.length>0&&((t[0].details?.fields.some(({name:o})=>o.toLowerCase()===this._resultDisplayField.toLocaleLowerCase())??!1)||(this._resultDisplayField=this._resultObjectIdField,this._resultSortField=this._resultObjectIdField),t.forEach(o=>{o?.details&&s.push(this._renderResultRowIndividual(o))}),s.length===0&&s.push(i("calcite-list-item",{label:e.resultsStrings.noFeaturesInMap}))),i("calcite-flow-item",{heading:this._assetTypeHeader,key:"individualResult",selected:this._traceResultsState==="records",onCalciteFlowItemBack:()=>{this._showResultOptions=!1,this.switchToFromIndividualRecords([],"","assetType")}},i("calcite-action",{afterCreate:J,bind:this,"data-node-ref":"_individualResultNode",icon:"gear",id:"field_options"+this.id,label:e.resultsStrings.displayAttribute,onclick:()=>{this._showResultOptions=!0},slot:"header-actions-end",text:e.resultsStrings.displayAttribute}),this._renderTraceResultIndividualPopover(),i("calcite-list",{label:"",selectionMode:"none"},s),this._renderStartOverContainer())}_renderTraceResultIndividualPopover(){let{messages:e}=this,t=this._traceResultsIndividual,s=[],o=[];return t.length>0&&(t[0].details?t[0].details.fields.forEach(({name:a,alias:r})=>{s.push(i("calcite-option",{key:`display-${a}`,label:r??a,selected:a===this._resultDisplayField,value:a})),o.push(i("calcite-option",{key:`sort-${a}`,label:r??a,selected:a===this._resultSortField,value:a}))}):(s.push(i("calcite-option",{key:`display-${this._resultDisplayField}`,label:this._resultDisplayField,value:this._resultDisplayField})),o.push(i("calcite-option",{key:`sort-${this._resultDisplayField}`,label:this._resultDisplayField,value:this._resultDisplayField})))),i("calcite-popover",{autoClose:!0,label:e.resultsStrings.displayAttribute,offsetDistance:0,offsetSkidding:0,open:this._showResultOptions,overlayPositioning:"fixed",placement:"left-start",referenceElement:this._individualResultNode,styles:this.domNode!==null?fe(.75*this.domNode.clientWidth):Te()},i("calcite-block",{label:e.resultsStrings.displayAttribute,open:!0,overlayPositioning:"fixed"},i("calcite-label",{scale:"s"},e.resultsStrings.displayAttribute,i("calcite-select",{label:e.resultsStrings.displayAttribute,scale:"s",onCalciteSelectChange:a=>{let r=a.currentTarget;this._resultDisplayField=r.selectedOption.value,this._showResultOptions=!1}},s)),i("calcite-label",{scale:"s"},e.resultsStrings.sortBy,i("calcite-select",{label:e.resultsStrings.sortBy,scale:"s",onCalciteSelectChange:a=>{let r=a.currentTarget;this._resultSortField=r.selectedOption.value,t.sort(this._compare(this._resultSortField,this._resultSortOrder)),this._traceResultsIndividual=t,this._showResultOptions=!1}},o))))}_renderTraceResults(){let{messages:e,messagesCommon:t}=this,{selectFeatures:s}=e.resultsStrings,o=this.viewModel.traceResults,a=[];return o.forEach((r,c)=>{let h=[],g=[],v=!1,b=!1,B=!1,O="";r.results!==null&&r.results.hasOwnProperty("elements")?(r.results.aggregatedGeometry!==null&&(b=!0),r.results.globalFunctionResults!==null&&r.results.globalFunctionResults.length>0&&(g=r.results.globalFunctionResults,g.length>0&&(B=!0)),r.results.elements&&r.results.elements.length>0&&(h=r.results.elements,h.length>0&&(v=!0)),(b||v)&&(O=this.messagesUnits.units[r.resultArea?.unit]?.abbr),a.push(i("calcite-block",{class:p.blockContent,collapsible:!0,description:r.trace.description??"",heading:r.trace.title,key:`${r.trace.title}${c}`,open:!0,overlayPositioning:"fixed"},this._renderRemoveTraceContainer(r),i("calcite-list",{label:""},B?i("calcite-list-item",{label:e.resultsStrings.functionHeader+" ("+g.length+")",onCalciteListItemSelect:()=>{this.switchToFromFunctions(g,"functions")}},i("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"})):null,v&&this.viewModel.showSelectionAttributes?i("calcite-list-item",{key:this.id,label:e.resultsStrings.viewFeatures+" ("+h.length+")",onCalciteListItemSelect:()=>{this.switchToFromAssetGroup(this._groupResultsByAssetGroup(r),r.trace.title+" ("+h.length+")","assetGroup")}},i("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"})):this.viewModel.showSelectionAttributes?i("calcite-label",{layout:"inline",scale:"s"},e.resultsStrings.noSelectionResults):null),v?i("div",{class:p.doublePaddingTop},i("calcite-label",{layout:"inline",onclick:_=>{_.preventDefault(),_.stopPropagation(),this.viewModel.mergeSelection(!r.selectionEnabled,r.trace)},scale:"s"},i("calcite-checkbox",{checked:r.selectionEnabled,onclick:_=>{_.preventDefault(),_.stopPropagation(),this.viewModel.mergeSelection(!r.selectionEnabled,r.trace)}}),this.viewModel.showSelectionAttributes?s:`${s} (${h.length})`)):null,b?i("calcite-block-section",{key:`aggregate-${r.trace.title}-${c}`,open:r.graphicEnabled,text:e.resultsStrings.highlightTrace,toggleDisplay:"switch",onCalciteBlockSectionToggle:_=>{_.currentTarget.open?this.viewModel.changeResultGraphicColor(r.graphicColor,r):this.viewModel.removeResultGraphicFromView(r)}},i("calcite-list",{label:e.resultsStrings.graphicColor,selectionMode:"none"},i("calcite-list-item",{label:e.resultsStrings.graphicColor,onclick:_=>{this._swatchNode=_.currentTarget,this._activeSwatch="aggGeom_"+c}},i("calcite-color-picker-swatch",{color:r.graphicColor.hex,scale:"s",slot:"actions-end"})))):null,this.enableResultArea&&(b||v)?i("calcite-block-section",{key:`area-${r.trace.title}-${c}`,open:r.resultArea?.show,text:e.resultsStrings.resultAreaHeader,toggleDisplay:"switch",onCalciteBlockSectionToggle:_=>{_.currentTarget.open?r.resultAreaGraphic?this.viewModel.addResultAreaToMap(r,r.resultAreaGraphic):this.viewModel.addResultAreaToMap(r):this.viewModel.removeResultAreaFromMap(r)}},i("calcite-list",{label:"",selectionMode:"none"},i("calcite-list-item",{label:e.resultsStrings.graphicColor,onclick:_=>{let E=_.currentTarget;this._swatchNode=E,this._activeSwatch="resultArea_"+c}},i("calcite-color-picker-swatch",{color:r.resultArea?.color.hex,scale:"s",slot:"actions-end"}))),i("calcite-list",{label:"",selectionMode:"none"},i("calcite-list-item",{label:e.resultsStrings.resultAreaBuffer},i("calcite-input-number",{afterCreate:this._afterComponentCreate,class:p.numberInput,max:999999,min:0,scale:"s",slot:"actions-end",suffixText:O,value:r.resultArea?.distance.toString(),onCalciteInputNumberChange:_=>{if(!this.view?.popup)return;this.view.popup.visible&&this.view.closePopup();let E=_.currentTarget;r.resultArea.distance>=0?(r.resultArea.distance=parseInt(E.value,10),this.viewModel.removeResultAreaFromMap(r),this.viewModel.addResultAreaToMap(r)):(r.resultArea.distance=0,this.viewModel.removeResultAreaFromMap(r),this.viewModel.addResultAreaToMap(r))}})))):null,i("calcite-popover",{autoClose:!0,closable:!0,label:e.resultsStrings.graphicColor,offsetDistance:0,offsetSkidding:0,open:this._activeSwatch==="aggGeom_"+c||this._activeSwatch==="resultArea_"+c,overlayPositioning:"fixed",placement:"auto-start",referenceElement:this._swatchNode,scale:"s",onCalcitePopoverClose:()=>{this._swatchNode=null,this._activeSwatch=null}},this._renderHighlightColorPicker(this._activeSwatch==="resultArea_"+c?r.resultArea?.color:r.graphicColor,r,this._activeSwatch==="resultArea_"+c?"resultArea":"aggregate"))))):a.push(i("calcite-block",{collapsible:!1,heading:r.trace.title,key:"error-"+c,open:!0,overlayPositioning:"fixed"},this._renderRemoveTraceContainer(r),this._renderWarningMessage("noController",!1,r.status)))}),i("calcite-flow-item",{key:"traceResults",selected:this._traceResultsState==="result"},a,this._renderStartOverContainer(),this._alertRemoveModal?i("calcite-scrim",{key:"prompt"},i("div",{class:p.clearPrompt},i("h3",{slot:"header"},e.globalStrings.clearResults),i("div",{slot:"content"},e.alertsStrings.clearResultsAlert),i("div",{class:p.promptDivider}),i("div",{styles:_e("row")},i("calcite-button",{appearance:"outline",onclick:()=>{this._alertRemoveModal=!1},slot:"secondary",width:"full"},t.cancel),i("calcite-button",{onclick:()=>{this._activeTrace&&this.viewModel.clearResult(this._activeTrace),this._alertRemoveModal=!1,this.viewModel.traceResults.length===0?this.switchTab("input"):(this._activeTrace=this.viewModel.traceResults[0].trace,this._traceResultsState="result")},slot:"primary",width:"full"},t.form.ok)))):null)}_renderTraceSelectorContainer(){let{messages:e}=this,t=this.viewModel.traces.map(a=>this._renderComboboxItem({value:a.globalId,text:a.title,selected:a.selected??!1})),s=this.viewModel.traces.filter(a=>a.selected),o=e.tracingStrings.traceOperation+` (${s.length})`;return i("calcite-block",{class:p.blockContent,collapsible:!0,heading:o,open:!0,overlayPositioning:"fixed"},i("calcite-icon",{icon:"utility-network-trace",scale:"s",slot:"icon"}),i("calcite-combobox",{label:e.inputsStrings.selectTraces,maxItems:0,overlayPositioning:"fixed",placeholder:e.inputsStrings.selectTraces,scale:"s",selectionMode:"multiple",onCalciteComboboxChange:a=>{this.viewModel.traces.forEach(r=>{r.selected=a.currentTarget.selectedItems.some(c=>c.value===r.globalId)}),a.currentTarget.selectedItems.length&&(this._warningNoTraceSelected=!1)}},t))}_renderUtilityNetworkTrace(){let{viewModel:e,viewModel:{utilityNetwork:t}}=this,s=e.view?.map,{messages:o}=this,a=i("calcite-tabs",{layout:"center",position:"top",styles:ke(this.container)},i("calcite-tab-nav",{slot:"title-group"},i("calcite-tab-title",{onclick:()=>{this.switchTab("input")},selected:this._activeTab==="input"},o.inputsStrings.headerTabInputs),i("calcite-tab-title",{onclick:()=>{this.switchTab("results")},selected:this._activeTab==="results"},o.resultsStrings.headerTabResults)),this._renderInputsTab(),this._renderResultsTab());return(!s.utilityNetworks?.length&&!t||t&&!t.sharedNamedTraceConfigurations.length)&&(a=i("calcite-panel",null,this._renderWarningMessage("noTraceConfig",!1))),this._loadUnError||(a=i("calcite-panel",null,this._renderWarningMessage("loadUNError",!1,this._errorMessage))),a}_renderWarningMessage(e,t,s){let{messages:o}=this,a=o.alertsStrings.NoRunAlertHeader,r=o.alertsStrings.noResultsInfo;switch(e){case"flag":a=o.alertsStrings.startingPointAlertHeader,r=o.alertsStrings.startingPointAlert;break;case"noTerminal":a=o.alertsStrings.noTerminalDefinedHeader,r=o.alertsStrings.noTerminalDefined;break;case"trace":a=o.alertsStrings.selectTraceAlertHeader,r=o.alertsStrings.selectTraceAlert;break;case"noTraceExecuted":a=o.alertsStrings.NoRunAlertHeader,r=o.alertsStrings.noResultsInfo;break;case"noBarrierAsset":case"noStartAsset":a=o.alertsStrings.noAssetsFoundHeader,r=o.alertsStrings.noAssetFound;break;case"noBarrierAssetNso":case"noStartAssetNso":a="",r=o.alertsStrings.noAssetFound;break;case"noTraceConfig":a="",r=o.alertsStrings.noTraceSupported;break;default:a=o.alertsStrings.genericErrorHeader,r=s||""}return i("div",{class:p.noticeContainer,key:e},i("calcite-notice",{closable:t,icon:!0,key:e,kind:"danger",open:!0,scale:"s",width:"auto",onCalciteNoticeClose:()=>this._handleWarningNoticeClose(e)},i("div",{slot:"title"},a),i("div",{slot:"message"},r)))}_afterComponentCreate(e){"value"in e&&e.value!=null&&"setNumberValue"in e&&e.setNumberValue({committing:!1,value:e.value,origin:"direct"})}_appendAttributes(e,t,s){let o=[];return e.forEach(a=>{t.forEach(r=>{r.featureSet.features.forEach(c=>{a[s]===c.attributes[this._resultObjectIdField]&&(a.details=c,a.details.fields=r.featureSet.fields,o.push(a))})})}),o}_changeCursor(e="default"){let t=this.view?.container?.style;t&&(t.cursor=e)}_disablePopup(){let{view:e}=this;e.popupEnabled=!1,e.closePopup()}_compare(e,t){return(s,o)=>{let a=0,r=s.details?.attributes[e]??s.objectId,c=o.details?.attributes[e]??o.objectId;return isNaN(r)&&(r=r.toLowerCase()),isNaN(c)&&(c=c.toLowerCase()),t==="desc"?r>c?a=1:r<c&&(a=-1):r<c?a=1:r>c&&(a=-1),a}}_getAssetGroupName(e){let t=e.assetGroupCode.toString(),s=e.assetGroupCode,o=this.viewModel.getValidSources().find(a=>a.sourceId===e.networkSourceId);if(o){let a=o.assetGroups.find(r=>r.assetGroupCode===s);a&&(t=a.assetGroupName)}return t}_getAssetTypeName(e){let t=e.assetTypeCode.toString(),s=e.assetGroupCode,o=this.viewModel.getValidSources().find(a=>a.sourceId===e.networkSourceId);if(o){let a=o.assetGroups.find(r=>r.assetGroupCode===s);if(a){let r=a.assetTypes.find(c=>c.assetTypeCode===e.assetTypeCode);r&&(t=r.assetTypeName)}}return t}_getSymbolIcon(e){return e.type==="picture-marker"?i("img",{height:e.height,src:e.url??void 0,width:e.width}):null}_groupBy(e,t){return e.reduce((s,o)=>((s[o[t]]=s[o[t]]||[]).push(o),s),{})}_groupResultsByAssetGroup(e){let t=[],s=e.results?.elements,o=this._groupBy(s??[],"networkSourceId");for(let a in o)t.push(this._groupBy(o[a],"assetGroupCode"));return t}_groupResultsByAssetType(e){return this._groupBy(e,"assetTypeCode")}_handleWarningNoticeClose(e){switch(e){case"flag":this._warningNoFlag=!1;break;case"noTerminal":this._warningNoTerminal=!1;break;case"trace":this._warningNoTraceSelected=!1;break;case"noStartAsset":this._warningNoStartAssetFound=!1;break;case"noStartAssetNso":this._warningNoStartAssetNsoFound=!1;break;case"noBarrierAsset":this._warningNoBarrierAssetFound=!1;break;case"noBarrierAssetNso":this._warningNoBarrierAssetNsoFound=!1}}_mixCustomStrings(){let{messages:e}=this;this.inputSettings.length>0&&this.inputSettings.forEach(t=>{t.type==="starting-point"&&(e.inputsStrings.headerStartingPoint=t.label,e.inputsStrings.startingPointHint=t.description),t.type==="barrier"&&(e.inputsStrings.headerBarrier=t.label,e.inputsStrings.barrierPointHint=t.description)})}_overrideFlagSymbol(){this.inputSettings.length>0&&this.inputSettings.forEach(e=>{e.type==="starting-point"?this._symbolStartFlag=e.symbol:this._symbolBarrier=e.symbol,this.viewModel.changeFlagSymbol(e.type,e.symbol)})}_processFlagOnLoad(){return this.view?.when().then(()=>{this._watchHandler=Z(()=>!this.view?.updating,()=>T(this,null,function*(){this._warningNoFlag=!1,this._warningNoBarrierAssetFound=!1,this._warningNoStartAssetFound=!1;let e=yield this.viewModel.addFlagsOnLoad();this.viewModel.removeFlagsOnLoadWatcher(),e.includes("barrier")&&(this._warningNoBarrierAssetFound=!0),e.includes("starting-point")&&(this._warningNoStartAssetFound=!0),this.disabled=!1,this._watchHandler!==null&&this._watchHandler.remove()}))})}_registerWatchers(){this.addHandles([m(()=>this.selectedTraces,()=>{this.viewModel.selectTracesOnLoad(),this.scheduleRender()}),m(()=>this.defaultGraphicColor,()=>{this.viewModel.traceResults.length>0&&this.viewModel.traceResults.forEach(e=>{this.viewModel.changeResultGraphicColor(this.viewModel.defaultGraphicColor,e)}),this.scheduleRender()})])}_renderComboboxItem({text:e,value:t,selected:s}){return i("calcite-combobox-item",{key:t,selected:s,textLabel:e,value:t})}_resetResultFeatureWidget(){this._showFeatureInfoActive=!1,this._resultFeatureWidget.feature=null,this.view.popupEnabled=this._wasPopupEnabled}_resetTraceLocationWarnings(){this._warningNoBarrierAssetFound=!1,this._warningNoBarrierAssetNsoFound=!1,this._warningNoStartAssetFound=!1,this._warningNoStartAssetNsoFound=!1}_setupAddNonspatialObject(e){this._disablePopup(),this._traceLocationType=e,this._addNonspatialObjectActive=!0,this._resetTraceLocationWarnings(),this.viewModel.getNonspatialTraceLocationInitialFeature().then(t=>{this._findNonspatialFeatureWidget.feature=null;let s=t.graphic;this._findNonspatialFeatureWidget.open(s)}).catch(()=>{this._warningNoStartAssetNsoFound=e==="starting-point",this._warningNoBarrierAssetNsoFound=e==="barrier",this._addNonspatialObjectActive=!1}).finally(()=>this._changeCursor("default"))}_setupAddTraceLocation(e){this._traceLocationType=e,this._changeCursor("crosshair"),this._selectToolActive=!0,this._addNonspatialObjectActive=!1,this._resetTraceLocationWarnings(),this.viewModel.addFlagByHit(this._traceLocationType,this._symbolStartFlag).then(t=>{this._changeCursor("default"),t?this._warningNoFlag=!1:(this._warningNoStartAssetFound=this._traceLocationType==="starting-point",this._warningNoBarrierAssetFound=this._traceLocationType==="barrier"),this._selectToolActive=!1})}_utilityNetworkTraceInitialized(){this.viewModel.loadUtilityNetwork().then(e=>{e&&(this.viewModel.selectTracesOnLoad(),this._registerWatchers(),this.viewModel.flags.length>0&&this._processFlagOnLoad()),this.disabled=!1}).catch(e=>{let{messages:t}=this;this._loadUnError=!1,e.name==="utility-network:no-user-type-extension"||e.details.raw?.extendedCode===Se.noExtension?this._errorMessage=t.alertsStrings.noUserExtension:this._errorMessage=e.message,this.disabled=!1})}_viewChangeHandle(){this._wasPopupEnabled=this.view?.popupEnabled??!1,this._findNonspatialFeatureWidget.view=this.view,this._resultFeatureWidget.view=this.view}};l([n()],d.prototype,"_activeTab",void 0),l([n()],d.prototype,"_activeTrace",void 0),l([n()],d.prototype,"_activeSwatch",void 0),l([n()],d.prototype,"_addNonspatialObjectActive",void 0),l([n()],d.prototype,"_alertRemoveModal",void 0),l([n()],d.prototype,"_assetGroupHeader",void 0),l([n()],d.prototype,"_assetTypeHeader",void 0),l([n()],d.prototype,"_confirmReset",void 0),l([n()],d.prototype,"_errorMessage",void 0),l([n()],d.prototype,"_swatchNode",void 0),l([n()],d.prototype,"_selectToolActive",void 0),l([n()],d.prototype,"_showFeatureInfoActive",void 0),l([n()],d.prototype,"_traceHeaderForFlow",void 0),l([n()],d.prototype,"_traceResultsFunctions",void 0),l([n()],d.prototype,"_traceResultsAssetGroup",void 0),l([n()],d.prototype,"_traceResultsAssetType",void 0),l([n()],d.prototype,"_traceResultsIndividual",void 0),l([n()],d.prototype,"_traceResultsState",void 0),l([n()],d.prototype,"_warningNoFlag",void 0),l([n()],d.prototype,"_warningNoTraceSelected",void 0),l([n()],d.prototype,"_updatingHandles",void 0),l([n()],d.prototype,"defaultGraphicColor",null),l([n()],d.prototype,"disabled",void 0),l([n()],d.prototype,"enableResultArea",null),l([n()],d.prototype,"flags",null),l([n()],d.prototype,"gdbVersion",null),l([n()],d.prototype,"icon",null),l([n()],d.prototype,"inputSettings",void 0),l([n()],d.prototype,"label",null),l([n(),f("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace")],d.prototype,"messages",void 0),l([n(),f("esri/t9n/common")],d.prototype,"messagesCommon",void 0),l([n(),f("esri/core/t9n/Units")],d.prototype,"messagesUnits",void 0),l([n()],d.prototype,"resultAreaProperties",null),l([n()],d.prototype,"selectedTraces",null),l([n()],d.prototype,"selectOnComplete",null),l([n()],d.prototype,"showGraphicsOnComplete",null),l([n()],d.prototype,"showSelectionAttributes",null),l([n()],d.prototype,"utilityNetwork",null),l([n()],d.prototype,"view",null),l([W(["add-flag","add-flag-complete","add-flag-error","select-features","clear-selection","add-result-area","remove-result-area","create-result-area","reset"]),n({type:U})],d.prototype,"viewModel",void 0),d=l([M("esri.widgets.UtilityNetworkTrace")],d);var ii=d;export{ii as default};
