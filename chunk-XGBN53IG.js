import{l as x}from"./chunk-2BJHWKO6.js";import{l as E}from"./chunk-Z7TBAZRW.js";import{d as D,e as P}from"./chunk-CL7L227X.js";import{c as R}from"./chunk-DMO5HQM3.js";import{g as p}from"./chunk-DA3SDKGO.js";import{d as z}from"./chunk-OLOKUDVI.js";import{b as S}from"./chunk-EQZWYK27.js";import{b as v}from"./chunk-2LI2GKBQ.js";import{y as h}from"./chunk-QBWJMFH5.js";import{a as i,b as u}from"./chunk-VTHXE323.js";function b(t,a){let n=null,e=null;return r=>{if(r.action==="cancel")return void(e!=null&&(e.execute({action:"cancel"}),n=null,e=null));let o={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};r.action==="start"&&n==null&&(n=new y,e=new y,a(t,n,e,r.pointerType,o)),n?.execute(o),r.action==="end"&&n!=null&&(n=null,e=null)}}function V(t,a){return t.events.on("drag",b(t,a))}function W(t,a){let n=[t.x,t.y,t.z??0],e=a,r=[Math.cos(e),Math.sin(e)],o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(o===0)return null;r[0]/=o,r[1]/=o;let l=s=>{let c=(s.x-n[0])*r[0]+(s.y-n[1])*r[1];s.x=n[0]+c*r[0],s.y=n[1]+c*r[1]};return s=>(l(s.mapStart),l(s.mapEnd),u(i({},s),{axis:r}))}function G(t){let a=null;return n=>{if(n.action==="start"&&(a=O(t,n.mapStart.spatialReference)),a==null)return null;let e=n.mapEnd.x-n.mapStart.x,r=n.mapEnd.y-n.mapStart.y,o=(n.mapEnd.z??0)-(n.mapStart.z??0);return a.move(e,r,o,n.action),u(i({},n),{translationX:e,translationY:r,translationZ:o})}}function j(t,a){return t==null?null:t.spatialReference.equals(a)?t.clone():p(t,a)}function O(t,a){let n=t.operations;if(!n)return null;let e=n.data.geometry,r=P(a);if(e.spatialReference.equals(r))return M(t,n,()=>{});if(e.type!=="mesh"){let o=j(e,r);if(o==null)return null;let l=e.spatialReference;return M(t,x.fromGeometry(o,n.viewingMode),()=>{let s=p(e,l);n.trySetGeometry(s)})}if(R(e)){let o=j(e.origin,r);if(!o)return null;let l=e.spatialReference,s=x.fromGeometry(o,n.viewingMode);return M(t,n,()=>{let c=p(s.data.geometry,l),m=c.x-e.origin.x,d=c.y-e.origin.y,f=(c.z??0)-(e.origin.z??0);n.move(m,d,f)})}return null}function M(t,a,n){let e=0,r=0,o=0;return{move:(l,s,c,m)=>{m==="start"&&(e=0,r=0,o=0);let d=l-e,f=s-r,g=c-o;a.move(d,f,g),e+=d,r+=f,o+=g,n(),m==="end"&&t.endInteraction?.()}}}function B(t,a=null,n){let e=null,r=a==null||t.spatialReference?.equals(a)?l=>l:l=>l!=null?p(l,a):l,o=i({exclude:[]},n);return l=>{if(l.action==="start"&&(e=r(t.toMap(l.screenStart,o))),e==null)return null;let s=r(t.toMap(l.screenEnd,o));return s!=null?u(i({},l),{mapStart:e,mapEnd:s}):null}}function H(t){let a=t.map(n=>G(n)).filter(h);return n=>{let e=n.mapEnd.x-n.mapStart.x,r=n.mapEnd.y-n.mapStart.y,o=n.mapEnd.z-n.mapStart.z;return a.forEach(l=>l(n)),u(i({},n),{translationX:e,translationY:r,translationZ:o})}}function J(t,a){let n=new Map;for(let e of a)n.set(e,v(t[e]));return e=>(n.forEach((r,o)=>{t[o]=r}),e)}function Z(t){let a=t.operations?.createResetState();return n=>(a?.remove(),n)}function K(t){let a=t.map(n=>Z(n)).filter(n=>n!=null);return n=>(a.forEach(e=>e(n)),n)}function N(){let t=0,a=0,n=0;return e=>{e.action==="start"&&(t=e.mapStart.x,a=e.mapStart.y,n=e.mapStart.z);let r=e.mapEnd.x-t,o=e.mapEnd.y-a,l=e.mapEnd.z-n;return t=e.mapEnd.x,a=e.mapEnd.y,n=e.mapEnd.z,u(i({},e),{mapDeltaX:r,mapDeltaY:o,mapDeltaZ:l,mapDeltaSpatialReference:e.mapStart.spatialReference})}}function Q(){let t=0,a=0;return n=>{n.action==="start"&&(t=n.screenStart.x,a=n.screenStart.y);let e=n.screenEnd.x-t,r=n.screenEnd.y-a;return t=n.screenEnd.x,a=n.screenEnd.y,u(i({},n),{screenDeltaX:e,screenDeltaY:r})}}function $(t,a){let n=null,e=0,r=0;return o=>{if(o.action==="start"&&(n=t.toScreen?.(a),n!=null&&(n.x<0||n.x>t.width||n.y<0||n.y>t.height?n=null:(e=o.screenStart.x-n.x,r=o.screenStart.y-n.y))),n==null)return null;let l=S(o.screenEnd.x-e,0,t.width),s=S(o.screenEnd.y-r,0,t.height),c=z(l,s);return o.screenStart=n,o.screenEnd=c,o}}var q=()=>{},y=class t{constructor(){this.execute=q}next(a,n=new t){return a!=null&&(this.execute=e=>{let r=a(e);r!=null&&n.execute(r)}),n}};function _(t,a,n=[]){if(t.type==="2d")return r=>r;let e=null;return r=>{r.action==="start"&&(e=t.toMap(r.screenStart,{exclude:n}),e!=null&&(e.z=E(e,t,a)));let o=t.toMap(r.screenEnd,{exclude:n});o!=null&&(o.z=E(o,t,a));let l=e!=null&&o!=null?{sceneStart:e,sceneEnd:o}:null;return u(i({},r),{scenePoints:l})}}function w(t,a,n){let e=a.elevationProvider.getElevation(t.x,t.y,t.z??0,t.spatialReference,"scene")??0,r=D(t);return r.z=e,r.hasZ=!0,r.z=E(r,a,n),r}function nn(t,a){if(t.type==="2d")return e=>e;let n=null;return e=>{e.action==="start"&&(n=w(e.mapStart,t,a));let r=w(e.mapEnd,t,a),o=n!=null&&r!=null?{sceneStart:n,sceneEnd:r}:null;return u(i({},e),{scenePoints:o})}}export{V as a,W as b,G as c,B as d,H as e,J as f,Z as g,K as h,N as i,Q as j,$ as k,y as l,_ as m,nn as n};
