import{a as V}from"./chunk-7LVUNMSI.js";import{a as B,c as G}from"./chunk-CISTQZ5X.js";import{a as k}from"./chunk-NX5B6XBR.js";import{a as W}from"./chunk-U4QEPZJ3.js";import{d as h}from"./chunk-OLOKUDVI.js";import{c as f}from"./chunk-VIEK2X23.js";import{j as P}from"./chunk-Q6Y4JG7Q.js";import{a as x}from"./chunk-7F5DJLJT.js";import{L as c,da as b,f as M,t as _}from"./chunk-NJWTSROP.js";import{a as u}from"./chunk-QGVBCWUY.js";import{H as y}from"./chunk-MYO4NP2N.js";import{e as d}from"./chunk-NFIPKH6V.js";import{l as S}from"./chunk-5QEXLALV.js";function R(t){return t>.5?{min:.5,max:1}:t>.2?{min:.2,max:.5}:{min:.1,max:.2}}function D(t,e){switch(e){case"metric":return t>1e3?{distance:c(t,"meters","kilometers"),unit:"kilometer"}:t>1?{distance:t,unit:"meter"}:t>.01?{distance:c(t,"meters","centimeters"),unit:"centimeter"}:{distance:c(t,"meters","millimeters"),unit:"millimeter"};case"imperial":return t>1609.344?{distance:c(t,"meters","miles"),unit:"mile"}:t>.3048?{distance:c(t,"meters","feet"),unit:"foot"}:{distance:c(t,"meters","inches"),unit:"inch"}}}function F(t){let{isWebMercator:e,wkt:i,wkt2:r}=t;return e||((r||i)?.includes("WGS_1984_Web_Mercator")??!1)}function C({state:{paddedViewState:t},spatialReference:e,width:i}){return e.isWrappable&&t.worldScreenWidth<i}function L(t,e){let{x:i,y:r}=t?P(e,!0):e;return[i,r]}var m=class extends y{constructor(t){super(t),this.scaleComputedFrom=h(),this.view=null}get state(){return this.view?.ready&&this.view.type==="2d"?V(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(t,e){if(this.state==="disabled"||isNaN(t)||!e||!this.view)return null;let i=this._getDistanceInMeters();return i==null?null:this._getScaleBarProps(t,i,e)}_getDistanceInMeters(){let{state:t,spatialReference:e}=this.view;if(!_(e))return null;let{isGeographic:i}=e,r=F(e);if(!i&&!r)return t.extent.width*(b(e)??1);let[o,s]=this._getScaleMeasuringPoints(),l=r||i&&!B(e)?x.WGS84:e,p=new W({paths:[[L(r,o),L(r,s)]],spatialReference:l}),n=k(p,10),a;try{[a]=G([n],"meters")}catch{return null}return a}_getScaleMeasuringPoints(){let t=this.view,{width:e,height:i,position:r,spatialReference:o}=t;if(C(t)){let n=M(o),{valid:a}=n;return[new f(a[0],0,o),new f(a[1],0,o)]}let s=this.scaleComputedFrom.y-r[1];s>i?s=i:s<0&&(s=0);let l=h(0,s),p=h(e,s);return[t.toMap(l),t.toMap(p)]}_getScaleBarProps(t,e,i){let r=this.view,o=t*e/(C(r)?r.state.paddedViewState.worldScreenWidth:r.width);if(o<.001)return null;let s=D(o,i),{distance:l,unit:p}=s,n=l,a=0;for(;n>=1;)n/=10,a++;let{min:w,max:g}=R(n),v=g/n>=n/w?w:g;return{length:t*(v/n),value:10**a*v,unit:p}}};u([d()],m.prototype,"scaleComputedFrom",void 0),u([d({readOnly:!0})],m.prototype,"state",null),u([d()],m.prototype,"view",void 0),m=u([S("esri.widgets.ScaleBar.ScaleBarViewModel")],m);var $=m;export{$ as a};
