import{a as v}from"./chunk-54VKSMWS.js";import{a as y}from"./chunk-MIS6QMFE.js";import{b}from"./chunk-BAEF3CT6.js";import{o as h}from"./chunk-AUAZP44J.js";import{a as i}from"./chunk-QGVBCWUY.js";import{e as r}from"./chunk-NFIPKH6V.js";import{l as p}from"./chunk-5QEXLALV.js";import{o as u}from"./chunk-4PTIEWMT.js";import{a as d,b as c,f as n}from"./chunk-VTHXE323.js";var w=b()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"}),e=class extends v{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}checkJobStatus(t){return n(this,null,function*(){let s=c(d({},t),{query:{f:"json"}}),{data:o}=yield h(this.statusUrl,s);return this.read(o),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this})}waitForJobCompletion(){return n(this,arguments,function*(t={}){let{interval:s=1e3,statusCallback:o}=t;return new Promise((T,m)=>{this._clearTimer();let f=setInterval(()=>{this._timer||m(u()),this.checkJobStatus().then(a=>{let{status:l}=a;switch(this.status=l,l){case"job-succeeded":this._clearTimer(),T(this);break;case"job-waiting":case"job-executing":o&&o(this)}},a=>{this._clearTimer(),m(a)})},s);this._timer=f})})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};i([r()],e.prototype,"editsResolver",void 0),i([r({type:String,json:{write:!0}})],e.prototype,"statusUrl",void 0),i([y(w)],e.prototype,"status",void 0),i([r({type:Date,json:{type:Number,write:{writer:(t,s)=>{s.submissionTime=t?t.getTime():null}}}})],e.prototype,"submissionTime",void 0),i([r({type:Date,json:{type:Number,write:{writer:(t,s)=>{s.lastUpdatedTime=t?t.getTime():null}}}})],e.prototype,"lastUpdatedTime",void 0),e=i([p("esri.networks.support.TopologyValidationJobInfo")],e);var P=e;export{P as a};
