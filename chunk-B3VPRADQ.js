import{a as w}from"./chunk-HJQNAAJT.js";import{c as C,d as y}from"./chunk-ES4WUTEM.js";import{d as u}from"./chunk-5AFOYCWC.js";import{a as D}from"./chunk-G23ELQMS.js";import{a as B}from"./chunk-RDGG4TVD.js";import{f as k,o as I}from"./chunk-F5AJITOA.js";import{da as q}from"./chunk-KALOJIUA.js";import{c as E,d as z}from"./chunk-K5T5FD5C.js";import{c as v}from"./chunk-P6QFA5MM.js";import{g as S}from"./chunk-XRGPJ3QY.js";import{i as h,y as V}from"./chunk-QBWJMFH5.js";import{f as c}from"./chunk-VTHXE323.js";function M(e){if(!e.colorStops)return[];let t=[...e.colorStops].filter(o=>o.color?.a>0),a=t.length-1;if(t[0]){let o=t[a];o&&o.ratio!==1&&(t.push(new D({ratio:1,color:o.color})),a++)}return t.map((o,i)=>{let l="";return i===0?l=e.legendOptions?.minLabel||"low":i===a&&(l=e.legendOptions?.maxLabel||"high"),{color:o.color,label:l,ratio:o.ratio}}).reverse()}var L=()=>S.getLogger("esri.renderers.support.utils"),b={lte:"<=",gte:">=",lt:"<",gt:">",pct:"%",ld:"\u2013"},R={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},te={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"},ae=E("short-date");function s(e,t,a){return c(this,null,function*(){v(e,t,()=>[]).push(...a)})}function oe(e){return c(this,null,function*(){let t=new Map;if(!e)return t;if("visualVariables"in e&&e.visualVariables){for(let a of e.visualVariables)if(j(a)){let o=((yield w(a))??[]).map(i=>i.color);yield s(t,a.field||a.valueExpression,o)}}if(e.type==="heatmap"){let a=M(e).map(o=>o.color);yield s(t,e.field||e.valueExpression,a)}else if(e.type==="pie-chart"){for(let a of e.attributes)yield s(t,a.field||a.valueExpression,[a.color]);yield s(t,"default",[e?.othersCategory?.color,u(e.backgroundFillSymbol,null)])}else if(e.type==="dot-density"){for(let a of e.attributes)yield s(t,a.field||a.valueExpression,[a.color]);yield s(t,"default",[e.backgroundColor])}else if(e.type==="unique-value")if(e.authoringInfo?.type==="predominance")for(let a of e.uniqueValueInfos??[])yield s(t,a.value.toString(),[u(a.symbol,null)]);else{let a=(e.uniqueValueInfos??[]).map(r=>u(r.symbol,null)),{field:o,field2:i,field3:l,valueExpression:n}=e;(o||n)&&(yield s(t,o||n,a)),i&&(yield s(t,i,a)),l&&(yield s(t,l,a))}else if(e.type==="class-breaks"){let a=e.classBreakInfos.map(l=>u(l.symbol,null)),{field:o,valueExpression:i}=e;yield s(t,o??i,a)}else e.type==="simple"&&(yield s(t,"default",[u(e.symbol,null)]));return"defaultSymbol"in e&&e.defaultSymbol&&(yield s(t,"default",[u(e.defaultSymbol,null)])),t.forEach((a,o)=>{let i=h(a.filter(Boolean),(l,n)=>JSON.stringify(l)===JSON.stringify(n));t.set(o,i)}),t})}function g(e,t,a){return c(this,null,function*(){let o=v(e,t,()=>new Map);for(let i of a)o.set(i.value,i.color)})}function ie(e){return c(this,null,function*(){let t=new Map;if(!e)return t;if(e.type!=="unique-value"||e.authoringInfo?.type)if(e.type==="class-breaks"){let a=e.classBreakInfos.map(l=>({value:l.minValue,color:u(l.symbol,null)})).reverse(),{field:o,valueExpression:i}=e;yield g(t,o??i,a)}else e.type==="simple"&&(yield g(t,"default",[{value:"default",color:u(e.symbol,null)}]));else{let a=(e.uniqueValueInfos??[]).map(m=>({value:m.value,color:u(m.symbol,null)})),{field:o,field2:i,field3:l,valueExpression:n,fieldDelimiter:r}=e,f=[o,i,l].filter(Boolean).join(r||"");(f||n)&&(yield g(t,f||n,a))}if("defaultSymbol"in e&&e.defaultSymbol&&(yield g(t,"default",[{value:"default",color:u(e.defaultSymbol,null)}])),"visualVariables"in e&&e.visualVariables){let a=e.visualVariables.filter(o=>o.type==="color");for(let o of a){let i=(yield w(o))??[];yield g(t,o.field||o.valueExpression,i)}}return t})}function A(e,t,a){let o="";return t===0?o=b.lt+" ":t===a&&(o=b.gt+" "),o+e}function le(e){let{values:t,colors:a,labelIndexes:o,isDate:i}=e;return t.map((l,n)=>{let r=null;if(!o||o.includes(n)){let f=i?z(l):y(l);f&&(r=A(f,n,t.length-1))}return new B({value:l,color:a[n],label:r})})}function O(e){let t=e.minValue,a=e.maxValue,o=e.isFirstBreak?"":b.gt+" ",i=e.normalizationType==="percent-of-total"?b.pct:"";return t=t==null?"":y(t),a=a==null?"":y(a),o+t+i+" "+b.ld+" "+a+i}function ne(e){let t=e.classBreakInfos,a=e.normalizationType,o=[];if(t?.length)if(e.classificationMethod!=="standard-deviation")if(e.round){o.push(t[0].minValue);for(let i of t)o.push(i.maxValue);o=C(o),t.forEach((i,l)=>{i.label=O({minValue:l===0?o[0]:o[l],maxValue:o[l+1],isFirstBreak:l===0,normalizationType:a})})}else t.forEach((i,l)=>{i.label=O({minValue:i.minValue,maxValue:i.maxValue,isFirstBreak:l===0,normalizationType:a})});else L().warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.")}function re(e){let t=e.map(l=>new Date(l)),a=t.length,o=1/0,i=null;for(let l=0;l<a-1;l++){let n=t[l],r=1/0,f=null;for(let m=l+1;m<a;m++){let d=t[m],x=(n.getFullYear()!==d.getFullYear()?"year":n.getMonth()!==d.getMonth()&&"month")||n.getDate()!==d.getDate()&&"day"||n.getHours()!==d.getHours()&&"hour"||n.getMinutes()!==d.getMinutes()&&"minute"||n.getSeconds()!==d.getSeconds()&&"second"||"millisecond",F=R[x];F<r&&(r=F,f=x)}r<o&&(o=r,i=f)}return i}function se(e){let{value:t,domain:a,fieldInfo:o,dateFormatOptions:i}=e,l=String(t),n=a&&"codedValues"in a&&a.codedValues?a.getName(t):null;return n?l=n:t!=null&&o&&(k(o)||q(o))?l=I(t,i??{fieldType:o.type}):typeof t=="number"&&(l=y(t)),l}function p(e,t){return"normalizationField"in e&&e.normalizationField?H(e.field,e.normalizationField):"field"in e&&e.field?T(e.field):"valueExpression"in e&&e.valueExpression?N(e.valueExpression,e.valueExpressionTitle,t):null}function T(e){return{type:"field",field:e}}function H(e,t){return{type:"normalized-field",field:e,normalizationField:t}}function N(e,t,a){return{type:"expression",expression:e,title:t,returnType:a}}function ue(e,t){let a=[];if(e.type==="class-breaks"||e.type==="heatmap")a.push(p(e,"number"));else if(e.type==="unique-value"){let i=e.authoringInfo;if(i&&i.type==="relationship"){if(i.field1&&i.field2){let l=i.field1.field,n=i.field2.field,r=i.field1.normalizationField,f=i.field2.normalizationField;a.push(p({field:l,normalizationField:r})),a.push(p({field:n,normalizationField:f}))}}else{let l=e.uniqueValueInfos?.[0],n=null;if(l?.value){let r=typeof l.value;r!=="string"&&r!=="number"||(n=r)}a.push(p(e,n)),[e.field2,e.field3].forEach(r=>r&&a.push(T(r)))}}else"attributes"in e&&e.attributes?.forEach(i=>a.push(p(i,"number")));let o=t?t(e):"visualVariables"in e?e.visualVariables:null;return o&&o.forEach(i=>a.push(p(i,"number"))),h(a.filter(V),(i,l)=>i.type==="field"&&l.type==="field"?i.field===l.field:i.type==="normalized-field"&&l.type==="normalized-field"?i.field===l.field&&i.normalizationField===l.normalizationField:i.type==="expression"&&l.type==="expression"&&i.expression===l.expression)}function j(e){return e.type==="color"}export{M as a,te as b,ae as c,oe as d,ie as e,le as f,O as g,ne as h,re as i,se as j,p as k,ue as l};
