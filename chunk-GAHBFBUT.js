import{c as n,e as u,f as p,h as c}from"./chunk-7XT4ARBK.js";import{a as o}from"./chunk-QGVBCWUY.js";import{e as r}from"./chunk-NFIPKH6V.js";import{l as m}from"./chunk-5QEXLALV.js";var _="demolishedphase",N="createdphase",i=class extends p{constructor(e){super(e),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=l=>{let s=this._createdPhaseFieldName,t=new RegExp(`${s}\\s*<=\\s*(\\d+)\\s*OR\\s*${s}\\s*IS\\s*NULL`,"gi"),a=this._demolishedPhaseFieldName,f=new RegExp(`${a}\\s*>\\s*(\\d+)\\s*OR\\s*${a}\\s*IS\\s*NULL`,"gi");for(let{filterExpression:d}of l.filterBlocks?.items??[]){let h=d?t.exec(d)??f.exec(d):null;if(h)return parseInt(h[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};let e=[],l=this._createdPhaseFieldName;l&&e.push(`(${l} <= ${this.value} OR ${l} IS NULL)`);let s=this._demolishedPhaseFieldName;s&&e.push(`(${s} > ${this.value} OR ${s} IS NULL)`);let t=e.join(" AND ");return{solid:t,xRay:t}}get _lastValue(){let e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){let e=[];this.layers.forEach(s=>{let t=n(s,N);t!=null&&(this._createdPhaseFieldName=t.fieldName,e.push(t));let a=n(s,_);a!=null&&(this._demolishedPhaseFieldName=a.fieldName,e.push(a))}),this._domainInfo=u(e);let l=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){let s=l??c(this.layers,this._parseValueFromFilter);this.select(s??this._lastValue)}else this.clear()}};o([r({readOnly:!0})],i.prototype,"filterExpressions",null),o([r()],i.prototype,"_createdPhaseFieldName",void 0),o([r()],i.prototype,"_demolishedPhaseFieldName",void 0),o([r({readOnly:!0})],i.prototype,"_lastValue",null),i=o([m("esri.widgets.BuildingExplorer.BuildingPhase")],i);var E=i;export{E as a};
