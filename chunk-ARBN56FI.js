import{a as I}from"./chunk-JOLRQN76.js";import{a as g}from"./chunk-MOTLSRMA.js";import"./chunk-WCHIR27X.js";import"./chunk-QGGZPZNN.js";import"./chunk-26JWDTE3.js";import{a as y}from"./chunk-PMIZEMLB.js";import"./chunk-CCSZEQ2U.js";import"./chunk-BBM5BVWD.js";import{a as u}from"./chunk-RJTRRFXW.js";import{a as c}from"./chunk-FY4QM6AV.js";import"./chunk-456M7HFK.js";import"./chunk-QCZ3ZIGQ.js";import{x as p}from"./chunk-XR5FT7TQ.js";import"./chunk-JQAW4OB5.js";import"./chunk-D3CUKSGS.js";import"./chunk-2TX472ZB.js";import"./chunk-FXCL7YYQ.js";import"./chunk-K75TK42V.js";import"./chunk-DZFUQCB6.js";import"./chunk-V2JYXY4D.js";import"./chunk-KVM6SHDX.js";import"./chunk-PIHANKUA.js";import"./chunk-EQZWYK27.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import{e as f}from"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import{b as d}from"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as s}from"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import{e as l}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as m}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import{g as h}from"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{f as n}from"./chunk-VTHXE323.js";var r=class extends u(g(y(c))){constructor(){super(...arguments),this.type="wmts-3d"}initialize(){this._getCompatibleTileInfoMatrixSet(t=>this._getTileInfoSupportError(t.tileInfo,t.fullExtent));let e=f(()=>this.view?.basemapTerrain?.tilingSchemeLocked).then(()=>{let t=this._getCompatibleTileInfoMatrixSet(i=>this._getTileInfoError(i.tileInfo,i.fullExtent));t!=null&&(t.id!==null&&this.layer.activeLayer.tileMatrixSetId!==t.id&&(this.layer.activeLayer.tileMatrixSetId=t.id),t.tileInfo&&(this.tileInfo=t.tileInfo),this.layer.fullExtent=t.fullExtent)});this.addResolvingPromise(e),this.when(()=>this._postInitialize())}refresh(){this.emit("data-changed")}canResume(){if(!super.canResume())return!1;let e=this.layer.activeLayer.tileMatrixSet;return e!=null&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}fetchTile(e,t){return n(this,null,function*(){return I(this,e,t)})}doRefresh(){return n(this,null,function*(){this.suspended||this.emit("data-changed")})}_postInitialize(){this._updatingHandles.add(()=>this.layer?.activeLayer?.styleId,()=>this.refresh()),this._updatingHandles.add(()=>this.layer?.activeLayer,e=>{let t=this._getCompatibleTileInfoMatrixSet(i=>this._getTileInfoError(i.tileInfo,i.fullExtent),!0);t&&t.id!=null&&e.tileMatrixSetId!==t.id&&(this.layer.activeLayer.tileMatrixSetId=t.id),this.notifyChange("suspended"),this.canResume()&&this.refresh()})}_getCompatibleTileInfoMatrixSet(e,t=!1){let i=p(this.layer);if(i!=null){if(d.isCollection(i))return i.find(x=>{let o=e(x);return o!=null&&(t?h.getLogger(this).error("The selected tile matrix set is not compatible with the view",o):this.addResolvingPromise(Promise.reject(o))),o==null});let a=e(i);return a!=null&&(t?h.getLogger(this).error("The selected tile matrix set is not compatible with the view",a):this.addResolvingPromise(Promise.reject(a))),i}return null}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};s([l()],r.prototype,"layer",void 0),s([l()],r.prototype,"suspended",void 0),s([l()],r.prototype,"tileInfo",void 0),r=s([m("esri.views.3d.layers.WMTSLayerView3D")],r);var j=r;export{j as default};
