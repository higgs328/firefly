import{c as L}from"./chunk-Z3MWEX65.js";import{e as k}from"./chunk-YB6RTOHR.js";import{a as m,b as u}from"./chunk-N3HRYLNW.js";import{a as g}from"./chunk-HRQT4R6X.js";import{a as c}from"./chunk-6F25LG6O.js";import{d as S}from"./chunk-QKO56XO6.js";import{b as w}from"./chunk-OLOKUDVI.js";import{j as d}from"./chunk-BOVYXYHK.js";import{a as h}from"./chunk-RAI4DTMT.js";import{f as s}from"./chunk-VTHXE323.js";var j=new c("white");function E(o){let t=o.symbolLayers?.at(-1);if(t&&"outline"in t)return t?.outline?.size}function W(o){if(!o)return 0;if(u(o)){let t=E(o);return t??0}return w(L(o)?.width)}function X(o){if(o==null||!("symbolLayers"in o)||o.symbolLayers==null)return!1;switch(o.type){case"point-3d":return o.symbolLayers.some(t=>t.type==="object");case"line-3d":return o.symbolLayers.some(t=>t.type==="path");case"polygon-3d":return o.symbolLayers.some(t=>t.type==="object"||t.type==="extrude");default:return!1}}function Y(o){return o.resource?.href??""}function Z(o,t){if(!o)return null;let r=null;return u(o)?r=C(o):m(o)&&(r=o.type==="cim"?k(o):o.color?new c(o.color):null),r?p(r,t):null}function C(o){let t=o.symbolLayers;if(!t)return null;let r=null;return t.forEach(n=>{n.type==="object"&&n.resource?.href||(r=n.type==="water"?n.color:n.material?n.material.color:null)}),r?new c(r):null}function p(o,t){if(t==null||o==null)return o;let r=o.toRgba();return r[3]=r[3]*t,new c(r)}function O(o,t,r){let n=o.symbolLayers;if(!n)return;let l=e=>p(t=t??e??(r!=null?j:null),r);n.forEach(e=>{if(e.type!=="object"||!e.resource?.href||t)if(e.type==="water")e.color=l(e.color);else{let a=e.material!=null?e.material.color:null,f=l(a);e.material==null?e.material=new g({color:f}):e.material.color=f,r!=null&&"outline"in e&&e.outline?.color!=null&&(e.outline.color=p(e.outline.color,r))}})}function v(o,t,r){(t=t??o.color)&&(o.color=p(t,r)),r!=null&&"outline"in o&&o.outline?.color&&(o.outline.color=p(o.outline.color,r))}function _(o,t,r){o&&(t||r!=null)&&(t&&(t=new c(t)),u(o)?O(o,t,r):m(o)&&v(o,t,r))}function F(o,t){return s(this,null,function*(){let r=o.symbolLayers;r&&(yield h(r,n=>s(this,null,function*(){return D(n,t)})))})}function D(o,t){return s(this,null,function*(){switch(o.type){case"extrude":R(o,t);break;case"icon":case"line":case"text":N(o,t);break;case"path":J(o,t);break;case"object":yield T(o,t)}})}function N(o,t){let r=z(t);r!=null&&(o.size=r)}function z(o){for(let t of o)if(typeof t=="number")return t;return null}function R(o,t){o.size=typeof t[2]=="number"?t[2]:0}function T(o,t){return s(this,null,function*(){let{resourceSize:r,symbolSize:n}=yield M(o),l=x(t,r,n);o.width=y(t[0],n[0],r[0],l),o.depth=y(t[1],n[1],r[1],l),o.height=y(t[2],n[2],r[2],l)})}function J(o,t){let r=x(t,d,[o.width,void 0,o.height]);o.width=y(t[0],o.width,1,r),o.height=y(t[2],o.height,1,r)}function x(o,t,r){for(let n=0;n<3;n++){let l=o[n];switch(l){case"symbol-value":{let e=r[n];return e!=null?e/t[n]:1}case"proportional":break;default:if(l&&t[n])return l/t[n]}}return 1}function M(o){return s(this,null,function*(){let{computeObjectLayerResourceSize:t}=yield import("./chunk-HA2YJC3H.js"),r=yield t(o,10),{width:n,height:l,depth:e}=o,a=[n,e,l],f=1;for(let i=0;i<3;i++){let b=a[i];if(b!=null){f=b/r[i];break}}for(let i=0;i<3;i++)a[i]==null&&(a[i]=r[i]*f);return{resourceSize:r,symbolSize:a}})}function y(o,t,r,n){switch(o){case"proportional":return r*n;case"symbol-value":return t??r;default:return o}}function H(o,t){let r=z(t);if(r!=null)switch(o.type){case"simple-marker":o.size=r;break;case"picture-marker":{let n=o.width/o.height;n>1?(o.width=r,o.height=r*n):(o.width=r*n,o.height=r);break}case"simple-line":o.width=r;break;case"text":o.font.size=r}}function $(o,t){return s(this,null,function*(){if(o&&t)return u(o)?F(o,t):void(m(o)&&H(o,t))})}function oo(o,t,r){if(o&&t!=null)if(u(o)){let n=o.symbolLayers;n&&n.forEach(l=>{if(l.type==="object")switch(r){case"tilt":l.tilt=(l.tilt??0)+t;break;case"roll":l.roll=(l.roll??0)+t;break;default:l.heading=(l.heading??0)+t}l.type==="icon"&&(l.angle+=t)})}else m(o)&&(o.type!=="simple-marker"&&o.type!=="picture-marker"&&o.type!=="text"||(o.angle+=t))}function to(o){if(!o)return null;let t=o.effects.filter(r=>r.type!=="bloom").map(r=>r.toJSON());return S(t)}function ro(o){return o!=null&&o.type==="polygon-3d"&&o.symbolLayers.some(t=>t.type==="extrude")}export{W as a,X as b,Y as c,Z as d,p as e,_ as f,$ as g,oo as h,to as i,ro as j};
