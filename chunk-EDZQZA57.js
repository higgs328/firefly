import{a as y,b as g}from"./chunk-V6AA2XHK.js";import{b as z}from"./chunk-NX5B6XBR.js";import{q as b}from"./chunk-DA3SDKGO.js";import{a as f,d as h,e as p,f as v}from"./chunk-ZC6EBRE4.js";import{a as F}from"./chunk-KJUZWSCL.js";import{d as R,fa as B,h as w,m as x,u as c}from"./chunk-NJWTSROP.js";import{a as d}from"./chunk-BAEF3CT6.js";import{b as S}from"./chunk-YOFFGXOB.js";import{f as m}from"./chunk-VTHXE323.js";var E=new d({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),k=Object.freeze({}),N="frequency";function K(e,n,r){return m(this,null,function*(){let i=e.bin;return i.onField&&(i.onField=i.onField.trim()),i.onExpression?.value&&(i.onExpression.value=i.onExpression.value.trim()),i.splitBy&&(i.splitBy.value&&(i.splitBy.value=i.splitBy.value.trim()),i.splitBy.outAlias&&(i.splitBy.outAlias=i.splitBy.outAlias.trim())),i.stackBy&&(i.stackBy.value&&(i.stackBy.value=i.stackBy.value.trim()),i.stackBy.outAlias&&(i.stackBy.outAlias=i.stackBy.outAlias.trim())),"normalizationField"in i.parameters&&i.parameters.normalizationField&&(i.parameters.normalizationField=i.parameters.normalizationField.trim()),e.outStatistics?.length||(e.outStatistics=[{statisticType:"count",onStatisticField:"1",outStatisticFieldName:N}]),U(e,n,r)})}function U(e,n,r){return m(this,null,function*(){let{outFields:i,orderByFields:a,groupByFieldsForStatistics:s,outStatistics:o}=e;if(i)for(let t=0;t<i.length;t++)i[t]=i[t].trim();if(a)for(let t=0;t<a.length;t++)a[t]=a[t].trim();if(s)for(let t=0;t<s.length;t++)s[t]=s[t].trim();if(o)for(let t=0;t<o.length;t++)o[t].onStatisticField&&(o[t].onStatisticField=o[t].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),q(e,n,r)})}function q(e,n,r){return m(this,null,function*(){if(!e)return null;let{where:i}=e;if(e.where=i=i?.trim(),(!i||/^1 *= *1$/.test(i)||n&&n===i)&&(e.where=null),!e.geometry)return e;let a=yield O(e);if(e.distance=0,e.units=null,e.spatialRel==="esriSpatialRelEnvelopeIntersects"){let{spatialReference:s}=e.geometry;a=F(a),a.spatialReference=s}if(a){yield y(a.spatialReference,r),a=M(a,r);let s=(yield z(v(a)))[0];if(s==null)throw k;let o="quantizationParameters"in e&&e.quantizationParameters?.tolerance||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,t=o&&A(a,r)?{densificationStep:8*o}:void 0,l=s.toJSON(),u=g(l,l.spatialReference,r,t);if(!u)throw k;u.spatialReference=r,e.geometry=u}return e})}function A(e,n){if(!e)return!1;let r=e.spatialReference;return(f(e)||p(e)||h(e))&&!R(r,n)&&!b(r,n)}function M(e,n){let r=e.spatialReference;return A(e,n)&&f(e)?{spatialReference:r,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}function O(e){return m(this,null,function*(){let{distance:n,units:r}=e,i=e.geometry;if(n==null||"vertexAttributes"in i)return i;let a=i.spatialReference,s=r?E.fromJSON(r):B(a),o=a&&(w(a)||x(a))?i:yield y(a,c).then(()=>g(i,c)),t=yield import("./chunk-NMV242K5.js");yield t.load();let l=t.execute(o,n||1,{unit:s})??void 0;if(!l||!p(l)||l.rings.length===0)throw new S("unsupported-query:invalid-parameters","Invalid parameters for query by distance");return l})}function W(e,n){return e==null?null:typeof e=="string"?n?new Date(`1970-01-01T${e}Z`).getTime():new Date(e).getTime():e instanceof Date?e.getTime():e}export{E as a,k as b,K as c,U as d,q as e,W as f};
