import{b as Bt}from"./chunk-W2NSYRQ2.js";import{a as Xt}from"./chunk-HCXKN2EN.js";import{c as xt,d as Ht,e as Dt,h as Vt,i as Ge,m as vt,n as Ft,o as Ue,p as de,q as X,r as Nt,s as Gt,t as Ut,u as We,v as Wt,w as jt,x as zt,y as je,z as kt}from"./chunk-XYAS56YV.js";import{a as q,f as Ne,g as yt,i as Lt,l as b}from"./chunk-RGD6ZU25.js";import{c as St}from"./chunk-NRFDPN3W.js";import{b as R,c as ee}from"./chunk-62UTK67Z.js";import{a as K}from"./chunk-SLOUGIU5.js";import{b as qt}from"./chunk-YV3FNVYY.js";import{b as Et}from"./chunk-THFX26II.js";import{a as _t,c as At}from"./chunk-IHEDDQC4.js";import{a as Ct}from"./chunk-W3HCXOXG.js";import{a as It}from"./chunk-3NS6RWJD.js";import{d as D}from"./chunk-6ZTUPVYX.js";import{a as wt}from"./chunk-FTYEGPVQ.js";import{d as Fe}from"./chunk-5MJEFA5N.js";import{h as Mt,j as ve,m as Pt,n as E}from"./chunk-QXSQOLB3.js";import{c as Ot}from"./chunk-2XTO2IAR.js";import{a as Rt}from"./chunk-P7MVFIZJ.js";import{a as nt}from"./chunk-FSW536RM.js";import{a as pt,b as bt}from"./chunk-T5UBLAP4.js";import{f as ft,l as gt,m as ht}from"./chunk-DA3NC6W4.js";import{d as Tt}from"./chunk-FGABE2LC.js";import{j as g}from"./chunk-J5AEP4US.js";import{a as lt}from"./chunk-L7NOU4T2.js";import{b as Ve,d as ct,e as dt,g as ut,l as ce,m as mt}from"./chunk-G2JMPZCN.js";import{h as st}from"./chunk-YEXMIDOT.js";import{a as it}from"./chunk-AYNBEMCC.js";import{b as De}from"./chunk-YQNUGDFH.js";import{d as ot,j as xe,p as He}from"./chunk-7SDNM7YV.js";import{b as l,d as U,e as Le}from"./chunk-4NUW747S.js";import{a as $}from"./chunk-ONYJLWAD.js";import{i as ye}from"./chunk-PHODKV66.js";import{i as le,k as at,s as Se}from"./chunk-ZM24RY22.js";import{a as P}from"./chunk-6F25LG6O.js";import{a as Ie}from"./chunk-RWCIDBNQ.js";import{i as rt}from"./chunk-HM5RIVQC.js";import{a as ne}from"./chunk-ALWV3RJ2.js";import{a as S,b as y,c as B,d as h,e as O,n as p,r as tt,u as A,v as G,w as L}from"./chunk-6B5XFA6F.js";import{o as et}from"./chunk-DA3SDKGO.js";import{c as H}from"./chunk-PTZYZULI.js";import{a as Ee}from"./chunk-NMLYCCKN.js";import{a as Ae}from"./chunk-BCREO4Q5.js";import{c as Pe,g as N,h as we,i as ie,k as _e,m as Ke,s as se,y as Ce}from"./chunk-ZTOZWLEE.js";import{a as Q,b as $e,c as C}from"./chunk-BOVYXYHK.js";import{i as Me,j as Qe}from"./chunk-EQZWYK27.js";import{c as Je}from"./chunk-VIEK2X23.js";import{a as z,j as k}from"./chunk-TG45K3WR.js";import{g as Ye}from"./chunk-XRGPJ3QY.js";import{a as _,b as oe}from"./chunk-VTHXE323.js";var Zt=H(0,0,0,.04);function Yt({accentColor:e}){return Se(e,.5)}function Jt({accentColor:e}){return Se(e,.7)}var ue=class extends lt{constructor(){super(...arguments),this.backgroundColor=H(1,0,0,.5),this.gridColor=H(0,1,0,.5),this.gridWidth=4}},me=class extends bt{constructor(t,s){super(t,s,new pt(qt,()=>import("./chunk-UVRQYCIQ.js")))}initializePipeline(){return ht({blending:ft,depthTest:{func:rt.LESS},colorWrite:gt})}};var pe=class extends It{constructor(t){super(t,ke),this.produces=new Map([[nt.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,s=>st(s)]])}get visible(){return!0}createGLMaterial(t){return new ze(t)}createBufferWriter(){return new Rt(Et)}getConfiguration(){return Bt}},ze=class extends Tt{constructor(t){super(t)}beginSlot(t){return this.getTechnique(me,t)}},ke=class extends ue{constructor(){super(...arguments),this.renderOccluded=g.Occlude,this.isDecoration=!1}};var fe=class extends Ct{constructor(t){super(t),this._material=null,this._renderOccluded=g.OccludeAndTransparent,this._gridWidth=1,this._gridColor=H(1,0,0,1),this._backgroundColor=H(1,0,0,1),this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){Ee(this._gridColor,t),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){Ee(this._backgroundColor,t),this._updateMaterial()}createExternalResources(){this._material=new pe(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){this._material!=null&&t(this._material)}createGeometries(t){if(this._material!=null){let s=Mt(this._material);t.addGeometry(s)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this._material!=null&&this._material.setParameters(this._materialParameters)}};function ba(e,t,s,a,o,i,r,n){return or(t,r.worldUpAtPosition(e,l.get()),o,i,n.basis1,n.basis2),p(n.basis1,n.basis1,s),p(n.basis2,n.basis2,a),y(n.origin,e),He(n.basis2,n.basis1,n.origin,n.plane),n}function or(e,t,s,a,o,i){let r=G(e,t),n=l.get(),d=l.get();switch(a===V.HORIZONTAL_OR_VERTICAL?Math.abs(r)>Vt?V.HORIZONTAL:V.VERTICAL:a){case V.VERTICAL:{let c=Math.abs(r)<=Ge?e:s.viewUp;L(n,c,t),y(d,t);break}case V.HORIZONTAL:L(n,s.viewUp,t),L(d,t,n);break;case V.TILTED:{let c=Math.abs(r)<=Ge?t:s.viewUp;L(n,c,e),L(d,e,n);break}}let u=L(l.get(),n,d);G(u,s.viewForward)>0&&p(d,d,-1),A(o,n),A(i,d)}function ir(e,t,s){let a=t.worldUpAtPosition(e.origin,l.get()),o=e.basis1,i=Xe(e,a),r=Math.round(i/Z)*Z;return ce(e,r-i,o,s)}function Ta(e,t,s,a,o,i){let r=y(l.get(),o.origin);h(r,r,p(l.get(),o.basis1,e.direction[0]<0?1:-1)),h(r,r,p(l.get(),o.basis2,e.direction[1]<0?1:-1));let n=S(o.basis1),d=S(o.basis2),u=O(l.get(),s,r),c=O(l.get(),t,r),m=0,f=0;if(be(e)){let Re=Be(o),Y=Be(i);m=n-.5*e.direction[0]*G(o.basis1,c)/n,f=d-.5*e.direction[1]*G(o.basis2,c)/d;let re=Y/Re;m*=re,f*=re}let T=m+.5*e.direction[0]*G(o.basis1,u)/n,w=f+.5*e.direction[1]*G(o.basis2,u)/d,W=p(l.get(),o.basis1,T/n),v=p(l.get(),o.basis2,w/d);(T<=0||Qt(i.origin,W,a)<=je)&&y(W,i.basis1),(w<=0||Qt(i.origin,v,a)<=je)&&y(v,i.basis2);let M=y(l.get(),r);return h(M,M,p(l.get(),W,e.direction[0]<0?-1:1)),h(M,M,p(l.get(),v,e.direction[1]<0?-1:1)),ct(M,W,v,i)}function Ra(e,t){return kt*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function Oa(e,t,s,a){let o=L(l.get(),t,s);return L(o,o,t),xe(e,o,a)}function Ma(e,t){return Lt(e.basis1,e.basis2,e.origin,t)}function Pa(e,t,s,a){let o=t.worldUpAtPosition(e.origin,l.get()),i=l.get();switch(s){case he.HEADING:y(i,o);break;case he.TILT:y(i,e.basis1)}return xe(e.origin,i,a)}function wa(e,t,s,a){let o=qe(s,x.NEGATIVE_X),i=U.get();Ke(i,t,o.edge*Math.PI/2);let r=A(l.get(),o.basis),n=p(l.get(),r,o.direction*a.computeScreenPixelSizeAt(o.position)*X);h(n,n,o.position);let d=a.projectToRenderScreen(n,l.get()),u=sr(a,d);St(a,d,ge),A(ge.direction,ge.direction);let c=l.get();!u&&ut(s,ge,c)&&(n=c),i[12]=0,i[13]=0,i[14]=0,e.modelTransform=i,e.renderLocation=$e(n),u?e.state|=te:e.state&=~te}function sr(e,t){let[s,a,o,i]=e.viewport,r=Math.min(o,i)/16,n=!0;return t[0]<s+r?(t[0]=s+r,n=!1):t[0]>s+o-r&&(t[0]=s+o-r,n=!1),t[1]<a+r?(t[1]=a+r,n=!1):t[1]>a+i-r&&(t[1]=a+i-r,n=!1),n}function _a(e,t,s,a){let o=S(a.basis1),i=S(a.basis2),r=$t(a),n=Be(a),d=B(l.get(),0,0,0);h(d,p(l.get(),a.basis1,t.direction[0]),p(l.get(),a.basis2,t.direction[1])),h(d,a.origin,d);let u=0,c=1;if(be(t))t.direction[0]===1&&t.direction[1]===-1?u=Z:t.direction[0]===1&&t.direction[1]===1?u=Math.PI:t.direction[0]===-1&&t.direction[1]===1&&(u=3*Math.PI/2),c=n;else{let f=t.direction[0]!==0?1:2;u=f===1?Z:0,c=(f===1?i:o)-r}let m=se(U.get(),u);ie(m,m,B(l.get(),c,c,c)),N(m,s,m),m[12]=0,m[13]=0,m[14]=0,e.modelTransform=m,e.renderLocation=d}function Ca(e,t,s,a){let o=a.worldUpAtPosition(s.origin,l.get()),i=qe(s,x.POSITIVE_X),r=se(U.get(),i.edge*Math.PI/2);_e(r,r,-Xe(s,o)),N(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=i.position}function Aa(e,t,s){let a=qe(s,x.POSITIVE_Y),o=se(U.get(),a.edge*Math.PI/2);_e(o,o,Z),N(o,t,o),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=a.position}var x;function qe(e,t){switch(t){case x.POSITIVE_X:return{basis:e.basis1,direction:1,position:h(l.get(),e.origin,e.basis1),edge:t};case x.POSITIVE_Y:return{basis:e.basis2,direction:1,position:h(l.get(),e.origin,e.basis2),edge:t};case x.NEGATIVE_X:return{basis:e.basis1,direction:-1,position:O(l.get(),e.origin,e.basis1),edge:t};case x.NEGATIVE_Y:return{basis:e.basis2,direction:-1,position:O(l.get(),e.origin,e.basis2),edge:t}}}function Qt(e,t,s){let a=s.projectToRenderScreen(h(l.get(),e,t),l.get()),o=s.projectToRenderScreen(O(l.get(),e,t),l.get());return tt(O(a,a,o))}function $t(e){let t=S(e.basis1),s=S(e.basis2);return Wt*Math.min(t,s)}function Be(e){return $t(e)}function be(e){return e.direction[0]!==0&&e.direction[1]!==0}function Ea(e){let t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new At({view:e,attached:!1,color:Jt(e.effectiveTheme),width:vt,renderOccluded:g.OccludeAndTransparent,geometry:[t],isDecoration:!0})}function Ia(e){return new fe({view:e,attached:!1,backgroundColor:Zt,gridColor:Yt(e.effectiveTheme),gridWidth:4,renderOccluded:g.OccludeAndTransparent,isDecoration:!0})}function Sa(e,t,s,a=new wt){if(e==null)return null;let{renderCoordsHelper:o}=t,i=o.fromRenderCoords(e.origin,new Je({spatialReference:t.spatialReference}));if(i==null)return null;let r=et(i,s);if(r==null)return null;a.position=r;let n=2*S(e.basis1),d=2*S(e.basis2),u=Fe.renderUnitScaleFactor(t.spatialReference,s);a.width=n*u,a.height=d*u;let c=o.worldUpAtPosition(e.origin,l.get());return a.tilt=Qe(Xe(e,c)),a.heading=o.headingAtPosition(e.origin,e.basis1)-90,a}function Xe(e,t){return ot(t,e.basis2,e.basis1)+Z}function nr(e,t,s,a,o,i,r=Ve()){return i.toRenderCoords(e,r.origin)?(i.worldBasisAtPosition(r.origin,Ae.X,r.basis1),i.worldBasisAtPosition(r.origin,Ae.Y,r.basis2),He(r.basis2,r.basis1,r.origin,r.plane),ce(r,-Me(t),mt(r),r),ce(r,Me(s),r.basis1,r),p(r.basis1,r.basis1,a/2),p(r.basis2,r.basis2,o/2),dt(r),r):(Ye.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function ya(e,t){if(e?.position==null)return null;let s=_t(e.position,t.spatialReference,t.elevationProvider);if(s==null)return null;let a=Fe.renderUnitScaleFactor(e.position.spatialReference,t.spatialReference),o=e.width*a,i=e.height*a;return{position:s,heading:e.heading,tilt:e.tilt,renderWidth:o,renderHeight:i}}function La(e,t,s,a=Ve()){if(e==null)return null;let o=nr(e.position,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,a);return s.tiltEnabled||o==null||ir(o,t.renderCoordsHelper,o),o}(function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"})(x||(x={}));var I=ee.Custom1,he,V;(function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"})(he||(he={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(V||(V={}));var te=ee.Custom2,ge=it(),Z=Math.PI/2,Te=ee.Custom1,Kt=ee.Custom2;function xa(e){return(e.type==="building-scene-3d"?e:null)!=null}var er=class extends q{constructor(t,s){let a=be(s),o=a?Ut:We,i=o*xt,r=We,n={renderOccluded:g.OccludeAndTransparent,isDecoration:!0},d=new D(oe(_({},n),{width:o})),u=new D(oe(_({},n),{width:i})),c=new D(oe(_({},n),{width:r}));super(_(_({view:t},yt),lr({isCorner:a,unfocusedMaterial:d,focusedMaterial:u,outlineMaterial:c}))),this._themeHandle=z(()=>t.effectiveTheme.accentColor,m=>{let f=P.toUnitRGBA(m);d.setParameters({color:f}),u.setParameters({color:f}),c.setParameters({color:f})},k)}destroy(){this._themeHandle.remove(),super.destroy()}};function lr({isCorner:e,unfocusedMaterial:t,focusedMaterial:s,outlineMaterial:a}){let o=e?[C(1,0,0),C(0,0,0),C(0,1,0)]:[C(1,0,0),C(-1,0,0)];return{renderObjects:[new b(E(t,o),R.Unfocused|Te),new b(E(s,o),R.Focused|Te),new b(E(a,o),Kt)],collisionType:{type:"line",paths:[o]},radius:e?jt:zt,state:Te}}var tr=class extends q{constructor(t,s){let a=new Xt({writeDepth:!1,renderOccluded:g.Opaque,isDecoration:!0}),o=Ne.calloutWidth,i=new D({width:o,renderOccluded:g.OccludeAndTransparent,isDecoration:!0});super(_({view:t},cr({imageMaterial:a,calloutMaterial:i}))),this._currentTexture=null,this._themeHandle=z(()=>t.effectiveTheme.accentColor,r=>{let n=at(r,.5),d=le(r),u=this._currentTexture,c=s(n,d);a.setParameters({textureId:c.texture.id}),i.setParameters({color:P.toUnitRGBA(r)}),this._currentTexture=c,u?.release()},k)}destroy(){this._themeHandle.remove(),this._currentTexture?.release(),super.destroy()}};function cr({imageMaterial:e,calloutMaterial:t}){let{focusMultiplier:s,calloutLength:a,discRadius:o}=Ne,i=o*s,r=(c,m)=>{let f=[0,1,2,2,3,0];return new Ot(m,[[Ie.POSITION,new De([a-c,-c,0,a+c,-c,0,a+c,c,0,a-c,c,0],f,3,!0)],[Ie.UV0,new De([0,0,1,0,1,1,0,1],f,2,!0)]])},n=E(t,[[0,0,0],[a-o,0,0]]),d=E(t,[[0,0,0],[a-i,0,0]]),u=I;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[a,0,0]},focusMultiplier:s,radius:o,renderObjects:[new b(r(o,e),R.Unfocused|u),new b(n,R.Unfocused|u),new b(r(i,e),R.Focused|u),new b(d,R.Focused|u)],state:u}}var Ze;(function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(Ze||(Ze={}));var rr=class extends q{constructor(t,s){let a=new D({width:1,renderOccluded:g.OccludeAndTransparent,isDecoration:!0}),o=new K({cullFace:$.Back,renderOccluded:g.Opaque,isDecoration:!0}),i=new K({cullFace:$.Back,renderOccluded:g.Opaque,isDecoration:!0}),r=new K({cullFace:$.Back,renderOccluded:g.Opaque,isDecoration:!0}),n=new K({writeDepth:!1,cullFace:$.Front,renderOccluded:g.Transparent,isDecoration:!0});super(_({view:t},dr({offsetMode:s,tubeMaterial:o,tipMaterial:i,capMaterial:r,outlineMaterial:n,calloutMaterial:a}))),this._themeHandle=z(()=>t.effectiveTheme.accentColor,d=>{let u=le(d),c=P.toUnitRGBA(d),m=P.toUnitRGBA(u),f=P.toUnitRGBA(P.blendColors(u,d,.4)),T=P.toUnitRGBA(P.blendColors(u,d,.14));a.setParameters({color:c}),o.setParameters({color:T}),i.setParameters({color:m}),r.setParameters({color:f}),n.setParameters({color:c})},k)}destroy(){this._themeHandle.remove(),super.destroy()}};function dr({offsetMode:e,tubeMaterial:t,tipMaterial:s,capMaterial:a,outlineMaterial:o,calloutMaterial:i}){let r=e===Ze.CENTER_ON_CALLOUT?X:0,n=[C(r,0,-24),C(r,0,Nt/2)],d=mr(n),u=ar({vertices:n,padding:0,materials:{tube:t,tip:s,cap:a}}),c=ar({vertices:n,padding:Gt,materials:{tube:o,tip:o,cap:o}}),m=E(i,[[r,0,0],[r-X,0,0]]),f=E(i,[[r,0,0],[r-X,0,0]]);return{renderObjects:[...u.normal.map(T=>new b(T,R.Unfocused|I)),...c.normal.map(T=>new b(T,R.Unfocused|I)),new b(m,R.Unfocused|I|te),...u.focused.map(T=>new b(T,R.Focused|I)),...c.focused.map(T=>new b(T,R.Focused|I)),new b(f,R.Focused|I|te)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[d]},collisionPriority:1,radius:Ue,state:I}}function ar({vertices:e,padding:t,materials:s}){let a=o=>{let i=e.slice(),r=O(l.get(),i[0],i[1]);A(r,r);let n=O(l.get(),i[i.length-1],i[i.length-2]);if(A(n,n),t>0){let J=p(Q(),n,-t);i[i.length-1]=h(J,J,i[i.length-1]);let j=p(Q(),r,-t);i[0]=h(j,j,i[0])}let d=o?Dt:1,u=de*d,c=Ue*d,m=Pe(U.get());if(t>0){let J=u/4,j=B(l.get(),0,J,0),ae=1+t/J;we(m,m,j),ie(m,m,B(l.get(),ae,ae,ae)),we(m,m,p(j,j,-1/ae))}let f=Pe(ne()),T=C(0,1,0),w=Ce(ne(),ye(Le.get(),T,n));w[12]=i[i.length-1][0],w[13]=i[i.length-1][1],w[14]=i[i.length-1][2],N(w,w,m);let W=s.tube,v=ur(Ft*(o?Ht:1)+t,i,W);v.transformation=f;let M=[v],Re=s.tip,Y=ve(Re,u,c,24,!1,!1,!0);Y.transformation=w,M.push(Y);let re=s.cap,Oe=ve(re,u,c,24,!1,!0,!1);Oe.transformation=w,M.push(Oe);let F=Ce(ne(),ye(Le.get(),T,r));return F[12]=i[0][0],F[13]=i[0][1],F[14]=i[0][2],N(F,F,m),M.push(Y.instantiate({transformation:F})),M.push(Oe.instantiate({transformation:F})),M};return{normal:a(!1),focused:a(!0)}}function ur(e,t,s){let a=[];for(let i=0;i<12;i++){let r=i/12*2*Math.PI;a.push([Math.cos(r)*e,Math.sin(r)*e])}return Pt(s,a,t,[],[],!1)}function mr(e,t){let s=O(Q(),e[e.length-1],e[e.length-2]);A(s,s),p(s,s,de),h(s,s,e[e.length-1]);{let a=O(Q(),e[0],e[1]);return A(a,a),p(a,a,de),h(a,a,e[0]),[a,...e,s]}}export{Zt as a,Yt as b,Jt as c,ba as d,Ta as e,Ra as f,Oa as g,Ma as h,Pa as i,wa as j,_a as k,Ca as l,Aa as m,Be as n,be as o,Ea as p,Ia as q,Sa as r,ya as s,La as t,I as u,he as v,V as w,te as x,Te as y,Kt as z,xa as A,er as B,tr as C,Ze as D,rr as E};
