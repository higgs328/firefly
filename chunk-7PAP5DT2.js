import{a as W}from"./chunk-OY5GEC5R.js";import{a as g,b as j,c as k,g as H,h as T,i as V,j as N}from"./chunk-CZAUQJCN.js";import{a as S}from"./chunk-MROWXKZJ.js";import{t as u,u as h,x as M,za as A}from"./chunk-KALOJIUA.js";import{a as I}from"./chunk-PEW2PLAN.js";import{a as b}from"./chunk-CX5IFQZJ.js";import{a as v}from"./chunk-G4DZJMGT.js";import{f as F}from"./chunk-CCJU4DSH.js";import{a as n}from"./chunk-QGVBCWUY.js";import{r as f,s as c}from"./chunk-MYO4NP2N.js";import{e as l}from"./chunk-NFIPKH6V.js";import{l as w}from"./chunk-5QEXLALV.js";import{b as d}from"./chunk-2LI2GKBQ.js";import{f as E}from"./chunk-VTHXE323.js";var x,y=H(W),i=x=class extends F{constructor(e){super(e),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(e){return N(e,y)}readElements(e,s){return T(s.formElements,y)}writeElements(e,s){s.formElements=V(e,y)}clone(){return new x({description:this.description,expressionInfos:d(this.expressionInfos),elements:d(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}getFieldsUsed(e,s){return E(this,null,function*(){let t=new Set,{description:r,elements:o,expressionInfos:a,title:O}=this;if(p(t,e,r),p(t,e,O),!o)return[];let U=q(o,a).map(m=>M(t,e,m));yield Promise.all(U);for(let m of o)B(t,{fieldsIndex:e,relationships:s},m);return Array.from(t).sort()})}};function B(e,s,t){let{fieldsIndex:r}=s;if(!r||r.fields.length!==e.size)switch(p(e,r,t.label),p(e,r,t.description),t.type){case"field":h(e,r,t.fieldName);break;case"group":t.elements.forEach(o=>B(e,s,o));break;case"relationship":if(s.relationships){let o=s.relationships.find(a=>a.id===t.relationshipId);o&&h(e,r,o.keyField)}u(e,r,t.orderByFields?.map(o=>o.field));break;case"text":p(e,r,t.text)}}function q(e,s){if(!s||s.length===0)return[];let t=J(e),r=[];for(let o of s)t.has(o.name)&&r.push(o.expression);return r}function J(e){let s=new Set;for(let t of e)if(c(s,t.visibilityExpression),!k(t)){if(j(t))f(s,J(t.elements));else if(c(s,t.editableExpression),g(t)){let{requiredExpression:r,valueExpression:o}=t;f(s,[r,o])}}return s}function p(e,s,t){u(e,s,A(t))}n([l({type:String,json:{write:!0}})],i.prototype,"description",void 0),n([l({json:{write:!0}})],i.prototype,"elements",void 0),n([v("elements")],i.prototype,"castElements",null),n([I("elements",["formElements"])],i.prototype,"readElements",null),n([b("elements")],i.prototype,"writeElements",null),n([l({type:[S],json:{write:!0}})],i.prototype,"expressionInfos",void 0),n([l({type:Boolean,json:{default:!1,write:!0}})],i.prototype,"preserveFieldValuesWhenHidden",void 0),n([l({type:String,json:{write:!0}})],i.prototype,"title",void 0),i=x=n([w("esri.form.FormTemplate")],i);var $=i;export{$ as a};
