import{A as S}from"./chunk-PKVI3POI.js";import{j as F}from"./chunk-Z7TBAZRW.js";import{a as P}from"./chunk-QCZ3ZIGQ.js";import{m as C}from"./chunk-Y4PJQPM4.js";import{h as U}from"./chunk-BBB7KLHV.js";import{A,B as I,C as T}from"./chunk-XR5FT7TQ.js";import{d as v,h as L,j as k,m as $}from"./chunk-NJWTSROP.js";import{a as t}from"./chunk-QGVBCWUY.js";import{H as w}from"./chunk-MYO4NP2N.js";import{e as r}from"./chunk-NFIPKH6V.js";import{l as f}from"./chunk-5QEXLALV.js";import{g as m}from"./chunk-XRGPJ3QY.js";var p=class extends w{constructor(e){super(e),this.layer=null}get attachments(){return{enabled:this._effectiveEnabled&&!!this._effectiveCapabilities?.data.supportsAttachment}}get create(){let{_effectiveCapabilities:e,layer:i}=this,a=this._createEnabled,l=a,d=i.capabilities?.operations.supportsAdd,s=!!e?.operations.supportsAdd;return{attachments:{enabled:a&&this.attachments.enabled},attributes:a,enabled:a,geometry:l,reliesOnOwnerAdminPrivileges:!d&&s}}get delete(){let{_effectiveCapabilities:e,layer:i}=this,a=i.capabilities?.operations.supportsDelete,l=!!e?.operations.supportsDelete;return{enabled:this._effectiveEnabled&&!!e?.operations.supportsDelete,reliesOnOwnerAdminPrivileges:!a&&l}}get reliesOnOwnerAdminPrivileges(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}get update(){let{_effectiveCapabilities:e,layer:i}=this,a=this._updateEnabled,l=!(!a||!e?.editing.supportsGeometryUpdate),d=i.capabilities?.operations.supportsUpdate,s=!!e?.operations.supportsUpdate,c=this.attachments.enabled,o=c&&this._canCreateOrUpdate;return{attachments:{enabled:c,create:o,update:o},attributes:a,enabled:a,geometry:l,reliesOnOwnerAdminPrivileges:!d&&s}}get _createEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsAdd}get _updateEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsUpdate}get _canCreateOrUpdate(){return!(!this._createEnabled&&!this._updateEnabled)}get _effectiveEnabled(){return T(this.layer)}get _effectiveCapabilities(){return I(this.layer)}};t([r()],p.prototype,"attachments",null),t([r()],p.prototype,"create",null),t([r()],p.prototype,"delete",null),t([r()],p.prototype,"layer",void 0),t([r()],p.prototype,"reliesOnOwnerAdminPrivileges",null),t([r()],p.prototype,"update",null),t([r()],p.prototype,"_createEnabled",null),t([r()],p.prototype,"_updateEnabled",null),t([r()],p.prototype,"_canCreateOrUpdate",null),t([r()],p.prototype,"_effectiveEnabled",null),t([r()],p.prototype,"_effectiveCapabilities",null),p=t([f("esri.layers.support.EditingCapabilities")],p);var E=p;var y="esri.views.layers.support.editableLayerViews";function V(e,i){let{associatedLayer:a}=e,l=a?.infoFor3D;if(!l)return!1;let d=U(l);if(!(d!=null&&l.queryFormats.includes(d)))return m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because it does not support GLB queries.`),!1;let s=e.spatialReference,c=a.spatialReference;if(!v(s,c))return m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${s.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${c.wkid}).`),!1;let o=a.sourceJSON.sourceSpatialReference;if(!(o==null||v(o,c)))return m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${c.wkid}) is different from its source spatial reference (wkid:${o.wkid}).`),!1;let{view:b}=i;if(i.destroyed||b==null)return!1;let g=b.spatialReference,{viewingMode:h}=b.state,_=L(s),O=h===P.Global;return _&&!O?(m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${s.wkid}) is geographic. Please consider changing the viewing mode to global.`),!1):!_&&O?(m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${s.wkid}) is projected. Please consider changing the viewing mode to local.`),!1):!!(v(s,g)||O&&$(g)&&k(s))||(m.getLogger(y).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${s.wkid}) does not match the view spatial reference (wkid:${g.wkid}).`),!1)}var u=class extends E{constructor(e){super(e),this.layerInfo=null,this.layerView=null}get attachments(){let e=this.defaults.attachments.enabled,i=this.layerInfo;return{enabled:e&&i?.enabled!==!1}}get create(){let{attachments:e,defaults:i,layerInfo:a,layer:l,layerView:d}=this,s=i.create,c=a?.enabled!==!1&&a?.addEnabled!==!1,o=s.enabled&&c;return{attributes:o&&s.attributes,enabled:o,geometry:o&&s.geometry&&x(l,d),attachments:{enabled:e.enabled&&o&&a?.attachmentsOnCreateEnabled!==!1},reliesOnOwnerAdminPrivileges:s.reliesOnOwnerAdminPrivileges}}get defaults(){return new E({layer:this.layer})}get delete(){let{defaults:e,layerInfo:i}=this,a=e.delete,l=i?.enabled!==!1&&i?.deleteEnabled!==!1;return{enabled:a.enabled&&l,reliesOnOwnerAdminPrivileges:a.reliesOnOwnerAdminPrivileges}}get formTemplate(){let{layer:e,layerInfo:i}=this;return i?.formTemplate?i.formTemplate:e&&"formTemplate"in e?e.formTemplate:null}get relationship(){let{layer:e}=this,i=!(!C(e)||!e.relationships?.length),a=!!this.formTemplate?.elements?.some(l=>l.type==="relationship");return{enabled:i&&a}}get update(){let{attachments:e,defaults:i,layerInfo:a,layer:l,layerView:d}=this,s=i.update,c=a?.enabled!==!1&&a?.updateEnabled!==!1,o=s.enabled&&c,b=o&&s.attributes&&a?.attributeUpdatesEnabled!==!1,g=o&&s.geometry&&a?.geometryUpdatesEnabled!==!1&&x(l,d),h=e.enabled&&a?.attachmentsOnUpdateEnabled!==!1;return{attributes:b,enabled:o,geometry:g,attachments:{enabled:h,create:h&&s.attachments.create,update:h&&s.attachments.update},reliesOnOwnerAdminPrivileges:s.reliesOnOwnerAdminPrivileges}}};function x(e,i){return e.type!=="scene"||i!=null&&"type"in i&&i.type==="scene-layer-3d"&&V(e,i)}t([r()],u.prototype,"attachments",null),t([r()],u.prototype,"create",null),t([r()],u.prototype,"defaults",null),t([r()],u.prototype,"delete",null),t([r()],u.prototype,"formTemplate",null),t([r()],u.prototype,"layerInfo",void 0),t([r()],u.prototype,"layerView",void 0),t([r()],u.prototype,"relationship",null),t([r()],u.prototype,"update",null),u=t([f("esri.widgets.Editor.support.EditorEditingCapabilities")],u);var G=u;var n=class extends w{constructor(e){super(e),this.disabled=!1,this.layer=null,this.layerInfo=null,this.layerView=null}get _suspended(){return!!this.layerView?.suspended}get capabilities(){return new G({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}get editable(){let{create:e,relationship:i,update:a,delete:{enabled:l}}=this.capabilities,d=e.attachments.enabled||a.attachments.enabled;return!this.disabled&&(e.enabled||a.enabled||d||l||i.enabled)}get formTemplate(){return this.capabilities.formTemplate}get hasInvalidFormTemplate(){return S(this.layer,this.formTemplate)}get isTable(){return A(this.layer)}get supportsCreateFeaturesWorkflow(){if(this.disabled||this.layerView?.view?.type==="3d"&&F(this.layer.elevationInfo))return!1;let{enabled:e,geometry:i}=this.capabilities.create;return this.isTable?e:e&&i}get supportsUpdateWorkflow(){let{capabilities:e}=this;return!this.disabled&&(e.update.enabled||e.update.attachments.enabled||e.delete.enabled)}get visible(){let{layer:e}=this,i=e.parent;return!this._suspended&&e.visible&&(!i||!("visible"in i)||i.visible)}};t([r()],n.prototype,"_suspended",null),t([r()],n.prototype,"capabilities",null),t([r()],n.prototype,"disabled",void 0),t([r()],n.prototype,"editable",null),t([r()],n.prototype,"formTemplate",null),t([r()],n.prototype,"hasInvalidFormTemplate",null),t([r()],n.prototype,"isTable",null),t([r()],n.prototype,"layer",void 0),t([r()],n.prototype,"layerInfo",void 0),t([r()],n.prototype,"layerView",void 0),t([r()],n.prototype,"supportsCreateFeaturesWorkflow",null),t([r()],n.prototype,"supportsUpdateWorkflow",null),t([r()],n.prototype,"visible",null),n=t([f("esri.widgets.Editor.support.EditorItem")],n);var Oe=n;export{Oe as a};
