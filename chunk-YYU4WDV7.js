import{b as L,d as b,e as A,g as N}from"./chunk-GYQWYHEG.js";import{b as B}from"./chunk-JC4DQSN3.js";import{g as E,j as F,k as T}from"./chunk-IO35PPBL.js";import{e as v,f as g,g as x,h}from"./chunk-F5AJITOA.js";import{W as q,da as z}from"./chunk-KALOJIUA.js";import{b as a}from"./chunk-YOFFGXOB.js";import{a as w,c as o,f as m}from"./chunk-VTHXE323.js";var S=[...q,...v,"time-only","string"];function C(s){return m(this,null,function*(){if(!s?.layer||!(s.field||s.valueExpression||s.sqlExpression))throw new a("summary-statistics:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(s.valueExpression&&!s.sqlExpression&&!s.view)throw new a("summary-statistics:missing-parameters","View is required when 'valueExpression' is specified");s.forBinning&&B(s,"summary-statistics");let u=s,{layer:n}=u,l=o(u,["layer"]),r=s.forBinning?b:L,e=N(n,r,s.forBinning);if(!e)throw new a("summary-statistics:invalid-parameters","'layer' must be one of these types: "+A(r).join(", "));let i=w({layerAdapter:e},l);i.normalizationType=h(i);let V=i.signal!=null?{signal:i.signal}:null;yield e.load(V);let p=i.field,y=i.normalizationType,j=i.valueExpression||i.sqlExpression,t=p?e.getField(p):null,R=yield x({field:i.field,normalizationField:i.normalizationField,valueExpression:i.valueExpression}),f=T(e,R,"summary-statistics:invalid-parameters");if(f)throw f;if(t){let c=E(e,t,"summary-statistics:invalid-parameters",S);if(c)throw c;if((g(t)||z(t))&&y)throw new a("summary-statistics:invalid-parameters","Normalization is not allowed for date fields")}else if(j&&y)throw new a("summary-statistics:invalid-parameters","Normalization is not allowed when 'valueExpression' or 'sqlExpression' is specified");i.filter&&!i.filter.spatialRelationship&&(i.filter.spatialRelationship="intersects");let d=F(i.filter,"summary-statistics:invalid-parameters");if(d)throw d;return i})}function H(s){return m(this,null,function*(){let r=yield C(s),{layerAdapter:n}=r,l=o(r,["layerAdapter"]);return n.summaryStatistics(l)})}export{H as a};
