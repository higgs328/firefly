import{b as G}from"./chunk-CJXY7S42.js";import{a as z}from"./chunk-3NS6RWJD.js";import{a as k}from"./chunk-P7MVFIZJ.js";import{a}from"./chunk-FSW536RM.js";import{b as R,c as N,d as w,f as x,g as L,h as F}from"./chunk-N7DSOI7B.js";import{c as q,g as V,h as W}from"./chunk-F4HA2HQL.js";import{a as Z}from"./chunk-CY62WWD7.js";import{b as i}from"./chunk-QAHTJVUZ.js";import{a as S,b as M}from"./chunk-T5UBLAP4.js";import{j as E,l as I,m as b}from"./chunk-DA3NC6W4.js";import{a as j}from"./chunk-FRN24G7D.js";import{a as B,d as H}from"./chunk-FGABE2LC.js";import{h as T}from"./chunk-6FZTFPIH.js";import{a as g}from"./chunk-EM2AEAFS.js";import{a as U}from"./chunk-VGAXEXH3.js";import{a as D}from"./chunk-PHMJ7KPL.js";import{a as h,f as y,h as u,j as c,o as O}from"./chunk-YEXMIDOT.js";import{a as p}from"./chunk-ONYJLWAD.js";import{b as C}from"./chunk-E2QKN2KY.js";import{a as n}from"./chunk-RWCIDBNQ.js";import{x as A}from"./chunk-HM5RIVQC.js";import{f as d}from"./chunk-PTZYZULI.js";import{a as s}from"./chunk-QGVBCWUY.js";var m=class extends M{constructor(t,e){super(t,e,new S(G,()=>import("./chunk-N3DR7DCV.js")))}_createPipeline(t,e){let{oitPass:o,output:f,transparent:J,cullFace:Y,draped:K,hasOccludees:P,polygonOffset:X,enableOffset:$}=t,tt=o===g.NONE,et=o===g.FrontFace;return b({blending:u(f)&&J?R(o):null,culling:E(Y),depthTest:K?null:{func:L(o)},depthWrite:N(t),drawBuffers:f===h.Depth?{buffers:[A.NONE]}:F(o,f),colorWrite:I,stencilWrite:P?q:null,stencilTest:P?e?W:V:null,polygonOffset:tt||et?X?rt:null:x($)})}initializePipeline(t){return this._occludeePipelineState=this._createPipeline(t,!0),this._createPipeline(t,!1)}getPipeline(t){return t?this._occludeePipelineState:super.getPipeline()}},rt={factor:1,units:1};var r=class extends Z{constructor(){super(...arguments),this.cullFace=p.None,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=B.None,this.emissionSource=j.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}};s([i({count:p.COUNT})],r.prototype,"cullFace",void 0),s([i()],r.prototype,"hasVertexColors",void 0),s([i()],r.prototype,"transparent",void 0),s([i()],r.prototype,"discardInvisibleFragments",void 0),s([i()],r.prototype,"polygonOffset",void 0),s([i()],r.prototype,"enableOffset",void 0),s([i()],r.prototype,"writeDepth",void 0),s([i()],r.prototype,"hasOccludees",void 0),s([i()],r.prototype,"terrainDepthTest",void 0),s([i()],r.prototype,"cullAboveTerrain",void 0),s([i()],r.prototype,"objectAndLayerIdColorInstanced",void 0),s([i()],r.prototype,"vvColor",void 0),s([i()],r.prototype,"draped",void 0);var Q=class extends z{constructor(t){super(t,v),this._configuration=new r,this.supportsEdges=!0,this.produces=new Map([[a.OPAQUE_MATERIAL,e=>this._isOpaqueMaterialPass(e)],[a.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>this._isOpaqueNoSSAODepthPass(e)],[a.TRANSPARENT_MATERIAL,e=>c(e)&&this._transparent&&this.parameters.writeDepth],[a.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,e=>O(e)&&this._transparent&&this.parameters.writeDepth],[a.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>c(e)&&this._transparent&&!this.parameters.writeDepth],[a.DRAPED_MATERIAL,e=>y(e)]])}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(t)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=e.hasOccludees,this._configuration.oitPass=e.oitPass,this._configuration.enableOffset=e.camera.relativeElevation<w,this._configuration.terrainDepthTest=e.terrainDepthTest&&u(t),this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=U}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(t){return this._isOpaqueMaterialPass(t)||this._isOpaqueNoSSAODepthPass(t)}_isOpaqueMaterialPass(t){return t===h.Highlight||c(t)&&!this._transparent}_isOpaqueNoSSAODepthPass(t){return O(t)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(t){return new _(t)}createBufferWriter(){let t=C().vec3f(n.POSITION);return D()&&t.vec4u8(n.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?t.f32(n.COLORFEATUREATTRIBUTE):t.vec4u8(n.COLOR),new k(t)}},_=class extends H{beginSlot(t){return this.getTechnique(m,t)}},v=class extends T{constructor(){super(...arguments),this.color=d,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=p.None,this.draped=!1,this.discardInvisibleFragments=!1}};export{Q as a};
