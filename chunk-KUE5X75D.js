import{l as F}from"./chunk-CTPO46HK.js";import{a as L}from"./chunk-M3BFYJNF.js";import{m as C,o as w}from"./chunk-FB4M3WPV.js";import{a as f,b as I,j as _}from"./chunk-TG45K3WR.js";import{a as o}from"./chunk-QGVBCWUY.js";import{H as x}from"./chunk-MYO4NP2N.js";import{e as s}from"./chunk-NFIPKH6V.js";import{l as E}from"./chunk-5QEXLALV.js";var v="esri-column",g={contentFull:`${v}__content--full`,sorter:`${v}__sorter`,headerContent:`${v}__header-content`,headerDescription:`${v}__header-description`,headerLabel:`${v}__header-label`,headerMenuIcon:`${v}__header-menu-icon`};var n=class extends x{constructor(i){super(i),this._menuIsOpen=!1,this.autoWidth=!1,this.cellValueFormatFunction=({root:e,rowData:t,value:l})=>{let{formatFunction:r}=this,a=C.sanitize(l);if(r&&t){let{index:c,item:{attachments:d,feature:m,relatedRecords:u}}=t;return r({attachments:d,column:this,feature:m,index:c,relatedRecords:u,value:a,virtualIndex:this.getVirtualRowIndex(e)})}return a},this.description=null,this.direction=null,this.fieldName=null,this.flexGrow=1,this.footerRenderFunction=null,this.formatFunction=null,this.frozen=!1,this.frozenToEnd=!1,this.grid=null,this.headerRenderFunction=e=>{let{root:t}=e,l=this.createHeaderContent();this.removeCellContent(t),t.appendChild(l)},this.hidden=!1,this.icon=null,this.iconText=null,this.initialSortPriority=null,this.label=null,this.menuConfig=null,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.renderFunction=({root:e,rowData:t})=>{let l=this.getCellValue(t),r=this.cellValueFormatFunction({root:e,rowData:t,value:l}),a=null;if(a=r instanceof HTMLElement?r:L(this.messagesURIUtils,r),this.removeCellContent(e),a instanceof HTMLElement)e.removeAttribute("title"),e.appendChild(a);else if(a!=null){let c=a.toString();e.innerHTML=c,e.title=c}},this.resizable=!0,this.sortable=!1,this.store=null,this.tableTimeZone=null,this.textAlign="start",this.textWrap=!1,this.timeZone=null,this.visibleElements=null,this.width=200}initialize(){let{fieldName:i}=this;this._set("sortElement",this.createSortElement()),this.sortElement.setAttribute("path",i),this.addHandles([f(()=>this.direction,e=>{let{sortElement:t}=this;this.sortable&&t&&(e?this.sortElement.direction!==e&&t.setAttribute("direction",e):t.removeAttribute("direction"))}),I(()=>this.grid?.isReady&&this.sortElement,()=>{let{direction:e,grid:t,hidden:l,sortElement:r}=this;l&&e&&r&&t&&!t.hasSorter(r)&&t.addSorter(r)},_),f(()=>[this.timeZone,this.icon,this.iconText],()=>this.grid?.requestContentUpdate()),f(()=>this.hidden,()=>this.closeMenu()),f(()=>this.fieldName,e=>{let{sortElement:t}=this;t&&t.path!==e&&t.setAttribute("path",e)}),f(()=>this.effectiveLabel,e=>{let{sortElement:t}=this;t&&t.textContent!==e&&(t.setAttribute("title",e),t.textContent=e)})])}get _headerRequiresTextContainer(){return!(!this.sortable&&this.effectiveLabel===""&&this.effectiveDescription==null)}get customMenuItems(){return this.menuConfig?.items?.map(({disabled:i,hidden:e,icon:t,iconClass:l,label:r,selected:a,clickFunction:c})=>this.createCalciteDropdownItem({disabled:i,hidden:e,iconClass:l,iconStart:t,selected:a,textContent:r,onclick:d=>c(d)}))??[]}get defaultMenuItems(){if(!this.sortable)return[];let i=this.messages,e=[],t=this.visibleElements?.columnMenuItems;if(t?.sortAscending!==!1){let l=this.createCalciteDropdownItem({iconStart:"sort-ascending-arrow",textContent:i?.sortAsc,onclick:()=>this.direction="asc"});e.push(l)}if(t?.sortDescending!==!1){let l=this.createCalciteDropdownItem({iconStart:"sort-descending-arrow",textContent:i?.sortDesc,onclick:()=>this.direction="desc"});e.push(l)}return e}get effectiveDescription(){let{description:i}=this;return F(i)?null:C.sanitize(i)}get effectiveLabel(){return C.sanitize(this.label||this.fieldName)}get iconNode(){let{icon:i,iconText:e}=this,t=e?C.sanitize(e):void 0;return i?this.createCalciteIcon({icon:i,textLabel:t}):null}set invalid(i){this._set("invalid",i),this.grid?.generateCellPartNames()}get invalid(){return this._get("invalid")??!1}get menu(){let{customMenuItems:i,defaultMenuItems:e,menuConfig:t}=this,l=!!t?.open,r=this.createCalciteAction({icon:t?.icon??"ellipsis",text:this.messages?.menu??"",slot:"trigger"}),a=document.createElement("calcite-dropdown");if(a.maxItems=t?.maxItems??4,a.placement="top-end",a.overlayPositioning="fixed",a.scale=t?.scale??"m",l&&(a.open=l,this._menuIsOpen=!0),a.appendChild(r),a.addEventListener("calciteDropdownOpen",()=>this._menuIsOpen=!0),a.addEventListener("calciteDropdownClose",()=>this._menuIsOpen=!1),a.onkeydown=this._stopPropagationOnSelect,a.addEventListener("mousewheel",c=>{c.stopPropagation()}),e.length){let c=a.appendChild(document.createElement("calcite-dropdown-group"));c.selectionMode="none",c.append(...e)}if(i.length){let c=a.appendChild(document.createElement("calcite-dropdown-group"));c.selectionMode=t?.selectionMode??"none",c.append(...i)}return a}get menuItems(){return[...this.defaultMenuItems,...this.customMenuItems]}get menuIsOpen(){return this._menuIsOpen}get menuIsVisible(){return!(this.visibleElements?.columnMenus===!1||!this.menuItems.length)}closeMenu(){this.menu.open=!1}createSortElement(){let{effectiveLabel:i,direction:e,fieldName:t,initialSortPriority:l}=this,r=document.createElement("vaadin-grid-sorter");return r.classList.add(g.sorter),r.setAttribute("path",t),r.setAttribute("title",i),r.textContent=i,e&&r.setAttribute("direction",e),l!=null&&(r._initialOrder=l),r.addEventListener("direction-changed",()=>{this.direction!==r.direction&&this._set("direction",r.direction)}),r}createCalciteAction(i){let e=document.createElement("calcite-action"),{alignment:t,appearance:l,className:r,disabled:a,icon:c,label:d,scale:m,slot:u,text:p,textEnabled:h,onclick:b}=i;return e.alignment=t??"center",e.appearance=l??"transparent",e.className=r??"",e.disabled=!!a,e.icon=c??"",e.label=d??"",e.scale=m??"s",e.slot=u??"",e.text=e.title=p??"",e.textEnabled=!!h,e.onclick=b??null,e}createCalciteButton(i){let e=document.createElement("calcite-button"),{alignment:t,appearance:l,className:r,disabled:a,iconEnd:c,iconFlipRtl:d,kind:m,loading:u,onclick:p,scale:h,textContent:b,title:y,width:M}=i;return e.alignment=t??"center",e.className=r??"",e.scale=h??"s",e.appearance=l??"transparent",e.disabled=!!a,e.iconEnd=c??"",d&&(e.iconFlipRtl=d),e.kind=m??"brand",e.loading=!!u,e.textContent=b??"",y&&(e.title=y),e.width=M??"auto",e.onclick=p??null,e}createCalciteDropdownItem(i){let e=document.createElement("calcite-dropdown-item"),{disabled:t,hidden:l,iconClass:r,iconStart:a,textContent:c,onclick:d,selected:m}=i,u=c??"";if(r&&!a){let p=document.createElement("span"),h=document.createElement("span");h.classList.add(g.headerMenuIcon,r),p.textContent=p.title=u,p.insertBefore(h,p.firstChild),e.appendChild(p)}else e.iconStart=a??"",e.textContent=e.title=u;return e.disabled=!!t,e.hidden=typeof l=="function"?l():!!l,e.selected=!!m,d&&(e.addEventListener("calciteDropdownItemSelect",d),e.onkeydown=this._stopPropagationOnSelect),e}createCalciteIcon(i){let{effectiveLabel:e}=this,{icon:t,scale:l,textLabel:r}=i,a=document.createElement("calcite-icon"),c=r??e;return a.icon=t,a.scale=l??"s",a.textLabel=c,a.title=c,a}createHeaderContent(){let{effectiveDescription:i,effectiveLabel:e,iconNode:t}=this,l=document.createElement("div");if(l.classList.add(g.headerContent),t&&l.appendChild(t),!this._headerRequiresTextContainer)return l;let r=l.appendChild(document.createElement("div"));return this.sortable?r.appendChild(this.sortElement):e!==""&&r.appendChild(this._createHeaderTextElement(e,g.headerLabel)),i!=null&&this.visibleElements?.columnDescriptions!==!1&&r.appendChild(this._createHeaderTextElement(i,g.headerDescription)),this.menuIsVisible&&l.appendChild(this.menu),l}getCellValue(i){return i?.item.feature.attributes?.[this.fieldName]}getVirtualRowIndex(i){let e=this.grid?.getRowContainingNode(i);return e?.parentElement?[...e.parentElement.children].indexOf(e):-1}removeCellContent(i){if(i&&i.firstChild)try{for(;i?.firstChild;)i?.removeChild(i.firstChild)}catch{}}openMenu(){this.menuIsVisible&&(this.menu.open=!0,w(this.menuItems[0]))}sort(){this.sortable&&this.sortElement?.click()}_stopPropagationOnSelect(i){i.key!=="Enter"&&i.key!==" "||i.stopPropagation()}_createHeaderTextElement(i,e){let t=document.createElement("span"),l=i??"";t.classList.add(e);let r=t.appendChild(document.createElement("span"));return r.textContent=l,r.setAttribute("title",l),t}};o([s()],n.prototype,"_headerRequiresTextContainer",null),o([s()],n.prototype,"_menuIsOpen",void 0),o([s()],n.prototype,"autoWidth",void 0),o([s()],n.prototype,"cellValueFormatFunction",void 0),o([s()],n.prototype,"customMenuItems",null),o([s()],n.prototype,"defaultMenuItems",null),o([s()],n.prototype,"description",void 0),o([s()],n.prototype,"direction",void 0),o([s()],n.prototype,"effectiveDescription",null),o([s()],n.prototype,"effectiveLabel",null),o([s({constructOnly:!0})],n.prototype,"fieldName",void 0),o([s()],n.prototype,"flexGrow",void 0),o([s()],n.prototype,"footerRenderFunction",void 0),o([s()],n.prototype,"formatFunction",void 0),o([s()],n.prototype,"frozen",void 0),o([s()],n.prototype,"frozenToEnd",void 0),o([s()],n.prototype,"grid",void 0),o([s()],n.prototype,"iconNode",null),o([s()],n.prototype,"invalid",null),o([s()],n.prototype,"headerRenderFunction",void 0),o([s()],n.prototype,"hidden",void 0),o([s()],n.prototype,"icon",void 0),o([s()],n.prototype,"iconText",void 0),o([s({constructOnly:!0})],n.prototype,"initialSortPriority",void 0),o([s()],n.prototype,"label",void 0),o([s()],n.prototype,"menu",null),o([s()],n.prototype,"menuItems",null),o([s()],n.prototype,"menuConfig",void 0),o([s()],n.prototype,"menuIsOpen",null),o([s()],n.prototype,"menuIsVisible",null),o([s()],n.prototype,"messages",void 0),o([s()],n.prototype,"messagesCommon",void 0),o([s()],n.prototype,"messagesURIUtils",void 0),o([s()],n.prototype,"renderFunction",void 0),o([s()],n.prototype,"resizable",void 0),o([s()],n.prototype,"sortable",void 0),o([s({readOnly:!0})],n.prototype,"sortElement",void 0),o([s()],n.prototype,"store",void 0),o([s()],n.prototype,"tableTimeZone",void 0),o([s()],n.prototype,"textAlign",void 0),o([s()],n.prototype,"textWrap",void 0),o([s()],n.prototype,"timeZone",void 0),o([s()],n.prototype,"visibleElements",void 0),o([s()],n.prototype,"width",void 0),n=o([E("esri.widgets.FeatureTable.Grid.Column")],n);var $=n;export{g as a,$ as b};
