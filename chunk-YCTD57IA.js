import{a as w}from"./chunk-2VMZZJFA.js";import{a as d}from"./chunk-4HILTGRJ.js";import{b as f}from"./chunk-JF73MJ44.js";import{a as g}from"./chunk-QOSJTJHZ.js";import{b as i}from"./chunk-ACP3S2CH.js";import{c as u}from"./chunk-P6QFA5MM.js";import{a as p}from"./chunk-TG2UTNEO.js";import{g as m}from"./chunk-XRGPJ3QY.js";import{f as l}from"./chunk-VTHXE323.js";function y(e,c){return l(this,null,function*(){let o;if("layers"in e){let t=f(e.allTables.concat(e.allLayers).filter(r=>r.type!=="group").toArray());e.utilityNetworks&&e.utilityNetworks.forEach(r=>{let a=f([r]);t.push(...a)}),o=t}else o=new i(e);let n=new Map;for(let t of o){let r=n.get(t.featureServiceUrl);r?r.push(t):n.set(t.featureServiceUrl,new i([t]))}let s=new i;for(let[t,r]of n){let a=new g({url:t});if(yield a.load(),!a.versionManagementServiceUrl)continue;let S=new w({url:a.versionManagementServiceUrl});s.push(new d({versionManagementService:S,versionableItems:r,usePersistentReadSessions:c}))}return s})}var v=new Map;function H(e,c=!1){return l(this,null,function*(){let o=yield y(e.map,c);return u(v,e,()=>(e.addHandles(p(()=>{v.delete(e),o.forEach(n=>n.destroy())})),o.forEach(n=>n.load().catch(s=>{m.getLogger("esri.versionManagement.VersioningState").error("Failed to load Versioning State",s)})),o))})}export{y as a,H as b};
