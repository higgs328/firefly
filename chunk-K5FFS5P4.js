import{c as F}from"./chunk-2XTO2IAR.js";import{b as R}from"./chunk-KPT44MCK.js";import{b as f}from"./chunk-YQNUGDFH.js";import{a as y}from"./chunk-QCZ3ZIGQ.js";import{a as b}from"./chunk-GJ2QRXGN.js";import{a as I}from"./chunk-6QXEFK4U.js";import{e as w}from"./chunk-5L2EJ5RT.js";import{a as c}from"./chunk-RWCIDBNQ.js";import{a as h}from"./chunk-EM35R6FY.js";import{b as T,z as g}from"./chunk-QXXXCEV5.js";import{g as A}from"./chunk-57VFBGF3.js";import{g as E}from"./chunk-PTZYZULI.js";import{B as D}from"./chunk-NJWTSROP.js";function Q(t,e,r=null){let a=[],l=e.mapPositions;d(e,a);let n=a[0][1].data,i=a[0][1].indices.length,o=w(i);return O(e,a,o),C(e,a,o),S(e,a,o),v(e,a,o),U(e,a,o),L(e,a,o),z(e,a,n),new F(t,a,l,R.Line,r)}function d(t,e){let{attributeData:{position:r},removeDuplicateStartEnd:a}=t,l=G(r)&&a,n=r.length/3-(l?1:0),i=new Array(2*(n-1)),o=l?r.slice(0,-3):r,u=0;for(let p=0;p<n-1;p++)i[u++]=p,i[u++]=p+1;e.push([c.POSITION,new f(o,i,3,l)])}function O(t,e,r){if(t.attributeData.colorFeature!=null)return;let a=t.attributeData.color;e.push([c.COLOR,new f(a??E,r,4)])}function S(t,e,r){t.attributeData.normal&&e.push([c.NORMAL,new f(t.attributeData.normal,r,3)])}function v(t,e,r){t.attributeData.colorFeature!=null&&e.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],r,1,!0)])}function C(t,e,r){t.attributeData.sizeFeature==null&&e.push([c.SIZE,new f([t.attributeData.size??1],r,1,!0)])}function U(t,e,r){t.attributeData.sizeFeature!=null&&e.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],r,1,!0)])}function L(t,e,r){t.attributeData.opacityFeature!=null&&e.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],r,1,!0)])}function z(t,e,r){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==y.Global||!t.overlayInfo.spatialReference.isGeographic)return;let a=b(r.length),l=D(t.overlayInfo.spatialReference);for(let s=0;s<a.length;s+=3)A(r,s,a,s,l);let n=r.length/3,i=I(n+1),o=M,u=N,p=0,m=0;T(o,a[m++],a[m++]),m++,i[0]=0;for(let s=1;s<n+1;++s)s===n&&(m=0),T(u,a[m++],a[m++]),m++,p+=g(o,u),i[s]=p,[o,u]=[u,o];e.push([c.DISTANCETOSTART,new f(i,e[0][1].indices,1,!0)])}function G(t){let e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}var M=h(),N=h();function X(t,e){if(t==null||t.length===0)return[];let r=[];return t.forEach(a=>{let l=a.length,n=b(3*l);a.forEach((o,u)=>{n[3*u]=o[0],n[3*u+1]=o[1],n[3*u+2]=o[2]});let i={attributeData:{position:n,normal:e},removeDuplicateStartEnd:!1};r.push(i)}),r}export{Q as a,X as b};
