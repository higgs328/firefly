import{a as A,b as D}from"./chunk-6ZXICKJ2.js";import"./chunk-AI4IPVQP.js";import"./chunk-HSKV7JWT.js";import"./chunk-JK6ANXJE.js";import"./chunk-OC2XJJQU.js";import{r as C}from"./chunk-DT6D5YZT.js";import"./chunk-CSSRRM4C.js";import"./chunk-RVXDLN3U.js";import{a as E}from"./chunk-4OC4J3KU.js";import"./chunk-L5YNB4C4.js";import"./chunk-FM2MN524.js";import"./chunk-XEJVICTW.js";import"./chunk-2JW3DUYT.js";import"./chunk-4JIR4MZV.js";import"./chunk-ZO3S2OWI.js";import"./chunk-Q5KIWWVU.js";import"./chunk-CISTQZ5X.js";import{q as V}from"./chunk-Z7TBAZRW.js";import"./chunk-NIYDRLW4.js";import"./chunk-QSQIQSC6.js";import"./chunk-AYNBEMCC.js";import"./chunk-LNYBTIG7.js";import"./chunk-7SDNM7YV.js";import"./chunk-4NUW747S.js";import"./chunk-T6WMVIUG.js";import"./chunk-JPMGMA4B.js";import"./chunk-YZJDOXQC.js";import{a as h,b as F,c as m}from"./chunk-PZOLWPGC.js";import"./chunk-F2BQ2GD6.js";import"./chunk-R3XLNYYB.js";import"./chunk-2HYVVLKS.js";import"./chunk-XRTA5GHC.js";import"./chunk-Y6XW36QP.js";import"./chunk-ZXKU6WBY.js";import"./chunk-BMYVPMAK.js";import"./chunk-EM35R6FY.js";import"./chunk-DJW5LMRG.js";import"./chunk-DEH76MSI.js";import"./chunk-ALWV3RJ2.js";import"./chunk-QXXXCEV5.js";import"./chunk-6B5XFA6F.js";import"./chunk-TJ6P6NLD.js";import"./chunk-3JGYBNJA.js";import"./chunk-GWBRHLNH.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-ZC6EBRE4.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-CELWVZPW.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-POX73EYJ.js";import"./chunk-NKUXRYJG.js";import"./chunk-EQZWYK27.js";import{b}from"./chunk-JLPLCY2B.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-O3EGNJTY.js";import"./chunk-WGAOVKGR.js";import"./chunk-G4DZJMGT.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import{a as g,c as _,j as c}from"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as n}from"./chunk-QGVBCWUY.js";import{H as S}from"./chunk-MYO4NP2N.js";import{e as o}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as w}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import{p as s,w as f}from"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{f as y}from"./chunk-VTHXE323.js";var r=class extends S{get availability(){return 1}get _snappingElevationAligner(){let{view:e}=this,{layer:t}=this.layerSource,i=e!=null&&e.type==="3d";if(!i||t.type==="subtype-group")return h();let a=(l,p)=>y(this,null,function*(){return(yield f(e.whenLayerView(t),p)).elevationAlignPointsInFeatures(l,p)});return h(i,{elevationInfo:t.elevationInfo,alignPointsInFeatures:a})}get _snappingElevationFilter(){let{view:e}=this,t=e!=null&&e.type==="3d"&&this.layerSource.layer.type!=="subtype-group";return F(t)}get _symbologySnappingFetcher(){let{view:e}=this,{layer:t}=this.layerSource;return e!=null&&e.type==="3d"&&t.type!=="subtype-group"?m(this._symbologySnappingSupported,(i,a)=>y(this,null,function*(){let l=yield e.whenLayerView(t);return s(a),l.queryForSymbologySnapping({candidates:i,spatialReference:e.spatialReference},a)})):m()}get _layerView(){let{view:e}=this;if(e==null)return null;let{layer:t}=this.layerSource;return e.allLayerViews.find(i=>i.layer===t)}get _layerView3D(){let{view:e}=this;return e==null||e.type==="2d"?null:this._layerView}get _symbologySnappingSupported(){return this._layerView3D!=null&&this._layerView3D.symbologySnappingSupported}initialize(){let{view:e}=this,{layer:t}=this.layerSource;e!=null&&e.type==="3d"&&t.type!=="subtype-group"&&this.addHandles([e.elevationProvider.on("elevation-change",({context:i})=>{let{elevationInfo:a}=t;V(i,a)&&this._snappingElevationAligner.notifyElevationSourceChange()}),g(()=>t.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),c),g(()=>this._layerView3D!=null?this._layerView3D.layer?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),c),_(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}constructor(e){super(e),this.view=null,this.updating=!1,this._memoizedMakeGetGroundElevation=E(D)}refresh(){}fetchCandidates(e,t){return y(this,null,function*(){let{layer:i}=this.layerSource,a=i.source;if(!a?.querySnapping)return[];let l=i.createQuery();this._layerView&&"effectiveDisplayFilter"in this._layerView&&(l.where=b(l.where,this._layerView.effectiveDisplayFilter?.where));let p=C(e,this.view?.type??"2d",l),I=yield a.querySnapping(p,{signal:t});s(t);let d=e.coordinateHelper.spatialReference,u=yield this._snappingElevationAligner.alignCandidates(I.candidates,d,t);s(t);let v=yield this._symbologySnappingFetcher.fetch(u,t);s(t);let G=v.length===0?u:[...u,...v],k=this._snappingElevationFilter.filter(p,G),q=this._memoizedMakeGetGroundElevation(this.view,d);return k.map(x=>A(x,q))})}};n([o({constructOnly:!0})],r.prototype,"layerSource",void 0),n([o({constructOnly:!0})],r.prototype,"view",void 0),n([o()],r.prototype,"_snappingElevationAligner",null),n([o()],r.prototype,"_snappingElevationFilter",null),n([o()],r.prototype,"_symbologySnappingFetcher",null),n([o()],r.prototype,"_layerView",null),n([o()],r.prototype,"_layerView3D",null),n([o()],r.prototype,"_symbologySnappingSupported",null),r=n([w("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],r);export{r as FeatureCollectionSnappingSource};
