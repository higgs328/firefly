import{d as ue}from"./chunk-C6DX4KYY.js";import{a as le}from"./chunk-7XYYDAZO.js";import{a as ae,b as ie,c as se}from"./chunk-WGX2RQVH.js";import{i as V}from"./chunk-4DLF223B.js";import{a as J}from"./chunk-735YNPMJ.js";import{a as x}from"./chunk-LAX5536Z.js";import{a as ne}from"./chunk-PMVHHMQJ.js";import{a as oe}from"./chunk-7B6U3N62.js";import{a as re}from"./chunk-BPWNCOXC.js";import{m as te}from"./chunk-25WBXAEY.js";import{b as $}from"./chunk-Y7GY5YIF.js";import{f as ee}from"./chunk-ZC6EBRE4.js";import{h as K}from"./chunk-RNC4P66O.js";import{a as X}from"./chunk-U4QEPZJ3.js";import{c as Z}from"./chunk-VIEK2X23.js";import{b as q}from"./chunk-X2B63YVS.js";import{b as Q}from"./chunk-YOFFGXOB.js";import{a as D,b as z,f as G}from"./chunk-VTHXE323.js";var H=class e{constructor(){this._featureLookup=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}static resetInstance(){e.instance&&(e.instance=null)}deleteFromStore(o){o.forEach(i=>{this._featureLookup.delete(i)})}readFromStoreByList(o){let i=[];return o.forEach(t=>{let s=this.readFromStoreById(t);s&&i.push(s)}),i}readFromStoreById(o){return this._featureLookup.get(o)??null}writeToStore(o,i,t){let s=[];return o.forEach(r=>{if(!r?.id)return;r.properties||(r.properties=[]);let a,n=null;if(t&&r.properties[t]&&(n=te(r.properties[t])),"originId"in r&&"destinationId"in r&&(r.properties[ie]=r.originId,r.properties[se]=r.destinationId),r.properties[i]=r.id,r.id&&this._featureLookup.has(r.id)&&this._featureLookup.get(r.id).attributes){let c=this._featureLookup.get(r.id),m=JSON.parse(JSON.stringify(Object.assign(c.attributes,r.properties)));t&&r.properties[t]&&(m[t]=ee(r.properties[t])),a=new $(n?JSON.parse(JSON.stringify(n)):c?.geometry?JSON.parse(JSON.stringify(c.geometry)):null,m,null,r.properties[i])}else a=new $(n?JSON.parse(JSON.stringify(n)):null,r.properties,null,r.properties[i]);this._featureLookup.set(`${r.typeName?`${r.typeName}__${r.id}`:r.id}`,a),s.push(a)}),s}};var W,l=null;function ke(){return W||(W=import("./chunk-MU5VGJB7.js").then(e=>e.l).then(({default:e})=>e({locateFile:o=>q(`esri/libs/linkchartlayout/${o}`)})).then(e=>{we(e)}),W)}function we(e){l=e}var ce,C,ye,T;(function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"})(ce||(ce={})),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Canceled=2]="Canceled"}(C||(C={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(ye||(ye={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(T||(T={}));var pe={none:0,"start-only":1,"start-and-end":2};function Re(e){let o=z(D({timeDirection:"right",timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:"start-and-end",showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0},e?.toJSON()??{}),{eventsTicksVisualization:e?.eventsTicksVisualization??"start-and-end"});return z(D({},o),{timeDirection:{value:T[o.timeDirection]??T.right},eventsTicksVisualization:{value:pe[o.eventsTicksVisualization]??pe["start-and-end"]}})}function v(e,o,i,t,s,r){let a=i.length,n=s.length,c=Float64Array.BYTES_PER_ELEMENT,m=Uint32Array.BYTES_PER_ELEMENT,p=Uint8Array.BYTES_PER_ELEMENT,y=16,u=y+a*(p+2*c)+n*(2*m),d=l._malloc(u);try{let f=d+y-d%y,E=f+a*c,b=E+a*c,L=b+n*m,g=L+n*m,F=()=>[l.HEAPF64.subarray(f>>3,(f>>3)+a),l.HEAPF64.subarray(E>>3,(E>>3)+a),l.HEAPU32.subarray(b>>2,(b>>2)+n),l.HEAPU32.subarray(L>>2,(L>>2)+n),l.HEAPU8.subarray(g,g+a)],[k,A,h,w,R]=F();k.set(i),A.set(t),h.set(s),w.set(r),R.set(o);let S=e(a,g,f,E,n,b,L),N=null,I=null;if(S.value===C.Success){let O=l.getLayoutLinksTypes(),B=l.getLayoutLinksVerticesEndIndices(),U=l.getLayoutLinksVertices(),j=l.countLayoutLinksVertices();!n||O&&B?j&&!U?S.value=C.Error:(N={types:new Uint8Array(l.HEAPU8.subarray(O,O+n)),vertexEndIndex:new Uint32Array(l.HEAPU32.subarray(B>>2,(B>>2)+n)),vertices:new Float64Array(l.HEAPF64.subarray(U>>3,(U>>3)+2*j))},I=l.getAuxiliaryGraphicElements()):S.value=C.Error}let[M,_,P,Ne,Ie]=F();return i.set(M),t.set(_),s.set(P),r.set(Ne),o.set(Ie),{status:S.value,links:N,graphics:I}}finally{l._free(d),l.cleanupLayout()}}var me=2,fe=1,de=-1,he,ge,Ee,be,Le,Ce,Se,Te,ve;(function(e){function o(){return l.getMinIdealEdgeLength()}function i(t,s,r,a,n,c,m=me,p=fe,y=de){return v((u,d,f,E,b,L,g)=>l.applyForceDirectedLayout(t,u,d,f,E,b,L,g,m,p,y),s,r,a,n,c)}e.getMinIdealEdgeLength=o,e.apply=i})(he||(he={})),function(e){function o(i,t,s,r,a,n,c=me,m=fe,p=de){return v((y,u,d,f,E,b,L)=>l.applyCommunityLayout(i,y,u,d,f,E,b,L,c,m,p),t,s,r,a,n)}e.apply=o}(ge||(ge={})),function(e){function o(i,t,s,r,a,n){return v((c,m,p,y,u,d,f)=>l.applySimpleLayout(i,c,m,p,y,u,d,f),t,s,r,a,n)}e.apply=o}(Ee||(Ee={})),function(e){function o(i,t,s,r,a,n){return v((c,m,p,y,u,d,f)=>l.applyHierarchicalLayout(i,c,m,p,y,u,d,f),t,s,r,a,n)}e.apply=o}(be||(be={})),function(e){function o(i,t,s,r,a,n){return v((c,m,p,y,u,d,f)=>l.applyRadialTreeLayout(i,c,m,p,y,u,d,f),t,s,r,a,n)}e.apply=o}(Le||(Le={})),function(e){function o(i,t,s,r,a,n){return v((c,m,p,y,u,d,f)=>l.applySmartTreeLayout(i,c,m,p,y,u,d,f),t,s,r,a,n)}e.apply=o}(Ce||(Ce={})),function(e){function o(i,t,s,r,a,n,c,m,p,y,u,d){return v((f,E,b,L,g,F,k)=>{if(a.length!==f)return{value:C.Error};if(n.length!==f)return{value:C.Error};if(p.length!==g)return{value:C.Error};if(y.length!==g)return{value:C.Error};let A=Float64Array.BYTES_PER_ELEMENT,h=16,w=l._malloc(h+f*A),R=l._malloc(h+f*A),S=l._malloc(h+g*A),N=l._malloc(h+g*A),I=w+h-w%h,M=R+h-R%h,_=S+h-S%h,P=N+h-N%h;try{return l.HEAPF64.subarray(I>>3,(I>>3)+f).set(a),l.HEAPF64.subarray(M>>3,(M>>3)+f).set(n),l.HEAPF64.subarray(_>>3,(_>>3)+g).set(p),l.HEAPF64.subarray(P>>3,(P>>3)+g).set(y),l.applyChronologicalLayout(i,f,E,b,L,I,M,g,F,k,_,P,u,Re(d))}finally{l._free(w),l._free(R),l._free(S),l._free(N)}},t,s,r,c,m)}e.apply=o}(Se||(Se={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Te||(Te={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(ve||(ve={}));function Ae(e,o){let i=new Map;if(o.dataModel?.relationshipTypes)for(let t of o.dataModel.relationshipTypes)t.name&&i.set(t.name,[]);for(let t of e)i.has(t.typeName)&&i.get(t.typeName)?.push(t.id);return i}function et(e,o,i){return G(this,null,function*(){let t=[],s=Ae(e,o),r={},a=[];for(let[p,y]of s){if(y.length<1)continue;let u=`${p}_ids`;r[u]=y,a.push(`MATCH (n)-[r:${p}]->(m) WHERE id(r) in $${u} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(a.length===0)return[];let n=a.join(" UNION "),c=new J({openCypherQuery:n,bindParameters:r}),m=(yield V(o,c,i?.requestOptions)).resultRowsStream.getReader();for(;;){let{done:p,value:y}=yield m.read();if(p)break;for(let u of y)t.push({id:u[0],typeName:u[1]}),t.push({id:u[2],typeName:u[3]})}return t})}function tt(e,o,i){return G(this,null,function*(){let t=new Map,s=Ae(e,o),r={},a=[];for(let[p,y]of s){if(y.length<1)continue;let u=`${p}_ids`;r[u]=y,a.push(`MATCH (n)-[r:${p}]->(m) WHERE id(r) in $${u} RETURN id(r), id(n), id(m)`)}if(a.length===0)return t;let n=a.join(" UNION "),c=new J({openCypherQuery:n,bindParameters:r}),m=(yield V(o,c,i?.requestOptions)).resultRowsStream.getReader();for(;;){let{done:p,value:y}=yield m.read();if(p)break;for(let u of y)t.set(u[0],[u[1],u[2]])}return t})}var Y="ESRI__ChronologicalLayoutOverlay",rt=()=>Y,ot=e=>{let o=[],i={type:"CIMGeometricEffectCut",beginCut:3,endCut:3};for(let t of e.chronologicalAuxiliaryGraphics?.lines??[]){let s={type:"CIMSolidStroke",enable:!0,width:t.width,color:[t.color.r,t.color.g,t.color.b,Math.round(t.color.a/100*255)],effects:t.dashPattern.length>0?[{type:"CIMGeometricEffectDashes",dashTemplate:t.dashPattern,lineDashEnding:"NoConstraint"},i]:[i]},r={type:"CIMVectorMarker",enable:!0,size:10,frame:{xmin:-5,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[-2.06,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[t.color.r,t.color.g,t.color.b,Math.round(t.color.a/100*255)]}]}}],markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineEnd",offsetAlongLine:0}},a=new ne({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:t.arrowheadSizeAtEnd?[s,r]:[s]}}});for(let n of t.elements){let c=new X({paths:[[[n.origin.x,n.origin.y],[n.destination.x,n.destination.y]]]});o.push(new x({geometry:c,symbol:a}))}}for(let t of e.chronologicalAuxiliaryGraphics?.polygons??[]){let s=new re({color:[t.color.r,t.color.g,t.color.b,t.color.a/100],style:"solid",outline:null});for(let r of t.elements){let a=new K({rings:[r.points.map(n=>[n.x,n.y])]});o.push(new x({geometry:a,symbol:s}))}}for(let t of e.chronologicalAuxiliaryGraphics?.texts??[]){let s="middle",r="center";switch(t.direction?.value){case T.left:r="right";break;case T.right:r="left";break;case T.bottom:s="bottom"}for(let a of t.elements){let n=new oe({color:[t.color.r,t.color.g,t.color.b,t.color.a/100],text:a.str,font:{size:t.height,weight:"bold"},verticalAlignment:s,horizontalAlignment:r}),c=new Z({x:a.anchor.x,y:a.anchor.y});o.push(new x({geometry:c,symbol:n}))}}return new le({graphics:o,listMode:"hide",title:Y,id:Y})},nt=(e,o)=>{let i=new Map;for(let s of[...o.entityTypes??[],...o.relationshipTypes??[]])for(let r of s.properties??[])r.geometryType&&r.geometryType!=="esriGeometryNull"&&i.set(s.name,r.name??"");let t=H.getInstance();for(let s of e)t.writeToStore([s],ae,i.get(s.typeName??"")??"")},at=e=>ue.get(e)??"radial-root-centric";function it(e){if(!e.spatialReference.isWGS84)throw new Q("knowledge-graph:layer-support-utils","The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(o=>[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]])}export{H as a,ke as b,ce as c,C as d,ye as e,he as f,ge as g,Ee as h,be as i,Le as j,Ce as k,Se as l,et as m,tt as n,rt as o,ot as p,nt as q,at as r,it as s};
