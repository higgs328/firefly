import{a as c}from"./chunk-C6JPAW54.js";import{a as I}from"./chunk-WWVPA6PE.js";import{f as g}from"./chunk-CCJU4DSH.js";import{a as o}from"./chunk-QGVBCWUY.js";import{e as l}from"./chunk-NFIPKH6V.js";import{l as w}from"./chunk-5QEXLALV.js";import{b as m}from"./chunk-YOFFGXOB.js";import{f as d}from"./chunk-VTHXE323.js";var y,r=y=class extends g{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){let t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){let t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){let t=this.portal?.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){let e=t&&t.item,s=t?.data,i=t?.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),s!=null&&(typeof s=="string"?n.query.text=s:typeof s=="object"&&(n.query.text=JSON.stringify(s))));let u=this.userContentUrl;return i&&(u+="/"+(typeof i=="string"?i:i.id)),this.portal.request(u+"/addItem",n).then(a=>(e.id=a.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}deleteItem(t,e=!1){return d(this,null,function*(){let s=this.userContentUrl;t.ownerFolder&&(s+="/"+t.ownerFolder);let i=e?{permanentDelete:!0}:{};yield this.portal.request(s+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null})}deleteItems(t,e=!1){return d(this,null,function*(){t=t.slice();let s=this.userContentUrl+"/deleteItems",i=[],n=t.map(u=>u.id);if(n.length){let u={method:"post",query:{items:n.join(","),permanentDelete:e}},a=yield this.portal.request(s,u);for(let p of a.results){let h=t.find(U=>p.itemId===U.id),f=p.success,v=null;f?(h.id=null,h.portal=null):p.error&&(v=new m("portal:delete-item-failed",p.error.message,p.error)),i.push({item:h,success:f,error:v})}}return i})}fetchFolders(){let t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let s;return s=e&&e.folders?e.folders.map(i=>{let n=I.fromJSON(i);return n.portal=this.portal,n}):[],s})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(s=>{let i=c.fromJSON(s);return i.portal=this.portal,i}):[],e})}fetchItems(t){return d(this,null,function*(){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);let{default:s}=yield import("./chunk-VBKMN4RI.js"),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},n=yield this.portal.request(e,{query:i}),u;return n?.items?(u=n.items.map(a=>{let p=s.fromJSON(a);return p.portal=this.portal,p}),yield Promise.all(u.map(a=>a.load())),{items:u,nextStart:n.nextStart,total:n.total}):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new c({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new m("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}restoreItem(t,e){return d(this,null,function*(){let s=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;yield this.portal.request(s+`/items/${t.id}/restore`,{method:"post",query:i})})}toJSON(){throw new m("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");let e=new y({sourceJSON:t});return e.read(t),e}};o([l()],r.prototype,"access",void 0),o([l({type:Date})],r.prototype,"created",void 0),o([l()],r.prototype,"culture",void 0),o([l()],r.prototype,"description",void 0),o([l()],r.prototype,"email",void 0),o([l()],r.prototype,"favGroupId",void 0),o([l()],r.prototype,"fullName",void 0),o([l({type:Date})],r.prototype,"modified",void 0),o([l()],r.prototype,"orgId",void 0),o([l()],r.prototype,"portal",void 0),o([l()],r.prototype,"preferredView",void 0),o([l()],r.prototype,"privileges",void 0),o([l()],r.prototype,"region",void 0),o([l()],r.prototype,"role",void 0),o([l()],r.prototype,"roleId",void 0),o([l()],r.prototype,"sourceJSON",void 0),o([l()],r.prototype,"thumbnail",void 0),o([l({readOnly:!0})],r.prototype,"thumbnailUrl",null),o([l()],r.prototype,"units",void 0),o([l({readOnly:!0})],r.prototype,"userContentUrl",null),o([l({readOnly:!0})],r.prototype,"url",null),o([l()],r.prototype,"username",void 0),o([l()],r.prototype,"userLicenseTypeId",void 0),o([l()],r.prototype,"userType",void 0),r=y=o([w("esri.portal.PortalUser")],r);var F=r;export{F as a};
