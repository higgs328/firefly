import{b as u}from"./chunk-YOFFGXOB.js";import{f}from"./chunk-VTHXE323.js";function m(e,i){return f(this,null,function*(){let{layer:t,view:a,forBinning:n,filter:r}=e;if(!t||!a)throw new u(`${i}:missing-parameters`,"'layer' and 'view' parameters are required");yield t.load();let s="featureReduction"in t?t.featureReduction:null;if(n){if(s?.type!=="binning")throw new u(`${i}:invalid-parameters`,"'layer' must have 'featureReduction' property defined with 'binning' type when 'forBinning' parameter is true");if(r)throw new u(`${i}:invalid-parameters`,"'filter' parameter is not supported when 'forBinning' parameter is true")}return e})}function h(e){return f(this,null,function*(){let{layer:i,forBinning:t,renderer:a}=e;yield i.load();let n="featureReduction"in i?i.featureReduction:null,r=a?.clone()??(t&&n?.type==="binning"?n?.renderer?.clone():"renderer"in i?i.renderer?.clone():null);if(!r)throw new u("get-renderer-to-update:invalid-parameters","renderer not available");return r})}function l(e,i,t){return e?.authoringInfo?.visualVariables?.find(n=>t==="reference-size"?n.type===i&&n.theme==="reference-size":n.type===i)}function v(e){if(!e)return null;let i=e.type,t="visualVariables"in e?e.visualVariables:null,a=t?.find(p),n=t?.find(d),r=e.authoringInfo,s=l(e,"color"),c=l(e,"size"),o=l(e,"size","reference-size");if(i==="class-breaks"){if(r?.type==="univariate-color-size")return"univariate-color-size";if(a)return n?c?.units?"color-size-age":s?.units?"color-age-size":"color-size":s?.units?"color-age":o?"color-size":"color-continuous";if(n)return c?.units?"size-age":"size-continuous";if(e.classBreakInfos.length>1)return r?.type==="class-breaks-color"?"color-class-breaks":r?.type==="class-breaks-size"?"size-class-breaks":null;if(o)return"size-continuous"}return i==="unique-value"?e.valueExpression?r?.type==="predominance"?"predominance":r?.type==="relationship"?n||o?"relationship-size":"relationship":n||o?"type-size":"type":n?c?.units?"type-size-age":"type-size":o?"type-size":"type":i==="pie-chart"?"pie-chart":i==="dot-density"?"dot-density":null}function b(e){return!!e.visualVariables?.some(y)}function S(e){return!!e.visualVariables?.some(V)}function w(e){return e?.findIndex(y)??-1}function x(e){return e?.findIndex(d)??-1}function I(e){return e?.findIndex(p)??-1}function A(e){return e?.findIndex(z)??-1}function R(e){return e?.findIndex(V)??-1}function p(e){return e.type==="color"}function z(e){return e.type==="opacity"}function d(e){return e.type==="size"&&e.target!=="outline"&&e.valueExpression!=="$view.scale"}function y(e){return e.type==="size"&&e.target==="outline"}function V(e){return e.type==="size"&&e.valueExpression==="$view.scale"&&e.target!=="outline"&&Array.isArray(e.stops)}function k(e,i,t){let a=e.visualVariables,n=t(a);if(!i||Array.isArray(i)&&!i.length)return;Array.isArray(i)||(i=[i]);let r=i.map(s=>s.clone());a?n>-1?a.splice(n,1,...r):a.push(...r):e.visualVariables=r}function B(e,i,t){let a=i?.visualVariables.find(r=>r.type===t),n=l(e,t);n&&a&&(n.minSliderValue=a.minSliderValue,n.maxSliderValue=a.maxSliderValue,t==="size"&&n.theme==="reference-size"&&(n.sizeStops=a.sizeStops?.map(r=>r.clone()),n.referenceSizeScale=a.referenceSizeScale))}export{m as a,h as b,l as c,v as d,b as e,S as f,w as g,x as h,I as i,A as j,R as k,p as l,d as m,k as n,B as o};
