import{a as n}from"./chunk-M6A73MNY.js";import{f as y}from"./chunk-ZEWUF6OQ.js";import{a as m,j as u}from"./chunk-TG45K3WR.js";import{b}from"./chunk-ACP3S2CH.js";import{a as c}from"./chunk-T7DXJKX7.js";import{a as l}from"./chunk-QGVBCWUY.js";import{e as o}from"./chunk-NFIPKH6V.js";import{l as p}from"./chunk-5QEXLALV.js";var h={map:"map",layerListMode:"layer-list-mode"},f="hide",I=b.ofType(n),i=class extends c.EventedAccessor{constructor(t){super(t),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.tableItems=new I,this.map=null}initialize(){this.addHandles([m(()=>[this.tables,this.map?.allTables.toArray()],()=>this._compileList(),u),m(()=>[this.map?.loaded,this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList())],h.map)}destroy(){this._removeAllItems(),this.map=null,this.tables=null}get tables(){return this.map?.allTables}set tables(t){this._overrideIfSome("tables",t)}get state(){let{map:t,tables:e}=this;if(!t)return e?"ready":"disabled";let s=t?.loadStatus;return typeof s=="string"?s==="loaded"?"ready":s==="loading"?"loading":"disabled":"ready"}get totalItems(){return this.tableItems.length}triggerAction(t,e){t&&!t.disabled&&this.emit("trigger-action",{action:t,item:e})}_removeAllItems(){this.tableItems.destroyAll()}_getViewableTables(t){return t?this.listModeDisabled?t:t.filter(e=>y(e)!==f):void 0}_watchTablesListMode(t){this.removeHandles(h.layerListMode),t&&!this.listModeDisabled&&this.addHandles(m(()=>t.filter(e=>"listMode"in e).map(e=>e.listMode).toArray(),()=>this._compileList()),h.layerListMode)}_compileList(){let{tables:t}=this;this._watchTablesListMode(t);let e=this._getViewableTables(t);e?.length?(this._createNewItems(e),this._removeItems(e),this._sortItems(e)):this._removeAllItems()}_createNewItems(t){let{tableItems:e,listItemCreatedFunction:s,checkPublishStatusEnabled:r}=this;t.forEach(a=>{e.some(d=>d.layer===a)||e.add(new n({checkPublishStatusEnabled:r,layer:a,listItemCreatedFunction:s}))})}_removeItems(t){let{tableItems:e}=this;e.forEach(s=>{if(!s)return;t?.find(a=>s.layer===a)||(e.remove(s),s.destroy())})}_sortItems(t){let{tableItems:e}=this;e.sort((s,r)=>{let a=t.indexOf(s.layer),d=t.indexOf(r.layer);return a>d?-1:a<d?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}};l([o()],i.prototype,"checkPublishStatusEnabled",void 0),l([o()],i.prototype,"listItemCreatedFunction",void 0),l([o({nonNullable:!0})],i.prototype,"listModeDisabled",void 0),l([o({type:I,readOnly:!0})],i.prototype,"tableItems",void 0),l([o()],i.prototype,"tables",null),l([o()],i.prototype,"map",void 0),l([o({readOnly:!0})],i.prototype,"state",null),l([o()],i.prototype,"totalItems",null),i=l([p("esri.widgets.TableList.TableListViewModel")],i);var C=i;export{C as a};
