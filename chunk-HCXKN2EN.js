import{c as $}from"./chunk-Z2LJUUE7.js";import{b as X}from"./chunk-THFX26II.js";import{a as Y}from"./chunk-3NS6RWJD.js";import{a as J}from"./chunk-P7MVFIZJ.js";import{a as m}from"./chunk-FSW536RM.js";import{j as Q,r as Z}from"./chunk-VN5FPMRB.js";import{a as L,c as N,d as B,f as V,g as W,h as q}from"./chunk-N7DSOI7B.js";import{c as U,g as k,h as j}from"./chunk-F4HA2HQL.js";import{a as K}from"./chunk-CY62WWD7.js";import{b as s}from"./chunk-QAHTJVUZ.js";import{a as S,b as F}from"./chunk-T5UBLAP4.js";import{f as w,j as M,l as y,m as C}from"./chunk-DA3NC6W4.js";import{a as G}from"./chunk-FRN24G7D.js";import{a as H,e as z}from"./chunk-FGABE2LC.js";import{k as R}from"./chunk-J5AEP4US.js";import{a as O}from"./chunk-EM2AEAFS.js";import{e as I,g as d,h as b}from"./chunk-YEXMIDOT.js";import{a as u}from"./chunk-ONYJLWAD.js";import{a as x}from"./chunk-PDQQY7RQ.js";import{a as n}from"./chunk-RWCIDBNQ.js";import{a as _}from"./chunk-2ZFXOJDB.js";import{a as i}from"./chunk-QGVBCWUY.js";import{a as P}from"./chunk-VTHXE323.js";var g=class extends F{constructor(e,t){super(e,t,new S($,()=>import("./chunk-V5W2Y6RX.js")),A)}_getPipelineState(e,t){let{oitPass:o,output:T,hasOccludees:c,enableOffset:h,cullFace:l}=e,a=o===O.NONE,f=o===O.FrontFace;return C({blending:b(T)?a?w:L(o):null,culling:M(l),depthTest:{func:W(o)},depthWrite:N(e),drawBuffers:q(o,T),colorWrite:y,stencilWrite:c?U:null,stencilTest:c?t?j:k:null,polygonOffset:a||f?null:V(h)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}},A=new Map([[n.POSITION,0],[n.UV0,2],[n.PERSPECTIVEDIVIDE,3]]);var r=class extends K{constructor(){super(...arguments),this.cullFace=u.None,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=H.None,this.emissionSource=G.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}};i([s({count:u.COUNT})],r.prototype,"cullFace",void 0),i([s()],r.prototype,"enableOffset",void 0),i([s()],r.prototype,"writeDepth",void 0),i([s()],r.prototype,"hasOccludees",void 0),i([s()],r.prototype,"terrainDepthTest",void 0),i([s()],r.prototype,"cullAboveTerrain",void 0),i([s()],r.prototype,"perspectiveInterpolation",void 0);var ee=class extends Y{constructor(e){super(e,E),this._configuration=new r,this.vertexAttributeLocations=A,this.supportsEdges=!0,this.produces=new Map([[m.OPAQUE_MATERIAL,t=>I(t)],[m.TRANSPARENT_MATERIAL,t=>d(t)&&this.parameters.writeDepth],[m.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>d(t)&&!this.parameters.writeDepth],[m.DRAPED_MATERIAL,t=>d(t)||I(t)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<B,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(e){return new D(e)}createBufferWriter(){let e=X.clone();return this.parameters.perspectiveInterpolation&&e.f32(n.PERSPECTIVEDIVIDE),new v(e)}},D=class extends z{constructor(e){super(P(P({},e),e.material.parameters))}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.getTechnique(g,e)}},v=class extends J{write(e,t,o,T,c,h){for(let l of this.vertexBufferLayout.fields.keys()){let a=o.get(l);if(a)if(l===n.PERSPECTIVEDIVIDE){x(a.size===1);let f=c.getField(l,_);f&&Q(a,f,h)}else Z(l,a,e,t,c,h)}}},E=class extends R{constructor(e){super(),this.textureId=e,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=u.None,this.opacity=1,this.perspectiveInterpolation=!1}};export{ee as a};
