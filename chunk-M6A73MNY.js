import{a as u}from"./chunk-5X33F26B.js";import{f as y,i as I,l as S}from"./chunk-ZEWUF6OQ.js";import{a as P}from"./chunk-ZTR6OS44.js";import{a as g}from"./chunk-VRTKAD2J.js";import{a as M}from"./chunk-DBLKLHK2.js";import{a as v}from"./chunk-K75TK42V.js";import{a as _}from"./chunk-G4DZJMGT.js";import{a as o,j as a}from"./chunk-TG45K3WR.js";import{b as n}from"./chunk-ACP3S2CH.js";import{a as s}from"./chunk-QGVBCWUY.js";import{H as C}from"./chunk-MYO4NP2N.js";import{b as c,e as l}from"./chunk-NFIPKH6V.js";import{l as f}from"./chunk-5QEXLALV.js";import{y as b}from"./chunk-QBWJMFH5.js";var h,m="layer",p="child-list-mode",O="hide",E=n.ofType({key:"type",defaultKeyValue:"button",base:M,typeMap:{button:P,toggle:g}}),L=n.ofType(E),i=h=class extends v.IdentifiableMixin(C){constructor(e){super(e),this.actionsSections=new L,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(n.ofType(h)),this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0}initialize(){if(this.addHandles([o(()=>[this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),a),o(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),a),o(()=>this.panel,e=>this._setListItemOnPanel(e),a)]),typeof this.listItemCreatedFunction=="function"){let e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll()}get error(){return this.layer?.loadError}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new u(e):null}get publishing(){let{layer:e,checkPublishStatusEnabled:t}=this;return(t&&e&&"publishingInfo"in e&&e.publishingInfo?.status==="publishing")??!1}get title(){let e=c(this,"layer.layer");return(!e||e&&c(this,"layer.layer.loaded")?this.layer?.title:null)??""}set title(e){this._overrideIfSome("title",e)}clone(){return new h({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title})}_updateChildrenPublishing(e){this.children?.forEach(t=>t.checkPublishStatusEnabled=e)}_setListItemOnPanel(e){e&&(e.listItem=this)}_createChildItems(e,t){return e.reverse().map(r=>t||S(r)?new h({layer:r,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this}):null).filter(b)}_createChildren(e){let{listModeDisabled:t,children:r}=this,d=e.reverse().filter(w=>!r.some(D=>D.layer===w));r.addMany(this._createChildItems(d,t))}_destroyChildren(e){let{children:t}=this,r=t.filter(d=>!!d.layer&&!e.includes(d.layer));t.destroyMany(r)}_sortChildren(e){this.children.sort((t,r)=>e.indexOf(r.layer)-e.indexOf(t.layer))}_destroyAllChildren(){this.removeHandles(p),this.children.destroyAll()}_compileChildren(e){let t=this.listModeDisabled?e:e?.filter(r=>y(r)!==O);e?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchChildLayerListMode(e){this.removeHandles(p),this.listModeDisabled||this.addHandles(e.toArray().map(t=>o(()=>t.listMode,()=>this._compileChildren(e))),p)}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",()=>this._compileChildren(e)),m)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_watchLayerProperties(e){if(this.removeHandles(m),this.removeHandles(p),!e)return;if(e.load(),(!this.listModeDisabled&&y(e))==="hide-children")return void this.children.destroyAll();let t=I(e);t&&this.addHandles(o(()=>e[t],r=>{e.hasOwnProperty(t)&&this._initializeChildLayers(r)},a),m)}};s([l({type:L})],i.prototype,"actionsSections",void 0),s([l()],i.prototype,"actionsOpen",void 0),s([l()],i.prototype,"checkPublishStatusEnabled",void 0),s([l({type:n.ofType(i)})],i.prototype,"children",void 0),s([l({readOnly:!0})],i.prototype,"error",null),s([l()],i.prototype,"hidden",void 0),s([l()],i.prototype,"layer",void 0),s([l()],i.prototype,"listItemCreatedFunction",void 0),s([l({nonNullable:!0})],i.prototype,"listModeDisabled",void 0),s([l()],i.prototype,"open",void 0),s([l({type:u})],i.prototype,"panel",void 0),s([_("panel")],i.prototype,"castPanel",null),s([l()],i.prototype,"parent",void 0),s([l({readOnly:!0})],i.prototype,"publishing",null),s([l()],i.prototype,"sortable",void 0),s([l()],i.prototype,"title",null),i=h=s([f("esri.widgets.TableList.ListItem")],i);var R=i;export{R as a};
