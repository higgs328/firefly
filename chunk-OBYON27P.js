import{a as ki}from"./chunk-E7FZSPTU.js";import{a as Ei}from"./chunk-Y5VMZN2I.js";import"./chunk-AKDISSFR.js";import{a as Ue}from"./chunk-G2BAKCGQ.js";import"./chunk-PVFH4TIQ.js";import"./chunk-HSKV7JWT.js";import"./chunk-JK6ANXJE.js";import{a as Li}from"./chunk-FAVOTTTZ.js";import{a as zi}from"./chunk-GHRDCMSY.js";import{b as Ri}from"./chunk-GPTDVBAY.js";import"./chunk-Q3T7LRXL.js";import"./chunk-DYNR3EAF.js";import"./chunk-W3TWKYGN.js";import"./chunk-72TNJFVF.js";import"./chunk-OC2XJJQU.js";import"./chunk-2XCEJBGD.js";import"./chunk-UZ6PRO67.js";import{a as Ti}from"./chunk-JTMZG4LS.js";import{a as xi}from"./chunk-AMX6AASB.js";import{t as Hi}from"./chunk-DT6D5YZT.js";import"./chunk-CSSRRM4C.js";import"./chunk-RVXDLN3U.js";import{a as Ai}from"./chunk-4OC4J3KU.js";import{a as Oi}from"./chunk-DOB47SIN.js";import"./chunk-I3XN2LJZ.js";import{a as bi}from"./chunk-CESHMSBL.js";import"./chunk-L5YNB4C4.js";import"./chunk-CJL3HAFX.js";import"./chunk-S3MATJKX.js";import"./chunk-NWJCHWGR.js";import"./chunk-FM2MN524.js";import"./chunk-XEJVICTW.js";import"./chunk-ESAKNWVF.js";import{a as wi}from"./chunk-4QVX2DIK.js";import{a as Fe}from"./chunk-HCXKN2EN.js";import"./chunk-Z2LJUUE7.js";import"./chunk-VS266ZEX.js";import{a as _t}from"./chunk-2JW3DUYT.js";import{a as Di}from"./chunk-5MQCBXNU.js";import{a as yt,i as Ie,j as Ci}from"./chunk-DFZB6AM2.js";import"./chunk-ZNIU6XIO.js";import"./chunk-GEYV2JMR.js";import"./chunk-IGGGB3TP.js";import"./chunk-JDU4SWWX.js";import"./chunk-HMOFKUIJ.js";import"./chunk-C5TDOKQP.js";import"./chunk-QGGZ7JI7.js";import"./chunk-EMILT3E5.js";import"./chunk-5KY2RG7F.js";import"./chunk-XQ4DD6H6.js";import"./chunk-E3FPV7ZA.js";import"./chunk-IQA3CVAZ.js";import"./chunk-2DH3L3DZ.js";import"./chunk-GPMOZK2F.js";import"./chunk-JHVSXE55.js";import"./chunk-XOJOMNES.js";import"./chunk-TTZ4CWZW.js";import"./chunk-EB24NRSQ.js";import"./chunk-4JIR4MZV.js";import"./chunk-ZO3S2OWI.js";import{a as Si,b as Mi,c as Pi}from"./chunk-IJETEJ35.js";import{a as yi}from"./chunk-QC7YKF4H.js";import{a as Me,d as fi,f as Pe,g as gt,h as gi,i as Ve,l as F}from"./chunk-RGD6ZU25.js";import"./chunk-NRFDPN3W.js";import{a as de,f as Ge,l as _i}from"./chunk-XGBN53IG.js";import"./chunk-KVIHP5QH.js";import{b as B,c as ft}from"./chunk-62UTK67Z.js";import{b as vi}from"./chunk-63BBKXWS.js";import"./chunk-SLOUGIU5.js";import"./chunk-RK73WDNW.js";import"./chunk-C24MSACP.js";import"./chunk-Y533SYIC.js";import"./chunk-SCVJO5X3.js";import"./chunk-AIPTYQTX.js";import"./chunk-INIILA7E.js";import"./chunk-YLC7GOFS.js";import"./chunk-KCIAXQ4S.js";import"./chunk-BONXCVQE.js";import"./chunk-DKDKCWEH.js";import"./chunk-PI27WDVR.js";import"./chunk-IXA5GG5W.js";import"./chunk-PIIZWXGF.js";import"./chunk-N3W77OHB.js";import"./chunk-CJXY7S42.js";import"./chunk-THFX26II.js";import{a as mi,c as j}from"./chunk-KU6G3BN4.js";import"./chunk-BNJVBYV4.js";import{d as ti,i as ii}from"./chunk-NPMJUDJ7.js";import"./chunk-NYVDVEEV.js";import"./chunk-KWYU7DMC.js";import{c as Ee}from"./chunk-M6JND3B6.js";import{a as li}from"./chunk-WSDIUTRN.js";import{a as Xt}from"./chunk-UF3HHTD3.js";import"./chunk-6OWZRPJO.js";import{e as ht}from"./chunk-67GIWMYL.js";import{a as pe}from"./chunk-HOMK53AL.js";import{a as oi,c as si,l as ri}from"./chunk-2BJHWKO6.js";import"./chunk-Q5KIWWVU.js";import{a as ei}from"./chunk-3Y3IWJBE.js";import{a as ni,b as ai,c as Z}from"./chunk-IHEDDQC4.js";import{a as pi}from"./chunk-W3HCXOXG.js";import"./chunk-AN3DAG6F.js";import{a as di,b as ci}from"./chunk-K5FFS5P4.js";import"./chunk-3NS6RWJD.js";import{d as K}from"./chunk-6ZTUPVYX.js";import"./chunk-5DVGZXEZ.js";import"./chunk-2I3LIA7G.js";import"./chunk-QIO7OVOF.js";import"./chunk-J3QLC2LP.js";import"./chunk-VBFF4VHB.js";import"./chunk-Q2IUY7EW.js";import"./chunk-6HINJY73.js";import{a as Jt,b as Qt}from"./chunk-FLXA3YE2.js";import"./chunk-WQKVID54.js";import{b as ui,g as hi}from"./chunk-DBCWR6HP.js";import"./chunk-CISTQZ5X.js";import"./chunk-NOHUHVCW.js";import{a as g,b as $t,c as Yt}from"./chunk-3YMDPTQW.js";import{d as ke}from"./chunk-H2NTHPNN.js";import"./chunk-Z7TBAZRW.js";import"./chunk-5H7NDIGP.js";import"./chunk-ZYYN4NWF.js";import"./chunk-MRKUOXYW.js";import{d as X}from"./chunk-CL7L227X.js";import"./chunk-2GLWK7ZW.js";import{d as Zt,n as me}from"./chunk-QXSQOLB3.js";import"./chunk-BKWQOCBC.js";import"./chunk-XACQ2RJ5.js";import"./chunk-LCFWGHLF.js";import"./chunk-CX3G2QWN.js";import"./chunk-YTAJKLRN.js";import"./chunk-D6N4VI5S.js";import"./chunk-3ZJ4NMBE.js";import"./chunk-4S7THJAS.js";import{c as Kt}from"./chunk-2XTO2IAR.js";import"./chunk-CQVHC5U2.js";import"./chunk-P7MVFIZJ.js";import"./chunk-FSW536RM.js";import"./chunk-VN5FPMRB.js";import"./chunk-N7DSOI7B.js";import"./chunk-F4HA2HQL.js";import"./chunk-DQZHSTUF.js";import"./chunk-CY62WWD7.js";import"./chunk-VDNRZCIE.js";import"./chunk-I2JD5OSI.js";import"./chunk-2MROBW6T.js";import"./chunk-QAHTJVUZ.js";import"./chunk-XE4T4457.js";import"./chunk-BWHHYBB5.js";import"./chunk-XWEUR6F7.js";import"./chunk-PSNQ2KG3.js";import"./chunk-MPI26GZ3.js";import"./chunk-5252J253.js";import"./chunk-7WCQBAQY.js";import"./chunk-VQSLKKYN.js";import"./chunk-JBAMJB5J.js";import"./chunk-VAOSSSLB.js";import"./chunk-AMISFAT3.js";import"./chunk-CUV3BSEW.js";import"./chunk-3ZJU5D2H.js";import"./chunk-2UHZH5L3.js";import"./chunk-DQINVX66.js";import"./chunk-CSFAHB4Y.js";import"./chunk-T5UBLAP4.js";import"./chunk-PTXLSCMJ.js";import"./chunk-DA3NC6W4.js";import"./chunk-6L543SC5.js";import"./chunk-FRN24G7D.js";import"./chunk-FGABE2LC.js";import"./chunk-CU7FHMWW.js";import"./chunk-CZMBPC27.js";import"./chunk-VANM5A4M.js";import"./chunk-VSD74FMI.js";import"./chunk-KALTBP5D.js";import"./chunk-O2J7LFYY.js";import"./chunk-BIU7ZFAB.js";import"./chunk-6FZTFPIH.js";import{j as D}from"./chunk-J5AEP4US.js";import"./chunk-YHRLMRSO.js";import"./chunk-KPT44MCK.js";import"./chunk-XKFJ6GWH.js";import"./chunk-SFANISLX.js";import"./chunk-UJ7KVQR6.js";import"./chunk-GSXOR3JU.js";import"./chunk-55OTJIMU.js";import"./chunk-EM2AEAFS.js";import"./chunk-YEPHAEAY.js";import"./chunk-TK4PPGQL.js";import"./chunk-ELCBU4NP.js";import"./chunk-GMZFCQJQ.js";import"./chunk-5WDH2LXO.js";import"./chunk-L7NOU4T2.js";import"./chunk-VGAXEXH3.js";import"./chunk-HMNTGQTR.js";import"./chunk-ZLIWNUFM.js";import"./chunk-GVSOJUIP.js";import"./chunk-GWSX6PRO.js";import"./chunk-G2JMPZCN.js";import"./chunk-IRQF7UTO.js";import"./chunk-3KOZOOEP.js";import"./chunk-EG2DTURK.js";import"./chunk-YVCKQBWT.js";import"./chunk-WOZSH7YY.js";import"./chunk-2PJRHNJW.js";import"./chunk-B2RVSTL3.js";import"./chunk-4XEE5PE3.js";import"./chunk-2CKJLDTO.js";import"./chunk-F6TN7E7K.js";import"./chunk-4LDVFWME.js";import"./chunk-HUUJBVXR.js";import"./chunk-7G56KLCZ.js";import"./chunk-L56OBJFS.js";import"./chunk-7HMNN4FJ.js";import"./chunk-UKAGN54W.js";import"./chunk-342NGUMP.js";import{a as qt}from"./chunk-NIYDRLW4.js";import"./chunk-PHMJ7KPL.js";import"./chunk-ESSDCWGF.js";import"./chunk-WVKBXQWE.js";import"./chunk-FSWSNKJD.js";import"./chunk-FGEB67EG.js";import"./chunk-YEXMIDOT.js";import"./chunk-T7PUQGWM.js";import"./chunk-GV3ZFCVD.js";import"./chunk-SOEEM7Z7.js";import"./chunk-MVDZB4AK.js";import"./chunk-44A27HB7.js";import"./chunk-47NSYSFY.js";import"./chunk-QXNVQZT7.js";import"./chunk-QSQIQSC6.js";import"./chunk-AYNBEMCC.js";import"./chunk-LNYBTIG7.js";import"./chunk-3WNFY6Z5.js";import"./chunk-VYZHOYXV.js";import"./chunk-ECA5I2I7.js";import"./chunk-XAHD7XBV.js";import"./chunk-Y7XRSFOZ.js";import{b as ut}from"./chunk-YQNUGDFH.js";import"./chunk-QCZ3ZIGQ.js";import{A as ct,e as ze,j as Le}from"./chunk-7SDNM7YV.js";import{b as f}from"./chunk-4NUW747S.js";import"./chunk-T6WMVIUG.js";import"./chunk-ONYJLWAD.js";import"./chunk-UBEQHTGJ.js";import"./chunk-PHODKV66.js";import"./chunk-JPMGMA4B.js";import"./chunk-YZJDOXQC.js";import{i as Nt,k as Wt}from"./chunk-ZM24RY22.js";import"./chunk-LAX5536Z.js";import"./chunk-N3HRYLNW.js";import"./chunk-4DBMALZW.js";import"./chunk-CVWWHM2V.js";import"./chunk-6OQYVEQJ.js";import"./chunk-YOXOWGT6.js";import"./chunk-EFZOSMYP.js";import"./chunk-WI7F4ZKJ.js";import"./chunk-MJ7M24NH.js";import"./chunk-GJH4QFRX.js";import"./chunk-T63F7663.js";import"./chunk-O4V2VBSK.js";import"./chunk-5TKRKB5E.js";import"./chunk-XAGMDNNR.js";import"./chunk-OP2TLIUN.js";import"./chunk-T2THIR6K.js";import"./chunk-LORHDXEB.js";import"./chunk-BBBPJI4H.js";import"./chunk-45BTW5EG.js";import"./chunk-TPFBHGDM.js";import"./chunk-73NLRHJD.js";import"./chunk-PNFEUBDF.js";import"./chunk-6RCCEJDL.js";import"./chunk-PQ2TNDUX.js";import"./chunk-6X6MKRQ3.js";import"./chunk-FQFHMHYU.js";import"./chunk-SZMEI3WL.js";import"./chunk-KKVGD67U.js";import"./chunk-MYOJWRDU.js";import"./chunk-L7UKJKHG.js";import"./chunk-V2IENAEU.js";import"./chunk-QAGQFNF2.js";import"./chunk-SY7JS2VW.js";import"./chunk-WK57SDN6.js";import"./chunk-AG4V3ZUO.js";import"./chunk-YWLMJ26A.js";import"./chunk-QAWNU3UJ.js";import"./chunk-HRQT4R6X.js";import"./chunk-44BHLWQ4.js";import"./chunk-5BPM64SU.js";import"./chunk-PMVHHMQJ.js";import"./chunk-NAFOM5UA.js";import"./chunk-DO7UF2F2.js";import"./chunk-ZTR6OS44.js";import"./chunk-VRTKAD2J.js";import"./chunk-DBLKLHK2.js";import"./chunk-UTE3ASAZ.js";import"./chunk-2AFEAPEX.js";import"./chunk-GNGXUEWV.js";import"./chunk-QBI5NDCA.js";import"./chunk-NOHW2DKR.js";import"./chunk-HVJAAM3A.js";import"./chunk-ACPEJEHK.js";import"./chunk-I7B3LWNP.js";import"./chunk-YP2E5N4E.js";import"./chunk-QLMNLSCT.js";import"./chunk-P55G5ATK.js";import"./chunk-JT3K52KQ.js";import"./chunk-SPLEGG4R.js";import"./chunk-Y4TJDUGP.js";import"./chunk-6PAFOJ4W.js";import"./chunk-74SDGE57.js";import"./chunk-FRXWHX3T.js";import"./chunk-DTDQ5X42.js";import"./chunk-RX2HFR4X.js";import"./chunk-AZW7YPTQ.js";import"./chunk-NJLJX4X6.js";import"./chunk-DZHFTD24.js";import"./chunk-K57Z4J34.js";import"./chunk-VWG3KVOU.js";import"./chunk-JOEUVLAN.js";import"./chunk-JZQDGIDQ.js";import"./chunk-CZ6CGC7I.js";import"./chunk-7B6U3N62.js";import"./chunk-46WDO5LS.js";import"./chunk-G5EYK5KM.js";import"./chunk-YJKJQU3F.js";import"./chunk-OK4K3OQT.js";import"./chunk-BPWNCOXC.js";import"./chunk-VNS4CQ27.js";import"./chunk-AVMO6LCR.js";import"./chunk-TEGPMVWT.js";import"./chunk-CLQRQC3Y.js";import"./chunk-KSNU73LO.js";import"./chunk-FACEVGRE.js";import"./chunk-5XTCPT52.js";import"./chunk-YW3L7OMP.js";import{a as Bt}from"./chunk-JQAW4OB5.js";import"./chunk-F2BQ2GD6.js";import"./chunk-R3XLNYYB.js";import"./chunk-2HYVVLKS.js";import"./chunk-XRTA5GHC.js";import"./chunk-Y6XW36QP.js";import"./chunk-ZXKU6WBY.js";import"./chunk-U2ZO6WN5.js";import"./chunk-BMYVPMAK.js";import{a as G}from"./chunk-6F25LG6O.js";import"./chunk-XLL67PCY.js";import"./chunk-MCO7DSFO.js";import"./chunk-IIROCMOY.js";import"./chunk-5LG2P6MT.js";import"./chunk-GJ2QRXGN.js";import"./chunk-6QXEFK4U.js";import"./chunk-5L2EJ5RT.js";import"./chunk-S52JRLJC.js";import"./chunk-E2QKN2KY.js";import"./chunk-PDQQY7RQ.js";import"./chunk-W5OI4BJ2.js";import{a as dt}from"./chunk-RWCIDBNQ.js";import"./chunk-2NH7HOKA.js";import"./chunk-EM35R6FY.js";import"./chunk-HM5RIVQC.js";import"./chunk-HKJZ7WI6.js";import"./chunk-CXOFHVIF.js";import"./chunk-EO2H4LIH.js";import"./chunk-DJW5LMRG.js";import"./chunk-DMO5HQM3.js";import"./chunk-DEH76MSI.js";import{a as le}from"./chunk-ALWV3RJ2.js";import"./chunk-2ZFXOJDB.js";import"./chunk-QXXXCEV5.js";import{D as Re,E as mt,G as V,I as pt,a as st,b as H,c as rt,e as He,n as te,o as ve,r as Se,u as jt,v as k,w as q,y as lt}from"./chunk-6B5XFA6F.js";import"./chunk-PUVSV35R.js";import"./chunk-FCWOKKZM.js";import"./chunk-TJ6P6NLD.js";import"./chunk-3JGYBNJA.js";import"./chunk-TQPBYYQ3.js";import"./chunk-DA3SDKGO.js";import"./chunk-ZOEPYNM4.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-BJH4F4SM.js";import"./chunk-Z3RBZHAK.js";import{a as Ut,f as re}from"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-JAPGPEA6.js";import"./chunk-ZC6EBRE4.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import{a as It}from"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import{a as x}from"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import{c as Gt,i as at,n as Ft,p as ot}from"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import{a as M,c as _e,i as Q}from"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import{i as nt,j as Vt}from"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import"./chunk-VU5W7W6Y.js";import"./chunk-ZQIC5NFT.js";import{c as E}from"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import{L as Lt,R as kt,S as Et}from"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-O3EGNJTY.js";import"./chunk-WGAOVKGR.js";import"./chunk-CFRDSUTM.js";import"./chunk-FB4M3WPV.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-WTB3O6DJ.js";import"./chunk-7P44K2YD.js";import"./chunk-32OAXCA4.js";import{b as zt}from"./chunk-UST6HCE7.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import{f as Rt}from"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import{a as y,b as se,g as Y,i as ye,j as J,k as C}from"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as p}from"./chunk-QGVBCWUY.js";import{H as U}from"./chunk-MYO4NP2N.js";import{e as d}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as L}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import{d as Ae}from"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import{b as oe,d as xt,e as tt,j as Ht,z as it}from"./chunk-4PTIEWMT.js";import{a as xe,g as I}from"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import{g as Oe}from"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import{g as ge}from"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as w,b as z,c as At,f as be}from"./chunk-VTHXE323.js";var vt=class{constructor(t,i,n,a,o,s){this.elevationAlignedStartPoint=t,this.elevationAlignedEndPoint=i,this.directSegment=n,this.dimensionSegment=a,this.primaryOffsetAxis=o,this.spatialReference=s}};function Vi(e,t,i){if(e==null)return null;let n;if(t===g.Horizontal)n=Ri(e.elevationAlignedStartPoint,e.elevationAlignedEndPoint);else{let{startRenderSpace:o,endRenderSpace:s}=e.dimensionSegment;n=ii(o,s,e.spatialReference)}if(n==null)return null;let a=t===g.Vertical?Et(n.value,n.unit,i):kt(n.value,n.unit,i);return ht(n,a)}function ie(e){let{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i,dimension:{offset:n,measureType:a,orientation:o}}=e;return{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i,offset:n,measureType:a,orientation:o}}function ne({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,offset:i,measureType:n,orientation:a},o,s=null){if(e==null||t==null)return null;let l=Fi(s?.directSegment??new j,{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t},o),r=s?.primaryOffsetAxis??M();we(r,{measureType:n,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,directSegment:l,orientation:a,renderCoordsHelper:o});let m=s?.dimensionSegment??new j;return Be({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t})&&n===g.Vertical?(H(m.startRenderSpace,l.startRenderSpace),H(m.endRenderSpace,l.endRenderSpace)):Ui(m,r,i,l,o),new vt(e,t,l,m,r,o.spatialReference)}function St(e,t,i,n){return t===ce.Start?(H(e.startRenderSpace,i.startRenderSpace),H(e.endRenderSpace,n.startRenderSpace)):(H(e.startRenderSpace,i.endRenderSpace),H(e.endRenderSpace,n.endRenderSpace)),e}var ce;function Gi(e,t,i,n){ve(e.startRenderSpace,t.startRenderSpace,i,n),ve(e.endRenderSpace,t.endRenderSpace,i,n)}function Mt(e,t,i,n){switch(t){case g.Direct:return Fi(e,i,n);case g.Horizontal:case g.Vertical:{let{elevationAlignedStartPoint:a,elevationAlignedEndPoint:o,dimension:s,geometry:l}=i,r;s.measureType===g.Direct?(r=An(l,n)===a.z>o.z,t===g.Horizontal&&(r=!r)):r=!xn(l);let[m,c]=r?[a,o]:[o,a],h=X(c,Hn);return t===g.Horizontal?h.z=m.z:(h.x=m.x,h.y=m.y),n.toRenderCoords(m,e.startRenderSpace),n.toRenderCoords(h,e.endRenderSpace),e}}}function Fi(e,t,i){return i.toRenderCoords(t.elevationAlignedStartPoint,e.startRenderSpace),i.toRenderCoords(t.elevationAlignedEndPoint,e.endRenderSpace),e}function An(e,t){let i=e.directSegment.eval(.5,f.get()),n=t.worldUpAtPosition(i,f.get()),a=e.dimensionSegment.eval(.5,f.get()),o=V(f.get(),a,i);return!mt(o,Q)&&k(o,n)>0}function xn(e){let{startRenderSpace:t,endRenderSpace:i}=e.dimensionSegment,{startRenderSpace:n,endRenderSpace:a}=e.directSegment;return pt(n,t)<pt(a,i)}(function(e){e[e.Start=0]="Start",e[e.End=1]="End"})(ce||(ce={}));var Hn=qt(0,0,0,null);function Ii(e,t,i,n){let{directSegment:a}=i,o=we(f.get(),{measureType:t,directSegment:a,renderCoordsHelper:n}),s=Ui(Rn,o,0,a,n).eval(.5,f.get()),l=V(f.get(),e,s);return k(l,o)*n.unitInMeters}var Rn=new j;function we(e,t){let{measureType:i,elevationAlignedStartPoint:n,elevationAlignedEndPoint:a,directSegment:{startRenderSpace:o,endRenderSpace:s},directSegment:l,renderCoordsHelper:r}=t,m=l.eval(.5,f.get()),c=r.worldUpAtPosition(m,f.get()),h=r.worldBasisAtPosition(m,It.Y,f.get());switch(i){case g.Horizontal:H(e,c);break;case g.Vertical:k(o,c)<k(s,c)?V(e,s,o):V(e,o,s),q(e,e,c),q(e,e,c);break;case g.Direct:{let u=t.orientation??0;if(Be({elevationAlignedStartPoint:n,elevationAlignedEndPoint:a}))ot(je,-nt(u),c),lt(e,h,je);else{let _=V(f.get(),s,o),v=q(f.get(),_,c);q(v,v,_),ot(je,nt(u),_),lt(e,v,je)}break}}return mt(e,Q)?H(e,h):jt(e,e)}var je=le();function Be({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}){return e!=null&&t!=null&&e.x===t.x&&e.y===t.y}function Ui(e,t,i,n,a){let{startRenderSpace:o,endRenderSpace:s}=n,l=i/a.unitInMeters,[r,m]=zn(o,s,t,l);return ve(e.startRenderSpace,n.startRenderSpace,t,r),ve(e.endRenderSpace,n.endRenderSpace,t,m),e}function zn(e,t,i,n=0){let a=k(t,i),o=k(e,i),s=Math.abs(a-o)+n;return a>o?[s,n]:[n,s]}function ue(e,t,i){let n=t.directSegment.eval(.5,f.get());return i.worldUpAtPosition(n,e)}function Ce(e,t){let{startRenderSpace:i,endRenderSpace:n}=t.directSegment;return V(e,n,i)}function Ne(e,t,i={invert:!1}){let{startRenderSpace:n,endRenderSpace:a}=t.dimensionSegment;return i.invert?V(e,n,a):V(e,a,n)}function We(e,t){let i=e.directSegment.eval(.5,f.get());return t.headingAtPosition(i,e.primaryOffsetAxis)}function ji(e,t){return Se(Ne(Ln,e))/t**2}var Ln=M();function qe(e){let{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i}=e;if(t==null||i==null)return!1;let n=ti(t,i);return n!=null&&ht(n,"meters").value>Ee}function ae(e){return e.geometry!=null}var ee=class extends U{constructor(e){super(e)}initialize(){let e=Y(()=>this.analysisViewData.computations,({computation:t})=>this._watchComputation(t));this.addHandles(I(e))}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return Xt(this.view)}_watchComputation(e){return y(()=>ie(e),t=>{let{measureType:i}=t;if(qe(t)&&i!==g.Direct){let a=Math.round(Lt(Ee,"meters","kilometers"));return Oe.getLogger(this).warnOnce(`A ${i} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${a} km. Update the measureType of the affected dimension to "direct" to display it.`),void(e.geometry=null)}let n=ne(t,this.view.renderCoordsHelper,e.geometry);e.geometry=n,e.result.length=Vi(n,i,this._defaultUnit)},C)}};p([d({constructOnly:!0})],ee.prototype,"analysisViewData",void 0),p([d({constructOnly:!0})],ee.prototype,"view",void 0),p([d()],ee.prototype,"analysis",null),p([d()],ee.prototype,"_defaultUnit",null),ee=p([L("esri.views.3d.analysis.Dimension.DimensionController")],ee);function he(e){return Wt(e.accentColor,.5)}function Bi(e){return Nt(e.accentColor)}var Ke=5,Ni=new G([127,127,127,.5]),Ze=.8,Wi=4,qi=6,Ki=.1,Pt=.5,Zi=18,$i=2,Yi=.3,Ji=2,Qi=.25,Xi=20,en=5,wt=5,Ct=10,tn=2500,nn=50,an=2;var $e=class{constructor(t){this.start=t.start,this.end=t.end,this.offset=t.offset,this.heading=t.heading,this.rotation=t.rotation,this.direct=t.direct,this.horizontal=t.horizontal,this.vertical=t.vertical}manipulatorName(t){return Object.keys(this).find(i=>this.hasOwnProperty(i)&&t===this[i])}values(){return[this.start,this.end,this.offset,this.heading,this.rotation,this.direct,this.horizontal,this.vertical]}forEachMeasureTypeManipulator(t){for(let i of $t)t(this.manipulatorForMeasureType(i),i)}manipulatorForMeasureType(t){switch(t){case g.Direct:return this.direct;case g.Horizontal:return this.horizontal;case g.Vertical:return this.vertical}}},Ye=class extends Me{constructor(t,i){let n=fi(G.toUnitRGBA(he(t.effectiveTheme))),a=[new F(Zt(n,1,32,32),N)];super({view:t,renderObjects:a,metadata:i.metadata,available:!1,grabCursor:"crosshair",radius:Ke,collisionPriority:1}),this._themeHandle=y(()=>({color:G.toUnitRGBA(he(t.effectiveTheme))}),o=>n.setParameters(o))}destroy(){this._themeHandle.remove(),super.destroy()}};function rn(e,t){let i=[_e(-.5,0,0),_e(.5,0,0)],n=me(t.unfocusedMaterial,i.map(o=>te(M(),o,Pt))),a=n.instantiate({material:t.focusedMaterial});return new Me(w({view:e,renderObjects:[new F(n,B.Unfocused|B.Selected|N),new F(a,B.Focused|N)],collisionType:{type:"line",paths:[i]},radius:Qe(t.lineSizePt)/2,metadata:t.metadata,available:!1},gt))}var Te=class extends Me{constructor(t,{lineSizePt:i,material:n,metadata:a}){super({view:t,autoScaleRenderObjects:!1,collisionPriority:1,metadata:a}),this._options={calloutColor:Ut(),lineSizePt:i,material:n},this._themeHandle=y(()=>G.toUnitRGBA(he(t.effectiveTheme)),o=>{this._options.calloutColor=o,sn(this,on(z(w({},this._options),{metadata:this.metadata})))},J)}update({lineSizePt:t,material:i}){this._options.lineSizePt=t,this._options.material=i,sn(this,on(z(w({},this._options),{metadata:this.metadata})))}destroy(){this._themeHandle.remove(),super.destroy()}};function on({calloutColor:e,lineSizePt:t,material:i,metadata:n}){return{calloutLength:.25*hi*Ze*x(t)+Zi,calloutColor:e,calloutWidth:$i,customStateMask:N,discScale:Yi,focusMultiplier:Ji,material:i,metadata:n}}function ln(e,t){let i=[_e(-.5,0,0),_e(.5,0,0)],n=me(t.thinOffsetManipulatorMaterial,i),a=me(t.unfocusedMaterial,i.map(s=>te(M(),s,Pt))),o=a.instantiate({material:t.focusedMaterial});return new Me(w({view:e,renderObjects:[new F(a,B.Unfocused|N),new F(o,B.Focused|N),new F(n,N)],collisionType:{type:"line",paths:[i]},radius:Qe(t.lineSizePt)/2,available:!1,metadata:t.metadata},gt))}function mn(e,{isStart:t,createSnappingPipelineStep:i,dimension:n,onUpdate:a,view:o}){let s=t?"startPoint":"endPoint";return[de(e,(r,m,c,h)=>{let u=Ie(r),{snappingStep:_,cancelSnapping:v}=i(h);c=c.next(u).next(Ge(n,[s,"measureType","orientation"])).next(v),m.next(u).next(Ci(o)).next(..._).next(P=>{let S=X(P.mapEnd,new E);a(s==="startPoint"?{startPoint:S}:{endPoint:S})})})]}function pn(e,{computation:t,view:i}){return[de(e,(n,a,o)=>{if(!ae(t)||!n.selected)return;let{geometry:s,dimension:l}=t,r=Ie(n);a.next(r).next(fn(i,l,s.dimensionSegment,s.primaryOffsetAxis)),o.next(r).next(Ge(l,["offset"]))})]}function dn(e,{computation:t,view:i}){return[de(e,(n,a,o)=>{un({cancel:o,computation:t,settingHeading:!0,steps:a,view:i})})]}function cn(e,{computation:t,view:i}){return[de(e,(n,a,o)=>{un({cancel:o,computation:t,settingHeading:!1,steps:a,view:i})}),e.events.on("immediate-click",n=>{kn(n,t,i)})]}function kn(e,t,i){let{dimension:n,geometry:a}=t;if(n.orientation===90||n.orientation===270)return n.orientation=0,void e.stopPropagation();if(a==null)return;let{renderCoordsHelper:o}=i,s=ne(z(w({},ie(t)),{orientation:90}),o),l=ne(z(w({},ie(t)),{orientation:270}),o);if(s==null||l==null)return;let r=We(s,o),m=We(l,o),c=Tt(a,i),h=ke.shortestSignedDiff(c,r),u=ke.shortestSignedDiff(c,m);n.orientation=Math.abs(h)<Math.abs(u)?90:270,e.stopPropagation()}function un(e){let{cancel:t,computation:i,settingHeading:n,steps:a,view:o}=e;if(!ae(i))return;let{renderCoordsHelper:s}=o,{dimension:l,geometry:r}=i,m=M(),c=Mn(M(),r,r.directSegment,s),h=Pn(f.get(),{forHeading:n,geometry:r,renderCoordsHelper:s}),u=Le(c,h,ze()),_=n?l.orientation??We(r,o.renderCoordsHelper):l.orientation??0;a.next(yt(o,u)).next(v=>{v.action==="start"&&H(m,v.renderStart);let P=u,S=gi(m,v.renderEnd,c,P),$=_-Vt(S);n||($=En($)),l.orientation=$}),t.next(Ge(l,["orientation"]))}function En(e){let t=ke.normalize(e)%90;return t<wt?e-t:90-t<wt?e+(90-t):e}function hn(e,{computation:t,manipulatorMeasureType:i,view:n}){let a=g.Direct,o=0,s=0;return[e.events.on("grab-changed",l=>{if(l.action!=="start"||!ae(t))return;let{dimension:r,geometry:m}=t;a=r.measureType,o=r.offset,s=r.orientation;let c=H(f.get(),e.renderLocation);r.measureType=i,r.offset=Ii(c,i,m,n.renderCoordsHelper),r.orientation=0}),de(e,(l,r,m)=>{if(!ae(t))return;let{geometry:c,dimension:h}=t,{renderCoordsHelper:u}=n,_=Mt(Cn,i,t,u),v=we(f.get(),{measureType:i,directSegment:c.directSegment,renderCoordsHelper:u}),P=Ie(l);r.next(P).next(fn(n,h,_,v)),m.next(P).next(S=>(h.measureType=a,h.offset=o,h.orientation=s,S))})]}function fn(e,t,i,n){let a=He(f.get(),i.endRenderSpace,i.startRenderSpace);q(a,a,n);let o=Le(i.startRenderSpace,a,ze()),s=Le(i.startRenderSpace,n,ze()),l=t.offset,r,m=0,c=new _i;return c.next(yt(e,o)).next(h=>{h.action==="start"&&(m=ct(s,h.renderStart));let u=(ct(s,h.renderEnd)-m)*e.renderCoordsHelper.unitInMeters;t.offset=l+u,r=h}),h=>(c.execute(h),r)}function Tt(e,t){let{directSegment:i}=e,{renderCoordsHelper:n}=t,a=ue(f.get(),e,n),o=Ce(f.get(),e),s=q(f.get(),o,a),{viewForward:l}=t.state.camera;k(s,l)>0&&te(s,s,-1);let r=i.eval(.5,f.get());return n.headingAtPosition(r,s)}function gn(e,t,i){let{dimensionSegment:n,primaryOffsetAxis:a}=t,o=Ne(De,t),s=Re(o,Q)?Gt(Je):Ve(o,a,Q,Je),l=Math.max(st(o),Ki/i.unitInMeters);at(s,s,rt(De,l,l,l)),e.modelTransform=s,e.renderLocation=n.eval(.5,De)}function yn(e,t,i){vn(e,t,i,{forHeading:!0})}function _n(e,t,i){vn(e,t,i,{forHeading:!1})}function vn(e,t,i,{forHeading:n}){let{dimension:a,geometry:o}=t,{primaryOffsetAxis:s}=o,l=te(Vn,s,a.offset>=0?1:-1),r=Pn(Gn,{forHeading:n,geometry:o,renderCoordsHelper:i});q(r,r,l);let m=Ve(l,r,Q,Je);e.modelTransform=m,e.renderLocation=Mn(De,o,o.dimensionSegment,i)}var Vn=M(),Gn=M();function Sn(e,t,i,n){let{geometry:a}=t,o=Mt(Cn,i,t,n),s=we(De,{measureType:i,directSegment:a.directSegment,renderCoordsHelper:n}),l=V(Dt,o.endRenderSpace,o.startRenderSpace),r=Ve(l,s,Q,Je),m=st(l);at(r,r,rt(Dt,m,m,m)),e.modelTransform=r,e.renderLocation=o.eval(.5,Dt)}function Mn(e,t,i,n){let{startRenderSpace:a,endRenderSpace:o}=i,s=Fn(t,n)?a:o;return H(e,s)}function Pn(e,{forHeading:t,geometry:i,renderCoordsHelper:n}){return t?ue(e,i,n):Ne(e,i,{invert:!0})}function Fn(e,t){let i=Ce(In,e),n=ue(Un,e,t);return k(i,n)>0}var In=M(),Un=M();function wn(e){return x(e)+Wi}function Qe(e){return x(e)+qi}function sn(e,t){let i=t.material??new Fe({writeDepth:!1,textureId:t.texture?.id,renderOccluded:D.Opaque,isDecoration:!0}),n=t.focusMultiplier??Pe.focusMultiplier,a=t.calloutLength??Pe.calloutLength,o=Pe.discRadius*(t.discScale??1),s=o*n,l=(_,v)=>{let P=[0,1,2,2,3,0];return new Kt(v,[[dt.POSITION,new ut([a-_,-_,0,a+_,-_,0,a+_,_,0,a-_,_,0],P,3,!0)],[dt.UV0,new ut([0,0,1,0,1,1,0,1],P,2,!0)]])},r=t.calloutWidth??Pe.calloutWidth,m=new K({width:r,color:t.calloutColor,renderOccluded:D.OccludeAndTransparent,isDecoration:!0}),c=me(m,[[0,0,0],[a-o,0,0]]),h=me(m,[[0,0,0],[a-s,0,0]]),u=t.customStateMask??ft.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[a,0,0]},e.focusMultiplier=n,e.metadata=t.metadata,e.radius=o,e.renderObjects=[new F(l(o,i),B.Unfocused|u),new F(c,B.Unfocused|u),new F(l(s,i),B.Focused|u),new F(h,B.Focused|u)]}var N=ft.Custom1,De=M(),Dt=M(),Je=le(),Cn=new j;var R;function Dn(e,t){return{enabled:t.effectiveFeatureEnabled,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,geometry:e.geometry}}function Tn(e,t){if(qe(e))return R.Direct;if(!e.enabled)return null;let{geometry:i}=e;if(i==null||Re(i.directSegment.startRenderSpace,i.directSegment.endRenderSpace))return null;let{camera:n}=t.state,a=ue(f.get(),i,t.renderCoordsHelper),o=Ce(f.get(),i),s=te(f.get(),a,k(o,a)),l=He(f.get(),o,s),r=Se(l),m=Se(s),{startRenderSpace:c,endRenderSpace:h}=i.directSegment,u=Math.max(n.computeScreenPixelSizeAt(c)*Ct,n.computeScreenPixelSizeAt(h)*Ct)**2;return r<u?R.Vertical:m<u?R.Horizontal:null}function bn(e,t,{constraint:i,view:n}){let{unconstrainedGeometry:a}=e;if(a==null)return;let{renderCoordsHelper:o,spatialReference:s}=n,{startRenderSpace:l,endRenderSpace:r}=a.directSegment,m=o.fromRenderCoords(l,new E({spatialReference:s})),c=o.fromRenderCoords(r,new E({spatialReference:s})),h;h=t==="start"?{startPoint:m}:{endPoint:c},bt(e,h,{constraint:i,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,unconstrainedGeometry:a,view:n})}function bt(e,t,i){let{constraint:n,elevationAlignedStartPoint:a,elevationAlignedEndPoint:o,unconstrainedGeometry:s,view:l}=i,{dimension:r,previousConstraint:m,preConstraintProperties:c}=e;if(a==null||o==null)return;let h=()=>{"startPoint"in t?r.startPoint=t.startPoint:"endPoint"in t&&(r.endPoint=t.endPoint)};if(n==null)h(),m!=null&&c!=null&&(r.measureType=c.measureType,r.orientation=c.orientation);else switch(r.measureType=g.Direct,n){case R.Horizontal:if(n!==m&&(r.orientation=0),"startPoint"in t){let u=t.startPoint;u!=null&&(u.z=o.z),r.startPoint=u}else if("endPoint"in t){let u=t.endPoint;u!=null&&(u.z=a.z),r.endPoint=u}break;case R.Vertical:if(n!==m&&(r.orientation=Tt(s,l)),"startPoint"in t){let u=t.startPoint;u!=null&&(u.x=o.x,u.y=o.y),r.startPoint=u}else if("endPoint"in t){let u=t.endPoint;u!=null&&(u.x=a.x,u.y=a.y),r.endPoint=u}break;case R.Direct:n!==m&&c!=null&&(r.orientation=c.orientation),h()}e.previousConstraint=n,e.unconstrainedGeometry=s}(function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Direct=2]="Direct"})(R||(R={}));var T=class extends U{constructor(e){super(e),this._stagedDimension=null,this._computationManipulators=new Map,this._computationHandles=new Ae,this._orientationManipulatorTexture=null,this._updatingHandles=new Bt,this._getSnappingContext=Ai(n=>new bi({elevationInfo:{mode:"absolute-height",offset:0},pointer:n,editGeometryOperations:new ri(new si("point",oi(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new zi}));let{view:t}=e;this._snappingManagerResult=ki(t),this.addHandles(this._snappingManagerResult),this._unfocusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._focusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial.setParameters({stipplePattern:pe(2)}),this._constraintSnappingIndicator=new Z({view:t,attached:!0,width:1,renderOccluded:D.OccludeAndTransparent,stipplePattern:pe(5),isDecoration:!0});let i=G.toUnitRGBA(Ni);this._stagedStartIndicator=new Li({view:t,attached:!1,elevationInfo:{mode:"absolute-height",offset:0},spatialReference:e.view.renderCoordsHelper.spatialReference,color:i,size:2*Ke,outlineSize:0,renderOccluded:D.OccludeAndTransparent,isDecoration:!0})}initialize(){let{view:e}=this;this._snappingOperation=new Oi({view:e});let t=!e._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this._orientationManipulatorMaterial=new Fe({writeDepth:!1,renderOccluded:D.Opaque,isDecoration:!0}),this.addHandles(y(()=>({accentColor:he(e.effectiveTheme),contrastColor:Bi(e.effectiveTheme)}),({accentColor:n,contrastColor:a})=>{let o=this._orientationManipulatorTexture,s=wi(e.textures,{accentColor:n,contrastColor:a,preMultiplyAlpha:t});this._orientationManipulatorMaterial.setParameters({textureId:s.texture.id}),this._orientationManipulatorTexture=s,o?.release();let l=G.toUnitRGBA(n);this._unfocusedOffsetManipulatorMaterial.setParameters({color:l}),this._focusedOffsetManipulatorMaterial.setParameters({color:l}),this._thinOffsetManipulatorMaterial.setParameters({color:l}),this._constraintSnappingIndicator.color=l},J));let i=Y(()=>this.analysisViewData.computations,({computation:n})=>this._createManipulators(n));this.addHandles(I(i)),this.addHandles([y(()=>({stagedPoint:this._snappingOperation.stagedPoint,stagedComputation:this._stagedComputation}),({stagedPoint:n,stagedComputation:a})=>{if(a==null||n==null)return;let o=X(n,new E);this._applyPointUpdate(a,{endPoint:o})},ye),y(()=>({stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator}),(n,a)=>{let{stagedDimension:o,selectedComputation:s,firstGrabbedManipulator:l}=n;if(o===a?.stagedDimension&&l===a?.firstGrabbedManipulator){for(let r of[s,a?.selectedComputation])if(r!=null){let m=this._computationManipulators.get(r);m!=null&&this._updateManipulators(r,m,n)}}else for(let[r,m]of this._computationManipulators)this._updateManipulators(r,m,n)},C),y(()=>this.analysis.style.lineSize,n=>{this._updateManipulatorStyle(n)},J),y(()=>this.view.state.camera,()=>{this._stagedComputation!=null&&this._updateStagedDimensionOffset(this._stagedComputation)}),y(()=>{let n=this._stagedComputation;if(!n)return null;let a=n.elevationAlignedStartPoint,o=M();return a!=null&&this.view.renderCoordsHelper.toRenderCoords(a,o)?o:null},n=>{n!=null?(this._stagedStartIndicator.vertices=[n],this._stagedStartIndicator.attached=!0):this._stagedStartIndicator.attached=!1})]),this.addHandles(this._constraintHandles),this.addHandles(this._snappingIndicatorHandles),Hi(this,()=>{let n=this._activeComputation,a=this._stagedComputation;if(n==null||a!=null){let o=this.view.inputManager.latestPointerType??"mouse",s=this._getSnappingContext(o);this._updatingHandles.addPromise(it(this._snappingOperation.snapAgainNearPreviousMapPoint(this._snappingManager,s)))}if(n!=null){let{start:o,end:s}=this._computationManipulators.get(n);if(o.grabbing||s.grabbing){let l=o.grabbing?"start":"end",r=this._computeConstraint(n);bn(n,l,{constraint:r,view:this.view})}}})}destroy(){this._snappingOperation=oe(this._snappingOperation),this._computationHandles.destroy(),this._constraintSnappingIndicator.destroy(),this._stagedStartIndicator.destroy(),this._orientationManipulatorTexture?.release()}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}get firstGrabbedManipulator(){return this.parentTool.firstGrabbedManipulator}get hasGrabbedManipulators(){return this.parentTool.hasGrabbedManipulators}get snappingOptions(){return this._snappingManager.options}get _snappingManager(){return this._snappingManagerResult.snappingManager}get _activeComputation(){if(this._stagedComputation!=null)return this._stagedComputation;let{selectedComputation:e}=this.analysisViewData;return this.hasGrabbedManipulators&&e!=null?e:null}get _stagedComputation(){let e=this._stagedDimension,t=this.analysisViewData.computations.at(-1)?.computation;return e==null||t==null||t.dimension!==e?null:t}get _constraintHandles(){return[se(()=>this.analysisViewData.selectedComputation,e=>{e.previousConstraint=this._computeConstraint(e)},z(w({},C),{equals:ge})),y(()=>{let e=this._activeComputation;if(e==null)return null;let{measureType:t,orientation:i}=e.dimension;return{measureType:t,orientation:i,computation:e}},(e,t)=>{if(e!=null&&t==null){let{measureType:i,orientation:n,computation:a}=e;switch(a.previousConstraint){case R.Horizontal:a.preConstraintProperties={measureType:g.Horizontal,orientation:0};break;case R.Vertical:a.preConstraintProperties={measureType:g.Vertical,orientation:0};break;case R.Direct:a.preConstraintProperties={measureType:g.Direct,orientation:n};break;default:a.preConstraintProperties={measureType:i,orientation:n}}}e==null&&t!=null&&(t.computation.preConstraintProperties=null)},ye)]}get _snappingIndicatorHandles(){let e="snapping-indicator-event-handles";return[y(()=>({stagedComputation:this._stagedComputation,activeComputation:this._activeComputation}),({stagedComputation:t,activeComputation:i})=>{let n=this._constraintSnappingIndicator;if(this.removeHandles(e),i!=null)if(i===t)n.attached=!0;else{let{start:a,end:o}=this._computationManipulators.get(i),s=()=>{n.attached=a.grabbing||o.grabbing};s(),this.addHandles([a.events.on("grab-changed",s),o.events.on("grab-changed",s)],e)}else n.attached=!1}),y(()=>{let t=this._activeComputation;return t!=null?{geometry:t.geometry,constraint:t.previousConstraint}:{}},({geometry:t,constraint:i})=>{let n=this._constraintSnappingIndicator;t!=null&&i!=null&&i!==R.Direct?(n.visible=!0,n.setGeometryFromSegment(t.directSegment)):n.visible=!1})]}removeStaged(){return this._stagedDimension!=null&&(this.analysis.dimensions.remove(this._stagedDimension),this._stagedDimension=null,!0)}onDeactivate(){this.removeStaged(),this._resetSnappingState()}onClick(e){let{_stagedDimension:t}=this;if(t==null){let i=this._onUnstagedClick(e);return this.analysis.dimensions.add(i),null}return this._onStagedClick(e),t}onPointerMove({mapPoint:e,pointerType:t}){if(t==="touch")return;let i=this._getSnappingContext(t);this._updatingHandles.addPromise(it(this._snappingOperation.snap({point:e},this._snappingManager,i)))}onManipulatorSelectionChanged(){this.analysisViewData.selectedComputation!=null&&(this._computationManipulators.get(this.analysisViewData.selectedComputation).offset.selected||(this.analysisViewData.selectedDimension=null))}_onUnstagedClick({mapPoint:e,pointerType:t}){let i=e;if(t==="mouse"){let a=this._getSnappingContext(t);i=this._snappingManager.update({point:e,context:a})}let n=new Yt({startPoint:X(i,new E),endPoint:null,measureType:g.Horizontal});return this._stagedDimension=n,this._resetSnappingState(),n}_onStagedClick({mapPoint:e,pointerType:t}){let i=this._stagedComputation;if(i==null)return;let n=e;if(t==="mouse"){let o=this._getSnappingContext(t);n=this._snappingManager.update({point:e,context:o})}let a=X(n,new E);this._applyPointUpdate(i,{endPoint:a}),this._stagedDimension=null,this._resetSnappingState()}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}_createManipulators(e){let t=this._setupPointManipulator(e,{isStart:!0}),i=this._setupPointManipulator(e,{isStart:!1}),n=this._setupOffsetManipulator(e),a=this._setupHeadingManipulator(e),o=this._setupRotationManipulator(e),s=this._setupMeasureTypeManipulator(e,g.Direct),l=this._setupMeasureTypeManipulator(e,g.Horizontal),r=this._setupMeasureTypeManipulator(e,g.Vertical),m=new $e({start:t,end:i,offset:n,heading:a,rotation:o,direct:s,horizontal:l,vertical:r});return this._setupComputationToManipulatorsSync(e,m),this._computationManipulators.set(e,m),this.manipulators.addMany(m.values()),{manipulators:m,remove:()=>{this._computationHandles.remove(e),this._computationManipulators.delete(e);for(let c of m.values())this.manipulators.remove(c)}}}_setupComputationToManipulatorsSync(e,t){this._computationHandles.add([y(()=>e.geometry,()=>this._updateManipulators(e,t),z(w({},C),{equals:ge}))],e)}_setupPointManipulator(e,t){let{view:i}=this,{dimension:n}=e,a=new Ye(i,{metadata:n}),o=mn(a,{isStart:t.isStart,createSnappingPipelineStep:s=>xi({snappingContext:this._getSnappingContext(s),snappingManager:this._snappingManager,updatingHandles:this._updatingHandles}),dimension:n,onUpdate:s=>this._applyPointUpdate(e,s),view:i});return this._computationHandles.add(o,e),a}_setupOffsetManipulator(e){let{view:t}=this,i=rn(t,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,metadata:e.dimension}),n=pn(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupHeadingManipulator(e){let{view:t}=this,i=new Te(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),n=dn(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupRotationManipulator(e){let{view:t}=this,i=new Te(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),n=cn(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupMeasureTypeManipulator(e,t){let{view:i}=this,n=ln(i,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,thinOffsetManipulatorMaterial:this._thinOffsetManipulatorMaterial,metadata:e.dimension}),a=hn(n,{computation:e,manipulatorMeasureType:t,view:i});return this._computationHandles.add(a,e),n}_updateManipulators(e,t,i={stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator}){let{stagedDimension:n,selectedComputation:a,firstGrabbedManipulator:o}=i,{start:s,end:l,offset:r,heading:m,rotation:c}=t,h=a===e,u=ae(e),{dimension:_}=e;for(let S of t.values()){let $=u&&n==null&&(o==null||S===o);S===r?(S.available=$,S.selected=h):S.available=$&&h}if(!u)return;this._computeConstraint(e)!=null?t.forEachMeasureTypeManipulator(S=>S.available=!1):t.manipulatorForMeasureType(_.measureType).available=!1;for(let S of[m,c])_.measureType===g.Direct&&_.offset!==0||(S.available=!1);Be(e)?c.available=!1:m.available=!1;let{geometry:v}=e;s.renderLocation=v.directSegment.startRenderSpace,l.renderLocation=v.directSegment.endRenderSpace;let{renderCoordsHelper:P}=this.view;gn(r,v,P),m.available&&yn(m,e,P),c.available&&_n(c,e,P),t.forEachMeasureTypeManipulator((S,$)=>{S.available&&Sn(S,e,$,P)})}_updateManipulatorStyle(e){let t=wn(e),i=Qe(e),n={lineSizePt:e,material:this._orientationManipulatorMaterial};for(let{offset:a,heading:o,rotation:s}of this._computationManipulators.values())a.radius=i/2,o.update(n),s.update(n);this._unfocusedOffsetManipulatorMaterial.setParameters({width:t}),this._focusedOffsetManipulatorMaterial.setParameters({width:i})}_applyPointUpdate(e,t){let{view:i}=this,n=ie(e);"startPoint"in t&&(n.elevationAlignedStartPoint=t.startPoint),"endPoint"in t&&(n.elevationAlignedEndPoint=t.endPoint);let a=ne(n,i.renderCoordsHelper);if(a==null)return;let o=this._computeConstraint(z(w({},n),{geometry:a}));bt(e,t,z(w({},n),{constraint:o,unconstrainedGeometry:a,view:i})),e===this._stagedComputation&&this._updateStagedDimensionOffset(e)}_updateStagedDimensionOffset(e){if(e.geometry==null)return;e.geometry.directSegment.eval(.5,On);let{state:t,renderCoordsHelper:i}=this.view,n=t.camera.computeScreenPixelSizeAt(On);e.dimension.offset=nn*n*i.unitInMeters}_computeConstraint(e){return Tn(Dn(e,this._snappingManager.options),this.view)}_createOffsetManipulatorMaterial(){return new K({width:1,renderOccluded:D.OccludeAndTransparent,writeDepth:!1,hasPolygonOffset:!0,isDecoration:!0})}get testInfo(){}};p([d({constructOnly:!0})],T.prototype,"analysis",void 0),p([d({constructOnly:!0})],T.prototype,"analysisViewData",void 0),p([d({constructOnly:!0})],T.prototype,"manipulators",void 0),p([d({constructOnly:!0})],T.prototype,"parentTool",void 0),p([d({constructOnly:!0,nonNullable:!0})],T.prototype,"view",void 0),p([d({readOnly:!0})],T.prototype,"updating",null),p([d()],T.prototype,"firstGrabbedManipulator",null),p([d()],T.prototype,"hasGrabbedManipulators",null),p([d()],T.prototype,"snappingOptions",null),p([d()],T.prototype,"_stagedDimension",void 0),p([d()],T.prototype,"_activeComputation",null),p([d()],T.prototype,"_stagedComputation",null),T=p([L("esri.views.3d.analysis.Dimension.LengthDimensionSubTool")],T);var On=M();var fe;(function(e){e.Ready="ready",e.Creating="creating",e.Created="created"})(fe||(fe={}));var b=class extends yi{constructor(e){super(e),this.automaticManipulatorSelection=!1,this.removeIncompleteOnCancel=!1,this._pointerMoveTimerMs=tn,this._prevPointerMoveTimeout=null}initialize(){this._intersector=Di(this.view.state.viewingMode),this._lengthDimensionSubTool=new T({analysis:this.analysis,analysisViewData:this.analysisViewData,manipulators:this.manipulators,parentTool:this,view:this.view}),this.addHandles([I(this._lengthDimensionSubTool),xe(()=>this._clearPointerMoveTimeout()),y(()=>this.state,e=>{e===fe.Created&&this.finishToolCreation()},C),se(()=>this.firstGrabbedManipulator,e=>{this.selectedDimension=e.metadata},C),y(()=>this.selectedDimension,()=>this._resetPointerMoveTimeout(),C)])}get state(){return this.analysis.dimensions.some(e=>e.type==="length")?this._activeSubTool!=null?fe.Creating:fe.Created:fe.Ready}get updating(){return this._lengthDimensionSubTool.updating}get cursor(){return this.active?"crosshair":null}get selectedDimension(){return this.analysisViewData.selectedDimension}set selectedDimension(e){this.analysisViewData.selectedDimension=e}onInputEvent(e){switch(e.type){case"immediate-click":this._clickHandler(e);break;case"immediate-double-click":this._doubleClickHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);break;case"key-down":if(_t.cancel===e.key){if(this._activeSubTool!=null&&this._activeSubTool.removeStaged())return void e.stopPropagation();this.active||(this.selectedDimension=null)}else _t.delete.includes(e.key)&&this._deleteKeyHandler()}}onActivate(){this._activeSubTool=this._lengthDimensionSubTool}onDeactivate(){this._activeSubTool!=null&&(this._activeSubTool.onDeactivate(),this._activeSubTool=null)}onShow(){this._resetPointerMoveTimeout()}onManipulatorSelectionChanged(){this._lengthDimensionSubTool.onManipulatorSelectionChanged()}onHide(){this.selectedDimension=null}_clickHandler(e){if(this.hasFocusedManipulators)return void e.stopPropagation();if(this._activeSubTool==null)return;let t=this._intersectScreen(e);t!=null&&(this.selectedDimension=this._activeSubTool.onClick({mapPoint:t,pointerType:e.pointerType}),e.stopPropagation())}_doubleClickHandler(e){this.active&&(this.view.activeTool=null,e.stopPropagation())}_pointerMoveHandler(e){if(this._resetPointerMoveTimeout(),this._activeSubTool==null||this.hasFocusedManipulators)return;let t=this._intersectScreen(e);t!=null&&this._activeSubTool.onPointerMove({mapPoint:t,pointerType:e.pointerType})}_deleteKeyHandler(){this._activeSubTool!=null&&this._activeSubTool.removeStaged(),this._removeSelected()}_intersectScreen(e){let t=vi(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);let i=this._intersector.results.min,n=f.get();return i.getIntersectionPoint(n)?this.view.renderCoordsHelper.fromRenderCoords(n,new E({spatialReference:this.view.spatialReference})):null}_removeSelected(){this.selectedDimension!=null&&(this.analysis.dimensions.remove(this.selectedDimension),this.selectedDimension=null)}_clearPointerMoveTimeout(){this._prevPointerMoveTimeout=xt(this._prevPointerMoveTimeout)}_resetPointerMoveTimeout(){this._clearPointerMoveTimeout(),this.manipulators.forEach(e=>e.manipulator.state|=N),this._prevPointerMoveTimeout=Ht.setTimeout(()=>{this.manipulators.forEach(e=>e.manipulator.state&=~N)},this._pointerMoveTimerMs)}get testInfo(){}};p([d({constructOnly:!0})],b.prototype,"view",void 0),p([d({constructOnly:!0})],b.prototype,"analysis",void 0),p([d({readOnly:!0})],b.prototype,"state",null),p([d({readOnly:!0})],b.prototype,"updating",null),p([d({readOnly:!0})],b.prototype,"cursor",null),p([d({constructOnly:!0})],b.prototype,"analysisViewData",void 0),p([d()],b.prototype,"selectedDimension",null),p([d()],b.prototype,"automaticManipulatorSelection",void 0),p([d()],b.prototype,"_activeSubTool",void 0),p([d()],b.prototype,"_lengthDimensionSubTool",void 0),b=p([L("esri.views.3d.analysis.Dimension.DimensionTool")],b);var Xe=class extends pi{constructor(t,i){super(t),this._hasExternalMaterial=!1,this._renderOccluded=D.OccludeAndTransparent,this._width=1,this._color=Qt(1,0,1,1),this._placement="end",this._markerPrimitive="arrow",this._material=i,this._hasExternalMaterial=i!=null,this.applyProperties(t)}setGeometryFromSegment(t,i){let n=t.endRenderSpace;this.transform=Ft(jn,n),this._normal=i;let{points:a}=t.createRenderGeometry(n,this.view.renderCoordsHelper);this.geometry=[a]}get renderOccluded(){return this._material!=null?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(t){this._renderOccluded=t,this._material!=null&&this._material.setParameters({renderOccluded:t})}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this.recreateGeometry()}get normal(){return this._normal}set normal(t){this._normal=t,this.recreateGeometry()}get width(){return this._material!=null?this._material.parameters.width:this._width}set width(t){this._width=t,this._material!=null&&this._material.setParameters({width:t})}get color(){return this._material!=null?this._material.parameters.color:this._color}set color(t){this._color=Jt(t),this._material!=null&&this._material.setParameters({color:this._color})}get placement(){return this._material!=null?this._material.parameters.placement:this._placement}set placement(t){this._placement=t,this._material!=null&&this._material.setParameters({placement:this._placement})}get markerPrimitive(){return this._material?.parameters.markerPrimitive??this._markerPrimitive}set markerPrimitive(t){this._markerPrimitive=t,this._material!=null&&this._material.setParameters({markerPrimitive:t})}createExternalResources(){this._hasExternalMaterial||(this._material=new Ue({width:this._width,color:this._color,placement:this._placement,renderOccluded:this._renderOccluded,markerPrimitive:this._markerPrimitive,isDecoration:this.isDecoration}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(t){for(let i of ci(this.geometry,this.normal)){let n=di(this._material,i);t.addGeometry(n)}}forEachExternalMaterial(t){this._hasExternalMaterial||t(this._material)}},jn=le();var et=class{set visible(t){for(let i of this._visualElements.values())i.attached=t}constructor(t){this.destroyed=!1,this._handles=new Ae,this._messages=null,this._labelSegment=new j;let{analysis:i,computation:n,view:a,messages:o,isDecoration:s}=t;this.analysis=i,this.computation=n,this.view=a,this._messages=o;let l=t.visible,r={view:a,attached:l,isDecoration:s},{fontSize:m,textColor:c,textBackgroundColor:h}=i.style;this._visualElements=new Ot({marker:new Xe(r,t.markerMaterial),dimension:new Z(r,t.dimensionLineMaterial),startOffset:new Z(r,t.offsetLineMaterial),endOffset:new Z(r,t.offsetLineMaterial),dimensionSmall:new Z(r,t.smallDimensionLineMaterial),startOffsetSmall:new Z(r,t.smallOffsetLineMaterial),endOffsetSmall:new Z(r,t.smallOffsetLineMaterial),label:new mi({view:a,attached:l,distance:0,geometry:{type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1},fontSize:x(m),textColor:c.clone(),backgroundColor:h.clone(),isDecoration:s})}),this._handles.add([y(()=>n.geometry,u=>{this.updateCameraDependentElements(a.state.camera,u,i.style),n.geometry!=null&&this._updateLines(n.geometry)},z(w({},J),{equals:ge})),y(()=>n.length,u=>this._updateLabelContent(u),J)])}destroy(){this.destroyed=!0,this._handles=oe(this._handles);for(let t of this._visualElements.values())t.destroy()}get testInfo(){}_updateLines(t){let i=St(Nn,ce.Start,t.directSegment,t.dimensionSegment),n=St(Wn,ce.End,t.directSegment,t.dimensionSegment),a=this._visualElements;a.marker.setGeometryFromSegment(t.dimensionSegment,t.primaryOffsetAxis),a.dimension.setGeometryFromSegment(t.dimensionSegment),a.startOffset.setGeometryFromSegment(i),a.endOffset.setGeometryFromSegment(n),a.dimensionSmall.setGeometryFromSegment(t.dimensionSegment),a.startOffsetSmall.setGeometryFromSegment(i),a.endOffsetSmall.setGeometryFromSegment(n)}updateCameraDependentElements(t,i,n){let a=this._visualElements;if(i==null){for(let P of a.values())P.visible=!1;return}let o=t.computeScreenPixelSizeAt(i.dimensionSegment.eval(.5,qn)),s=ji(i,o),l=s<(x(n.lineSize)*an)**2,r=!l;a.marker.visible=r,a.dimension.visible=r,a.startOffset.visible=r,a.endOffset.visible=r,a.dimensionSmall.visible=l,a.startOffsetSmall.visible=l,a.endOffsetSmall.visible=l;let m=x(n.fontSize)*en,{label:c}=a;if(c.visible=s>=m**2,!c.visible)return;let{dimensionSegment:h,primaryOffsetAxis:u}=i,{offset:_}=this.computation.dimension,v=(Math.sign(_)>=0?1:-1)*Bn(n)*o;Gi(this._labelSegment,h,u,v),c.updateLabelPosition()}updateLabelStyle(t){let{label:i}=this._visualElements;i.fontSize=x(t.fontSize),i.textColor=t.textColor,i.backgroundColor=t.textBackgroundColor}updateUnitsMessages(t){this._messages=t;let{length:i}=this.computation;this._updateLabelContent(i)}_updateLabelContent(t){let{label:i}=this._visualElements;t!=null&&this._messages!=null?i.text=li(this._messages,t,t.unit):i.text=""}};function Bn(e){return 1.5*x(e.fontSize)+Xi+x(e.lineSize/2)}var Nn=new j,Wn=new j,qn=M(),Ot=class{constructor(t){this.marker=t.marker,this.dimension=t.dimension,this.startOffset=t.startOffset,this.endOffset=t.endOffset,this.dimensionSmall=t.dimensionSmall,this.startOffsetSmall=t.startOffsetSmall,this.endOffsetSmall=t.endOffsetSmall,this.label=t.label}values(){return[this.marker,this.dimension,this.startOffset,this.endOffset,this.dimensionSmall,this.startOffsetSmall,this.endOffsetSmall,this.label]}};var W=class extends U{get analysis(){return this.analysisViewData.analysis}get visible(){return this.analysisViewData.visible}constructor(e){super(e),this.loadingMessages=!1,this._messages=null}initialize(){let e=this.isDecoration;this._markerMaterial=new Ue({width:1,anchor:ui.Tip,color:re,placement:"begin-end",worldSpace:!0,hideOnShortSegments:!0,hasTip:!0,renderOccluded:D.OccludeAndTransparent,markerPrimitive:"triangle",isDecoration:e}),this._dimensionLineMaterial=new K({width:1,color:re,renderOccluded:D.OccludeAndTransparent,markerParameters:this._markerMaterial.parameters,isDecoration:e}),this._offsetLineMaterial=new K({width:1,color:re,renderOccluded:D.OccludeAndTransparent,stipplePattern:pe(5),isDecoration:e}),this._smallDimensionLineMaterial=new K({width:1,color:re,renderOccluded:D.OccludeAndTransparent,isDecoration:e}),this._smallOffsetLineMaterial=new K({width:1,color:re,renderOccluded:D.OccludeAndTransparent,stipplePattern:pe(5),isDecoration:e});for(let i of this._lineMaterials())this.view._stage.add(i),this.addHandles(xe(()=>{this.view._stage?.remove(i)}));let t=Y(()=>this.analysisViewData.computations,({computation:i})=>this._createVisualization(i));this._dimensionVisualizations=t,this.addHandles([I(t),y(()=>G.toUnitRGBA(this.analysis.style.color),i=>{for(let n of this._lineMaterials())n.setParameters({color:i})},C),y(()=>this.analysis.style.lineSize,i=>{let n=x(i);this._markerMaterial.setParameters({width:n*Ze}),this._dimensionLineMaterial.setParameters({width:n,markerParameters:this._markerMaterial.parameters});let a=Math.max(n*Qi,1);this._offsetLineMaterial.setParameters({width:a})},C),y(()=>({camera:this.view.state.camera,style:Kn(this.analysis)}),({camera:i,style:n})=>{for(let{visualization:a}of this._dimensionVisualizations)a.updateCameraDependentElements(i,a.computation.geometry,n),a.updateLabelStyle(n)}),y(()=>this.visible,i=>{for(let{visualization:n}of this._dimensionVisualizations)n.visible=i})]),this.addHandles([Rt(()=>this._updateMessageBundle()),se(()=>!this.loadingMessages,()=>{for(let{visualization:i}of this._dimensionVisualizations)i.updateUnitsMessages(this._messages)},ye)]),this._updateMessageBundle()}get testInfo(){}_createVisualization(e){let t=new et({analysis:this.analysis,computation:e,view:this.view,visible:this.visible,markerMaterial:this._markerMaterial,dimensionLineMaterial:this._dimensionLineMaterial,offsetLineMaterial:this._offsetLineMaterial,smallDimensionLineMaterial:this._smallDimensionLineMaterial,smallOffsetLineMaterial:this._smallOffsetLineMaterial,messages:this._messages,isDecoration:this.isDecoration});return{visualization:t,remove:()=>t.destroy()}}_lineMaterials(){return[this._markerMaterial,this._dimensionLineMaterial,this._offsetLineMaterial,this._smallDimensionLineMaterial,this._smallOffsetLineMaterial]}_updateMessageBundle(){return be(this,null,function*(){this.loadingMessages=!0;try{this._messages=yield zt("esri/core/t9n/Units")}finally{this.loadingMessages=!1}})}};function Kn(e){let{fontSize:t,lineSize:i,textColor:n,textBackgroundColor:a}=e.style;return{fontSize:t,lineSize:i,textBackgroundColor:a.clone(),textColor:n.clone()}}p([d({constructOnly:!0})],W.prototype,"analysisViewData",void 0),p([d({constructOnly:!0,nonNullable:!0})],W.prototype,"view",void 0),p([d({constructOnly:!0})],W.prototype,"isDecoration",void 0),p([d()],W.prototype,"analysis",null),p([d()],W.prototype,"visible",null),p([d()],W.prototype,"loadingMessages",void 0),W=p([L("esri.views.3d.analysis.Dimension.DimensionVisualization")],W);var O=class extends U{constructor(e){super(e),this.geometry=null,this.unconstrainedGeometry=null,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}normalizeCtorArgs(e){let n=e,{dimension:t}=n,i=At(n,["dimension"]);return w({result:new Ei({dimension:t})},i)}initialize(){this.addHandles([y(()=>this.dimension.startPoint,e=>this.elevationAlignedStartPoint=this.projectAndAlignPoint(e),C),y(()=>this.dimension.endPoint,e=>this.elevationAlignedEndPoint=this.projectAndAlignPoint(e),C)])}get dimension(){return this.result.dimension}get length(){return this.result.length}};p([d({constructOnly:!0,nonNullable:!0})],O.prototype,"result",void 0),p([d({constructOnly:!0,nonNullable:!0})],O.prototype,"projectAndAlignPoint",void 0),p([d()],O.prototype,"dimension",null),p([d()],O.prototype,"length",null),p([d()],O.prototype,"geometry",void 0),p([d()],O.prototype,"unconstrainedGeometry",void 0),p([d()],O.prototype,"elevationAlignedStartPoint",void 0),p([d()],O.prototype,"elevationAlignedEndPoint",void 0),p([d()],O.prototype,"preConstraintProperties",void 0),p([d()],O.prototype,"previousConstraint",void 0),O=p([L("esri.views.3d.analysis.Dimension.LengthDimensionComputation")],O);var A=class extends Ti(ei(U)){constructor(e){super(e),this.type="dimension-view-3d",this.tool=null,this.selectedDimension=null,this._dimensionsToComputations=new Map,this._placementTask=null,this._projectAndAlignPoint=null}initialize(){this._projectAndAlignPoint=t=>{if(t==null)return null;let{spatialReference:i,elevationProvider:n}=this.view,a=ni(t,i,n);return a==null&&ai(this.analysis,t.spatialReference,Oe.getLogger(this)),a};let e=Y(()=>this.analysis.dimensions,t=>this._createComputation(t));this.computations=e,this.addHandles([Mi(this,b),I(e)]),this._analysisVisualization=new W({analysisViewData:this,view:this.view,isDecoration:!this.parent}),this._analysisController=new ee({analysisViewData:this,view:this.view})}destroy(){this._placementTask=tt(this._placementTask),this._analysisVisualization=oe(this._analysisVisualization),Pi(this)}get updating(){return this._analysisVisualization?.loadingMessages??!1}get results(){return this.analysis.dimensions.map(e=>this._dimensionsToComputations.get(e).result)}get selectedComputation(){let{selectedDimension:e}=this;return e==null?null:this._dimensionsToComputations.get(e)}get testInfo(){}createLengthDimensions(e){return be(this,null,function*(){return this.selectedDimension=null,this._placementTask=tt(this._placementTask),this._placementTask=Si(this,e),this._placementTask.promise})}_createComputation(e){let{_dimensionsToComputations:t}=this,i=new O({dimension:e,projectAndAlignPoint:this._projectAndAlignPoint});return t.set(e,i),{computation:i,remove:()=>this._removeComputation(i)}}_removeComputation(e){let{dimension:t}=e;t===this.selectedDimension&&(this.selectedDimension=null),this._dimensionsToComputations.delete(t),e.destroy()}};p([d({readOnly:!0})],A.prototype,"type",void 0),p([d()],A.prototype,"tool",void 0),p([d()],A.prototype,"updating",null),p([d({readOnly:!0})],A.prototype,"results",null),p([d()],A.prototype,"computations",void 0),p([d()],A.prototype,"selectedDimension",void 0),p([d()],A.prototype,"selectedComputation",null),p([d()],A.prototype,"_analysisVisualization",void 0),p([d()],A.prototype,"_analysisController",void 0),p([d()],A.prototype,"_dimensionsToComputations",void 0),p([d()],A.prototype,"_placementTask",void 0),A=p([L("esri.views.3d.analysis.DimensionAnalysisView3D")],A);var il=A;export{il as default};
