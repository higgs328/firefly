import{b as ge,e as W}from"./chunk-CK7KAXSH.js";import{a as ye}from"./chunk-X2BW2EWB.js";import{a as we}from"./chunk-KDDS5NS6.js";import"./chunk-4D52NPT3.js";import"./chunk-LPHQQI5O.js";import{a as le,b as oe,d as ue,e as pe,f as ce,g as me,h as de,k as fe,m as be,n as B,o as he}from"./chunk-MOUPZWB7.js";import"./chunk-KKRUR76T.js";import{a as _,j as G,k as ne,l as te,s as se,t as I}from"./chunk-TVZYM2NN.js";import"./chunk-TI4UXDNK.js";import"./chunk-YYU4WDV7.js";import"./chunk-U445SEXM.js";import"./chunk-TSQO2JBH.js";import"./chunk-U7H5KNVZ.js";import"./chunk-6ZSOJV5L.js";import"./chunk-D7UZS622.js";import{a as N}from"./chunk-47NA5MWW.js";import"./chunk-IXHKDLZL.js";import"./chunk-PWCKLYPC.js";import"./chunk-7T2VXP7X.js";import{a as w,d as re,e as A,f as ae,g as ie}from"./chunk-GYQWYHEG.js";import{b as ee}from"./chunk-JC4DQSN3.js";import"./chunk-D43YNUSN.js";import"./chunk-QZ7GU4N4.js";import"./chunk-XBSD6EUF.js";import"./chunk-B3VPRADQ.js";import"./chunk-HJQNAAJT.js";import"./chunk-KP75LCOH.js";import"./chunk-ES4WUTEM.js";import"./chunk-BC7GBJHB.js";import"./chunk-WBPLJNRU.js";import"./chunk-EBLTZITF.js";import"./chunk-GUIIGAD3.js";import"./chunk-SFSN6ZUK.js";import"./chunk-5AFOYCWC.js";import"./chunk-Z3MWEX65.js";import{e as Y}from"./chunk-YB6RTOHR.js";import"./chunk-H2NTHPNN.js";import"./chunk-E2J2V7JN.js";import"./chunk-XOMCYIPA.js";import"./chunk-N2JUYKXN.js";import"./chunk-7U52UAO2.js";import"./chunk-NIRJWS2D.js";import"./chunk-H3ZWZZ2B.js";import"./chunk-M3TNQKVJ.js";import"./chunk-KLZGQ7M6.js";import"./chunk-N36GL6VL.js";import"./chunk-UX3QUEDM.js";import"./chunk-YZJDOXQC.js";import"./chunk-6ZY36ZHO.js";import"./chunk-6RHGQ4Z5.js";import"./chunk-G23ELQMS.js";import{a as X,b as j}from"./chunk-PZOK2JKH.js";import{a as U}from"./chunk-FJUYECJ6.js";import{a as C}from"./chunk-2SXWYVJN.js";import{a as T}from"./chunk-ELUASJOG.js";import"./chunk-GAVFKWSK.js";import"./chunk-DK4DGLAO.js";import{t as q}from"./chunk-ZM24RY22.js";import"./chunk-7Y6S2GNA.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-PE276TWH.js";import"./chunk-BMZ3PE5Y.js";import{a as M}from"./chunk-EHG7JRYJ.js";import"./chunk-FNY6LFKI.js";import"./chunk-BBB7KLHV.js";import"./chunk-J2AEVBSH.js";import"./chunk-5ODXFRPI.js";import"./chunk-E5QCV5LT.js";import"./chunk-QS3EYJPF.js";import"./chunk-HJJZ2AXH.js";import"./chunk-TPNSUEHH.js";import"./chunk-SMVNQSZ4.js";import"./chunk-Z2QGLRDB.js";import"./chunk-7IDFDPA3.js";import"./chunk-VL2YL74P.js";import"./chunk-P2AJD2R2.js";import"./chunk-UMJIJLDA.js";import"./chunk-E5NFS3KN.js";import"./chunk-HQHD6BMN.js";import"./chunk-AIKKGGPG.js";import"./chunk-RDGG4TVD.js";import"./chunk-3IQFPOUU.js";import"./chunk-I4CY6X6S.js";import"./chunk-VQ4QGNRX.js";import"./chunk-GNEAU6X4.js";import"./chunk-4KXJ537H.js";import"./chunk-JIRULGDT.js";import"./chunk-QJGOWIJD.js";import"./chunk-QML26MQC.js";import"./chunk-RNZY2XUD.js";import"./chunk-JXPUHKCT.js";import"./chunk-XR5FT7TQ.js";import"./chunk-4YTM754S.js";import"./chunk-LAX5536Z.js";import"./chunk-N3HRYLNW.js";import"./chunk-4DBMALZW.js";import"./chunk-CVWWHM2V.js";import"./chunk-6OQYVEQJ.js";import"./chunk-YOXOWGT6.js";import"./chunk-EFZOSMYP.js";import"./chunk-WI7F4ZKJ.js";import"./chunk-MJ7M24NH.js";import"./chunk-GJH4QFRX.js";import"./chunk-T63F7663.js";import"./chunk-O4V2VBSK.js";import"./chunk-5TKRKB5E.js";import"./chunk-XAGMDNNR.js";import"./chunk-OP2TLIUN.js";import"./chunk-T2THIR6K.js";import"./chunk-LORHDXEB.js";import"./chunk-BBBPJI4H.js";import"./chunk-45BTW5EG.js";import"./chunk-TPFBHGDM.js";import"./chunk-73NLRHJD.js";import"./chunk-PNFEUBDF.js";import"./chunk-6RCCEJDL.js";import"./chunk-PQ2TNDUX.js";import"./chunk-6X6MKRQ3.js";import"./chunk-FQFHMHYU.js";import"./chunk-SZMEI3WL.js";import"./chunk-KKVGD67U.js";import"./chunk-MYOJWRDU.js";import"./chunk-L7UKJKHG.js";import"./chunk-V2IENAEU.js";import"./chunk-QAGQFNF2.js";import"./chunk-SY7JS2VW.js";import"./chunk-WK57SDN6.js";import"./chunk-AG4V3ZUO.js";import"./chunk-YWLMJ26A.js";import"./chunk-QAWNU3UJ.js";import"./chunk-HRQT4R6X.js";import"./chunk-44BHLWQ4.js";import"./chunk-5BPM64SU.js";import"./chunk-PMVHHMQJ.js";import"./chunk-NAFOM5UA.js";import"./chunk-DO7UF2F2.js";import"./chunk-ZTR6OS44.js";import"./chunk-VRTKAD2J.js";import"./chunk-DBLKLHK2.js";import"./chunk-UTE3ASAZ.js";import"./chunk-2AFEAPEX.js";import"./chunk-GNGXUEWV.js";import"./chunk-QBI5NDCA.js";import"./chunk-NOHW2DKR.js";import"./chunk-HVJAAM3A.js";import"./chunk-ACPEJEHK.js";import"./chunk-I7B3LWNP.js";import"./chunk-YP2E5N4E.js";import"./chunk-QLMNLSCT.js";import"./chunk-P55G5ATK.js";import"./chunk-JT3K52KQ.js";import"./chunk-SPLEGG4R.js";import"./chunk-Y4TJDUGP.js";import"./chunk-6PAFOJ4W.js";import"./chunk-74SDGE57.js";import"./chunk-FRXWHX3T.js";import"./chunk-DTDQ5X42.js";import"./chunk-RX2HFR4X.js";import"./chunk-AZW7YPTQ.js";import"./chunk-NJLJX4X6.js";import"./chunk-DZHFTD24.js";import"./chunk-K57Z4J34.js";import"./chunk-VWG3KVOU.js";import"./chunk-JOEUVLAN.js";import"./chunk-JZQDGIDQ.js";import"./chunk-CZ6CGC7I.js";import"./chunk-7B6U3N62.js";import"./chunk-46WDO5LS.js";import"./chunk-G5EYK5KM.js";import"./chunk-YJKJQU3F.js";import"./chunk-OK4K3OQT.js";import"./chunk-BPWNCOXC.js";import"./chunk-VNS4CQ27.js";import{a as Q}from"./chunk-AVMO6LCR.js";import"./chunk-TEGPMVWT.js";import"./chunk-CLQRQC3Y.js";import"./chunk-KSNU73LO.js";import"./chunk-FACEVGRE.js";import"./chunk-5XTCPT52.js";import"./chunk-72MRWGPJ.js";import"./chunk-2GF6YDKP.js";import"./chunk-DDZ3KR2Q.js";import"./chunk-R3XLNYYB.js";import"./chunk-2HYVVLKS.js";import"./chunk-XRTA5GHC.js";import"./chunk-Y6XW36QP.js";import"./chunk-ZXKU6WBY.js";import"./chunk-RBVFFAW6.js";import"./chunk-XQOE7Z4Q.js";import"./chunk-BMYVPMAK.js";import{a as y}from"./chunk-6F25LG6O.js";import"./chunk-6KRFVLII.js";import"./chunk-EDZQZA57.js";import"./chunk-V6AA2XHK.js";import"./chunk-25WBXAEY.js";import"./chunk-7QY3BMVN.js";import"./chunk-Y7GY5YIF.js";import"./chunk-LMGYHZE3.js";import"./chunk-5LG2P6MT.js";import"./chunk-GJ2QRXGN.js";import"./chunk-EM35R6FY.js";import"./chunk-QXXXCEV5.js";import"./chunk-TJ6P6NLD.js";import"./chunk-NX5B6XBR.js";import"./chunk-2JABY6DU.js";import"./chunk-MPRKSQLC.js";import"./chunk-57TARQ4F.js";import"./chunk-6RBQSBA2.js";import"./chunk-Z42K5ECK.js";import"./chunk-NVTU6MJO.js";import"./chunk-56M6LBCJ.js";import"./chunk-HZK6UIET.js";import"./chunk-T2RV3ABV.js";import"./chunk-CSNRCIB5.js";import"./chunk-6FW4T2SJ.js";import"./chunk-4ZVBFHBA.js";import"./chunk-3JGYBNJA.js";import"./chunk-DA3SDKGO.js";import"./chunk-ZOEPYNM4.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-BJH4F4SM.js";import"./chunk-Z3RBZHAK.js";import"./chunk-F4XWARLZ.js";import{l as H}from"./chunk-IO35PPBL.js";import{g as Z}from"./chunk-F5AJITOA.js";import"./chunk-IHATPE6U.js";import"./chunk-PU4AK46X.js";import"./chunk-3CLJ5OX5.js";import"./chunk-E6C7G5SC.js";import"./chunk-73K3NWCV.js";import"./chunk-SP2CO3KX.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-FYZRIMPP.js";import"./chunk-ZC6EBRE4.js";import"./chunk-ZAZJB7CV.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-QKO56XO6.js";import"./chunk-JRGT3GTH.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-VV5G7VY5.js";import{c as K}from"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-POX73EYJ.js";import"./chunk-NKUXRYJG.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-O3EGNJTY.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-WTB3O6DJ.js";import"./chunk-7P44K2YD.js";import"./chunk-32OAXCA4.js";import{b as k}from"./chunk-UST6HCE7.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import{b as d}from"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import{y as J}from"./chunk-QBWJMFH5.js";import{a as x,b as L,f as z}from"./chunk-VTHXE323.js";var D=[w.CSVLayer,w.FeatureLayer,w.GeoJSONLayer,w.KnowledgeGraphSublayer,w.OGCFeatureLayer,w.OrientedImageryLayer,w.ParquetLayer,w.StreamLayer,w.WFSLayer];function ve(e){return z(this,null,function*(){if(!(e?.layer&&e.view&&e.attributes?.length))throw new d("pie-chart-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>10)throw new d("pie-chart-renderer:invalid-parameters","PieChart renderer does not support more than 10 attributes");e.forBinning&&ee(e,"pie-chart-renderer");let r=L(x({},e),{layer:e.layer,view:e.view,attributes:e.attributes});r.shape=r.shape||"pie",r.othersCategoryEnabled??=!0,r.includeSizeVariable=e.includeSizeVariable||!1;let a=e.forBinning?re:D,n=ie(r.layer,a,e.forBinning);if(!n)throw new d("pie-chart-renderer:invalid-parameters","'layer' must be one of these types: "+A(a).join(", "));let i=r.signal!=null?{signal:r.signal}:null;yield Promise.all([e.view.when(),n.load(i)]);let t=n.geometryType,o=t==="polygon",f=t==="point"||t==="multipoint"||o;if(r.outlineOptimizationEnabled=!!o&&r.outlineOptimizationEnabled,r.sizeOptimizationEnabled=!!f&&r.sizeOptimizationEnabled,!f)throw new d("pie-chart-renderer:not-supported","PieChart renderer is only supported for point and polygon layers");let u=[],p=r.attributes;for(let m of p){let s=yield Z({field:m.field,valueExpression:m.valueExpression});u.push(...s)}let b=te(n,u.filter(Boolean),"pie-chart-renderer:invalid-parameters");if(b)throw b;return L(x({},r),{layer:n})})}function Oe(e){return z(this,null,function*(){let r="regenerate-pie-chart-renderer";yield le(e,r);let a=yield oe(e);if(ue(a)!=="pie-chart")throw new d(`${r}:invalid-parameters`,"Renderer is invalid");let{visualVariables:n}=a,{layer:i,forBinning:t,filter:o,view:f,signal:u}=e,p=pe(a),b=ce(a),m=n?.some(be),s=a.attributes.map(c=>({field:c.field,label:c.label,valueExpression:c.valueExpression,valueExpressionTitle:c.valueExpressionTitle})),l=yield ve({layer:i,attributes:s,outlineOptimizationEnabled:p,sizeOptimizationEnabled:b,includeSizeVariable:m,forBinning:t,filter:o,view:f,signal:u});return L(x({},e),{creatorParameters:l,renderer:a})})}function Se(e){return z(this,null,function*(){let r=e.pieChartScheme,a=null,n=null,i=yield se(e.basemap,e.view);if(a=i.basemapId!=null?i.basemapId:null,n=i.basemapTheme!=null?i.basemapTheme:null,r)return{scheme:W(r),basemapId:a,basemapTheme:n};let t=ge({numColors:e.attributes.length,geometryType:e.layer.geometryType,basemapTheme:n});return t&&(r=t.primaryScheme,a=t.basemapId,n=t.basemapTheme),{scheme:r,basemapId:a,basemapTheme:n}})}function ze(e,r){return z(this,null,function*(){let{valueExpression:a,sqlExpression:n,sqlWhere:i}=H(e.attributes),t=yield k("esri/smartMapping/t9n/smartMapping");return ye({layer:e.layer,basemap:e.basemap,valueExpression:a,sqlExpression:n,sqlWhere:i,sizeScheme:r,sizeOptimizationEnabled:e.sizeOptimizationEnabled,legendOptions:{title:t.sumOfCategories},view:e.view,signal:e.signal})})}function cr(e){return z(this,null,function*(){let[r,a]=yield Promise.all([ve(e),k("esri/smartMapping/t9n/smartMapping")]),n=yield Se(r),i=n?.scheme;if(!i)throw new d("pie-chart-renderer:insufficient-info","Unable to find pie-chart scheme");let{layer:t,includeSizeVariable:o,sizeOptimizationEnabled:f,outlineOptimizationEnabled:u,view:p,signal:b,filter:m}=r,s=i.sizeScheme,l=r.attributes,c=l.map(h=>h.field).filter(J),[g,V,v,$]=yield Promise.all([c.length>1?we({layer:t,fields:c,view:p,signal:b,filter:m}):null,o?ze(r,s):null,!o&&f?N({layer:t,view:p,signal:b,filter:m}).catch(I):null,u?_({layer:t,view:p,signal:b,filter:m}).catch(I):null]),Ce=g?.predominantCategoryInfos?{uniqueValueInfos:g.predominantCategoryInfos}:{uniqueValueInfos:c.map(h=>({value:h,count:0}))},Ie=q(i.colors,l.length),$e=l.map((h,E)=>new U({field:h.field,valueExpression:h.valueExpression,label:h.label,valueExpressionTitle:h.valueExpressionTitle,color:Ie[E]})),O=t.geometryType,R=s!=null&&"background"in s&&s.background,S=new j({attributes:$e,othersCategory:new X({label:a.other,color:r.othersCategoryEnabled?i.colorForOthersCategory:null,threshold:.04}),holePercentage:r.shape==="donut"?.45:0,backgroundFillSymbol:R?ne(O,{type:"2d",color:R.color,outline:G(R,O,$?.opacity)}):null,size:K(i.size),outline:new Q(G(i,"point",$?.opacity)),legendOptions:M.from(r.legendOptions)});if(V&&(Ve(V,f,O),S.authoringInfo=V.authoringInfo.clone(),S.visualVariables=V.visualVariables?.map(h=>h.clone())),$?.visualVariables?.length){let h=$.visualVariables.map(E=>E.clone()).filter(E=>E.type!=="color"&&E.type!=="rotation");S.visualVariables?S.visualVariables.push(...h):S.visualVariables=h}return v?.minSize&&(Ee(v,O),S.visualVariables?S.visualVariables.push(v.minSize):S.visualVariables=[v.minSize]),{renderer:S,pieChartScheme:W(i),size:V,basemapId:n.basemapId,basemapTheme:n.basemapTheme,statistics:Ce}})}function mr(e){return z(this,null,function*(){let{creatorParameters:r,view:a,signal:n,filter:i,renderer:t}=yield Oe(e),{layer:o,outlineOptimizationEnabled:f,includeSizeVariable:u,sizeOptimizationEnabled:p}=r,b=yield Se(r),m=b?.scheme?.sizeScheme,[s,l,c]=yield Promise.all([f?_({layer:o,view:a,signal:n,filter:i}).catch(I):null,u?ze(r,m):null,!u&&p?N({layer:o,view:a,signal:n,filter:i}).catch(I):null]),g=o.geometryType;if(l&&(Ve(l,p,g),B(t,l?.visualVariables,de),he(t,l?.authoringInfo,"size")),s?.visualVariables?.length){let V=s.visualVariables.map(v=>v.clone()).filter(v=>v.type!=="color"&&v.type!=="rotation");B(t,V,me)}return c?.minSize&&(Ee(c,g),B(t,c?.minSize,fe)),{renderer:t}})}function Ve(e,r,a){r||e.visualVariables.forEach(n=>{typeof n.minSize=="number"&&typeof n.maxSize=="number"&&(n.minSize*=2.5,n.maxSize*=1.8)}),r&&a==="point"&&e.visualVariables.forEach(n=>{n?.minSize&&typeof n.minSize=="object"&&n.minSize?.stops?.forEach(i=>{i.size*=1.8})})}function Ee(e,r){r==="point"&&e.minSize.stops?.forEach(a=>{a.size*=2.5}),r==="polygon"&&e.minSize.stops?.forEach(a=>{a.size*=1.8})}var Le=new Set(["unique-value","class-breaks"]),ke=new y("#aaaaaa"),xe=new y("#5c5c5c"),Te=[new y("#e60049"),new y("#0bb4ff"),new y("#50e991"),new y("#e6d800"),new y("#9b19f5"),new y("#ffa300"),new y("#dc0ab4"),new y("#b3d4ff"),new y("#00bfa0"),new y("#f0cccc")];function qe(e){return z(this,null,function*(){if(!e||!e.layer)throw new d("pie-chart-cluster-renderer:missing-parameters","'layer' parameter is required");let r=x({},e);r.shape=r.shape||"pie",r.defaultSymbolEnabled??=!0;let a=e.layer;if(!ae(D).includes(a.type))throw new d("pie-chart-cluster-renderer:invalid-parameters","'layer' must be one of these types: "+A(D).join(", "));let n=r.signal!=null?{signal:r.signal}:null;if(yield a.load(n),a.geometryType!=="point")throw new d("pie-chart-cluster-renderer:invalid-parameters","Cluster renderers are only supported for point layers");let i="renderer"in a?a.renderer:void 0;if(!i)throw new d("pie-chart-cluster-renderer:invalid-parameters","input layer does not have a renderer.");if(!Le.has(i.type))throw new d("pie-chart-cluster-renderer:invalid-parameters",`Cannot create a pie chart renderer for clusters based on a ${i.type} renderer.`);if("valueExpression"in i&&i.valueExpression)throw new d("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a layer whose renderer contains a valueExpression.");if(i.type==="unique-value"){if(i.field2)throw new d("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a UniqueValueRenderer using more than one field.");if(i.uniqueValueInfos!=null&&i.uniqueValueInfos.length>10)throw new d("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer cannot be created from a UniqueValueRenderer with more than 10 unique value infos.")}if(i.type==="class-breaks"){if(i.classBreakInfos.length<2)throw new d("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a layer renderer with a continuous color or size gradient.");if(i.classBreakInfos.length>10)throw new d("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer can not be created from a ClassBreaksRenderer with more than 10 class break infos.");if(i?.authoringInfo?.type==="class-breaks-size")throw new d("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer can not be created from a ClassBreaksRenderer with breaks varied by size instead of color.")}return r})}function dr(e){return z(this,null,function*(){let r=yield qe(e),{layer:a,shape:n,defaultSymbolEnabled:i,legendOptions:t}=r,o="renderer"in a?a.renderer:void 0,f=(yield k("esri/smartMapping/t9n/smartMapping")).other,u=[];o?.type==="unique-value"&&(u=Be({renderer:o,defaultSymbolEnabled:i,defaultLabelBackup:f})),o?.type==="class-breaks"&&(u=Pe({renderer:o,defaultSymbolEnabled:i,defaultLabelBackup:f}));let p=[],b=[];for(let m of u){let{field:s,color:l}=m;p.push(s),b.push(new U({color:l,field:s.name,label:s.alias}))}return{fields:p,renderer:new j({attributes:b,legendOptions:M.from(t),holePercentage:n==="donut"?.45:0,outline:null,size:9,othersCategory:null})}})}function Be(e){let{renderer:r,defaultSymbolEnabled:a,defaultLabelBackup:n}=e,{field:i,defaultSymbol:t,defaultLabel:o}=r,f=r.uniqueValueInfos??[],u=t&&a,p=u?9:10,b=q(Te,p),m=(i?f.slice(0,p).map((s,l)=>{let c=s.label,g=b[l];return{field:new C({name:P(s.value?.toString()),alias:c,onStatisticExpression:new T({title:`Field definition - ${c}`,expression:Fe(i,s),returnType:"number"}),statisticType:"sum"}),color:F(s.symbol,g)}}):null)??[];if(u){let s="cluster_default",l=o||n;m.push({field:new C({name:P(s),alias:l,onStatisticExpression:new T({title:`Field definition - ${l}`,expression:Re(i,f),returnType:"number"}),statisticType:"sum"}),color:F(t,xe)})}return m}function Pe(e){let{renderer:r,defaultSymbolEnabled:a,defaultLabelBackup:n}=e,{field:i,classBreakInfos:t,defaultSymbol:o,defaultLabel:f}=r,u=o&&a,p=u?9:10,b=q(Te,p),m=t.slice(0,p).map((s,l)=>{let c=s.label||`${s.minValue} - ${s.maxValue}`,g=b[l];return{field:new C({name:P(c),alias:c,onStatisticExpression:new T({title:`Field definition - ${c}`,expression:Me(i,s),returnType:"number"}),statisticType:"sum"}),color:F(s.symbol,g)}});if(u){let s="cluster_default",l=f||n;m.push({field:new C({name:P(s),alias:l,onStatisticExpression:new T({title:`Field definition - ${l}`,expression:Ue(i,t),returnType:"number"}),statisticType:"sum"}),color:F(o,xe)})}return m}function P(e){return"SUM_"+(e+"").replaceAll(/[^a-zA-Z0-9_]/g,"_")}function F(e,r){if(e?.type==="simple-marker"&&e.color)return e.color.clone();if(e?.type==="cim"){let a=Y(e);if(a)return a.clone()}return r?r.clone():ke.clone()}function Fe(e,r){return`Number(Text($feature["${e}"]) == "${r.value+""}")`}function Re(e,r){return`Number(!(${r.map(a=>`(Text($feature["${e}"]) == "${a.value+""}")`).join(" || ")}))`}function Me(e,r){return`Number($feature["${e}"] >= ${r.minValue} && $feature["${e}"] < ${r.maxValue})`}function Ue(e,r){return`Number(!(${r.map(a=>`($feature["${e}"] >= ${a.minValue} && $feature["${e}"] < ${a.maxValue})`).join(" || ")}))`}export{cr as createRenderer,dr as createRendererForClustering,mr as regenerateRenderer};
