import{a as ue}from"./chunk-2UKYPYIL.js";import{a as ne,b as ce}from"./chunk-5C7K2G4S.js";import{a as te,b as ae,c as re,d as oe,e as ie,f as se,g as O}from"./chunk-3HZYMAA2.js";import{a as le}from"./chunk-4A4DMQSS.js";import{d as D,e as N,f as z,g as Q,h as ee,i as I}from"./chunk-5AFOYCWC.js";import{a as K,c as V}from"./chunk-Z3MWEX65.js";import{a as B}from"./chunk-YHWE4TIZ.js";import{g as J}from"./chunk-XR5FT7TQ.js";import{b as P}from"./chunk-KMMTNF7G.js";import{b as A}from"./chunk-OLOKUDVI.js";import{a as p}from"./chunk-5XCFNEYX.js";import{e as $,g as Z}from"./chunk-FB4M3WPV.js";import{a as S,b as M,f as T}from"./chunk-VTHXE323.js";var me="esri-relationship-ramp",x=`${me}--diamond`,R=`${me}--square`,Re="http://www.w3.org/2000/svg",h={diamondContainer:`${x}__container`,diamondLeftCol:`${x}__left-column`,diamondRightCol:`${x}__right-column`,diamondMidCol:`${x}__middle-column`,diamondMidColLabel:`${x}__middle-column--label`,diamondMidColRamp:`${x}__middle-column--ramp`,squareTable:`${R}__table`,squareTableRow:`${R}__table-row`,squareTableCell:`${R}__table-cell`,squareTableLabel:`${R}__table-label`,squareTableLabelLeftBottom:`${R}__table-label--left-bottom`,squareTableLabelRightBottom:`${R}__table-label--right-bottom`,squareTableLabelLeftTop:`${R}__table-label--left-top`,squareTableLabelRightTop:`${R}__table-label--right-top`};function pe(l,e,t={}){let{focus:i,labels:r}=l,a=!!i,o=He(l,e,t),u={justifyContent:"center"},m=Z(),b=t.key??e;return a?p("div",{class:h.diamondContainer,key:`${b}-container`,styles:u},p("div",{class:h.diamondLeftCol},m?r.right:r.left),p("div",{class:h.diamondMidCol},p("div",{class:h.diamondMidColLabel},r.top),o,p("div",{class:h.diamondMidColLabel},r.bottom)),p("div",{class:h.diamondRightCol},m?r.left:r.right)):p("div",{class:h.squareTable,key:`${b}-container`},p("div",{class:h.squareTableRow},p("div",{class:$(h.squareTableCell,h.squareTableLabel,h.squareTableLabelRightBottom)},m?r.top:r.left),p("div",{class:h.squareTableCell}),p("div",{class:$(h.squareTableCell,h.squareTableLabel,h.squareTableLabelLeftBottom)},m?r.left:r.top)),p("div",{class:h.squareTableRow},p("div",{class:h.squareTableCell}),o,p("div",{class:h.squareTableCell})),p("div",{class:h.squareTableRow},p("div",{class:$(h.squareTableCell,h.squareTableLabel,h.squareTableLabelRightTop)},m?r.right:r.bottom),p("div",{class:h.squareTableCell}),p("div",{class:$(h.squareTableCell,h.squareTableLabel,h.squareTableLabelLeftTop)},m?r.bottom:r.right)))}function fe(l,e,t){let i=`${t}_arrowStart`,r=`${t}_arrowEnd`,a=l==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":a?o.markerStart=`url(#${r})`:o.markerEnd=`url(#${i})`;break;case"LL":o.markerStart=`url(#${r})`;break;case"LH":a?o.markerEnd=`url(#${i})`:o.markerStart=`url(#${r})`;break;default:o.markerEnd=`url(#${i})`}return o}function He(l,e,t={}){let{focus:i,numClasses:r,colors:a,rotation:o}=l,{opacity:u,effectList:m,ariaLabel:b}=t,c=t.size??60,f=!!i,s=Math.sqrt(c**2+c**2)+(f?0:5),d=[],n=[],y=[],g=(c||75)/r;for(let F=0;F<r;F++){let Se=F*g;for(let E=0;E<r;E++){let ve=E*g,U=ae(a[F][E]),Ce=re(null),X={type:"rect",x:ve,y:Se,width:g,height:g},j=oe(U);j&&d.push(j);let Y=te(X,U.fill,Ce,null);Y&&n.push(Y),y.push(ie(X))}}let k=15,w=15,L=10,v=null;f||(v="margin: -15px -15px -18px -15px");let C=fe("left",i,e),H=fe("right",i,e),G=se(y),Le=O(G,s,s,0,!1,o,!1),we=O(G,s,s,0,!1,f?-45:null,!1),ke={filter:I(m)??void 0,opacity:u==null?"":`${u}`};return p("div",{class:f?h.diamondMidColRamp:h.squareTableCell,styles:ke},p("svg",{"aria-label":b,focusable:!1,height:s,role:"image",style:v,width:s,xmlns:Re},p("defs",null,p("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},p("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),p("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},p("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),d),p("g",{transform:Le},n),p("g",{transform:we},p("line",{fill:"none","marker-end":C.markerEnd,"marker-start":C.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:c-k,y2:k}),p("line",{fill:"none","marker-end":H.markerEnd,"marker-start":H.markerStart,stroke:"#555555","stroke-width":"1",x1:w,x2:c-w,y1:c+L,y2:c+L}))))}var be={HH:315,HL:45,LL:135,LH:225},Me={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function Te(l){if(!l)return;let{type:e}=l;if(e.includes("3d"))return ue(l.symbolLayers.at(0));if(e==="simple-line"){let t=V(l);return t&&t.color}if(l.type==="simple-marker"&&(l.style==="x"||l.style==="cross")){let t=V(l);return t&&t.color}return K(l)}function xe(l,e){let t=e.HH.label,i=e.LL.label,r=e.HL.label,a=e.LH.label;switch(l){case"HH":default:return{top:t,bottom:i,left:r,right:a};case"HL":return{top:r,bottom:a,left:i,right:t};case"LL":return{top:i,bottom:t,left:a,right:r};case"LH":return{top:a,bottom:r,left:t,right:i}}}function de(l){let{focus:e,infos:t,numClasses:i}=l,r=Me[i],a={};t.forEach(u=>{a[u.value]={label:u.label,fill:Te(u.symbol)}});let o=[];for(let u=0;u<i;u++){let m=[];for(let b=0;b<i;b++){let c=a[r[u][b]];m.push(c.fill)}o.push(m)}return{type:"relationship-ramp",numClasses:i,focus:e,colors:o,labels:xe(e,a),rotation:qe(e)}}function qe(l){let e=be[l];return l&&e==null&&(e=be.HH),e||0}var q=null,he=[255,255,255];function ye(l,e){return Math.floor(Math.random()*(e-l+1)+l)}function el(l,e,t){let{backgroundColor:i,outline:r,dotSize:a}=l,o=t?.swatchSize||le.size,u=.8,m=Math.round(o*o/Math.max(a,.5)**2*u),b=window.devicePixelRatio,c=document.createElement("canvas"),f=o*b;c.width=f,c.height=f,c.style.width=c.width/b+"px",c.style.height=c.height/b+"px";let s=c.getContext("2d");if(i&&(s.fillStyle=i.toCss(!0),s.fillRect(0,0,f,f),s.fill()),s.fillStyle=e?.toCss(!0)??"",q&&q.length/2===m)for(let n=0;n<2*m;n+=2){let y=q[n],g=q[n+1];s.fillRect(y,g,a*b,a*b),s.fill()}else{q=[];for(let n=0;n<2*m;n+=2){let y=ye(0,f),g=ye(0,f);q.push(y,g),s.fillRect(y,g,a*b,a*b),s.fill()}}r&&(r.color&&(s.strokeStyle=r.color.toCss(!0)),s.lineWidth=r.width,s.strokeRect(0,0,f,f));let d=new Image(o,o);return d.src=c.toDataURL(),d.ariaLabel=t?.ariaLabel??null,d.alt=t?.ariaLabel??"",d}function ll(l,e={}){let t=e.radius||40,i=2*Math.PI*t,r=l.length,a=i/r,o=[],u=V(e.outline);u?.width!=null&&(u.width*=2),(u||e.backgroundColor)&&o.push({shape:{type:"circle",cx:t,cy:t,r:t},fill:e.backgroundColor,stroke:u,offset:[0,0]});let m=e.values,b=m&&m.length===r&&m.reduce((n,y)=>n+y,0)===100,c=[0];for(let n=0;n<r;n++){let y=null;b&&(y=m[n]*i/100,c.push(y+c[n])),o.push({shape:{type:"circle",cx:t,cy:t,r:t/2},fill:[0,0,0,0],stroke:{width:t,dashArray:`${(y??a)/2} ${i}`,dashoffset:"-"+(b?c[n]/2:n*(a/2)),color:l[n]},offset:[0,0]})}let f=null,s=2*t+(u?.width||0),d=e.holePercentage;if(d){u&&o.push({shape:{type:"circle",cx:t,cy:t,r:t*d},fill:null,stroke:u,offset:[0,0]});let n=s/2;f=[[{shape:{type:"circle",cx:n,cy:n,r:n},fill:he,stroke:u?M(S({},u),{color:he}):null,offset:[0,0]},{shape:{type:"circle",cx:n,cy:n,r:t*d},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return ce([o],[s,s],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:f,rotations:[-90],ariaLabel:e.ariaLabel})}function tl(l,e={}){let t=l?.authoringInfo;if(t?.type!=="relationship"||!t?.numClasses||!l.uniqueValueInfos)return null;let{focus:i,numClasses:r}=t,a=de({focus:i,numClasses:r,infos:l.uniqueValueInfos}),o=e?.node||document.createElement("div");return ne(o,()=>pe(a,e.id||"relationship",{opacity:e.opacity||1,effectList:e.effectList,ariaLabel:e.ariaLabel})),o}function al(l,e={}){let r=e.align==="horizontal",a=r?75:24,o=r?24:75,u=e.width??a,m=e.height??o,b=e.gradient??!0,c=window.devicePixelRatio,f=u*c,s=m*c,d=document.createElement("canvas");d.width=f,d.height=s,d.ariaLabel=e.ariaLabel??null,d.style.width=`${u}px`,d.style.height=`${m}px`;let n=d.getContext("2d"),y=r?f:0,g=r?0:s;if(b){let w=n.createLinearGradient(0,0,y,g),L=l.length,v=L===1?0:1/(L-1);l.forEach((C,H)=>w.addColorStop(H*v,C.toString())),n.fillStyle=w,n.fillRect(0,0,f,s)}else{let w=r?f/l.length:f,L=r?s:s/l.length,v=0,C=0;for(let H of l)n.fillStyle=H.toString(),n.fillRect(v,C,w,L),v=r?v+w:0,C=r?0:C+L}let k=document.createElement("div");return k.style.width=`${u}px`,k.style.height=`${m}px`,$e(k,e?.effectList),k.appendChild(d),k}function $e(l,e){if(!e)return;l.style.filter=I(e);let t=e.effects;if(t){for(let i of t)if(i?.type==="drop-shadow"){i.offsetX<0?l.style.marginLeft=`${Math.abs(i.offsetX)}px`:l.style.marginRight=`${i.offsetX}px`;break}}}function ge(l,e){return T(this,null,function*(){switch(l.type){case"web-style":{let{previewWebStyleSymbol:t}=yield import("./chunk-I7KXHVOY.js");return t(l,ge,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{let{previewSymbol3D:t}=yield import("./chunk-CZMMOBZN.js");return t(l,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{let{previewSymbol2D:t}=yield import("./chunk-RSTAW37I.js");return t(l,e)}case"cim":{let{previewCIMSymbol:t}=yield import("./chunk-PFTOLKU2.js");return t(l,e)}default:return}})}function W(l){return l&&"opacity"in l?l.opacity*W(l.parent):1}function Ve(l,e){return T(this,null,function*(){if(!l)return;let t=l.sourceLayer,i=(e!=null&&e.useSourceLayer?t:l.layer)??t,r=e?.ignoreOpacity?1:W(i);if(l.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){let L=l.symbol.type==="web-style"?yield l.symbol.fetchSymbol(M(S({},e),{acceptedFormats:["web","cim"],cache:e!=null?e.webStyleCache:null})):l.symbol.clone();return z(L,null,r),L}let a=e?.renderer??_(i),o=a&&"getSymbolAsync"in a?yield a.getSymbolAsync(l,e):null;if(!o)return;if(o=o.type==="web-style"?yield o.fetchSymbol(M(S({},e),{cache:e!=null?e.webStyleCache:null})):o.clone(),!a||!("visualVariables"in a)||!a.visualVariables?.length)return z(o,null,r),o;if("arcadeRequiredForVisualVariables"in a&&a.arcadeRequiredForVisualVariables&&e?.arcade==null){let L=S({},e);L.arcade=yield P(),e=L}let{getColor:u,getOpacity:m,getAllSizes:b,getRotationAngle:c}=yield import("./chunk-R45N3IFT.js"),f=[],s=[],d=[],n=[];for(let L of a.visualVariables)switch(L.type){case"color":f.push(L);break;case"opacity":s.push(L);break;case"rotation":n.push(L);break;case"size":L.target||d.push(L)}let y=!!f.length&&f[f.length-1],g=y?u(y,l,e):null,k=!!s.length&&s[s.length-1],w=k?m(k,l,e):null;if(r!=null&&(w=w!=null?w*r:r),e?.ignoreOpacity&&(w=1),z(o,g,w),d.length&&e?.ignoreSizeVariables!==!0){let L=b(d,l,e);yield Q(o,L)}if(e?.ignoreRotationVariables!==!0)for(let L of n)ee(o,c(L,l,e),L.axis);return o})}function rl(l,e){return T(this,null,function*(){if(!l)return;let{layer:t,sourceLayer:i}=l,r=W(t??i);if(l.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){let g=l.symbol.type==="web-style"?yield l.symbol.fetchSymbol(M(S({},e),{acceptedFormats:B})):l.symbol.clone();return D(g,r)}let a=e?.renderer??_(t)??_(i),o=a&&"getSymbolAsync"in a?yield a.getSymbolAsync(l,e):void 0;if(!o)return;o=o.type==="web-style"?yield o.fetchSymbol(M(S({},e),{acceptedFormats:B})):o.clone();let u=D(o,r);if(!a||!("visualVariables"in a)||"visualVariables"in a&&!a.visualVariables||"visualVariables"in a&&!a.visualVariables?.length)return u;if("arcadeRequiredForVisualVariables"in a&&a.arcadeRequiredForVisualVariables&&e?.arcade==null){let g=S({},e);g.arcade=yield P(),e=g}let{getColor:m,getOpacity:b}=yield import("./chunk-R45N3IFT.js"),c=[],f=[];if(a.visualVariables)for(let g of a.visualVariables)switch(g.type){case"color":c.push(g);break;case"opacity":f.push(g)}let s=c.length>0?c[c.length-1]:null,d=s?m(s,l,e):u,n=f.length>0?f[f.length-1]:null,y=n?b(n,l,e):null;return r!=null&&(y=y!=null?y*r:r),d?N(d,y):null})}function _(l){if(l)return"renderer"in l?l.renderer:void 0}function ol(l,e,t){return T(this,null,function*(){if(!l)return;let{layer:i,sourceLayer:r}=l,a=t?.renderer??_(i)??_(r);if(!a)return null;if("visualVariables"in a&&a.visualVariables?.length){let{getRampStops:o}=yield import("./chunk-557FMSW7.js"),{getRampStops:u}=yield import("./chunk-4OU2LMIN.js"),{getDateFormatOptions:m}=yield import("./chunk-VSTR34BJ.js"),b=null;for(let c of a.visualVariables){let f=e?m(i,c,e.timeZone):null,s=null;switch(c.type){case"color":s=yield o(c,null,f);break;case"opacity":s=yield o(c);break;case"size":c.target||(s=yield u(a,c,null,t?.scale||e?.scale,e,f))}if(s?.length){let d=s.find((n,y)=>{let g=l.attributes[c.field];return y===0?g>=n.value:y===s?.length-1?g<=n.value:n.value===g});if(d){b=d.label;break}}}if(b)return b}switch(a.type){case"class-breaks":{let o="getClassBreakInfo"in a?yield a.getClassBreakInfo(l,t):null;return o?.label??(o&&a.classBreakInfos?.length>1)?`${o.minValue} - ${o.maxValue}`:null}case"unique-value":return("getUniqueValueInfo"in a?yield a.getUniqueValueInfo(l,t):null)?.label}return null})}function il(l,e){return T(this,null,function*(){l?.layer&&J(l.layer)&&((l=l.cloneShallow()).layer=l.layer.findSublayerForFeature(l)??null);let t=l===null?e?.fallbackSymbol??null:(yield Ve(l,{ignoreGraphicSymbol:!!l.layer,ignoreOpacity:e?.ignoreOpacity??!0,ignoreRotationVariables:e?.ignoreRotationVariables??!0,ignoreSizeVariables:e?.ignoreSizeVariables??!0}))??e?.fallbackSymbol??null;if(!t)return null;let i=yield ge(t,S({geometry:e.useGeometryForShape?l?.geometry??null:null,useMarkerSymbolSize:e.useMarkerSymbolSize!==!1,size:{width:A(e.widthInPixels??16),height:A(e.heightInPixels??16)}},t?.type==="cim"?{cimOptions:{feature:{attributes:l?.attributes??{}}}}:{}));return i?(e?.format??"element")==="element"?i:i.outerHTML:null})}export{pe as a,de as b,qe as c,el as d,ll as e,tl as f,al as g,ge as h,Ve as i,rl as j,ol as k,il as l};
