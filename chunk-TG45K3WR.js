import{f as E}from"./chunk-RAI4DTMT.js";import{b as w}from"./chunk-ACP3S2CH.js";import{F as x}from"./chunk-MYO4NP2N.js";import{d as f,k as g,l as C,o as d,r as y,u as L,z as v}from"./chunk-4PTIEWMT.js";import{a as A,d as b,g as M}from"./chunk-TG2UTNEO.js";import{f as p}from"./chunk-VTHXE323.js";function H(e,t,n={}){return h(e,t,n,k)}function F(e,t,n={}){return h(e,t,n,O)}function h(e,t,n={},r){let o=null,i=n.once?(a,s)=>{r(a)&&(f(o),t(a,s))}:(a,s)=>{r(a)&&t(a,s)};if(o=x(e,i,n.sync,n.equals),n.initial){let a=e();i(a,a)}return o}function T(e,t,n,r={}){let o=null,i=null,a=null;function s(){o&&i&&(i.remove(),r.onListenerRemove?.(o),o=null,i=null)}function c(u){r.once&&r.once&&f(a),n(u)}let l=H(e,(u,m)=>{s(),g(u)&&(o=u,i=C(u,t,c),r.onListenerAdd?.(u))},{sync:r.sync,initial:!0});return a=A(()=>{l.remove(),s()}),a}function J(e,t){return P(e,null,t)}function K(e,t){return P(e,O,t)}function P(e,t,n){if(y(n))return Promise.reject(d());let r=e();if(t?.(r))return Promise.resolve(r);let o=null;function i(){o=f(o)}return new Promise((a,s)=>{o=b([L(n,()=>{i(),s(d())}),h(e,c=>{i(),a(c)},{sync:!1,once:!0},t??k)])})}function k(e){return!0}function O(e){return!!e}function N(e,t,n={}){let r=!1,o=H(e,(i,a)=>{r||t(i,a)},n);return{remove(){o.remove()},pause(){r=!0},resume(){r=!1}}}function j(e,t){let n=new w,r=T(e,"after-splice",({added:o,start:i,deleteCount:a})=>{let s=n.splice(i,a);for(let c of s)c.remove();if(o?.length){let c=o.map(t);n.addMany(c,i)}},{sync:!0,onListenerRemove:()=>n.drain(o=>o.remove()),onListenerAdd:o=>n.addMany(o.items.map(t))});return n.addHandles(r),n}function Q(e,t){let n=new w,r=j(e,s=>E(c=>p(this,null,function*(){let l=yield t(s,c);if(y(c))throw l.remove(),d();return l}))),o=()=>null,i=s=>p(this,null,function*(){let c=yield s.promise,l=r.indexOf(s);l<0||n.splice(l,1,c)});n.addMany(r.items.map(o));for(let s of r)v(i(s));let a=r.on("after-splice",({added:s,start:c,deleteCount:l})=>{let u=n.splice(c,l);for(let m of u)m?.remove();if(s?.length){n.addMany(s.map(o),c);for(let m of s)v(i(m))}});return n.addHandles([M(r),a]),n}var S={sync:!0},V={initial:!0},W={sync:!0,initial:!0};export{H as a,F as b,T as c,J as d,K as e,N as f,j as g,Q as h,S as i,V as j,W as k};
