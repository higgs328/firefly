import{a as d}from"./chunk-DZFUQCB6.js";import{a as v}from"./chunk-KVM6SHDX.js";import{a as M}from"./chunk-PIHANKUA.js";import{i as x,n as w,s as W,t as A,x as I}from"./chunk-EQZWYK27.js";import{m as E}from"./chunk-ZQIC5NFT.js";import{c as f}from"./chunk-VIEK2X23.js";import{c as T,d as y}from"./chunk-Q6Y4JG7Q.js";import{a as R}from"./chunk-7F5DJLJT.js";import{ca as L,h as b}from"./chunk-NJWTSROP.js";import{b as g}from"./chunk-YOFFGXOB.js";var G=12,p=class a{constructor(e){let t=a.checkUnsupported(e);if(t!=null)throw t;let i=e;this.spatialReference=i.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=b(this.spatialReference),this.origin=[i.origin.x,i.origin.y],this.pixelSize=i.size[0],this.dpi=i.dpi;let s=i.lods.reduce((n,c)=>(c.level<n.minLod.level&&(n.minLod=c),n.max=Math.max(n.max,c.level),n),{minLod:i.lods[0],max:-1/0}),o=s.minLod,r=2**o.level,l=o.resolution*r,h=o.scale*r;this.levels=new Array(s.max+1);for(let n=0;n<this.levels.length;n++)this.levels[n]={resolution:l,scale:h,tileSize:[l*i.size[0],l*i.size[1]]},l/=2,h/=2}clone(){return new a(this.toTileInfo())}toTileInfo(){return new d({dpi:this.dpi,origin:new f({x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference}),size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((e,t)=>new M({level:t,scale:e.scale,resolution:e.resolution}))})}getExtent(e,t,i,s){let o=this.levels[e],r=o.tileSize[0],l=o.tileSize[1];s[0]=this.origin[0]+i*r,s[2]=this.origin[0]+(i+1)*r,s[3]=this.origin[1]-t*l,s[1]=this.origin[1]-(t+1)*l}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=T(e[0]),t[1]=y(e[1]),t[2]=T(e[2]),t[3]=y(e[3])):this._isGCS&&(t[0]=x(e[0]),t[1]=x(e[1]),t[2]=x(e[2]),t[3]=x(e[3]))}getExtentGeometry(e,t,i,s=new E){return this.getExtent(e,t,i,u),s.spatialReference=this.spatialReference,s.xmin=u[0],s.ymin=u[1],s.xmax=u[2],s.ymax=u[3],s.zmin=void 0,s.zmax=void 0,s}ensureMaxLod(e){if(e==null)return!1;let t=!1;for(;this.levels.length<=e;){let{resolution:i,scale:s}=this.levels[this.levels.length-1],o=i/2*this.pixelSize;this.levels.push({resolution:i/2,scale:s/2,tileSize:[o,o]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){let t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e,t=1/0){if(a.checkUnsupported(e))return!1;let i=new a(e);if(!i.spatialReference.equals(this.spatialReference)||i.pixelSize!==this.pixelSize)return!1;let s=Math.min(this.levels.length-1,i.levels.length-1,t),o=this.levels[s].resolution,r=.5*o;return!w(i.origin[0],this.origin[0],r)||!w(i.origin[1],this.origin[1],r)?!1:(r=.5*o/2**s/this.pixelSize*G,w(o,i.levels[s].resolution,r))}rootTilesInExtent(e,t=null,i=1/0){let s=new Array,o=this.levels[0].tileSize;if(e==null||o[0]===0||o[1]===0)return s;a.computeRowColExtent(e,o,this.origin,u);let r=u[1],l=u[3],h=u[0],n=u[2],c=n-h,S=l-r;if(c*S>i){let m=Math.floor(Math.sqrt(i));S>m&&(r=r+Math.floor(.5*S)-Math.floor(.5*m),l=r+m),c>m&&(h=h+Math.floor(.5*c)-Math.floor(.5*m),n=h+m)}for(let m=r;m<l;m++)for(let z=h;z<n;z++)s.push([0,m,z]);return t!=null&&(t[0]=this.origin[0]+h*o[0],t[1]=this.origin[1]-l*o[1],t[2]=this.origin[0]+n*o[0],t[3]=this.origin[1]-r*o[1]),s}static computeRowColExtent(e,t,i,s){let o=.001*(e[2]-e[0]+(e[3]-e[1]));s[0]=Math.max(0,Math.floor((e[0]+o-i[0])/t[0])),s[2]=Math.max(0,Math.ceil((e[2]-o-i[0])/t[0])),s[1]=Math.max(0,Math.floor((i[1]-e[3]+o)/t[1])),s[3]=Math.max(0,Math.ceil((i[1]-e[1]-o)/t[1]))}static isPowerOfTwo(e){let t=e.lods,i=t[0].resolution*2**t[0].level;return!t.some(s=>!W(s.resolution,i/2**s.level))}static hasGapInLevels(e){let t=e.lods.map(i=>i.level);t.sort((i,s)=>i-s);for(let i=1;i<t.length;i++)if(t[i]!==t[0]+i)return!0;return!1}static tileSizeSupported(e){let t=e.size[1];return t===e.size[0]&&!(t&t-1)&&t>=128&&t<=512}static hasOriginPerLODs(e){let t=e.origin;return e.lods.some(i=>i.origin!=null&&(i.origin[0]!==t.x||i.origin[1]!==t.y))}static getMissingTileInfoError(){return new g("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return e==null?C():e.lods.length<1?new g("tilingscheme:generic","Tiling scheme must have at least one level"):a.isPowerOfTwo(e)?a.hasGapInLevels(e)?new g("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):a.tileSizeSupported(e)?a.hasOriginPerLODs(e)?new g("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new g("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new g("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){let i=e[2]-e[0],s=e[3]-e[1],o=L(t),r=1.2*Math.max(i,s),l=256,h=r/l,n=h*o*(96/.0254),c=new a(new d({size:[l,l],origin:new f({x:e[0]-.5*(r-i),y:e[3]+.5*(r-s)}),lods:[new M({level:0,resolution:h,scale:n})],spatialReference:t}));return c.ensureMaxLod(20),c}static makeWebMercatorAuxiliarySphere(e){let t=new a(a.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,i=16){let s=256/t,o=new a(new d({size:[t,t],origin:new f({x:-180,y:90,spatialReference:e}),spatialReference:e,lods:[new M({level:0,resolution:.703125*s,scale:295497598570834e-6*s})]}));return o.ensureMaxLod(i),o}get test(){}};function C(){return new g("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}p.WebMercatorAuxiliarySphereTileInfo=new d({size:[256,256],origin:new f({x:-20037508342787e-6,y:20037508342787e-6,spatialReference:R.WebMercator}),spatialReference:R.WebMercator,lods:[new M({level:0,resolution:156543.03392800014,scale:591657527591555e-6})]}),p.WebMercatorAuxiliarySphere=p.makeWebMercatorAuxiliarySphere(19);var u=v();var Z=64,$=512,_=2.5,ee=A(I/10),te=2,O=v();p.WebMercatorAuxiliarySphere.getExtent(0,0,0,O);var ie=v([-180,-90,180,90]),se="Cannot extend surface to encompass all layers because it would result in too many root tiles.",oe="Surface extent is too large for tile resolution at level 0.",re=4;export{p as a,C as b,Z as c,$ as d,_ as e,ee as f,te as g,O as h,ie as i,se as j,oe as k,re as l};
