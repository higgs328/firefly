import{Aa as M,D as _,F as b,ba as D,ia as R,la as U,ma as E,pa as F,v}from"./chunk-A2QQP5DF.js";import{a as I}from"./chunk-LTHAIW3V.js";import{N as k,W as w,ea as T}from"./chunk-WFHQTMIY.js";import{a as C}from"./chunk-XAZOVQGA.js";import{a as G,b as u,o as x,z as S}from"./chunk-V3KEO7AJ.js";var q=class{getOperatorType(){return 10700}accelerateGeometry(r,t,l){return!1}canAccelerateGeometry(r){return!1}supportsCurves(){return!0}executeMany(r,t,l,s=1){return new d(r,t,l,s)}},d=class extends I{constructor(r,t,l,s){super(),this.m_progressTracker=l,this.m_inputGeoms=r,this.m_spatialReference=t,this.m_currentGeometry=null,this.m_singlePartIndex=-1,this.m_singlePartCount=-1,this.m_polygonStart=-1,this.m_index=-1,this.m_options=s}tock(){return!0}getRank(){return 1}next(){if(this.m_singlePartIndex===this.m_singlePartCount){let t=this.m_inputGeoms.next();if(t===null)return null;if(S(t),t.getGeometryType()===u.enumPolygon)if(this.m_options===1)this.m_currentGeometry=new M().execute(t,this.m_spatialReference,!1,this.m_progressTracker);else if(this.m_options===2)if(t.getPathCount()<2)this.m_currentGeometry=t;else{let l=[0],s=t.getImpl().getIsSimple(0,l);if(w(s))this.m_currentGeometry=t;else{let e=new b,a=e.addGeometry(t),i=null;if(e.hasCurves()){i=new F;let n=new C;t.queryEnvelope(n);let o=k(null,t,!0),y=E(o.total(),n);U(e,y,o.total(),12e3,null,i,null,this.m_progressTracker)}let P=e.createPathUserIndex();{let n=0;for(let o=e.getFirstPath(a);o!==_;o=e.getNextPath(o))e.setPathUserIndex(o,P,n++)}let m=D(e,a,this.m_progressTracker);G(m>=0);let h=[];for(let n=e.getFirstPath(a);n!==_;n=e.getNextPath(n))h.push(n);h.sort((n,o)=>Math.abs(e.getPathUserIndex(n,m))-Math.abs(e.getPathUserIndex(o,m)));let g=t,c=new v({vd:t.getDescription()});c.reserveParts(g.getPointCount(),g.getPathCount());for(let n=0,o=h.length;n<o;n++){let y=h[n],f=e.getPathUserIndex(y,P),A=g.calculateRingArea2D(f)>0,B=e.getPathUserIndex(y,m)>=0;c.addPath(g,f,A===B)}this.m_currentGeometry=c}}else x("");else this.m_currentGeometry=t;this.m_singlePartCount=N(this.m_currentGeometry),this.m_singlePartIndex=0,this.m_polygonStart=0,this.m_index=this.m_inputGeoms.getGeometryID()}let r=this.getSingleGeometry(this.m_singlePartIndex,this.m_singlePartCount,this.m_polygonStart,this.m_currentGeometry);return r.getGeometryType()===u.enumPolygon&&(this.m_polygonStart+=r.getPathCount()),this.m_singlePartIndex++,r}getGeometryID(){return this.m_index}getSingleGeometry(r,t,l,s){let e=null;switch(s.getGeometryType()){case u.enumMultiPoint:e=new T({vd:s.getDescription()}),s.isEmpty()||s.getPointByVal(r,e);break;case u.enumPolyline:if(t===1)e=s;else{e=s.createInstance(),e.getImpl().addPath(s.getImpl(),r,!0);let a=[0],i=s.getImpl().getIsSimple(0,a);e.getImpl().setIsSimple(i,a[0],!0)}break;case u.enumPolygon:if(t===1)e=s;else{e=s.createInstance();let a=e.getImpl(),i=s.getImpl(),P=i.getPathFlagsStreamRef(),m=l,h=i.getPathCount();do a.addPath(i,m,!0),m++;while(m<h&&!(8&P.read(m)));a.getPathFlagsStreamRef().setBits(0,8);let g=[0],c=i.getIsSimple(0,g);a.setIsSimple(c,g[0],!0)}break;default:e=s}return e}};function N(p){return p.isEmpty()?1:R(p)}export{q as a};
