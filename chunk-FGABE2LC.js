import{a as m}from"./chunk-CU7FHMWW.js";import{a as v}from"./chunk-L7NOU4T2.js";import{a as o}from"./chunk-47NSYSFY.js";import{d as n}from"./chunk-ONYJLWAD.js";import{a}from"./chunk-RWCIDBNQ.js";import{I as h,f as i}from"./chunk-4PTIEWMT.js";var s;function _(e,t){switch(t.textureCoordinateType){case s.Default:return e.attributes.add(a.UV0,"vec2"),e.varyings.add("vuv0","vec2"),void e.vertex.code.add(o`void forwardTextureCoordinates() {
vuv0 = uv0;
}`);case s.Compressed:return e.attributes.add(a.UV0,"vec2"),e.varyings.add("vuv0","vec2"),void e.vertex.code.add(o`vec2 getUV0() {
return uv0 / 16384.0;
}
void forwardTextureCoordinates() {
vuv0 = getUV0();
}`);case s.Atlas:return e.attributes.add(a.UV0,"vec2"),e.varyings.add("vuv0","vec2"),e.attributes.add(a.UVREGION,"vec4"),e.varyings.add("vuvRegion","vec4"),void e.vertex.code.add(o`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:t.textureCoordinateType;case s.None:return void e.vertex.code.add(o`void forwardTextureCoordinates() {}`);case s.COUNT:return}}(function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Atlas=2]="Atlas",e[e.Compressed=3]="Compressed",e[e.COUNT=4]="COUNT"})(s||(s={}));function E(e,t){let{textureCoordinateType:r}=t;if(r===s.None||r===s.COUNT)return;e.include(_,t);let u=r===s.Atlas;u&&e.include(m),e.fragment.code.add(o`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${u?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}var d=class{constructor(t){this._material=t.material,this._techniques=t.techniques,this._output=t.output}dispose(){}get _stippleTextures(){return this._techniques.context.stippleTextures}get _markerTextures(){return this._techniques.context.markerTextures}getTechnique(t,r){return this._techniques.get(t,this._material.getConfiguration(this._output,r))}ensureResources(t){return n.LOADED}};var p=class extends d{constructor(t){super(t),this._numLoading=0,this._disposed=!1,this._textures=t.textures,this.updateTexture(t.textureId),this._acquire(t.normalTextureId,r=>this._textureNormal=r),this._acquire(t.emissiveTextureId,r=>this._textureEmissive=r),this._acquire(t.occlusionTextureId,r=>this._textureOcclusion=r),this._acquire(t.metallicRoughnessTextureId,r=>this._textureMetallicRoughness=r)}dispose(){super.dispose(),this._texture=i(this._texture),this._textureNormal=i(this._textureNormal),this._textureEmissive=i(this._textureEmissive),this._textureOcclusion=i(this._textureOcclusion),this._textureMetallicRoughness=i(this._textureMetallicRoughness),this._disposed=!0}ensureResources(t){return this._numLoading===0?n.LOADED:n.LOADING}get textureBindParameters(){return new c(this._texture!=null?this._texture.glTexture:null,this._textureNormal!=null?this._textureNormal.glTexture:null,this._textureEmissive!=null?this._textureEmissive.glTexture:null,this._textureOcclusion!=null?this._textureOcclusion.glTexture:null,this._textureMetallicRoughness!=null?this._textureMetallicRoughness.glTexture:null)}updateTexture(t){this._texture!=null&&t===this._texture.id||(this._texture=i(this._texture),this._textureId=t,this._acquire(this._textureId,r=>this._texture=r))}_acquire(t,r){if(t==null)return void r(null);let u=this._textures.acquire(t);if(h(u))return++this._numLoading,void u.then(l=>{if(this._disposed)return i(l),void r(null);r(l)}).finally(()=>--this._numLoading);r(u)}},x=class extends v{constructor(t=null){super(),this.textureEmissive=t}},c=class extends x{constructor(t=null,r=null,u=null,l=null,T=null,g,f){super(u),this.texture=t,this.textureNormal=r,this.textureOcclusion=l,this.textureMetallicRoughness=T,this.scale=g,this.normalTextureTransformMatrix=f}};export{s as a,_ as b,E as c,d,p as e,c as f};
