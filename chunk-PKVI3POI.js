import{b as m,i as b,j as I,k as T,l as j}from"./chunk-NQ53MXMB.js";import{g,h as R}from"./chunk-4RK2B3SZ.js";import{D as V,h as O}from"./chunk-XR5FT7TQ.js";import{a as S}from"./chunk-CZAUQJCN.js";import{f as v}from"./chunk-F5AJITOA.js";import{da as A,g as F,ha as L,ia as _}from"./chunk-KALOJIUA.js";import{a as y}from"./chunk-7P44K2YD.js";import{a as c,e as p,g as h}from"./chunk-XRGPJ3QY.js";import{h as E}from"./chunk-2LI2GKBQ.js";import{y as N}from"./chunk-QBWJMFH5.js";import{a as f}from"./chunk-VTHXE323.js";function w(e){let{attributes:t,sourceLayer:n}=e??{},i=n&&"displayField"in n?n.displayField:null,r=i?t?.[i]:null,s=r!=null?JSON.stringify(r):null,a=e?.getObjectId()?.toString();return s||a||""}var $=e=>e?.type==="field",D=e=>e?.type==="group",G=e=>e?.type==="relationship",le=e=>e.type==="text",P=e=>e.type==="utilityNetworkAssociations",ue=e=>!D(e)&&e.group!=null,x=e=>e.reduce((t,n)=>D(n)?[...t,...n.inputs]:[...t,n],[]),pe=e=>x(e).filter($),me=e=>x(e).filter(G),de=e=>x(e).filter(P),fe=e=>e!=null&&(C(e,"combo-box")||C(e,"radio-buttons")),C=(e,t)=>e!=null&&e.input?.type===t,ce=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function ye(e,t){let{title:n,feature:i}=e??{};return n||(i?w(i):null)||t||""}function Fe(e){let{attributes:t,fieldsIndex:n,label:i,timeZone:r}=e;if(!t||typeof t!="object")return i;let s=Object.keys(t).filter(o=>p(i,o)),a=s.map(o=>t[o]),l=s.map(o=>n.get(o)).filter(N);return k(i,W({values:a,fields:l,timeZone:r}))}var d="expression/",Z="expr/",M="field/";function ge(e){let[t,n]=e.split(d);return t===""&&n?n:(h.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${d}/expressionName'`),"")}function be(e){return`${d}${e}`}function Ie(e){return`${M}${e}`}function Te(e){return e.startsWith(d)}function xe(e){return e.startsWith(Z)}function W(e){let{fields:t,values:n}=e,i=e.timeZone??void 0,r=t.map((s,a)=>{let l=n[a];if(s.domain&&s.domain.type==="coded-value"){let o=s.domain.codedValues.find(u=>u.code===l);o?.name&&(l=o.name)}return(v(s)||A(s))&&(l=R(s,l,f({timeZone:i},g(s)))),[s.name,l]});return Object.fromEntries(r)}function k(e,t){return c(c(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,i])=>[n.toLowerCase(),i])))}var Ne=e=>{let t={typeFieldName:null,types:[]};return e&&(O(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):e.type==="subtype-group"||e.type==="feature"&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:n,name:i,domains:r})=>({code:n,name:i,domains:r}))),t.typeFieldName!=null&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName)),t},Ee=(e,t,n)=>{let{dataType:i,error:r,minLength:s}=e,a=t?.validationErrors;if(!a||!r)return null;if(r===m.CANNOT_BE_EMPTY)return a.cannotBeNull;if(r===F.VALUE_OUT_OF_RANGE||r===L.OUT_OF_RANGE){let{field:l,range:o}=e,u={type:"date",intlOptions:f({timeZone:l.type==="date"&&n?n:void 0},g(l))},U=j(o,a);return y(U,o,{format:{max:i==="date"?u:o.max!=null&&T(o.max)?I:b,min:i==="date"?u:o.min!=null&&T(o.min)?I:b}})}return r===F.INVALID_CODED_VALUE?a.invalidCodedValue:r===_.INVALID_TYPE?a.invalidType:r===m.TOO_SHORT?y(a.tooShort,{min:s}):(m.TOO_LONG,null)},he=e=>{if(!e)return;let t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return i==="polyline"||n==="polyline"?"line":i==="mesh"||n==="mesh"||n==="multipatch"?"cube":i==="multipoint"||n==="multipoint"?"point":i||n||"table"},Oe=e=>{let t=[];if(e.formTemplate){let{description:n,title:i}=e.formTemplate;e.fields?.forEach(r=>{let s=i&&p(i,r.name),a=n&&p(n,r.name);(s||a)&&t.push(r.name)})}return t};function Ve(e,t){let n=t??("formTemplate"in e&&e.formTemplate);return n?(n.elements?.filter(S)??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function ve(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function Se(e,t){switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===t.codedValue?.code;case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return t.objectType,!1}}function Ae(e,t,n){let i=V(e),r=i?.find(a=>a.code===n);if(!r)return!1;let s=i?.find(a=>a.code===t);return!E(r.defaultValues,s?.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{w as a,$ as b,D as c,G as d,le as e,P as f,ue as g,x as h,pe as i,me as j,de as k,fe as l,C as m,ce as n,ye as o,Fe as p,ge as q,be as r,Ie as s,Te as t,xe as u,W as v,Ne as w,Ee as x,he as y,Oe as z,Ve as A,ve as B,Se as C,Ae as D};
