import{a as rt,b as te}from"./chunk-ZWHAEUE3.js";import{f as Ie}from"./chunk-E56W4PK4.js";import{b as De}from"./chunk-VU5W7W6Y.js";import{b as nt}from"./chunk-X2B63YVS.js";import{a as $e,o as et,r as tt}from"./chunk-4PTIEWMT.js";import{b as ie}from"./chunk-YOFFGXOB.js";import{a as me,b as Se,f as ae}from"./chunk-VTHXE323.js";var at,it={exports:{}};function vt(){return at||(at=1,t=it,e=function(){function d(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return d.prototype={ensureBuffer:function(i){var c=this.buffer,g=c?c.byteLength:0;if(i<g)return c;for(var h=512;h<i;)h<<=1;for(var s=new Uint8Array(h),o=0;o<g;++o)s[o]=c[o];return this.buffer=s},getByte:function(){for(var i=this.pos;this.bufferLength<=i;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(i){var c=this.pos;if(i){this.ensureBuffer(c+i);for(var g=c+i;!this.eof&&this.bufferLength<g;)this.readBlock();var h=this.bufferLength;g>h&&(g=h)}else{for(;!this.eof;)this.readBlock();g=this.bufferLength}return this.pos=g,this.buffer.subarray(c,g)},lookChar:function(){for(var i=this.pos;this.bufferLength<=i;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var i=this.pos;this.bufferLength<=i;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(i,c,g){for(var h=i+c;this.bufferLength<=h&&!this.eof;)this.readBlock();return new Stream(this.buffer,i,c,g)},skip:function(i){i||(i=1),this.pos+=i},reset:function(){this.pos=0}},d}(),(n=function(){if(!self||!self.Uint32Array)return null;var d=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),c=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),g=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],h=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function s(a){throw new Error(a)}function o(a){var f=0,l=a[f++],p=a[f++];l!=-1&&p!=-1||s("Invalid header in flate stream"),(15&l)!=8&&s("Unknown compression method in flate stream"),((l<<8)+p)%31!=0&&s("Bad FCHECK in flate stream"),32&p&&s("FDICT bit set in flate stream"),this.bytes=a,this.bytesPos=f,this.codeSize=0,this.codeBuf=0,e.call(this)}return o.prototype=Object.create(e.prototype),o.prototype.getBits=function(a){for(var f,l=this.codeSize,p=this.codeBuf,y=this.bytes,A=this.bytesPos;l<a;)(f=y[A++])===void 0&&s("Bad encoding in flate stream"),p|=f<<l,l+=8;return f=p&(1<<a)-1,this.codeBuf=p>>a,this.codeSize=l-=a,this.bytesPos=A,f},o.prototype.getCode=function(a){for(var f=a[0],l=a[1],p=this.codeSize,y=this.codeBuf,A=this.bytes,b=this.bytesPos;p<l;){var S;(S=A[b++])===void 0&&s("Bad encoding in flate stream"),y|=S<<p,p+=8}var v=f[y&(1<<l)-1],P=v>>16,r=65535&v;return(p==0||p<P||P==0)&&s("Bad encoding in flate stream"),this.codeBuf=y>>P,this.codeSize=p-P,this.bytesPos=b,r},o.prototype.generateHuffmanTable=function(a){for(var f=a.length,l=0,p=0;p<f;++p)a[p]>l&&(l=a[p]);for(var y=1<<l,A=new Uint32Array(y),b=1,S=0,v=2;b<=l;++b,S<<=1,v<<=1)for(var P=0;P<f;++P)if(a[P]==b){var r=0,u=S;for(p=0;p<b;++p)r=r<<1|1&u,u>>=1;for(p=r;p<y;p+=v)A[p]=b<<16|P;++S}return[A,l]},o.prototype.readBlock=function(){function a(F,X,_,M,H){for(var q=F.getBits(_)+M;q-- >0;)X[v++]=H}var f=this.getBits(3);if(1&f&&(this.eof=!0),(f>>=1)!=0){var l,p;if(f==1)l=g,p=h;else if(f==2){for(var y=this.getBits(5)+257,A=this.getBits(5)+1,b=this.getBits(4)+4,S=Array(d.length),v=0;v<b;)S[d[v++]]=this.getBits(3);for(var P=this.generateHuffmanTable(S),r=0,u=(v=0,y+A),T=new Array(u);v<u;){var E=this.getCode(P);E==16?a(this,T,2,3,r):E==17?a(this,T,3,3,r=0):E==18?a(this,T,7,11,r=0):T[v++]=r=E}l=this.generateHuffmanTable(T.slice(0,y)),p=this.generateHuffmanTable(T.slice(y,u))}else s("Unknown block type in flate stream");for(var m=(D=this.buffer)?D.length:0,I=this.bufferLength;;){var w=this.getCode(l);if(w<256)I+1>=m&&(m=(D=this.ensureBuffer(I+1)).length),D[I++]=w;else{if(w==256)return void(this.bufferLength=I);var U=(w=i[w-=257])>>16;U>0&&(U=this.getBits(U)),r=(65535&w)+U,w=this.getCode(p),(U=(w=c[w])>>16)>0&&(U=this.getBits(U));var L=(65535&w)+U;I+r>=m&&(m=(D=this.ensureBuffer(I+r)).length);for(var k=0;k<r;++k,++I)D[I]=D[I-L]}}}else{var N,B=this.bytes,O=this.bytesPos;(N=B[O++])===void 0&&s("Bad block header in flate stream");var V=N;(N=B[O++])===void 0&&s("Bad block header in flate stream"),V|=N<<8,(N=B[O++])===void 0&&s("Bad block header in flate stream");var x=N;(N=B[O++])===void 0&&s("Bad block header in flate stream"),(x|=N<<8)!=(65535&~V)&&s("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var j=this.bufferLength,D=this.ensureBuffer(j+V),R=j+V;this.bufferLength=R;for(var G=j;G<R;++G){if((N=B[O++])===void 0){this.eof=!0;break}D[G]=N}this.bytesPos=O}},o}())!==void 0&&(t.exports=n)),it.exports;var e,t,n}var le=De(vt());var Ce=class e{constructor(t){this._canvas=null,this._ctx=null,t&&(this._canvas=t.canvas,this._ctx=t.ctx||t.canvas&&t.canvas.getContext("2d"))}decode(t,n,d){if(!t||t.byteLength<10)throw new ie("imagecanvasdecoder: decode","required a valid encoded data as input.");let{width:i=0,height:c=0,format:g}=n,{applyJpegMask:h}=n;if(h&&(!i||!c))throw new ie("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((s,o)=>{let a=null;g==="jpg"&&h&&(a=e._getMask(t,{width:i,height:c}));let f=new Blob([new Uint8Array(t)],{type:"image/"+g=="jpg"?"jpeg":g}),l=URL.createObjectURL(f),p=new Image,y;p.src=l,p.onload=()=>{if(URL.revokeObjectURL(l),tt(d))return void o(et());i=p.width,c=p.height,this._canvas&&this._ctx?(this._canvas.width===i&&this._canvas.height===c||(this._canvas.width=i,this._canvas.height=c),this._ctx.clearRect(0,0,i,c)):(this._canvas=document.createElement("canvas"),this._canvas.width=i,this._canvas.height=c,this._ctx=this._canvas.getContext("2d")),this._ctx.drawImage(p,0,0);let A=this._ctx.getImageData(0,0,i,c),b;if(y=A.data,n.renderOnCanvas){if(a)for(b=0;b<a.length;b++)a[b]?y[4*b+3]=255:y[4*b+3]=0;return this._ctx.putImageData(A,0,0),void s(null)}let S=i*c,v=new Uint8Array(S),P=new Uint8Array(S),r=new Uint8Array(S);if(a)for(b=0;b<S;b++)v[b]=y[4*b],P[b]=y[4*b+1],r[b]=y[4*b+2];else for(a=new Uint8Array(S),b=0;b<S;b++)v[b]=y[4*b],P[b]=y[4*b+1],r[b]=y[4*b+2],a[b]=y[4*b+3];s({width:i,height:c,pixels:[v,P,r],mask:a,pixelType:"u8"})},p.onerror=()=>{URL.revokeObjectURL(l),o("cannot load image")}})}static _getMask(t,n){let d=null;try{let i=new Uint8Array(t),c=Math.ceil(i.length/2),g=0,h=i.length-2;for(g=c;g<h&&(i[g]!==255||i[g+1]!==217);g++);if(g+=2,g<i.length-1){let s=new le(i.subarray(g)).getBytes();d=new Uint8Array(n.width*n.height);let o=0;for(let a=0;a<s.length;a++)for(let f=7;f>=0;f--)d[o++]=s[a]>>f&1}}catch{}return d}};var st,ot={exports:{}};function Pt(){return st||(st=1,e=ot,t=function(){var d=function(){function i(c){this.message="JPEG error: "+c}return i.prototype=new Error,i.prototype.name="JpegError",i.constructor=i,i}();return function(){if(!self||!self.Uint8ClampedArray)return null;var i=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),c=4017,g=799,h=3406,s=2276,o=1567,a=3784,f=5793,l=2896;function p(){this.decodeTransform=null,this.colorTransform=-1}function y(r,u){for(var T,E,m=0,I=[],w=16;w>0&&!r[w-1];)w--;I.push({children:[],index:0});var U,L=I[0];for(T=0;T<w;T++){for(E=0;E<r[T];E++){for((L=I.pop()).children[L.index]=u[m];L.index>0;)L=I.pop();for(L.index++,I.push(L);I.length<=T;)I.push(U={children:[],index:0}),L.children[L.index]=U.children,L=U;m++}T+1<w&&(I.push(U={children:[],index:0}),L.children[L.index]=U.children,L=U)}return I[0].children}function A(r,u,T){return 64*((r.blocksPerLine+1)*u+T)}function b(r,u,T,E,m,I,w,U,L){var k=T.mcusPerLine,N=T.progressive,B=u,O=0,V=0;function x(){if(V>0)return V--,O>>V&1;if((O=r[u++])===255){var C=r[u++];if(C)throw new d("unexpected marker "+(O<<8|C).toString(16))}return V=7,O>>>7}function j(C){for(var Y=C;;){if(typeof(Y=Y[x()])=="number")return Y;if(typeof Y!="object")throw new d("invalid huffman sequence")}}function D(C){for(var Y=0;C>0;)Y=Y<<1|x(),C--;return Y}function R(C){if(C===1)return x()===1?1:-1;var Y=D(C);return Y>=1<<C-1?Y:Y+(-1<<C)+1}function G(C,Y){var W=j(C.huffmanTableDC),Z=W===0?0:R(W);C.blockData[Y]=C.pred+=Z;for(var Q=1;Q<64;){var re=j(C.huffmanTableAC),z=15&re,$=re>>4;if(z!==0){var It=i[Q+=$];C.blockData[Y+It]=R(z),Q++}else{if($<15)break;Q+=16}}}function F(C,Y){var W=j(C.huffmanTableDC),Z=W===0?0:R(W)<<L;C.blockData[Y]=C.pred+=Z}function X(C,Y){C.blockData[Y]|=x()<<L}var _=0;function M(C,Y){if(_>0)_--;else for(var W=I,Z=w;W<=Z;){var Q=j(C.huffmanTableAC),re=15&Q,z=Q>>4;if(re!==0){var $=i[W+=z];C.blockData[Y+$]=R(re)*(1<<L),W++}else{if(z<15){_=D(z)+(1<<z)-1;break}W+=16}}}var H,q=0;function he(C,Y){for(var W,Z,Q=I,re=w,z=0;Q<=re;){var $=i[Q];switch(q){case 0:if(z=(Z=j(C.huffmanTableAC))>>4,(W=15&Z)==0)z<15?(_=D(z)+(1<<z),q=4):(z=16,q=1);else{if(W!==1)throw new d("invalid ACn encoding");H=R(W),q=z?2:3}continue;case 1:case 2:C.blockData[Y+$]?C.blockData[Y+$]+=x()<<L:--z==0&&(q=q===2?3:0);break;case 3:C.blockData[Y+$]?C.blockData[Y+$]+=x()<<L:(C.blockData[Y+$]=H<<L,q=0);break;case 4:C.blockData[Y+$]&&(C.blockData[Y+$]+=x()<<L)}Q++}q===4&&--_==0&&(q=0)}function be(C,Y,W,Z,Q){var re=W%k;Y(C,A(C,(W/k|0)*C.v+Z,re*C.h+Q))}function _e(C,Y,W){Y(C,A(C,W/C.blocksPerLine|0,W%C.blocksPerLine))}var ce,ne,se,ue,J,Ae,de=E.length;Ae=N?I===0?U===0?F:X:U===0?M:he:G;var ee,pe,Le,Ue,oe=0;for(pe=de===1?E[0].blocksPerLine*E[0].blocksPerColumn:k*T.mcusPerColumn;oe<pe;){var ke=m?Math.min(pe-oe,m):pe;for(ne=0;ne<de;ne++)E[ne].pred=0;if(_=0,de===1)for(ce=E[0],J=0;J<ke;J++)_e(ce,Ae,oe),oe++;else for(J=0;J<ke;J++){for(ne=0;ne<de;ne++)for(Le=(ce=E[ne]).h,Ue=ce.v,se=0;se<Ue;se++)for(ue=0;ue<Le;ue++)be(ce,Ae,oe,se,ue);oe++}V=0,(ee=P(r,u))&&ee.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+ee.invalid),u=ee.offset);var ge=ee&&ee.marker;if(!ge||ge<=65280)throw new d("marker was not found");if(!(ge>=65488&&ge<=65495))break;u+=2}return(ee=P(r,u))&&ee.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+ee.invalid),u=ee.offset),u-B}function S(r,u,T){var E,m,I,w,U,L,k,N,B,O,V,x,j,D,R,G,F,X=r.quantizationTable,_=r.blockData;if(!X)throw new d("missing required Quantization Table.");for(var M=0;M<64;M+=8)B=_[u+M],O=_[u+M+1],V=_[u+M+2],x=_[u+M+3],j=_[u+M+4],D=_[u+M+5],R=_[u+M+6],G=_[u+M+7],B*=X[M],O|V|x|j|D|R|G?(O*=X[M+1],V*=X[M+2],x*=X[M+3],j*=X[M+4],D*=X[M+5],R*=X[M+6],G*=X[M+7],m=(E=(E=f*B+128>>8)+(m=f*j+128>>8)+1>>1)-m,F=(I=V)*a+(w=R)*o+128>>8,I=I*o-w*a+128>>8,k=(U=(U=l*(O-G)+128>>8)+(k=D<<4)+1>>1)-k,L=(N=(N=l*(O+G)+128>>8)+(L=x<<4)+1>>1)-L,w=(E=E+(w=F)+1>>1)-w,I=(m=m+I+1>>1)-I,F=U*s+N*h+2048>>12,U=U*h-N*s+2048>>12,N=F,F=L*g+k*c+2048>>12,L=L*c-k*g+2048>>12,k=F,T[M]=E+N,T[M+7]=E-N,T[M+1]=m+k,T[M+6]=m-k,T[M+2]=I+L,T[M+5]=I-L,T[M+3]=w+U,T[M+4]=w-U):(F=f*B+512>>10,T[M]=F,T[M+1]=F,T[M+2]=F,T[M+3]=F,T[M+4]=F,T[M+5]=F,T[M+6]=F,T[M+7]=F);for(var H=0;H<8;++H)B=T[H],(O=T[H+8])|(V=T[H+16])|(x=T[H+24])|(j=T[H+32])|(D=T[H+40])|(R=T[H+48])|(G=T[H+56])?(m=(E=4112+((E=f*B+2048>>12)+(m=f*j+2048>>12)+1>>1))-m,F=(I=V)*a+(w=R)*o+2048>>12,I=I*o-w*a+2048>>12,w=F,k=(U=(U=l*(O-G)+2048>>12)+(k=D)+1>>1)-k,L=(N=(N=l*(O+G)+2048>>12)+(L=x)+1>>1)-L,F=U*s+N*h+2048>>12,U=U*h-N*s+2048>>12,N=F,F=L*g+k*c+2048>>12,L=L*c-k*g+2048>>12,B=(B=(E=E+w+1>>1)+N)<16?0:B>=4080?255:B>>4,O=(O=(m=m+I+1>>1)+(k=F))<16?0:O>=4080?255:O>>4,V=(V=(I=m-I)+L)<16?0:V>=4080?255:V>>4,x=(x=(w=E-w)+U)<16?0:x>=4080?255:x>>4,j=(j=w-U)<16?0:j>=4080?255:j>>4,D=(D=I-L)<16?0:D>=4080?255:D>>4,R=(R=m-k)<16?0:R>=4080?255:R>>4,G=(G=E-N)<16?0:G>=4080?255:G>>4,_[u+H]=B,_[u+H+8]=O,_[u+H+16]=V,_[u+H+24]=x,_[u+H+32]=j,_[u+H+40]=D,_[u+H+48]=R,_[u+H+56]=G):(F=(F=f*B+8192>>14)<-2040?0:F>=2024?255:F+2056>>4,_[u+H]=F,_[u+H+8]=F,_[u+H+16]=F,_[u+H+24]=F,_[u+H+32]=F,_[u+H+40]=F,_[u+H+48]=F,_[u+H+56]=F)}function v(r,u){for(var T=u.blocksPerLine,E=u.blocksPerColumn,m=new Int16Array(64),I=0;I<E;I++)for(var w=0;w<T;w++)S(u,A(u,I,w),m);return u.blockData}function P(r,u,T){function E(L){return r[L]<<8|r[L+1]}var m=r.length-1,I=T<u?T:u;if(u>=m)return null;var w=E(u);if(w>=65472&&w<=65534)return{invalid:null,marker:w,offset:u};for(var U=E(I);!(U>=65472&&U<=65534);){if(++I>=m)return null;U=E(I)}return{invalid:w.toString(16),marker:U,offset:I}}return p.prototype={parse:function(r){function u(){var C=r[w]<<8|r[w+1];return w+=2,C}function T(){var C=u(),Y=w+C-2,W=P(r,Y,w);W&&W.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+W.invalid),Y=W.offset);var Z=r.subarray(w,Y);return w+=Z.length,Z}function E(C){for(var Y=Math.ceil(C.samplesPerLine/8/C.maxH),W=Math.ceil(C.scanLines/8/C.maxV),Z=0;Z<C.components.length;Z++){J=C.components[Z];var Q=Math.ceil(Math.ceil(C.samplesPerLine/8)*J.h/C.maxH),re=Math.ceil(Math.ceil(C.scanLines/8)*J.v/C.maxV),z=Y*J.h,$=W*J.v*64*(z+1);J.blockData=new Int16Array($),J.blocksPerLine=Q,J.blocksPerColumn=re}C.mcusPerLine=Y,C.mcusPerColumn=W}var m,I,w=0,U=null,L=null,k=[],N=[],B=[],O=u();if(O!==65496)throw new d("SOI not found");for(O=u();O!==65497;){var V,x,j;switch(O){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var D=T();O===65504&&D[0]===74&&D[1]===70&&D[2]===73&&D[3]===70&&D[4]===0&&(U={version:{major:D[5],minor:D[6]},densityUnits:D[7],xDensity:D[8]<<8|D[9],yDensity:D[10]<<8|D[11],thumbWidth:D[12],thumbHeight:D[13],thumbData:D.subarray(14,14+3*D[12]*D[13])}),O===65518&&D[0]===65&&D[1]===100&&D[2]===111&&D[3]===98&&D[4]===101&&(L={version:D[5]<<8|D[6],flags0:D[7]<<8|D[8],flags1:D[9]<<8|D[10],transformCode:D[11]});break;case 65499:for(var R=u()+w-2;w<R;){var G=r[w++],F=new Uint16Array(64);if(G>>4){if(G>>4!=1)throw new d("DQT - invalid table spec");for(x=0;x<64;x++)F[i[x]]=u()}else for(x=0;x<64;x++)F[i[x]]=r[w++];k[15&G]=F}break;case 65472:case 65473:case 65474:if(m)throw new d("Only single frame JPEGs supported");u(),(m={}).extended=O===65473,m.progressive=O===65474,m.precision=r[w++],m.scanLines=u(),m.samplesPerLine=u(),m.components=[],m.componentIds={};var X,_=r[w++],M=0,H=0;for(V=0;V<_;V++){X=r[w];var q=r[w+1]>>4,he=15&r[w+1];M<q&&(M=q),H<he&&(H=he);var be=r[w+2];j=m.components.push({h:q,v:he,quantizationId:be,quantizationTable:null}),m.componentIds[X]=j-1,w+=3}m.maxH=M,m.maxV=H,E(m);break;case 65476:var _e=u();for(V=2;V<_e;){var ce=r[w++],ne=new Uint8Array(16),se=0;for(x=0;x<16;x++,w++)se+=ne[x]=r[w];var ue=new Uint8Array(se);for(x=0;x<se;x++,w++)ue[x]=r[w];V+=17+se,(ce>>4?N:B)[15&ce]=y(ne,ue)}break;case 65501:u(),I=u();break;case 65498:u();var J,Ae=r[w++],de=[];for(V=0;V<Ae;V++){var ee=m.componentIds[r[w++]];J=m.components[ee];var pe=r[w++];J.huffmanTableDC=B[pe>>4],J.huffmanTableAC=N[15&pe],de.push(J)}var Le=r[w++],Ue=r[w++],oe=r[w++],ke=b(r,w,m,de,I,Le,Ue,oe>>4,15&oe);w+=ke;break;case 65535:r[w]!==255&&w--;break;default:if(r[w-3]===255&&r[w-2]>=192&&r[w-2]<=254){w-=3;break}throw new d("unknown marker "+O.toString(16))}O=u()}for(this.width=m.samplesPerLine,this.height=m.scanLines,this.jfif=U,this.eof=w,this.adobe=L,this.components=[],V=0;V<m.components.length;V++){var ge=k[(J=m.components[V]).quantizationId];ge&&(J.quantizationTable=ge),this.components.push({output:v(m,J),scaleX:J.h/m.maxH,scaleY:J.v/m.maxV,blocksPerLine:J.blocksPerLine,blocksPerColumn:J.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(r,u){var T,E,m,I,w,U,L,k,N,B,O,V=this.width/r,x=this.height/u,j=0,D=this.components.length,R=r*u*D,G=new Uint8ClampedArray(R),F=new Uint32Array(r),X=4294967288;for(L=0;L<D;L++){for(E=(T=this.components[L]).scaleX*V,m=T.scaleY*x,j=L,O=T.output,I=T.blocksPerLine+1<<3,w=0;w<r;w++)k=0|w*E,F[w]=(k&X)<<3|7&k;for(U=0;U<u;U++)for(B=I*((k=0|U*m)&X)|(7&k)<<3,w=0;w<r;w++)G[j]=O[B+F[w]],j+=D}var _=this.decodeTransform;if(_)for(L=0;L<R;)for(k=0,N=0;k<D;k++,L++,N+=2)G[L]=(G[L]*_[N]>>8)+_[N+1];return G},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this.colorTransform!==0:this.colorTransform===1},_convertYccToRgb:function(r){for(var u,T,E,m=0,I=r.length;m<I;m+=3)u=r[m],T=r[m+1],E=r[m+2],r[m]=u-179.456+1.402*E,r[m+1]=u+135.459-.344*T-.714*E,r[m+2]=u-226.816+1.772*T;return r},_convertYcckToRgb:function(r){for(var u,T,E,m,I=0,w=0,U=r.length;w<U;w+=4)u=r[w],T=r[w+1],E=r[w+2],m=r[w+3],r[I++]=T*(-660635669420364e-19*T+.000437130475926232*E-54080610064599e-18*u+.00048449797120281*m-.154362151871126)-122.67195406894+E*(-.000957964378445773*E+.000817076911346625*u-.00477271405408747*m+1.53380253221734)+u*(.000961250184130688*u-.00266257332283933*m+.48357088451265)+m*(-.000336197177618394*m+.484791561490776),r[I++]=107.268039397724+T*(219927104525741e-19*T-.000640992018297945*E+.000659397001245577*u+.000426105652938837*m-.176491792462875)+E*(-.000778269941513683*E+.00130872261408275*u+.000770482631801132*m-.151051492775562)+u*(.00126935368114843*u-.00265090189010898*m+.25802910206845)+m*(-.000318913117588328*m-.213742400323665),r[I++]=T*(-.000570115196973677*T-263409051004589e-19*E+.0020741088115012*u-.00288260236853442*m+.814272968359295)-20.810012546947+E*(-153496057440975e-19*E-.000132689043961446*u+.000560833691242812*m-.195152027534049)+u*(.00174418132927582*u-.00255243321439347*m+.116935020465145)+m*(-.000343531996510555*m+.24165260232407);return r},_convertYcckToCmyk:function(r){for(var u,T,E,m=0,I=r.length;m<I;m+=4)u=r[m],T=r[m+1],E=r[m+2],r[m]=434.456-u-1.402*E,r[m+1]=119.541-u+.344*T+.714*E,r[m+2]=481.816-u-1.772*T;return r},_convertCmykToRgb:function(r){for(var u,T,E,m,I=0,w=1/255,U=0,L=r.length;U<L;U+=4)u=r[U]*w,T=r[U+1]*w,E=r[U+2]*w,m=r[U+3]*w,r[I++]=255+u*(-4.387332384609988*u+54.48615194189176*T+18.82290502165302*E+212.25662451639585*m-285.2331026137004)+T*(1.7149763477362134*T-5.6096736904047315*E-17.873870861415444*m-5.497006427196366)+E*(-2.5217340131683033*E-21.248923337353073*m+17.5119270841813)-m*(21.86122147463605*m+189.48180835922747),r[I++]=255+u*(8.841041422036149*u+60.118027045597366*T+6.871425592049007*E+31.159100130055922*m-79.2970844816548)+T*(-15.310361306967817*T+17.575251261109482*E+131.35250912493976*m-190.9453302588951)+E*(4.444339102852739*E+9.8632861493405*m-24.86741582555878)-m*(20.737325471181034*m+187.80453709719578),r[I++]=255+u*(.8842522430003296*u+8.078677503112928*T+30.89978309703729*E-.23883238689178934*m-14.183576799673286)+T*(10.49593273432072*T+63.02378494754052*E+50.606957656360734*m-112.23884253719248)+E*(.03296041114873217*E+115.60384449646641*m-193.58209356861505)-m*(22.33816807309886*m+180.12613974708367);return r},getData:function(r,u,T){if(this.numComponents>4)throw new d("Unsupported color mode");var E=this._getLinearizedBlockData(r,u);if(this.numComponents===1&&T){for(var m=E.length,I=new Uint8ClampedArray(3*m),w=0,U=0;U<m;U++){var L=E[U];I[w++]=L,I[w++]=L,I[w++]=L}return I}if(this.numComponents===3&&this._isColorConversionNeeded())return this._convertYccToRgb(E);if(this.numComponents===4){if(this._isColorConversionNeeded())return T?this._convertYcckToRgb(E):this._convertYcckToCmyk(E);if(T)return this._convertCmykToRgb(E)}return E}},p}()},(n=t())!==void 0&&(e.exports=n)),ot.exports;var e,t,n}var Oe=De(Pt());var xe=class{static decode(t,n=!1){let d=new Uint8Array(t),i=new Oe;i.parse(d);let{width:c,height:g,numComponents:h,eof:s}=i,o=i.getData(c,g,!0),a=c*g,f,l=null,p=0,y=0,A=0;if(!n&&s<d.length-1)try{let b=new le(d.subarray(s)).getBytes();l=new Uint8Array(a);let S=0;for(p=0;p<b.length;p++)for(A=7;A>=0;A--)l[S++]=b[p]>>A&1}catch{}if(h===1&&o.length===c*g){let b=new Uint8Array(o.buffer);f=[b,b,b]}else{for(f=[],p=0;p<3;p++)f.push(new Uint8Array(a));for(A=0,y=0;y<a;y++)for(p=0;p<3;p++)f[p][y]=o[A++]}return{width:c,height:g,pixels:f,mask:l}}};var lt=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}],Ke=null;function Me(){return Ke||(Ke=import("./chunk-EHZSGMW5.js").then(e=>e.l).then(({default:e})=>e({locateFile:t=>nt(`esri/layers/support/rasterFormats/${t}`)})).then(e=>{Ut(e)}),Ke)}var Ge={getBlobInfo:null,decode:null};function Lt(e){return 16+(e>>3<<3)}function fe(e,t,n){n.set(e.slice(t,t+n.length))}function Ut(e){let{_malloc:t,_free:n,_lerc_getBlobInfo:d,_lerc_getDataRanges:i,_lerc_decode_4D:c,asm:g}=e,h,s=Object.values(g).find(a=>a&&"buffer"in a&&a.buffer===e.HEAPU8.buffer),o=a=>{let f=a.map(A=>Lt(A)),l=f.reduce((A,b)=>A+b),p=t(l);h=new Uint8Array(s.buffer);let y=f[0];f[0]=p;for(let A=1;A<f.length;A++){let b=f[A];f[A]=f[A-1]+y,y=b}return f};Ge.getBlobInfo=a=>{let p=new Uint8Array(48),y=new Uint8Array(8*3),[A,b,S]=o([a.length,p.length,y.length]);h.set(a,A),h.set(p,b),h.set(y,S);let v=d(A,a.length,b,S,12,3);if(v)throw n(A),new Error(`lerc-getBlobInfo: error code is ${v}`);h=new Uint8Array(s.buffer),fe(h,b,p),fe(h,S,y);let P=new Uint32Array(p.buffer),r=new Float64Array(y.buffer),[u,T,,E,m,I,w,U,L,k,N]=P,B={version:u,depthCount:k,width:E,height:m,validPixelCount:w,bandCount:I,blobSize:U,maskCount:L,dataType:T,minValue:r[0],maxValue:r[1],maxZerror:r[2],statistics:[],bandCountWithNoData:N};if(N&&k>1)return n(A),B;if(k===1&&I===1)return n(A),B.statistics.push({minValue:r[0],maxValue:r[1]}),B;let O=k*I*8,V=new Uint8Array(O),x=new Uint8Array(O),j=A,D=0,R=0,G=!1;if(h.byteLength<A+2*O?(n(A),G=!0,[j,D,R]=o([a.length,O,O]),h.set(a,j)):[D,R]=o([O,O]),h.set(V,D),h.set(x,R),v=i(j,a.length,k,I,D,R),v)throw n(j),G||n(D),new Error(`lerc-getDataRanges: error code is ${v}`);h=new Uint8Array(s.buffer),fe(h,D,V),fe(h,R,x);let F=new Float64Array(V.buffer),X=new Float64Array(x.buffer),_=B.statistics;for(let M=0;M<I;M++)if(k>1){let H=F.slice(M*k,(M+1)*k),q=X.slice(M*k,(M+1)*k),he=Math.min.apply(null,H),be=Math.max.apply(null,q);_.push({minValue:he,maxValue:be,depthStats:{minValues:H,maxValues:q}})}else _.push({minValue:F[M],maxValue:X[M]});return n(j),G||n(D),B},Ge.decode=(a,f)=>{let{maskCount:l,depthCount:p,bandCount:y,width:A,height:b,dataType:S,bandCountWithNoData:v}=f,P=lt[S],r=A*b,u=new Uint8Array(r*y),T=r*p*y*P.size,E=new Uint8Array(T),m=new Uint8Array(y),I=new Uint8Array(8*y),[w,U,L,k,N]=o([a.length,u.length,E.length,m.length,I.length]);h.set(a,w),h.set(u,U),h.set(E,L),h.set(m,k),h.set(I,N);let B=c(w,a.length,l,U,p,A,b,y,S,L,k,N);if(B)throw n(w),new Error(`lerc-decode: error code is ${B}`);h=new Uint8Array(s.buffer),fe(h,L,E),fe(h,U,u);let O=null;if(v){fe(h,k,m),fe(h,N,I),O=[];let V=new Float64Array(I.buffer);for(let x=0;x<m.length;x++)O.push(m[x]?V[x]:null)}return n(w),{data:E,maskData:u,noDataValues:O}}}function kt(e,t,n,d,i){if(n<2)return e;let c=new d(t*n);for(let g=0,h=0;g<t;g++)for(let s=0,o=g;s<n;s++,o+=t)c[o]=e[h++];return c}function Re(e,t={}){let n=t.inputOffset??0,d=e instanceof Uint8Array?e.subarray(n):new Uint8Array(e,n),i=Ge.getBlobInfo(d),{data:c,maskData:g,noDataValues:h}=Ge.decode(d,i),{width:s,height:o,bandCount:a,depthCount:f,dataType:l,maskCount:p,statistics:y}=i,A=lt[l],b=new A.ctor(c.buffer),S=[],v=[],P=s*o,r=P*f;for(let w=0;w<a;w++){let U=b.subarray(w*r,(w+1)*r);if(t.returnInterleaved)S.push(U);else{let L=kt(U,P,f,A.ctor);S.push(L)}v.push(g.subarray(w*r,(w+1)*r))}let u=p===0?null:p===1?v[0]:new Uint8Array(P);if(p>1){u.set(v[0]);for(let w=1;w<v.length;w++){let U=v[w];for(let L=0;L<P;L++)u[L]=u[L]&U[L]}}let{noDataValue:T}=t,E=T!=null&&A.range[0]<=T&&A.range[1]>=T;if(p>0&&E)for(let w=0;w<a;w++){let U=S[w],L=v[w]||u;for(let k=0;k<P;k++)L[k]===0&&(U[k]=T)}let m=p===a&&a>1?v:null,{pixelType:I}=A;return{width:s,height:o,bandCount:a,pixelType:I,depthCount:f,statistics:y,pixels:S,mask:u,bandMasks:m,noDataValues:h}}function Dt(e,t,n,d=!0){if(t%4!=0||n%4!=0){let i=new ArrayBuffer(4*Math.ceil(n/4)),c=new Uint8Array(i),g=new Uint8Array(e,t,n);if(d)for(let h=0;h<c.length;h+=4)c[h]=g[h+3],c[h+1]=g[h+2],c[h+2]=g[h+1],c[h+3]=g[h];else c.set(g);return new Uint32Array(c.buffer)}if(d){let i=new Uint8Array(e,t,n),c=new Uint8Array(i.length);for(let g=0;g<c.length;g+=4)c[g]=i[g+3],c[g+1]=i[g+2],c[g+2]=i[g+1],c[g+3]=i[g];return new Uint32Array(c.buffer)}return new Uint32Array(e,t,n/4)}function ct(){let e=[];for(let t=0;t<=257;t++)e[t]=[t];return e}function ft(e,t){for(let n=0;n<t.length;n++)e.push(t[n])}var Te=new Set;function ve(e,t,n,d=!0){let i=Dt(e,t,n,d),c=9,g=ct(),h=32,s=g.length,o=[],a=1,f=i[0],l=0,p=i.length,y=8*(4*p-n),A=[];for(;f!=null;){if(h>=c)h-=c,l=f>>>32-c,f<<=c;else{l=f>>>32-h,f=i[a++];let S=c-h;h=32-S,l=(l<<S)+(f>>>h),f<<=S}if(l===257)break;if(l===256){c=9,g=ct(),s=g.length,o=[];continue}let b=g[l];if(b==null){if(l>g.length)throw new Error("data integrity issue: code does not exist on code page");o.push(o[0]),g[s++]=o.slice(),ft(A,o)}else ft(A,b),o.push(b[0]),o.length>1&&(g[s++]=o.slice()),o=b.slice();if(Te.has(s)&&c++,h===0&&(f=i[a++],h=32),a>p||a===p&&h<=y)break}return new Uint8Array(A)}Te.add(511),Te.add(1023),Te.add(2047),Te.add(4095),Te.add(8191);var ht=(e,t)=>{let n=t.width*t.height,d=t.pixelType;return Math.floor(e.byteLength/(n*ut(d)))},ut=e=>{let t=1;switch(e){case Uint8Array:case Int8Array:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},Ct=(e,t)=>{if(8*e.byteLength<t)return null;let n=new Uint8Array(e,0,Math.ceil(t/8)),d=new Uint8Array(t),i=0,c=0,g=0,h=0;for(g=0;g<n.length-1;g++)for(c=n[g],h=7;h>=0;h--)d[i++]=c>>h&1;for(h=7;i<t-1;)c=n[n.length-1],d[i++]=c>>h&1,h--;return d},Ne=class{static decode(t,n){let d=n.pixelType,i=[],c=n.width*n.height,g=ht(t,n),{bandIds:h,format:s}=n,o=h?.length||ht(t,n),a=t.byteLength-t.byteLength%(c*ut(d)),f=new d(t,0,c*g),l,p,y,A,b=null;if(s==="bip")for(l=0;l<o;l++){for(y=new d(c),A=h?h[l]:l,p=0;p<c;p++)y[p]=f[p*g+A];i.push(y)}else if(s==="bsq")for(l=0;l<o;l++)A=h?h[l]:l,i.push(f.subarray(A*c,(A+1)*c));return a<t.byteLength-1&&(b=Ct(t.slice(a),c)),{pixels:i,mask:b}}};function dt(e,t){let n=0,d="",i=0,c=0,g=e.length;for(;n<g;)c=e[n++],i=c>>4,i<8?i=1:i===15?(i=4,c=(7&c)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++]):i===14?(i=3,c=(15&c)<<12|(63&e[n++])<<6|63&e[n++]):(i=2,c=(31&c)<<6|63&e[n++]),(c!==0||t)&&(d+=String.fromCharCode(c));return d}var je=(()=>{let e=[];return e[254]="NEWSUBFILETYPE",e[255]="SUBFILETYPE",e[256]="IMAGEWIDTH",e[257]="IMAGELENGTH",e[258]="BITSPERSAMPLE",e[259]="COMPRESSION",e[262]="PHOTOMETRICINTERPRETATION",e[263]="THRESHHOLDING",e[264]="CELLWIDTH",e[265]="CELLLENGTH",e[266]="FILLORDER",e[269]="DOCUMENTNAME",e[270]="IMAGEDESCRIPTION",e[271]="MAKE",e[272]="MODEL",e[273]="STRIPOFFSETS",e[274]="ORIENTATION",e[277]="SAMPLESPERPIXEL",e[278]="ROWSPERSTRIP",e[279]="STRIPBYTECOUNTS",e[280]="MINSAMPLEVALUE",e[281]="MAXSAMPLEVALUE",e[282]="XRESOLUTION",e[283]="YRESOLUTION",e[284]="PLANARCONFIGURATION",e[285]="PAGENAME",e[286]="XPOSITION",e[287]="YPOSITION",e[288]="FREEOFFSETS",e[289]="FREEBYTECOUNTS",e[290]="GRAYRESPONSEUNIT",e[291]="GRAYRESPONSECURVE",e[292]="T4OPTIONS",e[293]="T6OPTIONS",e[296]="RESOLUTIONUNIT",e[297]="PAGENUMBER",e[300]="COLORRESPONSEUNIT",e[301]="TRANSFERFUNCTION",e[305]="SOFTWARE",e[306]="DATETIME",e[315]="ARTIST",e[316]="HOSTCOMPUTER",e[317]="PREDICTOR",e[318]="WHITEPOINT",e[319]="PRIMARYCHROMATICITIES",e[320]="COLORMAP",e[321]="HALFTONEHINTS",e[322]="TILEWIDTH",e[323]="TILELENGTH",e[324]="TILEOFFSETS",e[325]="TILEBYTECOUNTS",e[326]="BADFAXLINES",e[327]="CLEANFAXDATA",e[328]="CONSECUTIVEBADFAXLINES",e[330]="SUBIFD",e[332]="INKSET",e[333]="INKNAMES",e[334]="NUMBEROFINKS",e[336]="DOTRANGE",e[337]="TARGETPRINTER",e[338]="EXTRASAMPLES",e[339]="SAMPLEFORMAT",e[340]="SMINSAMPLEVALUE",e[341]="SMAXSAMPLEVALUE",e[342]="TRANSFERRANGE",e[347]="JPEGTABLES",e[512]="JPEGPROC",e[513]="JPEGIFOFFSET",e[514]="JPEGIFBYTECOUNT",e[515]="JPEGRESTARTINTERVAL",e[517]="JPEGLOSSLESSPREDICTORS",e[518]="JPEGPOINTTRANSFORM",e[519]="JPEGQTABLES",e[520]="JPEGDCTABLES",e[521]="JPEGACTABLES",e[529]="YCBCRCOEFFICIENTS",e[530]="YCBCRSUBSAMPLING",e[531]="YCBCRPOSITIONING",e[532]="REFERENCEBLACKWHITE",e[700]="XMP",e[33550]="GEOPIXELSCALE",e[33922]="GEOTIEPOINTS",e[33432]="COPYRIGHT",e[42112]="GDAL_METADATA",e[42113]="GDAL_NODATA",e[50844]="RPCCOEFFICIENT",e[34264]="GEOTRANSMATRIX",e[34735]="GEOKEYDIRECTORY",e[34736]="GEODOUBLEPARAMS",e[34737]="GEOASCIIPARAMS",e[34665]="EXIFIFD",e[34853]="GPSIFD",e[40965]="INTEROPERABILITYIFD",e})(),Ot=(()=>{let e=je.slice();return e[36864]="ExifVersion",e[40960]="FlashpixVersion",e[40961]="ColorSpace",e[42240]="Gamma",e[37121]="ComponentsConfiguration",e[37122]="CompressedBitsPerPixel",e[40962]="PixelXDimension",e[40963]="PixelYDimension",e[37500]="MakerNote",e[37510]="UserComment",e[40964]="RelatedSoundFile",e[36867]="DateTimeOriginal",e[36868]="DateTimeDigitized",e[36880]="OffsetTime",e[36881]="OffsetTimeOriginal",e[36882]="OffsetTimeDigitized",e[37520]="SubSecTime",e[37521]="SubSecTimeOriginal",e[37522]="SubSecTimeDigitized",e[37888]="Temperature",e[37889]="Humidity",e[37890]="Pressure",e[37891]="WaterDepth",e[37892]="Acceleration",e[37893]="CameraElevationAngle",e[42016]="ImageUniqueID",e[42032]="CameraOwnerName",e[42033]="BodySerialNumber",e[42034]="LensSpecification",e[42035]="LensMake",e[42036]="LensModel",e[42037]="LensSerialNumber",e[33434]="ExposureTime",e[33437]="FNumber",e[34850]="ExposureProgram",e[34852]="SpectralSensitivity",e[34855]="PhotographicSensitivity",e[34856]="OECF",e[34864]="SensitivityType",e[34865]="StandardOutputSensitivity",e[34866]="RecommendedExposureIndex",e[34867]="ISOSpeed",e[34868]="ISOSpeedLatitudeyyy",e[34869]="ISOSpeedLatitudezzz",e[37377]="ShutterSpeedValue",e[37378]="ApertureValue",e[37379]="BrightnessValue",e[37380]="ExposureBiasValue",e[37381]="MaxApertureValue",e[37382]="SubjectDistance",e[37383]="MeteringMode",e[37384]="LightSource",e[37385]="Flash",e[37386]="FocalLength",e[37396]="SubjectArea",e[41483]="FlashEnergy",e[41484]="SpatialFrequencyResponse",e[41486]="FocalPlaneXResolution",e[41487]="FocalPlaneYResolution",e[41488]="FocalPlaneResolutionUnit",e[41492]="SubjectLocation",e[41493]="ExposureIndex",e[41495]="SensingMethod",e[41728]="FileSource",e[41729]="SceneType",e[41730]="CFAPattern",e[41985]="CustomRendered",e[41986]="ExposureMode",e[41987]="WhiteBalance",e[41988]="DigitalZoomRatio",e[41989]="FocalLengthIn35mmFilm",e[41990]="SceneCaptureType",e[41991]="GainControl",e[41992]="Contrast",e[41993]="Saturation",e[41994]="Sharpness",e[41995]="DeviceSettingDescription",e[41996]="SubjectDistanceRange",e})(),xt=["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"],Gt=(()=>{let e=[];return e[1024]="GTModelTypeGeoKey",e[1025]="GTRasterTypeGeoKey",e[1026]="GTCitationGeoKey",e[2048]="GeographicTypeGeoKey",e[2049]="GeogCitationGeoKey",e[2050]="GeogGeodeticDatumGeoKey",e[2051]="GeogPrimeMeridianGeoKey",e[2052]="GeogLinearUnitsGeoKey",e[2053]="GeogLinearUnitSizeGeoKey",e[2054]="GeogAngularUnitsGeoKey",e[2055]="GeogAngularUnitSizeGeoKey",e[2056]="GeogEllipsoidGeoKey",e[2057]="GeogSemiMajorAxisGeoKey",e[2058]="GeogSemiMinorAxisGeoKey",e[2059]="GeogInvFlatteningGeoKey",e[2061]="GeogPrimeMeridianLongGeoKey",e[2060]="GeogAzimuthUnitsGeoKey",e[3072]="ProjectedCSTypeGeoKey",e[3073]="PCSCitationGeoKey",e[3074]="ProjectionGeoKey",e[3075]="ProjCoordTransGeoKey",e[3076]="ProjLinearUnitsGeoKey",e[3077]="ProjLinearUnitSizeGeoKey",e[3078]="ProjStdParallel1GeoKey",e[3079]="ProjStdParallel2GeoKey",e[3080]="ProjNatOriginLongGeoKey",e[3081]="ProjNatOriginLatGeoKey",e[3082]="ProjFalseEastingGeoKey",e[3083]="ProjFalseNorthingGeoKey",e[3084]="ProjFalseOriginLongGeoKey",e[3085]="ProjFalseOriginLatGeoKey",e[3086]="ProjFalseOriginEastingGeoKey",e[3087]="ProjFalseOriginNorthingGeoKey",e[3088]="ProjCenterLongGeoKey",e[3090]="ProjCenterEastingGeoKey",e[3091]="ProjCenterNorthingGeoKey",e[3092]="ProjScaleAtNatOriginGeoKey",e[3093]="ProjScaleAtCenterGeoKey",e[3094]="ProjAzimuthAngleGeoKey",e[3095]="ProjStraightVertPoleLongGeoKey",e[4096]="VerticalCSTypeGeoKey",e[4097]="VerticalCitationGeoKey",e[4098]="VerticalDatumGeoKey",e[4099]="VerticalUnitsGeoKey",e})(),Mt=(e,t)=>{let n=(t||je)[e];return n===void 0&&(n="unknown"+String(e)),n},He=new Map;He.set("EXIFIFD",Ot),He.set("GPSIFD",xt);var ye={tiffTags:je,ifdTags:He,geoKeys:Gt,getTagName:Mt};var Pe=(()=>{let e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,t[0]===1})();var pt=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],Ee=4294967296,Rt=new Set([1,5,6,7,8,34712,34887]);function Ze(e,t){let n="unknown";return e===3?n=t===64?"f64":"f32":e===1?t===1?n="u1":t===2?n="u2":t===4?n="u4":t<=8?n="u8":t<=16?n="u16":t<=32&&(n="u32"):e===2&&(t<=8?n="s8":t<=16?n="s16":t<=32&&(n="s32")),n}function Be(e){let t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f64":t=Float64Array;break;default:t=Float32Array}return t}function Nt(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function mt(e,t){return e.get(t)?.values}function we(e,t){return e.get(t)?.values}function gt(e,t){return e.get(t)?.values?.[0]}function K(e,t){return e.get(t)?.values?.[0]}function Ye(e,t,n,d=0,i=ye.tiffTags,c=4){let g=c===8,h=g?Qe(new DataView(e,n,8),0,t):new DataView(e,n,2).getUint16(0,t),s=4+2*c,o=g?8:2,a=o+h*s;if(n+a>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:a};let f=n+a+4<=e.byteLength?Fe(new DataView(e,n+a,c===8?8:4),0,t,c===8):null,l=n+o,p=new Map,y,A,b,S,v,P=0,r=0;for(let u=0;u<h;u++){A=new DataView(e,l+s*u,s),b=A.getUint16(0,t),v=A.getUint16(2,t),S=ye.getTagName(b,i);let T=[];c===2?(P=A.getUint16(4,t),r=A.getUint16(6,t)):c===4?(P=A.getUint32(4,t),r=A.getUint32(8,t)):c===8&&(P=Fe(A,4,t,!0),r=Fe(A,12,t,!0),T.push(A.getUint32(12,t)),T.push(A.getUint32(16,t))),y={id:b,type:v,valueCount:P,valueOffset:r,valueOffsets:T,values:null},Ht(e,t,y,d,!1,c),p.set(S,y)}return{success:!0,ifd:p,nextIFD:f,requiredBufferSize:a}}var Ft=(e,t)=>Re(e,{inputOffset:t}).pixels[0];function We(e,t){if(t!==1&&t!==2&&t!==4)return e;let n=new Uint8Array(e),d=8/t,i=new Uint8Array(e.byteLength*d),c=0,g=2**t-1;for(let h=0;h<n.length;h++){let s=n[h];for(let o=0;o<d;o++)i[c++]=s<<t*o>>>8-t&g}return i.buffer}function Xe(e,t,n){let d=new Oe;d.parse(e),d.colorTransform=n===6?-1:0;let i=d.getData(d.width,d.height,t!==1&&t!==4);return new Uint8Array(i.buffer)}function Je(e){let t=new le(e).getBytes(),n=new ArrayBuffer(t.length),d=new Uint8Array(n);return d.set(t),d}function qe(e,t,n,d,i){return ae(this,null,function*(){let c=Pe===t,g=K(n,"BITSPERSAMPLE"),h=K(n,"SAMPLESPERPIXEL")??1,s=K(n,"PHOTOMETRICINTERPRETATION"),o=K(n,"SAMPLEFORMAT")??1,a=Ze(o,g),f=K(n,"COMPRESSION")??1,l=Be(a),p,y,A;if(f===34887)return yield Me(),Ft(e,d);if(f===1)p=e.slice(d,d+i),y=new Uint8Array(p);else if(f===8||f===32946)y=new Uint8Array(e,d,i),y=Je(y),p=y.buffer;else if(f===6)y=new Uint8Array(e,d,i),y=Xe(y,h,s),p=y.buffer;else if(f===7){let P=n.get("JPEGTABLES").values,r=P.length-2;y=new Uint8Array(r+i-2);for(let T=0;T<r;T++)y[T]=P[T];let u=new Uint8Array(e,d+2,i-2);for(let T=0;T<u.length;T++)y[r+T]=u[T];y=Xe(y,h,s),p=y.buffer}else{if(f!==5)throw new Error("tiff-decode: unsupport compression "+f);y=ve(e,d,i,t),p=y.buffer}if(p=We(p,g),a==="u8"||a==="s8"||c)A=new l(p);else{p=new ArrayBuffer(y.length);let P=new Uint8Array(p);switch(a){case"u16":case"s16":for(let r=0;r<y.length;r+=2)P[r]=y[r+1],P[r+1]=y[r];break;case"u32":case"s32":case"f32":for(let r=0;r<y.length;r+=4)P[r]=y[r+3],P[r+1]=y[r+2],P[r+2]=y[r+1],P[r+3]=y[r]}A=new l(p)}let b=K(n,"PREDICTOR")??1,S=K(n,"TILEWIDTH"),v=K(n,"TILELENGTH");if(b>1&&(f===5||f===8||f===32946)&&S&&v){let P=Ve(n),r=new l(A.length);r.set(A),A=Jt(r,v,S,o===3&&b===3,P?1:h)}return A})}function Bt(e,t,n){return ae(this,null,function*(){let d=we(n,"TILEOFFSETS");if(d===void 0)return null;let i=we(n,"TILEBYTECOUNTS"),{width:c,height:g,pixelType:h,tileWidth:s,tileHeight:o}=ze([n]),a=Ve(n,t),f=K(n,"SAMPLESPERPIXEL")||t.planes,l=c*g,p=K(n,"BITSPERSAMPLE"),y=(K(n,"COMPRESSION")??1)===34887,A=Be(h),b=[];for(let V=0;V<f;V++)b.push(new A(l));let S,v,P,r,u,T,E,m,I,w,U,L,k,N=Math.ceil(c/s),B=new Uint8Array(l).fill(255),O=!1;if(p%8==0)if(y&&a&&f>1){let V=Math.round(d.length/f);for(S=0;S<V;S++){T=Math.floor(S/N)*o,E=S%N*s,m=T*c+E;for(let x=0;x<f;x++){let j=S*f+x;for(i[j]===0?(P=null,O=!0):P=yield qe(e,t.littleEndian,n,d[j],i[j]),w=0,I=m,L=Math.min(s,c-E),U=Math.min(o,g-T),k=b[x],r=0;r<U;r++)for(I=m+r*c,w=r*s,u=0;u<L;u++,I++,w++)P?k[I]=P[w]:B[I]=0}}}else for(S=0;S<d.length;S++)for(T=Math.floor(S/N)*o,E=S%N*s,m=T*c+E,i[S]===0?(P=null,O=!0):P=yield qe(e,t.littleEndian,n,d[S],i[S]),w=0,I=m,L=Math.min(s,c-E),U=Math.min(o,g-T),v=0;v<f;v++)if(k=b[v],a||y)for(r=0;r<U;r++)for(I=m+r*c,w=s*o*v+r*s,u=0;u<L;u++,I++,w++)P?k[I]=P[w]:B[I]=0;else for(r=0;r<U;r++)for(I=m+r*c,w=r*s*f+v,u=0;u<L;u++,I++,w+=f)P?k[I]=P[w]:B[I]=0;return{width:c,height:g,pixelType:h,pixels:b,mask:O?B:void 0}})}var Vt=(e,t,n)=>{let d=Pe===t.littleEndian,i=we(n,"STRIPOFFSETS");if(i===void 0)return null;let{width:c,height:g,pixelType:h}=ze([n]),s=K(n,"SAMPLESPERPIXEL")||t.planes,o=K(n,"PHOTOMETRICINTERPRETATION"),a=c*g,f=K(n,"BITSPERSAMPLE"),l=Be(h),p=new l(a*s),y=we(n,"STRIPBYTECOUNTS"),A=K(n,"ROWSPERSTRIP"),b=K(n,"COMPRESSION")??1,S,v,P,r,u,T,E,m,I;if(f%8==0)for(S=0;S<i.length;S++){if(u=S*(A*c)*s,h==="u8"||h==="s8"||d)b===8||b===32946?(E=new Uint8Array(e,i[S],y[S]),E=Je(E),T=E.buffer):b===6?(E=new Uint8Array(e,i[S],y[S]),E=Xe(E,s,o),T=E.buffer):b===5?(E=ve(e,i[S],y[S],t.littleEndian),T=E.buffer):T=e.slice(i[S],i[S]+y[S]),T=We(T,f),r=new l(T);else{switch(b===6||b===8||b===32946?(E=new Uint8Array(e,i[S],y[S]),m=Je(E),T=m.buffer):(T=new ArrayBuffer(y[S]),E=new Uint8Array(e,i[S],y[S]),m=new Uint8Array(T)),h){case"u16":case"s16":for(P=0;P<E.length;P+=2)m[P]=E[P+1],m[P+1]=E[P];break;case"u32":case"s32":case"f32":for(P=0;P<E.length;P+=4)m[P]=E[P+3],m[P+1]=E[P+2],m[P+2]=E[P+1],m[P+3]=E[P]}T=We(T,f),r=new l(T)}p.set(r,u)}let w=[];if(s===1)w.push(p);else for(S=0;S<s;S++){for(I=new l(a),v=0;v<a;v++)I[v]=p[v*s+S];w.push(I)}return{width:c,height:g,pixelType:h,pixels:w}},_t=(e,t,n)=>{if(!(e.length>0&&t&&n))return null;let d,i,c,g=e[0].length,h=e.length,s=new Uint8Array(g);for(let o=0;o<h;o++)if(d=e[o],i=t[o],c=n[o],o===0)for(let a=0;a<g;a++)s[a]=d[a]<i||d[a]>c?0:1;else for(let a=0;a<g;a++)s[a]&&(s[a]=d[a]<i||d[a]>c?0:1);return s},Kt=e=>{if(!e)return null;let t=e.match(/<Item(.*?)Item>/gi);if(!t||t.length===0)return null;let n=new Map,d,i,c,g,h;for(let S=0;S<t.length;S++)d=t[S],i=d.slice(6,d.indexOf(">")),g=d.indexOf("sample="),g>-1&&(h=d.slice(g+8,d.indexOf('"',g+8))),g=d.indexOf("name="),g>-1&&(i=d.slice(g+6,d.indexOf('"',g+6))),i&&(c=d.slice(d.indexOf(">")+1,d.indexOf("</Item>")).trim(),h!=null?n.has(i)?n.get(i)[h]=c:n.set(i,[c]):n.set(i,c)),h=null;let s=n.get("STATISTICS_MINIMUM"),o=n.get("STATISTICS_MAXIMUM"),a=n.get("STATISTICS_MEAN"),f=n.get("STATISTICS_STDDEV"),l=null;if(s&&o){l=[];for(let S=0;S<s.length;S++)l.push({min:parseFloat(s[S]),max:parseFloat(o[S]),avg:a&&parseFloat(a[S]),stddev:f&&parseFloat(f[S])})}let p=n.get("BandName"),y=n.get("WavelengthMin"),A=n.get("WavelengthMax"),b=null;if(p){b=[];for(let S=0;S<p.length;S++)b.push({BandName:p[S],WavelengthMin:y&&parseFloat(y[S]),WavelengthMax:A&&parseFloat(A[S])})}return{statistics:l,bandProperties:b,dataType:n.get("DataType"),rawMetadata:n}};function Ht(e,t,n,d=0,i=!1,c=4){if(n.values)return!0;let g=n.type,h=n.valueCount,s=n.valueOffset,o=[],a=pt[g],f=8*a,l=h*a,p=h*pt[g]*8,y,A,b=c===8?64:32,S=n.valueOffsets;if(p>b&&l>(i?e.byteLength:e?e.byteLength-s+d:0))return n.offlineOffsetSize=[s,l],n.values=null,!1;if(p<=b){if(!t)if(b<=32)s>>>=32-p;else{let v=S?.length?S[0]:s>>>0,P=S?.length?S[1]:Math.round((s-v)/Ee);p<=32?(s=v>>>32-p,S[0]=s):(s=v*2**(32-p)+(P>>>32-p),S[0]=v,S[1]=P>>>32-p)}if(h===1&&f===b)o=[s];else if(b===64){let v=S?.length?S[0]:s>>>0,P=S?.length?S[1]:Math.round((s-v)/Ee),r=v,u=32;for(A=1;A<=h;A++){let T=32-f*A%32;if(u<f){let E=r<<T>>>32-u,m=P<<32-u>>>32-u;r=P,o.push(E+m*2**(f-u)),u-=32-(f-u)}else o.push(r<<T>>>32-f),u-=f;u===0&&(u=32,r=P)}}else for(A=1;A<=h;A++){let v=32-f*A;o.push(s<<v>>>32-f)}}else{s-=d,i&&(s=0);for(let v=s;v<s+l;v+=a){switch(g){case 1:case 2:case 7:y=new DataView(e,v,1).getUint8(0);break;case 3:y=new DataView(e,v,2).getUint16(0,t);break;case 4:case 13:y=new DataView(e,v,4).getUint32(0,t);break;case 5:y=new DataView(e,v,4).getUint32(0,t)/new DataView(e,v+4,4).getUint32(0,t);break;case 6:y=new DataView(e,v,1).getInt8(0);break;case 8:y=new DataView(e,v,2).getInt16(0,t);break;case 9:y=new DataView(e,v,4).getInt32(0,t);break;case 10:y=new DataView(e,v,4).getInt32(0,t)/new DataView(e,v+4,4).getInt32(0,t);break;case 11:y=new DataView(e,v,4).getFloat32(0,t);break;case 12:y=new DataView(e,v,8).getFloat64(0,t);break;case 16:case 18:y=Qe(new DataView(e,v,8),0,t);break;case 17:y=Yt(new DataView(e,v,8),0,t);break;default:y=null}o.push(y)}}if(g===2){let v="",P=o;for(o=[],A=0;A<P.length;A++)P[A]===0&&v!==""?(o.push(v),v=""):v+=String.fromCharCode(P[A]);v===""&&o.length!==0||o.push(v)}return n.values=o,!0}function ze(e){let t=e[0],n=K(t,"TILEWIDTH"),d=K(t,"TILELENGTH"),i=K(t,"IMAGEWIDTH"),c=K(t,"IMAGELENGTH"),g=K(t,"BITSPERSAMPLE"),h=K(t,"SAMPLESPERPIXEL"),s=K(t,"SAMPLEFORMAT")??1,o=Ze(s,g),a=Ve(t),f=mt(t,"GDAL_NODATA"),l=null;f?.length&&(l=f.map(R=>parseFloat(R)),l.some(R=>isNaN(R))&&(l=null));let p=K(t,"COMPRESSION")??1,y;switch(p){case 1:y="NONE";break;case 2:case 3:case 4:case 32771:y="CCITT";break;case 5:y="LZW";break;case 6:case 7:y="JPEG";break;case 32773:y="PACKBITS";break;case 8:case 32946:y="DEFLATE";break;case 34712:y="JPEG2000";break;case 34887:y="LERC";break;default:y=String(p)}let A=!0,b="";Rt.has(p)||(A=!1,b+="unsupported tag compression "+p),s>3&&(A=!1,b+="unsupported tag sampleFormat "+s),g!==1&&g!==2&&g!==4&&g%8!=0&&(A=!1,b+="unsupported tag bitsPerSample "+g);let S=gt(t,"GEOASCIIPARAMS"),v;if(S){let R=S.split("|").find(F=>F.includes("ESRI PE String = ")),G=R?R.replace("ESRI PE String = ",""):"";v=G.startsWith("COMPD_CS")||G.startsWith("PROJCS")||G.startsWith("GEOGCS")?{wkid:null,wkt:G}:null}let P=we(t,"GEOTIEPOINTS"),r=we(t,"GEOPIXELSCALE"),u=we(t,"GEOTRANSMATRIX"),T=t.has("GEOKEYDIRECTORY")?t.get("GEOKEYDIRECTORY").data:null,E,m,I=!1,w=!1;if(T){I=K(T,"GTRasterTypeGeoKey")===2;let R=K(T,"GTModelTypeGeoKey");if(R===2){let G=K(T,"GeographicTypeGeoKey");G>=1024&&G<=32766&&(v={wkid:G}),v||G!==32767||(w=!0,v={wkid:4326})}else if(R===1){let G=K(T,"ProjectedCSTypeGeoKey");G>=1024&&G<=32766&&(v={wkid:G})}}if(r&&P&&P.length>=6?(E=[r[0],0,P[3]-P[0]*r[0],0,-Math.abs(r[1]),P[4]-P[1]*r[1]],I&&(E[2]-=.5*E[0]+.5*E[1],E[5]-=.5*E[3]+.5*E[4])):u&&u.length===16&&(E=I?[u[0],u[1],u[3]-.5*u[0],u[4],u[5],u[7]-.5*u[5]]:[u[0],u[1],u[3],u[4],u[5],u[7]]),E){let R=[{x:0,y:c},{x:0,y:0},{x:i,y:c},{x:i,y:0}],G,F=Number.POSITIVE_INFINITY,X=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;for(let H=0;H<R.length;H++)G=Nt(R[H],E),F=G.x>F?F:G.x,_=G.x<_?_:G.x,X=G.y>X?X:G.y,M=G.y<M?M:G.y;m={xmin:F,xmax:_,ymin:X,ymax:M,spatialReference:v}}else m={xmin:-.5,ymin:.5-c,xmax:i-.5,ymax:.5,spatialReference:v};w&&(m.xmax-m.xmin>400||Math.max(Math.abs(m.xmin),Math.abs(m.xmax))>361)&&(v=null,m.spatialReference=null);let U=yt(e),L,k,N,B,O;if(U.length>0){N=Math.round(Math.log(i/K(U[0],"IMAGEWIDTH"))/Math.LN2);let R=U[U.length-1];B=U.length,L=K(R,"TILEWIDTH"),k=K(R,"TILELENGTH")}L=B!=null&&B>0?L||n:null,k=B!=null&&B>0?k||d:null,n&&(O=[{maxCol:Math.ceil(i/n)-1,maxRow:Math.ceil(c/d)-1,minRow:0,minCol:0}],U.forEach(R=>{O.push({maxCol:Math.ceil(K(R,"IMAGEWIDTH")/K(R,"TILEWIDTH"))-1,maxRow:Math.ceil(K(R,"IMAGELENGTH")/K(R,"TILELENGTH"))-1,minRow:0,minCol:0})}));let V=gt(e[0],"GDAL_METADATA"),x=Kt(V);b+=" "+Tt({width:i,height:c,tileWidth:n,tileHeight:d,planes:h,ifds:e});let j=wt(e).length===U.length+1,D=U?.length?U.map(R=>({x:i/K(R,"IMAGEWIDTH"),y:c/K(R,"IMAGELENGTH")})):void 0;return{width:i,height:c,tileWidth:n,tileHeight:d,planes:h,isBSQ:a,pixelType:o,compression:y,noData:l,hasMaskBand:j,isSupported:A,pyramidResolutions:D,message:b,extent:m,isPseudoGeographic:w,affine:r?null:E,firstPyramidLevel:N,maximumPyramidLevel:B,pyramidBlockWidth:L,pyramidBlockHeight:k,tileBoundary:O,metadata:x}}function Ve(e,t){let n=mt(e,"PLANARCONFIGURATION");return n?n[0]===2:!!t&&t.isBSQ}function yt(e){return e.filter(t=>K(t,"NEWSUBFILETYPE")===1)}function wt(e){return e.filter(t=>{let n=!(4&~(K(t,"NEWSUBFILETYPE")??0)),d=K(t,"PHOTOMETRICINTERPRETATION")===4;return n&&d})}function jt(e){let{littleEndian:t,isBigTiff:n,firstIFDPos:d}=Wt(e),i=d,c=[];do{let g=Xt(e,t,i,0,ye.tiffTags,n?8:4);if(!g.success)break;c.push(g.ifd),i=g.nextIFD}while(i>0);return Se(me({},ze(c)),{littleEndian:t,isBigTiff:n,ifds:c,pyramidIFDs:yt(c),maskIFDs:wt(c)})}function Qe(e,t,n){let d=e.getUint32(t,n),i=e.getUint32(t+4,n);return n?i*Ee+d:d*Ee+i}function Yt(e,t,n){let d=n?e.getInt32(t,n):e.getUint32(t,n),i=n?e.getUint32(t+4,n):e.getInt32(t+4,n),c=(n?d:i)>=0?1:-1;return n?d*=c:i*=c,c*(n?i*Ee+d:d*Ee+i)}function Fe(e,t,n,d){return d?Qe(e,t,n):e.getUint32(t,n)}function Wt(e){let t=new DataView(e,0,16),n=t.getUint16(0,!1),d=null;if(n===18761)d=!0;else{if(n!==19789)throw new Error("unexpected endianess byte");d=!1}let i=t.getUint16(2,d);if(i!==42&&i!==43)throw new Error("unexpected tiff identifier");let c=4,g=i===43;if(g){let h=t.getUint16(c,d);if(c+=2,h!==8)throw new Error("unsupported bigtiff version");if(t.getUint16(c,d)!==0)throw new Error("unsupported bigtiff version");c+=2}return{littleEndian:d,isBigTiff:g,firstIFDPos:Fe(t,c,d,g)}}function Xt(e,t,n,d=0,i=ye.tiffTags,c=4){let g=Ye(e,t,n,d,i,c),h,s=g.ifd;if(s){if(ye.ifdTags.forEach((o,a)=>{s.has(a)&&(h=s.get(a),h.data=Ye(e,t,h.valueOffset-d,d,o).ifd)}),s.has("GEOKEYDIRECTORY")){h=s.get("GEOKEYDIRECTORY");let o=h.values;if(o&&o.length>4){let a=o[0]+"."+o[1]+"."+o[2];h.data=Ye(e,t,h.valueOffset+6-d,d,ye.geoKeys,2).ifd,h.data&&h.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[a]})}}if(s.has("XMP")){h=s.get("XMP");let o=h.values;typeof o[0]=="number"&&h.type===7&&(h.values=[dt(new Uint8Array(o))])}}return g}function Tt(e){let{width:t,height:n,tileHeight:d,tileWidth:i}=e,c=e.planes,g=i?i*d:t*n,h=K(e.ifds[0],"BITSPERSAMPLE"),s="";return g*c>2**30/(h>8?h/8:1)&&(s=i?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),s}function Jt(e,t,n,d,i){let c=d?4:1,g=n*c*i;d&&(e=new Uint8Array(e.buffer));for(let o=0;o<t;o++){let a=o*g;for(let f=i;f<g;f++)e[a+f]+=e[a+f-i]}if(!d)return e;let h=new Uint8Array(e.length),s=n*i;for(let o=0;o<t;o++){let a=o*g;for(let f=0;f<s;f++)for(let l=0;l<c;l++)h[a+f*c+l]=e[a+f+(c-l-1)*s]}return new Float32Array(h.buffer)}function Et(e,t){return ae(this,null,function*(){let{headerInfo:n,ifd:d,offsets:i,sizes:c}=t,g=[];for(let I=0;I<i.length;I++){c[I];let w=yield qe(e,n.littleEndian,d,i[I],c[I]||e.byteLength);g.push(w)}let h=Ve(d,n),s=K(d,"BITSPERSAMPLE"),o=Ze(K(d,"SAMPLEFORMAT")??1,s),a=K(d,"SAMPLESPERPIXEL")||n.planes,f=Be(o),l=K(d,"TILEWIDTH"),p=K(d,"TILELENGTH"),y=K(d,"COMPRESSION")??1,A=l*p,b,S=[],v=g[0],P=y===34887;for(let I=0;I<a;I++){if(b=new f(A),g.length===a)v=g[I],v.length===A&&(b=v);else if(v.length)if(h||P)b=v.length===A?v:v.slice(A*I,A*(I+1));else for(let w=0;w<A;w++)b[w]=v[w*a+I];S.push(b)}let r=n.noData?n.noData[0]:t.noDataValue,u=n.metadata?n.metadata.statistics:null,T=u?u.map(I=>I.min):null,E=u?u.map(I=>I.max):null,m={pixelType:o,width:l,height:p,pixels:S,noDataValue:r};return r!=null?Ie(m,r,{matchAllNoData:t?.matchAllNoData}):T&&E&&t.applyMinMaxConstraint&&(m.mask=_t(S,T,E)),m})}function bt(n){return ae(this,arguments,function*(e,t={}){let d=t.pyramidLevel||0,i=t.headerInfo||jt(e),{ifds:c,noData:g}=i;if(c.length===0)throw new Error("no valid image file directory");let h=Tt(i);if(h)throw h;let s=null,o=d===-1?c[c.length-1]:c[d],a=g??t.noDataValue;return s=i.tileWidth?yield Bt(e,i,o):Vt(e,i,o),s&&(a!=null&&Ie(s,a,{matchAllNoData:g==null&&t?.matchAllNoData}),s)})}var qt=function(e){var t,n,d,i,c,g;function h(s){var o,a,f,l,p,y,A,b,S,v,P,r,u;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(o=this.readUInt32(),b=function(){var T,E;for(E=[],T=0;T<4;++T)E.push(String.fromCharCode(this.data[this.pos++]));return E}.call(this).join(""),b){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},l=this.readUInt16(),f=this.readUInt16()||100,p.delay=1e3*l/f,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(b==="fdAT"&&(this.pos+=4,o-=4),s=p?.data||this.imgData,P=0;0<=o?P<o:P>o;0<=o?++P:--P)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(o),(S=255-this.transparency.indexed.length)>0)for(r=0;0<=S?r<S:r>S;0<=S?++r:--r)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":y=(v=this.read(o)).indexOf(0),A=String.fromCharCode.apply(String,v.slice(0,y)),this.text[A]=String.fromCharCode.apply(String,v.slice(y+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(u=this.colorType)===4||u===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return h.load=function(s,o,a){var f;return typeof o=="function"&&(a=o),(f=new XMLHttpRequest).open("GET",s,!0),f.responseType="arraybuffer",f.onload=function(){var l;return l=new h(new Uint8Array(f.response||f.mozResponseArrayBuffer)),typeof o?.getContext=="function"&&l.render(o),typeof a=="function"?a(l):void 0},f.send(null)},n=1,d=2,t=0,h.prototype.read=function(s){var o,a;for(a=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)a.push(this.data[this.pos++]);return a},h.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},h.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},h.prototype.decodePixels=function(s){var o,a,f,l,p,y,A,b,S,v,P,r,u,T,E,m,I,w,U,L,k,N,B;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);for(s=(s=new le(s)).getBytes(),m=(r=this.pixelBitlength/8)*this.width,u=new Uint8Array(m*this.height),y=s.length,E=0,T=0,a=0;T<y;){switch(s[T++]){case 0:for(l=U=0;U<m;l=U+=1)u[a++]=s[T++];break;case 1:for(l=L=0;L<m;l=L+=1)o=s[T++],p=l<r?0:u[a-r],u[a++]=(o+p)%256;break;case 2:for(l=k=0;k<m;l=k+=1)o=s[T++],f=(l-l%r)/r,I=E&&u[(E-1)*m+f*r+l%r],u[a++]=(I+o)%256;break;case 3:for(l=N=0;N<m;l=N+=1)o=s[T++],f=(l-l%r)/r,p=l<r?0:u[a-r],I=E&&u[(E-1)*m+f*r+l%r],u[a++]=(o+Math.floor((p+I)/2))%256;break;case 4:for(l=B=0;B<m;l=B+=1)o=s[T++],f=(l-l%r)/r,p=l<r?0:u[a-r],E===0?I=w=0:(I=u[(E-1)*m+f*r+l%r],w=f&&u[(E-1)*m+(f-1)*r+l%r]),A=p+I-w,b=Math.abs(A-p),v=Math.abs(A-I),P=Math.abs(A-w),S=b<=v&&b<=P?p:v<=P?I:w,u[a++]=(o+S)%256;break;default:throw new Error("Invalid filter algorithm: "+s[T-1])}E++}return u},h.prototype.decodePalette=function(){var s,o,a,f,l,p,y,A,b;for(a=this.palette,p=this.transparency.indexed||[],l=new Uint8Array((p.length||0)+a.length),f=0,a.length,s=0,o=y=0,A=a.length;y<A;o=y+=3)l[f++]=a[o],l[f++]=a[o+1],l[f++]=a[o+2],l[f++]=(b=p[s++])!=null?b:255;return l},h.prototype.copyToImageData=function(s,o){var a,f,l,p,y,A,b,S,v,P,r;if(f=this.colors,v=null,a=this.hasAlphaChannel,this.palette.length&&(v=(r=this._decodedPalette)!=null?r:this._decodedPalette=this.decodePalette(),f=4,a=!0),S=(l=s.data||s).length,y=v||o,p=A=0,f===1)for(;p<S;)b=v?4*o[p/4]:A,P=y[b++],l[p++]=P,l[p++]=P,l[p++]=P,l[p++]=a?y[b++]:this.transparency.grayscale&&this.transparency.grayscale===P?0:255,A=b;else for(;p<S;)b=v?4*o[p/4]:A,l[p++]=y[b++],l[p++]=y[b++],l[p++]=y[b++],l[p++]=a?y[b++]:this.transparency.rgb&&this.transparency.rgb[1]===y[b-3]&&this.transparency.rgb[3]===y[b-2]&&this.transparency.rgb[5]===y[b-1]?0:255,A=b},h.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s},c=e.document&&e.document.createElement("canvas"),g=c&&c.getContext("2d"),i=function(s){var o;return g.width=s.width,g.height=s.height,g.clearRect(0,0,s.width,s.height),g.putImageData(s,0,0),(o=new Image).src=c.toDataURL(),o},h.prototype.decodeFrames=function(s){var o,a,f,l,p,y,A,b;if(this.animation){for(b=[],a=p=0,y=(A=this.animation.frames).length;p<y;a=++p)o=A[a],f=s.createImageData(o.width,o.height),l=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(f,l),o.imageData=f,b.push(o.image=i(f));return b}},h.prototype.renderFrame=function(s,o){var a,f,l;return a=(f=this.animation.frames)[o],l=f[o-1],o===0&&s.clearRect(0,0,this.width,this.height),l?.disposeOp===n?s.clearRect(l.xOffset,l.yOffset,l.width,l.height):l?.disposeOp===d&&s.putImageData(l.imageData,l.xOffset,l.yOffset),a.blendOp===t&&s.clearRect(a.xOffset,a.yOffset,a.width,a.height),s.drawImage(a.image,a.xOffset,a.yOffset)},h.prototype.animate=function(s){var o,a,f,l,p,y,A=this;return a=0,y=this.animation,l=y.numFrames,f=y.frames,p=y.numPlays,(o=function(){var b,S;if(b=a++%l,S=f[b],A.renderFrame(s,b),l>1&&a/l<p)return A.animation._timeout=setTimeout(o,S.delay)})()},h.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},h.prototype.render=function(s){var o,a;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(a=o.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),o.putImageData(a,0,0))},h}(self),Zt=new Set(["jpg","png","bmp","gif"]);function zt(e,t){return ae(this,null,function*(){if(!Pe)throw new ie("rasterCoded:decode","lerc decoder is not supported on big endian platform");yield Me();let{offset:n}=t,{width:d,height:i,pixelType:c,statistics:g,depthCount:h,noDataValues:s,bandMasks:o,pixels:a,mask:f}=Re(e,{inputOffset:n,returnInterleaved:t.returnInterleaved}),l=new te({width:d,height:i,pixelType:c.toLowerCase(),pixels:a,mask:f,statistics:g.map(({minValue:p,maxValue:y})=>new rt(p,y)),bandMasks:o,depthCount:h,noDataValues:s});return g?.length||l.updateStatistics(),l})}function Qt(e,t){return ae(this,null,function*(){let n=yield bt(e,Se(me({},t),{noDataValue:t.tiffNoDataValue,matchAllNoData:t.matchAllNoData}));$e(n);let d=new te({width:n.width,height:n.height,pixels:n.pixels,pixelType:n.pixelType.toLowerCase(),mask:n.mask,bandMasks:n.bandMasks,statistics:null});return d.updateStatistics(),d})}function $t(e,t){return ae(this,null,function*(){let n=yield Et(e,t.customOptions),d=new te({width:n.width,height:n.height,pixels:n.pixels,pixelType:n.pixelType.toLowerCase(),mask:n.mask,statistics:null});return d.updateStatistics(),d})}function At(e,t){let n=t.pixelType||"u8",d=te.getPixelArrayConstructor(n),i=n==="u8"?e:new d(e.buffer),c=[],g=t.planes||1;if(g===1)c.push(i);else for(let s=0;s<g;s++){let o=(t.width||1)*(t.height||e.length),a=new d(o);for(let f=0;f<o;f++)a[f]=i[f*g+s];c.push(a)}let h=new te({width:t.width||1,height:t.height||e.length,pixels:c,pixelType:n,statistics:null});return h.updateStatistics(),h}function en(e,t){return At(new le(new Uint8Array(e)).getBytes(),t)}function tn(e,t){return At(ve(e,t.offset,t.eof,!t.isInputBigEndian),t)}function nn(e,t,n){let{pixelTypeCtor:d}=ln(t.pixelType),i=(0,Ne.decode)(e,{width:t.width,height:t.height,pixelType:d,format:n}),c=new te({width:t.width,height:t.height,pixels:i.pixels,pixelType:t.pixelType,mask:i.mask,statistics:null});return c.updateStatistics(),c}function rn(e,t){let n=xe.decode(e,t.hasNoZlibMask??void 0),d=new te({width:n.width,height:n.height,pixels:n.pixels,pixelType:"u8",mask:n.mask,statistics:null});return d.updateStatistics(),d}function an(e,t){let n=new Uint8Array(e),d=new qt(n),{width:i,height:c}=t,g=i*c,h=d.decode(),s,o=0,a=0,f=new Uint8Array(g);for(o=0;o<g;o++)f[o]=h[4*o+3];let l=new te({width:i,height:c,pixels:[],pixelType:"u8",mask:f,statistics:[]});for(o=0;o<3;o++){for(s=new Uint8Array(g),a=0;a<g;a++)s[a]=h[4*a+o];l.addData({pixels:s})}return l.updateStatistics(),l}function sn(e,t,n,d){return ae(this,null,function*(){let i=new Ce,c=me({applyJpegMask:!1,format:t},n),g=yield i.decode(e,c,d),h=new te(g);return h.updateStatistics(),h})}function St(e){if(e==null)throw new ie("rasterCodec:decode","parameter encodeddata is required.");let t=new Uint8Array(e,0,10),n="";return t[0]===255&&t[1]===216?n="jpg":t[0]===137&&t[1]===80&&t[2]===78&&t[3]===71?n="png":t[0]===67&&t[1]===110&&t[2]===116&&t[3]===90&&t[4]===73&&t[5]===109&&t[6]===97&&t[7]===103&&t[8]===101&&t[9]===32?n="lerc":t[0]===76&&t[1]===101&&t[2]===114&&t[3]===99&&t[4]===50&&t[5]===32?n="lerc2":t[0]===73&&t[1]===73&&t[2]===42&&t[3]===0||t[0]===77&&t[1]===77&&t[2]===0&&t[3]===42||t[0]===73&&t[1]===73&&t[2]===43&&t[3]===0||t[0]===77&&t[1]===77&&t[2]===0&&t[3]===43?n="tiff":t[0]===71&&t[1]===73&&t[2]===70?n="gif":t[0]===66&&t[1]===77?n="bmp":String.fromCharCode.apply(null,t).toLowerCase().includes("error")&&(n="error"),n}function on(e){let t=null;switch(e){case"lerc":case"lerc2":t=zt;break;case"jpg":t=rn;break;case"png":t=an;break;case"bsq":case"bip":t=(n,d)=>nn(n,d,e);break;case"tiff":t=Qt;break;case"deflate":t=en;break;case"lzw":t=tn;break;case"error":t=()=>{throw new ie("rasterCodec:decode","input data contains error")};break;default:t=()=>{throw new ie("rasterCodec:decode","unsupported raster format")}}return t}function ln(e){let t=null,n=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":n=255,t=Uint8Array;break;case"u16":n=n||65535,t=Uint16Array;break;case"u32":n=n||2**32-1,t=Uint32Array;break;case"s8":n=n||-128,t=Int8Array;break;case"s16":n=n||-32768,t=Int16Array;break;case"s32":n=n||0-2**31,t=Int32Array;break;default:t=Float32Array}return{pixelTypeCtor:t,noDataValue:n}}function cn(e,t=1){if(!e)return;let{pixels:n,width:d,height:i,mask:c}=e;if(!n||n.length===0)return;let g=n.length,h=d-1,s=i-1,o=[],a,f,l,p,y,A,b=null,S=te.getPixelArrayConstructor(e.pixelType);if(t===0){for(a=0;a<g;a++){for(y=n[a],A=new S(h*s),f=0;f<s;f++)for(p=f*d,l=0;l<h;l++)A[f*h+l]=y[p+l];o.push(A)}if(c!=null)for(b=new Uint8Array(h*s),f=0;f<s;f++)for(p=f*d,l=0;l<h;l++)b[f*h+l]=c[p+l]}else{for(a=0;a<g;a++){for(y=n[a],A=new S(h*s),f=0;f<s;f++)for(p=f*d,l=0;l<h;l++)A[f*h+l]=(y[p+l]+y[p+l+1]+y[p+d+l]+y[p+d+l+1])/4;o.push(A)}if(c)for(b=new Uint8Array(h*s),f=0;f<s;f++)for(p=f*d,l=0;l<h;l++)b[f*h+l]=Math.min.apply(null,[c[p+l],c[p+l+1],c[p+d+l],c[p+d+l+1]])}e.width=h,e.height=s,e.mask=b,e.pixels=o}function Qn(e){let t=St(e);return t==="lerc2"?t="lerc":t==="error"&&(t=""),t}function $n(d){return ae(this,arguments,function*(e,t={},n){if(e==null)throw new ie("rasterCodec:decode","missing encodeddata parameter.");let i=t.format?.toLowerCase();if(!(i!=="bsq"&&i!=="bip"||t.width!=null&&t.height!=null))throw new ie("rasterCodec:decode","requires width and height in options parameter.");if(i==="tiff"&&t.customOptions)return $t(e,t);if((!i||i!=="bsq"&&i!=="bip"&&i!=="deflate"&&i!=="lzw")&&(i=St(e)),t.useCanvas&&Zt.has(i))return sn(e,i,t,n);let c=on(i),g;t.isPoint&&((t=me({},t)).width!=null&&t.width++,t.height!=null&&t.height++);let{offsets:h}=t;if(h&&h.length>1){let s=h.map((f,l)=>c(e.slice(f,h[l+1]),t)),o=yield Promise.all(s);g=o[0],g.pixels=o.map(f=>f.pixels[0]);let a=o.map(f=>f.mask);o.some(f=>f!=null)&&(a.forEach((f,l)=>{f==null&&(a[l]=new Uint8Array(g.width*g.height).fill(255))}),g.bandMasks=a,g.mask=te.combineBandMasks(a)),g.updateStatistics()}else g=yield c(e,Se(me({},t),{offset:h?.[0]??t.offset}));return i!=="jpg"&&t.noDataValue!=null&&g.depthCount===1&&Ie(g,t.noDataValue,{customFloatTolerance:t.tolerance}),t.isPoint&&cn(g),g})}export{dt as a,ye as b,Pe as c,Ht as d,ze as e,Ve as f,yt as g,wt as h,Wt as i,Xt as j,Qn as k,$n as l};
