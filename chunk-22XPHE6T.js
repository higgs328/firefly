import{a as d}from"./chunk-PPBOBNTL.js";import{a as g}from"./chunk-JAM5M2OZ.js";import{a as p}from"./chunk-DKGGDYJI.js";import{c as l}from"./chunk-VIEK2X23.js";import{i as m}from"./chunk-Q6Y4JG7Q.js";import{b as c}from"./chunk-YOFFGXOB.js";import{g as a}from"./chunk-XRGPJ3QY.js";import{e as s}from"./chunk-6MRUJ2UW.js";import{a as u}from"./chunk-QBWJMFH5.js";var v=()=>a.getLogger("esri.widgets.support.geolocationUtils"),h={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function y(){let e=!!u("esri-geolocation");return e||v().warn("geolocation-unsupported","Geolocation unsupported."),e}function P(){let e=window.isSecureContext;return e||v().warnOnce("insecure-context","Geolocation requires a secure origin."),e}function L(){return y()&&P()}function M(e){return e??=h,new Promise((t,r)=>{setTimeout(()=>r(new c("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(t,r,e??void 0)})}var f;function N(e,o){if(f)return f(e,o);let{position:t,view:r}=e,i=S(t),n=i?.coords;if(!n)throw new c("geometry-service:no-coords","Geolocation has no coordinates");return x(G(n),r,o)}function S(e){let o=e&&e.coords||{},t={accuracy:o.accuracy,altitude:o.altitude,altitudeAccuracy:o.altitudeAccuracy,heading:o.heading,latitude:o.latitude,longitude:o.longitude,speed:o.speed,toJSON:()=>({})};return e&&{coords:t,timestamp:e.timestamp,toJSON:()=>({})}}function G({longitude:e,latitude:o,altitude:t}){return new l({longitude:e,latitude:o,z:t||void 0,spatialReference:{wkid:4326}})}function x(e,o,t){if(!o)return Promise.resolve(e);let r=o.spatialReference;return r.isWGS84?Promise.resolve(e):r.isWebMercator?Promise.resolve(m(e)):A(t).then(i=>{if(!i)throw new c("geometry-service:missing-url","Geometry service URL is missing");let n=new g({geometries:[e],outSpatialReference:r});return d(i,n,t).then(w=>w[0])})}function A(e){if(s.geometryServiceUrl)return Promise.resolve(s.geometryServiceUrl);let o=p.getDefault();return o.load(e).catch(()=>{}).then(()=>o.helperServices?.geometry?.url)}export{L as a,M as b,N as c};
