import"./chunk-VTHXE323.js";function p(e,n){let r=[];if(!e)return r;if("valueExpression"in e&&e.valueExpression){let o={expression:e.valueExpression,title:e.valueExpressionTitle,profileInfo:{name:"visualization",context:`${e.type}-renderer`,source:n}};r.push(o)}if("visualVariables"in e&&e.visualVariables){let o=e.visualVariables.filter(({valueExpression:t})=>t&&t!=="$view.scale").map(({valueExpression:t,valueExpressionTitle:s,type:i})=>({expression:t,title:s,profileInfo:{name:"visualization",context:`${i}-variable`,source:n}}));r.push(...o)}if("attributes"in e&&e.attributes){let o=e?.attributes.filter(({valueExpression:t})=>t).map(({valueExpression:t,valueExpressionTitle:s})=>({expression:t,title:s,profileInfo:{name:"visualization",context:`${e.type}-renderer`,source:n}}));r.push(...o)}return r}function u(e,n){let r=[];if(e?.expressionInfos){let o=e?.expressionInfos.map(({title:t,name:s,expression:i,returnType:l})=>({title:t,name:s,expression:i,profileInfo:{name:n==="layer"?"popup":"popup-feature-reduction",context:"popup-template",returnType:l,source:n}}));r.push(...o)}if(e?.content&&Array.isArray(e.content)){let o=e?.content.filter(({type:t})=>t==="expression").map(({expressionInfo:t})=>({title:t.title,expression:t.expression,profileInfo:{name:n==="layer"?"popup-element":"popup-element-feature-reduction",context:"popup-expression-content",returnType:t.returnType,source:n}}));r.push(...o)}return r}function f(e){let n=[];if(e?.featureExpressionInfo?.expression){let r={expression:e?.featureExpressionInfo?.expression,profileInfo:{name:"feature-z",context:"elevation-info",source:"layer"}};n.push(r)}return n}function c(e){let n=[];if(e){let r=e.filter(({valueExpression:o})=>o).map(({valueExpression:o})=>({expression:o,profileInfo:{name:"feature-z",context:"order-by",source:"layer"}}));n.push(...r)}return n}function x(e){let n=[];if(e?.expressionInfos){let r=e?.expressionInfos.map(({title:o,name:t,expression:s,returnType:i})=>({title:o,name:t,expression:s,profileInfo:{name:i==="boolean"?"form-constraint":"form-calculation",context:"form-template",returnType:i,source:"layer"}}));n.push(...r)}return n}function m(e){return[...u(e?.popupTemplate,"feature-reduction"),...a(e?.labelingInfo,"feature-reduction"),...p(e?.renderer,"feature-reduction"),...v(e?.fields)]}function v(e){let n=[];if(e){let r=e.filter(({onStatisticExpression:o,isAutoGenerated:t})=>o&&!t).map(({onStatisticExpression:{expression:o,title:t}})=>({expression:o,title:t,profileInfo:{name:"aggregate-field",context:"aggregate-field",source:"feature-reduction"}}));n.push(...r)}return n}function a(e,n){let r=[];if(e){let o=e.filter(({labelExpressionInfo:t})=>t?.expression).map(({labelExpressionInfo:t})=>({expression:t?.expression,title:t?.title,profileInfo:{name:"labeling",context:"label-class",source:n}}));r.push(...o)}return r}function I(e){let n=[...a(e.labelingInfo,"layer"),...u(e.popupTemplate,"layer"),...p(e.renderer,"layer")];if("elevationInfo"in e&&n.push(...f(e.elevationInfo)),"featureReduction"in e&&n.push(...m(e.featureReduction)),"trackInfo"in e){let r=e.trackInfo;n.push(...p(r?.latestObservations.renderer),...p(r?.previousObservations.renderer),...p(r?.trackLines.renderer),...a(r?.latestObservations.labelingInfo),...a(r?.previousObservations.labelingInfo),...a(r?.trackLines.labelingInfo),...u(r?.popupTemplate))}return"orderBy"in e&&n.push(...c(e.orderBy)),"formTemplate"in e&&n.push(...x(e.formTemplate)),n}export{I as getExpressionsFromLayer};
