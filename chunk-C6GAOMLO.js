import{a as G}from"./chunk-BNOCJUWF.js";import{a as w}from"./chunk-FHBFWDFD.js";import{a as nt}from"./chunk-AXYQJCCX.js";import{a as E}from"./chunk-5XCFNEYX.js";import{a as et}from"./chunk-GQL2MBZT.js";import{f as tt}from"./chunk-FB4M3WPV.js";import{a as Z}from"./chunk-G4DZJMGT.js";import{a as Q}from"./chunk-7P44K2YD.js";import{b as C}from"./chunk-ACP3S2CH.js";import{a as d}from"./chunk-QGVBCWUY.js";import{e as _}from"./chunk-NFIPKH6V.js";import{l as J}from"./chunk-5QEXLALV.js";import{a as j}from"./chunk-4PTIEWMT.js";import{a as k,b as M}from"./chunk-VTHXE323.js";var p="esri-slider",c={base:p,reversed:`${p}--reversed`,horizontalLayout:`${p}--horizontal`,verticalLayout:`${p}--vertical`,contentElement:`${p}__content`,extraContentElement:`${p}__extra-content`,trackElement:`${p}__track`,ticksContainerElement:`${p}__ticks`,tickElement:`${p}__tick`,tickLabelElement:`${p}__tick-label`,maxElement:`${p}__max`,minElement:`${p}__min`,maxElementInteractive:`${p}__max--interactive`,minElementInteractive:`${p}__min--interactive`,rangeElementActive:`${p}__range--active`,rangeInput:`${p}__range-input`,anchorElement:`${p}__anchor`,movingAnchorElement:`${p}__anchor--moving`,lastMovedAnchorElement:`${p}__anchor--moved`,anchorElementActive:`${p}__anchor--active`,anchorElementIndexPrefix:`${p}__anchor-`,segmentElement:`${p}__segment`,segmentElementIndexPrefix:`${p}__segment-`,segmentElementInteractive:`${p}__segment--interactive`,segmentElementActive:`${p}__segment--active`,effectiveSegmentElement:`${p}__effective-segment`,effectiveMaxSegmentElement:`${p}__effective-max-segment`,effectiveMinSegmentElement:`${p}__effective-min-segment`,thumbElement:`${p}__thumb`,labelElement:`${p}__label`,labelElementInteractive:`${p}__label--interactive`,labelInput:`${p}__label-input`};var y={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},it={labels:!1,rangeLabels:!1},m=class extends et{constructor(t,e){super(t,e),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=[],this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new C,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new C,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new C,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new C,this.tickElements=new C,this.trackElement=null,this.viewModel=new G,this.visibleElements=k({},it),this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(t){this.viewModel.effectiveMax=t}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(t){this.viewModel.effectiveMin=t}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(t){this.viewModel.inputFormatFunction=t}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(t){this.viewModel.inputParseFunction=t}get icon(){return"caret-double-horizontal"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(t){this.viewModel.labelFormatFunction=t}get labels(){return this.viewModel.labels}set layout(t){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(t)||(t="horizontal"),this._set("layout",t)}get max(){return this.viewModel.max}set max(t){this.viewModel.max=t}get min(){return this.viewModel.min}set min(t){this.viewModel.min=t}get precision(){return this.viewModel.precision}set precision(t){this.viewModel.precision=t}get state(){let{_activeLabelInputIndex:t,_isMaxInputActive:e,_isMinInputActive:n,_dragStartInfo:i,_segmentDragStartInfo:s,disabled:o,viewModel:r}=this;return o?"disabled":t===null&&!e&&!n?i!=null||s!=null?"dragging":r.state:"editing"}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(t){this.viewModel.thumbsConstrained=t}set tickConfigs(t){this._set("tickConfigs",t),this.scheduleRender()}get values(){return this.viewModel.values}set values(t){this.viewModel.values=t}castVisibleElements(t){return k(k({},it),t)}render(){let{label:t}=this,e=this.classes(c.base,w.widget,this._isHorizontalLayout()?c.horizontalLayout:c.verticalLayout,this._isReversedLayout()?c.reversed:null,this._isDisabled()?w.disabled:null);return this._storeTrackDimensions(),E("div",{afterCreate:this._afterContainerCreate,"aria-label":t,bind:this,class:e,"touch-action":"none"},this._renderContent())}toNextStep(t){this._toStep(t,1)}toPreviousStep(t){this._toStep(t,-1)}getCurrentPosition(){return this._positionFromValue(this.values?.[0]??0)}_renderContent(){let{max:t,min:e}=this;if(!(e==null||t==null||e>=t))return[this._renderMin(),this._renderSliderContainer(),this._renderMax()]}_renderSliderContainer(){return E("div",{bind:this,class:c.contentElement,key:"slider-container"},this._renderTrackElement(),this._renderTicksContainer(),this._renderExtraContentElements())}_renderTrackElement(){return E("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:c.trackElement,"touch-action":"none"},this._renderEffectiveSegmentElements(),this._renderSegmentElements(),this._renderAnchorElements())}_renderEffectiveSegmentElements(){if(!this.trackElement||!this.values?.length)return;let t=this.effectiveMax!=null,e=this.effectiveMin!=null;if(!t&&!e)return;let{max:n,min:i,viewModel:s}=this,o=s.getBounds(),r=[];return e&&r.push(this._renderEffectiveSegmentElement(i,o.min,!0)),t&&r.push(this._renderEffectiveSegmentElement(o.max,n,!1)),r}_renderSegmentElements(){if(!this.trackElement||!this.values?.length)return;let t=this.values.length,e=[];for(let n=0;n<=t;n++)e.push(this._renderSegmentElement(n));return e}_renderSegmentElement(t){let{_trackHeight:e,_trackWidth:n,draggableSegmentsEnabled:i,id:s,state:o}=this,r=this.values,a=this._isHorizontalLayout(),l=a?n:e,h=this.viewModel.getBounds(),u=this._positionFromValue(h.max),v=this._positionFromValue(h.min),g=t===r?.length?null:t,b=t===0?null:t-1,f=g!=null,x=b!=null,I,P,A=[...r].sort((U,B)=>U-B);this._isReversedLayout()?(I=x?this._positionFromValue(A[b]):v,P=f?this._positionFromValue(A[g]):u):(I=f?this._positionFromValue(A[g]):u,P=x?this._positionFromValue(A[b]):v);let S=this._applyPrecisionToPosition(100*P/l),L=(I-P)/l,O=a?`transform: translate(${S}%, 0px) scale(${L}, 1);`:`transform: translate(0px, ${S}%) scale(1, ${L});`,z=this.classes(c.segmentElement,c.segmentElementIndexPrefix+t,i&&f&&x&&o!=="disabled"?c.segmentElementInteractive:null);return E("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:z,"data-max-thumb-index":g,"data-min-thumb-index":b,"data-segment-index":t,key:`${s}-segment-${t}`,style:O,"touch-action":"none"})}_renderEffectiveSegmentElement(t,e,n){let{_trackHeight:i,_trackWidth:s,layout:o}=this,r=this._positionFromValue(t),a=this._positionFromValue(e),l=this._isHorizontalLayout(),h=l?s:i,u=this._applyPrecisionToPosition(100*r/h),v=null;if(o==="horizontal"){let f=n?h-a:a,x=r===h?0:u;v=`clip-path: inset(0% ${a===h?0:this._applyPrecisionToPosition(f/h*100)}% 0% ${x}%);`}else{let f=(a-r)/h;v=l?`transform: translate(${u}%, 0px) scale(${f}, 1);`:`transform: translate(0px, ${u}%) scale(1, ${f});`}let g=n?c.effectiveMinSegmentElement:c.effectiveMaxSegmentElement,b=this.classes(c.segmentElement,c.effectiveSegmentElement,g);return E("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:b,style:v,"touch-action":"none"})}_renderAnchorElements(){let{trackElement:t,values:e}=this;if(e?.length)return this._zIndices=e.map((n,i)=>{let s=this._positionFromValue(n),o=this._positionToPercent(s),r=(this._isHorizontalLayout()?o>50:o<50)?-1:1;return this._zIndexOffset+(e.length+r*i)}),t&&e&&e.length?e.map((n,i)=>this._renderAnchorElement(n,i)):null}_renderAnchorElement(t,e){let n=this._positionFromValue(t),i=this._valueFromPosition(n);if(i==null||isNaN(i))return;let{_dragStartInfo:s,_lastMovedHandleIndex:o,id:r,layout:a,visibleElements:{labels:l}}=this,h=this.values,u=s&&s.index===e,v=o===e,g=this.classes(c.anchorElement,c.anchorElementIndexPrefix+e,u?c.movingAnchorElement:null,v?c.lastMovedAnchorElement:null),b=this.labels.values[e],f=this._getStyleForAnchor(t,e,u||v),{min:x,max:I}=this.viewModel.getBoundsForValueAtIndex(e),{disabled:P,messages:A}=this,S=h.length===2?Q(e===0?A.rangeMinimum:A.rangeMaximum,{value:t}):b,L=h.length===1?null:e===0?`${r}-handle-${e+1}`:e===h.length-1?`${r}-handle-${e-1}`:`${r}-handle-${e-1} ${r}-handle-${e+1}`;return E("div",{afterCreate:this._afterAnchorCreate,afterRemoved:this._afterAnchorRemoved,afterUpdate:this._afterAnchorUpdate,"aria-controls":L,"aria-label":A.sliderValue,"aria-labelledby":l?`${r}-label-${e}`:null,"aria-orientation":a,"aria-valuemax":I?.toString(),"aria-valuemin":x?.toString(),"aria-valuenow":t.toString(),"aria-valuetext":S,bind:this,class:g,"data-thumb-index":e,"data-value":t,id:`${r}-handle-${e}`,key:`${r}-handle-${e}`,onkeydown:this._onAnchorKeyDown,role:"slider",style:f,tabIndex:P?-1:0,"touch-action":"none"},E("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:c.thumbElement,"data-thumb-index":e,"touch-action":"none"}),this.renderThumbLabel(e))}renderThumbLabel(t){let{id:e,labels:n,labelInputsEnabled:i,state:s}=this,o=this.visibleElements.labels,r=n.values[t],a=this.classes(c.labelElement,o?null:w.hidden,i&&s!=="disabled"?c.labelElementInteractive:null);return E("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!o).toString(),bind:this,class:a,"data-thumb-index":t,id:`${e}-label-${t}`,key:`${e}-label-${t}`,role:i?"button":null,"touch-action":"none"},this._activeLabelInputIndex===t?this._renderValueInput(t):r)}_renderValueInput(t){let{disabled:e,values:n}=this;if(n==null)return;let i=n[t];return E("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:c.labelInput,"data-input-index":t,"data-input-type":"thumb",key:`value-input-${t}`,onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:e?-1:0,type:"text",value:this._formatInputValue(i,"value",t)})}_renderMax(){let{_isMaxInputActive:t,labels:e,rangeLabelInputsEnabled:n,state:i}=this,s=this.visibleElements.rangeLabels,o=this.classes(c.maxElement,{[w.hidden]:!s,[c.maxElementInteractive]:n&&i!=="disabled",[c.rangeElementActive]:t});return E("div",{afterCreate:this._afterMaxLabelCreate,"aria-hidden":(!s).toString(),bind:this,class:o,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:n?"button":null,tabIndex:!this.disabled&&n?0:-1},t?this._renderMaxInput():e.max)}_renderMin(){let{_isMinInputActive:t,labels:e,rangeLabelInputsEnabled:n,state:i}=this,s=this.visibleElements.rangeLabels,o=this.classes(c.minElement,{[w.hidden]:!s,[c.minElementInteractive]:n&&i!=="disabled",[c.rangeElementActive]:t});return E("div",{afterCreate:this._afterMinLabelCreate,"aria-hidden":(!s).toString(),bind:this,class:o,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:n?"button":null,tabIndex:!this.disabled&&n?0:-1},t?this._renderMinInput():e.min)}_renderMaxInput(){return E("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:c.rangeInput,"data-input-type":"max",onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max")})}_renderMinInput(){return E("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:c.rangeInput,"data-input-type":"min",onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown,required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min")})}_renderExtraContentElements(){return E("div",{bind:this,class:c.extraContentElement},this.extraNodes)}_renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(this._trackHeight!==0||this._trackWidth!==0))return this.tickConfigs.map((t,e)=>E("div",{class:this.classes(c.ticksContainerElement),key:"ticks-container"},this._renderTicks(t,e)))}_renderTicks(t,e){let{mode:n,values:i}=t;if(this.tickElements.at(e)||this.tickElements.add(new C,e),n==="position"){let r=Array.isArray(i)?i:[i];return this._calculateTickPositions(r).map((a,l)=>this._renderTickGroup(t,l,e,a))}if(n==="percent"&&Array.isArray(i)){let r=this.min??0,a=(this.max??0)-r,l=i.map(h=>this._applyPrecisionToPosition(h/100*a+r));return this._calculateTickPositions(l).map((h,u)=>this._renderTickGroup(t,u,e,h))}let s=Array.isArray(i)&&i.length?i[0]:isNaN(i)?null:i,o=this._getTickCounts(s,t);return this._calculateEquidistantTickPositions(o).map((r,a)=>this._renderTickGroup(t,a,e,r))}_renderTickGroup(t,e,n,i){let s=t.mode==="position"?Array.isArray(t.values)?t.values[e]:t.values:this._valueFromPosition(i);if(s!=null&&!isNaN(s))return E("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":t,"data-position":i,"data-tick-config-index":n,"data-tick-group-index":e,"data-value":s,key:`tick-group-${e}`,onclick:this._onTickGroupClick},this._renderTickLine(t,e,n,s),t.labelsVisible?this._renderTickLabel(t,e,n,s):null)}_renderTickLine(t,e,n,i){return E("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":i.toString(),bind:this,class:c.tickElement,"data-config":t,"data-tick-config-index":n,"data-tick-group-index":e,"data-value":i,key:`tick-label-${e}`,style:this._getPositionStyleForElement(i)})}_renderTickLabel(t,e,n,i){let s=t.labelFormatFunction?t.labelFormatFunction(i,"tick",e):this.viewModel.getLabelForValue(i,"tick",e);return E("div",{afterCreate:this._afterTickLabelCreate,"aria-label":s,"aria-valuenow":i.toString(),"aria-valuetext":s,bind:this,class:c.tickLabelElement,"data-config":t,"data-tick-config-index":n,"data-tick-group-index":e,"data-value":i,key:`tick-label-${e}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(i)}`},s)}_afterContainerCreate(t){this.addHandles(tt(t,()=>this.scheduleRender()))}_afterTrackCreate(t){this._set("trackElement",t),t.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(t){t.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(t){this.segmentElements.add(t),t.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(t){this.segmentElements.remove(t),t.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(t){this.effectiveSegmentElements.add(t)}_afterEffectiveSegmentRemoved(t){this.effectiveSegmentElements.remove(t)}_afterAnchorCreate(t){if(this._anchorElements.push(t),t.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){let e=$(t),n=K(t),i=this.thumbElements.at(e),s=this.labelElements.at(e)||null;this.thumbCreatedFunction(e,n,i,s)}}_afterAnchorUpdate(t){this._focusedAnchorIndex!=null&&$(t)===this._focusedAnchorIndex&&(t.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(t){let e=this._anchorElements.indexOf(t,0);e>-1&&this._anchorElements.splice(e,1),t.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(t){this.thumbElements.add(t)}_afterThumbRemoved(t){this.thumbElements.remove(t)}_afterLabelCreate(t){this.labelElements.add(t),t.addEventListener("pointerdown",this._onLabelPointerDown),t.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(t){this.labelElements.remove(t),t.removeEventListener("pointerdown",this._onLabelPointerDown),t.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(t){if(t.focus(),t.select(),this.inputCreatedFunction){let e=t.getAttribute("data-input-type"),n=e==="thumb"?rt(t):null;this.inputCreatedFunction(t,e,n)}}_afterTickLineCreate(t){let e=R(t),n=H(t),i=this.tickElements.at(e),s=i.at(n);s?s.tickElement=t:i.add({groupElement:null,tickElement:t,labelElement:null},n)}_afterTickLabelCreate(t){let e=R(t),n=H(t),i=this.tickElements.at(e),s=i.at(n);s?s.labelElement=t:i.add({groupElement:null,labelElement:t,tickElement:null},n)}_afterTickGroupRemoved(t){let e=R(t),n=this.tickElements.items[e],i=n?.find(s=>s.groupElement===t);i&&n.remove(i)}_afterTickGroupCreate(t){let e=st(t);if(e?.tickCreatedFunction){let n=R(t),i=H(t),s=K(t),o=this.tickElements?.at(n)?.at(i);if(o){o.groupElement=t;let r=o.tickElement||null,a=o.labelElement||null;e.tickCreatedFunction(s,r,a)}}}_afterMaxLabelCreate(t){this._set("maxLabelElement",t)}_afterMinLabelCreate(t){this._set("minLabelElement",t)}_onAnchorKeyDown(t){if(this._isDisabled()||this.state==="editing")return;let{key:e,target:n}=t,i=this.values,s=$(n),o=this._anchorElements[s],r=i[s],a=[y.moveAnchorUp,y.moveAnchorDown,y.moveAnchorLeft,y.moveAnchorRight];if(e===y.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=s,this.notifyChange("state");else if(a.includes(e)){t.preventDefault();let{steps:l}=this,h=e===y.moveAnchorUp||e===y.moveAnchorRight?1:-1;if(l!=null)this._toStep(s,this._isReversedLayout()?-1*h:h);else{let{precision:v}=this,g=this._getPositionOfElement(o),b=this._valueFromPosition(g),f=this._isHorizontalLayout()?h:-1*h,x;x=v===0?this._positionFromValue(b+f):v===1?this._positionFromValue(b+.1*f):g+f,this._toPosition(s,x)}let u=this.values[s];r!==u&&this._emitThumbChangeEvent({index:s,oldValue:r,value:u})}else if(e===y.moveAnchorToMax||e===y.moveAnchorToMin){t.preventDefault();let{min:l,max:h}=this._getAnchorBoundsInPixels(s),u=this._isPositionInverted()?e===y.moveAnchorToMax?l:h:e===y.moveAnchorToMin?l:h;this._toPosition(s,u);let v=this.values[s];r!==v&&this._emitThumbChangeEvent({index:s,oldValue:r,value:v})}}_onAnchorPointerDown(t){if(this._isDisabled())return;let{target:e,clientX:n,clientY:i}=t,s=$(e);s!=null&&(t.preventDefault(),this._anchorElements[s]&&this._anchorElements[s].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:n,clientY:i,index:s,position:this._getPositionOfElement(this._anchorElements[s])},this.notifyChange("state"),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(t){if(this.state==="editing"||!this._dragStartInfo)return;t.preventDefault();let{values:e,_anchorElements:n,_dragged:i,_dragStartInfo:s,_dragStartInfo:{index:o,position:r}}=this,{clientX:a,clientY:l}=t,h=i?"drag":"start",u=n[o],v=this._getPositionOfElement(u),g=this._applyPrecisionToPosition(this._isHorizontalLayout()?r+a-s.clientX:r+l-s.clientY);if(v===g)return;let b=e[o];this._dragged=!0,this._toPosition(o,g);let f=this.values[o];i?b!==f&&this._emitThumbDragEvent({index:o,state:h,value:f}):this._emitThumbDragEvent({index:o,state:h,value:b})}_onAnchorPointerUp(t){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;t.preventDefault();let{index:e}=this._dragStartInfo,n=this._dragged,i=this.values[e];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=e,this.notifyChange("state"),n?this._emitThumbDragEvent({index:e,state:"stop",value:i}):(this.scheduleRender(),this.state!=="editing"&&this._emitThumbClickEvent({index:e,value:i}))}_onTrackPointerDown(t){let{_dragStartInfo:e,snapOnClickEnabled:n,state:i,values:s}=this;if(this._isDisabled()||i==="editing"||e||(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!n||!s?.length))return;let{steps:o}=this,{clientX:r,clientY:a}=t,l=this._getCursorPositionFromEvent(t),h=this._valueFromPosition(l),u=this._getIndexOfNearestValue(h),v=s[u],g=s.some((I,P)=>I===v&&P!==u)&&h>v?s.lastIndexOf(v):u;if(g==null)return;let b=s[g],f=o!=null?this._calculateNearestStepPosition(l):l;this._toPosition(g,f),this._dragged=!0,this._dragStartInfo={clientX:r,clientY:a,index:g,position:f},this._focusedAnchorIndex=g,this.notifyChange("state"),this._emitThumbDragEvent({index:g,state:"start",value:b});let x=this.values[g];b!==x&&this._emitThumbDragEvent({index:g,state:"drag",value:x}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(t){t.preventDefault(),this._dragged=!0}_onTrackPointerUp(t){if(t.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){let e=this._getCursorPositionFromEvent(t),n=this._valueFromPosition(e);this._emitTrackClickEvent({value:n})}}_onSegmentPointerDown(t){t.preventDefault();let e=t.target,n=at(e),i=lt(e),s=ht(e);if(this._isDisabled()||i==null||s==null)return;t.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);let o=this._getAnchorDetails(i),r=this._getAnchorDetails(s);this.syncedSegmentsEnabled?(this.segmentElements.forEach(a=>a.classList.add(c.segmentElementActive)),this._anchorElements.forEach(a=>a.classList.add(c.anchorElementActive))):(this.segmentElements.at(n).classList.add(c.segmentElementActive),this._anchorElements[o.index]?.classList.add(c.anchorElementActive),this._anchorElements[r.index]?.classList.add(c.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(t),index:n,details:this._normalizeSegmentDetails({min:o,max:r})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this.notifyChange("state"),this._emitSegmentDragEvent({index:n,state:"start",thumbIndices:[i,s]}))}_onSegmentPointerMove(t){if(!this._segmentDragStartInfo)return;t.preventDefault();let{_trackHeight:e,_trackWidth:n,_segmentDragStartInfo:{index:i,cursorPosition:s,details:{min:o,max:r}}}=this,{index:a,position:l,value:h}=o,{index:u,position:v,value:g}=r;this._dragged=!0;let b=this._getCursorPositionFromEvent(t);if(b===s)return;let f=this._positionToPercent(s),x=this._positionToPercent(b)-f,I=this._positionToPercent(l)+x,P=this._positionToPercent(v)+x,{min:A}=this._getAnchorBoundsAsPercents(a),{max:S}=this._getAnchorBoundsAsPercents(u),L=!1,O=!1;if(I<A?L=!0:P>S&&(O=!0),L){let{min:F,max:T}=this.viewModel.getBoundsForValueAtIndex(a),D=this._isPositionInverted()?T:F,N=D,V=g+(D-h),W=V-this.values[u];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(W):this._updateAnchorValues([a,u],[N,V]))}if(O){let{min:F,max:T}=this.viewModel.getBoundsForValueAtIndex(u),D=this._isPositionInverted()?F:T,N=D,V=h+(D-g),W=V-this.values[a];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(W):this._updateAnchorValues([a,u],[V,N]))}let z=this._isHorizontalLayout()?n:e,U=P/100*z,B=I/100*z,X=this.values,Y=[X[a],X[u]],q=this._getValueForAnchorAtPosition(a,B),ot=this._getValueForAnchorAtPosition(u,U);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(q-Y[0]):this._updateAnchorValues([a,u],[q,ot]),[this.values[a],this.values[u]].every((F,T)=>F===Y[T])||this._emitSegmentDragEvent({index:i,state:"drag",thumbIndices:[a,u]})}_onSegmentPointerUp(t){if(t.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;let{_dragged:e}=this,n=this.min,i=this.max,s=this.values,{index:o,details:{min:{index:r},max:{index:a}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach(l=>l.classList.remove(c.segmentElementActive)),this._anchorElements.forEach(l=>l.classList.remove(c.anchorElementActive)),this.draggableSegmentsEnabled){let l=i-n,h=s[r],u=s[a];this._lastMovedHandleIndex=h===u?h>l/2?r:a:null,this._dragged=!1,this._segmentDragStartInfo=null,this.notifyChange("state"),this._emitSegmentDragEvent({index:o,state:"stop",thumbIndices:[r,a]})}if(!e){let l=this._getCursorPositionFromEvent(t),h=this._valueFromPosition(l);this._emitSegmentClickEvent({index:o,value:h,thumbIndices:[r,a]})}}_onTickGroupClick(t){let e=t.target;if(st(e)){let n=R(e),i=H(e),s=K(e);this._emitTickClickEvent({configIndex:n,groupIndex:i,value:s})}}_storeTrackDimensions(){if(this.trackElement){let t=this._getDimensions(this.trackElement);this._trackHeight=this._applyPrecisionToPosition(t.height),this._trackWidth=this._applyPrecisionToPosition(t.width)}}_onLabelPointerDown(){this._isDisabled()||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled()||(this._dragged=!0)}_onLabelPointerUp(t){if(this._isDisabled())return;let e=$(t.target);this.labelInputsEnabled&&!this._dragged&&e!=null&&(this._activeLabelInputIndex=e),this._dragged=!1,this.notifyChange("state"),document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(t){let{_activeLabelInputIndex:e,values:n,viewModel:i}=this,s=t.target.value;if(this._activeLabelInputIndex=null,this.notifyChange("state"),!s||e==null||n==null)return;let o=this._parseInputValue(s,"value",e),r=n[e],{min:a,max:l}=this.viewModel.getBoundsForValueAtIndex(e);if(o<a||o>l)return;i.setValue(e,o);let h=this.values[e];r!==h&&this._emitThumbChangeEvent({index:e,oldValue:r,value:h})}_onInputKeyDown(t){if(this._isDisabled())return;let{key:e,target:n}=t,{hideInput1:i,hideInput2:s,hideInput3:o}=y,{_activeLabelInputIndex:r,_anchorElements:a}=this,l=n;if(e===i||e===s||e===o){t.stopPropagation();let h=r;l.blur(),h!=null?a[h].focus():l.parentElement?.focus()}}_onMaxLabelClick(){this._isDisabled()||(this._emitMaxRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0,this.notifyChange("state")))}_onMaxLabelKeyDown({key:t}){this._isDisabled()||t!==y.showInput||(this._isMaxInputActive=!0,this.notifyChange("state"))}_onMaxInputBlur(t){let e=t.target.value;if(this._isMaxInputActive=!1,this.notifyChange("state"),!e)return;let n=this.max,i=this._parseInputValue(e,"max");i<=this.min||(this.viewModel.set("max",i),this.max!==n&&this._emitMaxChangeEvent({oldValue:n,value:this.max}))}_onMinLabelClick(){this._isDisabled()||(this._emitMinRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0,this.notifyChange("state")))}_onMinLabelKeyDown({key:t}){this._isDisabled()||t!==y.showInput||(this._isMinInputActive=!0,this.notifyChange("state"))}_onMinInputBlur(t){let e=t.target.value;if(this._isMinInputActive=!1,this.notifyChange("state"),!e)return;let n=this.min,i=this._parseInputValue(e,"min");i>=this.max||(this.viewModel.set("min",i),this.min!==n&&this._emitMinChangeEvent({oldValue:n,value:this.min}))}_isDisabled(){return this.disabled||this.state==="disabled"}_positionFromValue(t){let{_trackHeight:e,_trackWidth:n}=this,i=this.min??0,s=this.max??0,o=s-i;if(o===0||t==null)return 0;let r=this._isHorizontalLayout(),a=r?this._applyPrecisionToPosition(n*(t-i)/o):this._applyPrecisionToPosition(e*(s-t)/o);return this._isReversedLayout()&&(a=r?n-a:e-a),a}_valueFromPosition(t){let{_trackHeight:e,_trackWidth:n,precision:i}=this,s=this.min??0,o=this.max??0,r=o-s,a=this._isHorizontalLayout()?t*r/n+s:r*(1e3-t/e*1e3)/1e3+s;return this._isReversedLayout()&&(a=o+s-a),parseFloat(a.toFixed(i))}_positionToPercent(t){let{_trackHeight:e,_trackWidth:n}=this,i=100*t/(this._isHorizontalLayout()?n:e);return this._applyPrecisionToPosition(i)}_applyPrecisionToPosition(t){return parseFloat(t.toFixed(this._positionPrecision))}_isPositionInverted(){let{layout:t}=this;return t==="horizontal-reversed"||t==="vertical"}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(t){if(this._isPositionInverted()){let{min:e,max:n}=t;return{min:n,max:e}}return t}_parseInputValue(t,e,n){return this.inputParseFunction?this.inputParseFunction(t,e,n):this.viewModel.defaultInputParseFunction(t)}_formatInputValue(t,e,n){return this.inputFormatFunction?this.inputFormatFunction(t,e,n):this.viewModel.defaultInputFormatFunction(t)}_getAnchorDetails(t){let e=this.values,n=[...e].sort((s,o)=>s-o)[t],i=e.indexOf(n);return{index:i,position:this._getPositionOfElement(this._anchorElements[i]),value:n}}_updateAnchorStyle(t,e){let n=this._anchorElements[t];n&&(this._isHorizontalLayout()?n.style.left=`${e}`:n.style.top=`${e}`)}_getStyleForAnchor(t,e,n){let i=this._getPositionStyleForElement(t);if(this.values?.length===1)return`${i}`;let s=this._zIndices[e];return`${i}; z-index: ${n?this._zIndexOffset+s:s}`}_getPositionStyleForElement(t){let e=this._positionFromValue(t),n=this._positionToPercent(e);return`${this._isHorizontalLayout()?"left":"top"}: ${n}%`}_getPositionOfElement(t){let e=this._getDimensions(t.offsetParent),n=this._getDimensions(t);return this._isHorizontalLayout()?this._applyPrecisionToPosition(n.left-e.left):this._applyPrecisionToPosition(n.top-e.top)}_updateAnchorValues(t,e){t.forEach((n,i)=>this._toValue(n,e[i]))}_updateAnchorValuesByDifference(t){let{min:e,max:n,values:i}=this;i?.forEach((s,o)=>this._toValue(o,Math.max(Math.min(s+t,n),e)))}_toValue(t,e){this.steps!=null&&(e=this._getStepValues()[this._getIndexOfNearestStepValue(e)]),this._updateAnchorStyle(t,this._getPositionStyleForElement(e)),this.viewModel.setValue(t,e)}_toPosition(t,e){let n=this.steps!=null?this._getStepValueForAnchorAtPosition(t,e):this._getValueForAnchorAtPosition(t,e);this._updateAnchorStyle(t,this._getPositionStyleForElement(n)),this.viewModel.setValue(t,n)}_getValueForAnchorAtPosition(t,e){let{min:n,max:i}=this._getAnchorBoundsInPixels(t),{min:s,max:o}=this.viewModel.getBoundsForValueAtIndex(t),r,a,l=null;return this._isPositionInverted()?(r=s,a=o):(r=o,a=s),l=e>i?r:e<n?a:this._valueFromPosition(e),l>o?l=o:l<s&&(l=s),l}_getStepValueForAnchorAtPosition(t,e){let n=this._getStepValues(),i=this._calculateNearestStepPosition(e),s=this._getValueForAnchorAtPosition(t,i);return n[this._getIndexOfNearestStepValue(s)]}_getAnchorBoundsAsPercents(t){let{min:e,max:n}=this._getAnchorBoundsInPixels(t);return{min:this._positionToPercent(e),max:this._positionToPercent(n)}}_getAnchorBoundsInPixels(t){let{_anchorElements:e,_trackHeight:n,_trackWidth:i,effectiveMax:s,effectiveMin:o,thumbsConstrained:r}=this,a=e[t-1],l=e[t+1],h=this._isHorizontalLayout()?i:n,u,v;return this._isPositionInverted()?(u=o!=null?this._positionFromValue(o):h,v=s!=null?this._positionFromValue(s):0):(u=s!=null?this._positionFromValue(s):h,v=o!=null?this._positionFromValue(o):0),r?this._isPositionInverted()?{max:a?this._getPositionOfElement(a):u,min:l?this._getPositionOfElement(l):v}:{max:l?this._getPositionOfElement(l):u,min:a?this._getPositionOfElement(a):v}:{max:u,min:v}}_getIndexOfNearestValue(t){let e=this.values;return e.indexOf(e.reduce((n,i)=>Math.abs(i-t)<Math.abs(n-t)?i:n))}_getCursorPositionFromEvent(t){let e=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?this._applyPrecisionToPosition(t.clientX-e.left):this._applyPrecisionToPosition(t.clientY-e.top)}_getStepValues(){let{steps:t}=this;if(Array.isArray(t))return t;let{max:e,min:n}=this;if(n==null||e==null||t==null)return[];let i=Math.ceil((e-n)/t),s=[];for(let o=0;o<=i;o++){let r=n+t*o;s.push(r>e?e:r)}return s}_toStep(t,e){let n=this.values[t],i=this._getStepValues(),s=i.indexOf(n),o=null;if(s>-1){let r=i[s+e];isNaN(r)&&(r=i[s]);let a=this._positionFromValue(r);o=this._getStepValueForAnchorAtPosition(t,a)}else o=i[this._getIndexOfNearestStepValue(n)+e];this.viewModel.setValue(t,o)}_getIndexOfNearestStepValue(t){let{steps:e}=this;if(e==null)return null;let n=this._getStepValues(),i=n.reduce((s,o)=>Math.abs(o-t)<Math.abs(s-t)?o:s);return n.indexOf(i)}_calculateNearestStepPosition(t){let e=this._valueFromPosition(t),n=this._getIndexOfNearestStepValue(e),i=this._getStepValues();return this._positionFromValue(i[n])}_getTickCounts(t,e){let{mode:n}=e;return n==="count"||n==="position"?t||0:n==="percent"&&100/t||0}_calculateTickPositions(t){return t.map(e=>this._positionFromValue(e))}_calculateEquidistantTickPositions(t){let{_trackWidth:e,_trackHeight:n}=this,i=this._isHorizontalLayout()?e:n,s=i/(t-1),o=[];if(t===1)return[i/2];for(let r=0;r<t;r++){let a=r*s;a<=i&&o.push(a)}return o}_getDimensions(t){try{return j(t),t.getBoundingClientRect()}catch(e){if(typeof e=="object"&&e!==null)return new DOMRect(0,0,0,0);throw e}}_emitTrackClickEvent(t){this.emit("track-click",M(k({},t),{type:"track-click"}))}_emitTickClickEvent(t){this.emit("tick-click",M(k({},t),{type:"tick-click"}))}_emitMaxChangeEvent(t){this.emit("max-change",M(k({},t),{type:"max-change"}))}_emitMinChangeEvent(t){this.emit("min-change",M(k({},t),{type:"min-change"}))}_emitThumbChangeEvent(t){this.emit("thumb-change",M(k({},t),{type:"thumb-change"}))}_emitThumbClickEvent(t){this.emit("thumb-click",M(k({},t),{type:"thumb-click"}))}_emitThumbDragEvent(t){this.emit("thumb-drag",M(k({},t),{type:"thumb-drag"}))}_emitSegmentClickEvent(t){this.emit("segment-click",M(k({},t),{type:"segment-click"}))}_emitSegmentDragEvent(t){this.emit("segment-drag",M(k({},t),{type:"segment-drag"}))}_emitMinRangeLabelClickEvent(t){this.emit("min-click",t)}_emitMaxRangeLabelClickEvent(t){this.emit("min-click",t)}};function $(t){return t?.["data-thumb-index"]}function rt(t){return t?.["data-input-index"]}function at(t){return t?.["data-segment-index"]}function lt(t){return t?.["data-min-thumb-index"]}function ht(t){return t?.["data-max-thumb-index"]}function K(t){return t?.["data-value"]}function R(t){return t?.["data-tick-config-index"]}function H(t){return t?.["data-tick-group-index"]}function st(t){return t?.["data-config"]}d([_()],m.prototype,"disabled",void 0),d([_()],m.prototype,"draggableSegmentsEnabled",void 0),d([_()],m.prototype,"effectiveMax",null),d([_()],m.prototype,"effectiveMin",null),d([_({readOnly:!0})],m.prototype,"effectiveSegmentElements",void 0),d([_()],m.prototype,"extraNodes",void 0),d([_()],m.prototype,"inputCreatedFunction",void 0),d([_()],m.prototype,"inputFormatFunction",null),d([_()],m.prototype,"inputParseFunction",null),d([_()],m.prototype,"icon",null),d([_()],m.prototype,"label",null),d([_({readOnly:!0})],m.prototype,"labelElements",void 0),d([_()],m.prototype,"labelInputsEnabled",void 0),d([_()],m.prototype,"labelFormatFunction",null),d([_({readOnly:!0})],m.prototype,"labels",null),d([_({value:"horizontal"})],m.prototype,"layout",null),d([_()],m.prototype,"max",null),d([_({readOnly:!0})],m.prototype,"maxLabelElement",void 0),d([_(),nt("esri/widgets/Slider/t9n/Slider")],m.prototype,"messages",void 0),d([_()],m.prototype,"min",null),d([_({readOnly:!0})],m.prototype,"minLabelElement",void 0),d([_()],m.prototype,"precision",null),d([_()],m.prototype,"rangeLabelInputsEnabled",void 0),d([_({readOnly:!0})],m.prototype,"segmentElements",void 0),d([_()],m.prototype,"snapOnClickEnabled",void 0),d([_({readOnly:!0})],m.prototype,"state",null),d([_()],m.prototype,"steps",void 0),d([_()],m.prototype,"syncedSegmentsEnabled",void 0),d([_()],m.prototype,"thumbsConstrained",null),d([_()],m.prototype,"thumbCreatedFunction",void 0),d([_({readOnly:!0})],m.prototype,"thumbElements",void 0),d([_()],m.prototype,"tickConfigs",null),d([_({readOnly:!0})],m.prototype,"tickElements",void 0),d([_({readOnly:!0})],m.prototype,"trackElement",void 0),d([_()],m.prototype,"values",null),d([_({type:G})],m.prototype,"viewModel",void 0),d([_()],m.prototype,"visibleElements",void 0),d([Z("visibleElements")],m.prototype,"castVisibleElements",null),m=d([J("esri.widgets.Slider")],m);var Lt=m;export{Lt as a};
