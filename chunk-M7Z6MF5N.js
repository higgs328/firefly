import{b,c as p}from"./chunk-PTFN55DA.js";import{b as x,f as v,q as y}from"./chunk-DA3SDKGO.js";import{h as R,k as _}from"./chunk-IHATPE6U.js";import{d as o}from"./chunk-NJWTSROP.js";import{a as B}from"./chunk-G4DZJMGT.js";import{a as d,e as u,j as g}from"./chunk-TG45K3WR.js";import{a as t}from"./chunk-QGVBCWUY.js";import{H as f}from"./chunk-MYO4NP2N.js";import{e as s}from"./chunk-NFIPKH6V.js";import{l as h}from"./chunk-5QEXLALV.js";import{f as m}from"./chunk-VTHXE323.js";var a=class extends f{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=p("hybrid",this._basemapCache),this.view=null}initialize(){d(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},g)}destroy(){this.view=null,b(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return R(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){let{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){return p(this.view?.map?.basemap??"topo-vector",this._basemapCache)}castNextBasemap(e){return p(e,this._basemapCache)}get state(){let{view:e}=this;if(!e?.ready||this._nextBasemapSpatialReferenceTask.updating)return"disabled";let{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!e.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}toggle(){return m(this,null,function*(){let{activeBasemap:e,nextBasemap:i,state:l,view:n}=this;if(!n||l==="disabled"||l==="incompatible-next-basemap")return;let c=this._viewSpatialReferenceLocked;if(!c){if(yield u(()=>!this._nextBasemapSpatialReferenceTask.updating),i!==this.nextBasemap||e!==this.activeBasemap)return;let{spatialReference:r}=this._nextBasemapSpatialReferenceTask;if(r==null||o(n.spatialReference,r)||x()||y(n.spatialReference,r)||(this._loadingProjectionEngine=!0,yield v(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||e!==this.activeBasemap)return}n.map.basemap=i,c||this._nextBasemapSpatialReferenceTask.spatialReference==null||o(n.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(n.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e})}static getThumbnailUrl(e){return _(e)}};t([s()],a.prototype,"_loadingProjectionEngine",void 0),t([s({readOnly:!0})],a.prototype,"_nextBasemapSpatialReferenceTask",null),t([s({readOnly:!0})],a.prototype,"_viewSpatialReferenceLocked",null),t([s({readOnly:!0})],a.prototype,"activeBasemap",null),t([s()],a.prototype,"nextBasemap",void 0),t([B("nextBasemap")],a.prototype,"castNextBasemap",null),t([s({readOnly:!0})],a.prototype,"state",null),t([s()],a.prototype,"view",void 0),t([s()],a.prototype,"toggle",null),a=t([h("esri.widgets.BasemapToggle.BasemapToggleViewModel")],a);var U=a;export{U as a};
