import{a as E,b as _}from"./chunk-2JABY6DU.js";import{a as D,b,c as I,d as F}from"./chunk-MPRKSQLC.js";import{h as X}from"./chunk-RNC4P66O.js";import{a as k}from"./chunk-U4QEPZJ3.js";import{i as T,j as q}from"./chunk-Q6Y4JG7Q.js";import{f as C}from"./chunk-NJWTSROP.js";import{b as W}from"./chunk-YOFFGXOB.js";import{g as S}from"./chunk-XRGPJ3QY.js";import{e as j}from"./chunk-6MRUJ2UW.js";import{f as U}from"./chunk-VTHXE323.js";var K=()=>S.getLogger("esri.geometry.support.normalizeUtils");function O(e){return e.type==="polygon"}function Q(e){return e[0].type==="polygon"}function V(e){return e[0].type==="polyline"}function B(e){let n=[],i=0,o=0;for(let t=0;t<e.length;t++){let l=e[t],r=null;for(let s=0;s<l.length;s++)r=l[s],n.push(r),s===0?(i=r[0],o=i):(i=Math.min(i,r[0]),o=Math.max(o,r[0]));r&&n.push([(i+o)/2,0])}return n}function Y(e,n){if(!(e instanceof k||e instanceof X)){let t="straightLineDensify: the input geometry is neither polyline nor polygon";throw K().error(t),new W(t)}let i=F(e),o=[];for(let t of i){let l=[];o.push(l),l.push([t[0][0],t[0][1]]);for(let r=0;r<t.length-1;r++){let s=t[r][0],c=t[r][1],u=t[r+1][0],p=t[r+1][1],d=Math.sqrt((u-s)*(u-s)+(p-c)*(p-c)),a=(p-c)/d,x=(u-s)/d,m=d/n;if(m>1){for(let P=1;P<=m-1;P++){let z=P*n,f=x*z+s,h=a*z+c;l.push([f,h])}let w=(d+Math.floor(m-1)*n)/2,L=x*w+s,G=a*w+c;l.push([L,G])}l.push([u,p])}}return O(e)?new X({rings:o,spatialReference:e.spatialReference}):new k({paths:o,spatialReference:e.spatialReference})}function H(e,n,i){if(n){let o=Y(e,1e6);e=q(o,!0)}return i&&(e=I(e,i)),e}function J(e,n,i){if(Array.isArray(e)){let o=e[0];if(o>n){let t=b(o,n);e[0]=o+t*(-2*n)}else if(o<i){let t=b(o,i);e[0]=o+t*(-2*i)}}else{let o=e.x;if(o>n){let t=b(o,n);e=e.clone().offset(t*(-2*n),0)}else if(o<i){let t=b(o,i);e=e.clone().offset(t*(-2*i),0)}}return e}function Z(e,n){let i=-1;for(let o=0;o<n.cutIndexes.length;o++){let t=n.cutIndexes[o],l=n.geometries[o],r=F(l);for(let s=0;s<r.length;s++){let c=r[s];c.some(u=>{if(u[0]<180)return!0;{let p=0;for(let a=0;a<c.length;a++){let x=c[a][0];p=x>p?x:p}p=Number(p.toFixed(9));let d=-360*b(p,180);for(let a=0;a<c.length;a++){let x=l.getPoint(s,a);l.setPoint(s,a,x.clone().offset(d,0))}return!0}})}if(t===i){if(Q(e))for(let s of F(l))e[t]=e[t].addRing(s);else if(V(e))for(let s of F(l))e[t]=e[t].addPath(s)}else i=t,e[t]=l}return e}function $(e,n,i){return U(this,null,function*(){if(!Array.isArray(e))return $([e],n);n&&typeof n!="string"&&K().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");let o=typeof n=="string"?n:n?.url??j.geometryServiceUrl,t,l,r,s,c,u,p,d,a=0,x=[],m=[];for(let f of e)if(f!=null)if(t||(t=f.spatialReference,l=C(t),r=t.isWebMercator,u=r?102100:4326,s=D[u].maxX,c=D[u].minX,p=D[u].plus180Line,d=D[u].minus180Line),l)if(f.type==="mesh")m.push(f);else if(f.type==="point")m.push(J(f.clone(),s,c));else if(f.type==="multipoint"){let h=f.clone();h.points=h.points.map(y=>J(y,s,c)),m.push(h)}else if(f.type==="extent"){let h=f.clone()._normalize(!1,!1,l);m.push(h.rings?new X(h):h)}else if(f.extent){let h=f.extent,y=b(h.xmin,c)*(2*s),M=y===0?f.clone():I(f.clone(),y);h.offset(y,0);let{xmin:R,xmax:g}=h;R=Number(R.toFixed(9)),g=Number(g.toFixed(9)),h.intersects(p)&&g!==s?(a=g>a?g:a,M=H(M,r),x.push(M),m.push("cut")):h.intersects(d)&&R!==c?(a=g*(2*s)>a?g*(2*s):a,M=H(M,r,360),x.push(M),m.push("cut")):m.push(M)}else m.push(f.clone());else m.push(f);else m.push(f);let w=b(a,s),L=-90,G=w,P=new k;for(;w>0;){let f=360*w-180;P.addPath([[f,L],[f,-1*L]]),L*=-1,w--}if(x.length>0&&G>0){let f=Z(x,yield E(o,x,P,i)),h=[],y=[];for(let g=0;g<m.length;g++){let v=m[g];if(v!=="cut")y.push(v);else{let N=f.shift(),A=e[g];A!=null&&A.type==="polygon"&&A.rings&&A.rings.length>1&&N.rings.length>=A.rings.length?(h.push(N),y.push("simplify")):y.push(r?T(N):N)}}if(!h.length)return y;let M=yield _(o,h,i),R=[];for(let g=0;g<y.length;g++){let v=y[g];v!=="simplify"?R.push(v):R.push(r?T(M.shift()):M.shift())}return R}let z=[];for(let f=0;f<m.length;f++){let h=m[f];if(h!=="cut")z.push(h);else{let y=x.shift();z.push(r===!0?T(y):y)}}return z})}function ae(e){if(!e)return null;let n=e.extent;if(!n)return null;let i=e.spatialReference&&C(e.spatialReference);if(!i)return n;let[o,t]=i.valid,l=2*t,{width:r}=n,s,{xmin:c,xmax:u}=n;if([c,u]=[u,c],e.type==="extent"||r===0||r<=t||r>l||c<o||u>t)return n;switch(e.type){case"polygon":if(!(e.rings.length>1))return n;s=B(e.rings);break;case"polyline":if(!(e.paths.length>1))return n;s=B(e.paths);break;case"multipoint":s=e.points}let p=n.clone();for(let d=0;d<s.length;d++){let a=s[d][0];a<0?(a+=t,u=Math.max(a,u)):(a-=t,c=Math.min(a,c))}return p.xmin=c,p.xmax=u,p.width<r?(p.xmin-=t,p.xmax-=t,p):n}function ue(e,n,i){let o=C(i);if(o==null)return e;let[t,l]=o.valid,r=2*l,s=0,c=0;n>l?s=Math.ceil(Math.abs(n-l)/r):n<t&&(s=-Math.ceil(Math.abs(n-t)/r)),e>l?c=Math.ceil(Math.abs(e-l)/r):e<t&&(c=-Math.ceil(Math.abs(e-t)/r));let u=e+(s-c)*r,p=u-n;return p>l?u-=r:p<t&&(u+=r),u}function pe(e,n){let i=C(n);if(i){let[o,t]=i.valid,l=t-o;if(e<o)for(;e<o;)e+=l;if(e>t)for(;e>t;)e-=l}return e}export{Y as a,$ as b,ae as c,ue as d,pe as e};
