import{a as v,b as _,d as $}from"./chunk-GWBRHLNH.js";import{h as Y}from"./chunk-RNC4P66O.js";import{a as Z}from"./chunk-U4QEPZJ3.js";import{c as X}from"./chunk-VIEK2X23.js";import{a as B}from"./chunk-7F5DJLJT.js";import{L as U,d as Q,h as T,m as V}from"./chunk-NJWTSROP.js";import{i as K}from"./chunk-P6QFA5MM.js";import{b}from"./chunk-YOFFGXOB.js";function te(e){if(!e)return null;let t=e.wkid;if(t)return $[t];let s=e.wkt2??e.wkt;return s?he(s):null}function he(e){let t=_.exec(e);if(!t||t.length!==2)return null;let s=t[1].split(",");if(!s||s.length<3)return null;let i=parseFloat(s[1]),n=parseFloat(s[2]);return isNaN(i)||isNaN(n)?null:{a:i,f:n===0?0:1/n}}function L(e){let t=te(e);if(le(t))return t;let s=t.a*(1-t.f);return Object.assign(t,{b:s,eSq:1-(s/t.a)**2,radius:(2*t.a+s)/3,densificationRatio:1e4/((2*t.a+s)/3)})}function le(e){return e!=null&&"b"in e&&"eSq"in e&&"radius"in e}function ee(e){return e!=null&&e<0?e+360:e}function E(e,t,s){let{a:i,eSq:n}=L(s),a=Math.sqrt(n),r=Math.sin(t[1]*v),l=i*t[0]*v,c;return n>0?c=i*((1-n)*(r/(1-n*(r*r))-1/(2*a)*Math.log((1-a*r)/(1+a*r))))*.5:c=i*r,e[0]=l,e[1]=c,e}function I(e){return T(e)&&!!te(e)}function Re(e,t="square-meters"){if(e.some(r=>!I(r.spatialReference)))throw new b("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");let s=[];for(let r=0;r<e.length;r++){let l=e[r],c=l.spatialReference,{radius:h,densificationRatio:p}=L(c),o=h*p;s.push(pe(l,o))}let i=[],n=[0,0],a=[0,0];for(let r=0;r<s.length;r++){let{rings:l,spatialReference:c}=s[r],h=0;for(let p=0;p<l.length;p++){let o=l[p];E(n,o[0],c),E(a,o[o.length-1],c);let d=a[0]*n[1]-n[0]*a[1];for(let m=0;m<o.length-1;m++)E(n,o[m+1],c),E(a,o[m],c),d+=a[0]*n[1]-n[0]*a[1];h+=d}h=U(h,"square-meters",t),i.push(h/-2)}return i}function ze(e,t="meters"){if(!e)throw new b("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some(i=>!I(i.spatialReference)))throw new b("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");let s=[];for(let i=0;i<e.length;i++){let n=e[i],{spatialReference:a}=n,r=n.type==="polyline"?n.paths:n.rings,l=0;for(let c=0;c<r.length;c++){let h=r[c],p=0;for(let o=1;o<h.length;o++){let d=h[o-1][0],m=h[o][0],M=h[o-1][1],g=h[o][1];if(M!==g||d!==m){let u=new D;H(u,[d,M],[m,g],a),p+=u.distance}}l+=p}l=U(l,"meters",t),s.push(l)}return s}function pe(e,t){if(e.type!=="polyline"&&e.type!=="polygon")throw new b("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");let{spatialReference:s}=e;if(!I(s))throw new b("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");let i=e.type==="polyline"?e.paths:e.rings,n=[],a=[0,0],r=new D;for(let c of i){let h=[];n.push(h),h.push([c[0][0],c[0][1]]);let p,o,d=c[0][0],m=c[0][1];for(let M=0;M<c.length-1;M++){if(p=c[M+1][0],o=c[M+1][1],d===p&&m===o)continue;let g=[d,m];H(r,[d,m],[p,o],s);let{azimuth:u,distance:R}=r,w=R/t;if(w>1){for(let N=1;N<=w-1;N++)W(a,g,u,N*t,s),h.push(a.slice());W(a,g,u,(R+Math.floor(w-1)*t)/2,s),h.push(a.slice())}W(a,g,u,R,s),h.push(a.slice()),d=a[0],m=a[1]}}let l=K(B,s);return e.type==="polyline"?new Z({paths:n,spatialReference:l}):new Y({rings:n,spatialReference:l})}var D=class{constructor(t=0,s=void 0,i=void 0){this.distance=t,this.azimuth=s,this.reverseAzimuth=i}};function W(e,t,s,i,n){let a=t[0],r=t[1],l=a*v,c=r*v,h=(s??0)*v,{a:p,b:o,f:d}=L(n),m=Math.sin(h),M=Math.cos(h),g=(1-d)*Math.tan(c),u=1/Math.sqrt(1+g*g),R=g*u,w=Math.atan2(g,M),N=u*m,G=N*N,q=1-G,f=q*(p*p-o*o)/(o*o),F=1+f/16384*(4096+f*(f*(320-175*f)-768)),j=f/1024*(256+f*(f*(74-47*f)-128)),z,A,y,x=i/(o*F),P=2*Math.PI;for(;Math.abs(x-P)>1e-12;)y=Math.cos(2*w+x),z=Math.sin(x),A=Math.cos(x),P=x,x=i/(o*F)+j*z*(y+j/4*(A*(2*y*y-1)-j/6*y*(4*z*z-3)*(4*y*y-3)));let S=R*z-u*A*M,k=Math.atan2(R*A+u*z*M,(1-d)*Math.sqrt(G+S*S)),C=d/16*q*(4+d*(4-3*q)),O=Math.atan2(z*m,u*A-R*z*M)-(1-C)*d*N*(x+C*z*(y+C*A*(2*y*y-1)));return e[0]=(l+O)/v,e[1]=k/v,e}function H(e,t,s,i){let n=t[0]*v,a=t[1]*v,r=s[0]*v,l=s[1]*v,{a:c,b:h,f:p,radius:o}=L(i),d=r-n,m=Math.atan((1-p)*Math.tan(a)),M=Math.atan((1-p)*Math.tan(l)),g=Math.sin(m),u=Math.cos(m),R=Math.sin(M),w=Math.cos(M),N,G,q,f,F,j,z,A,y,x,P=1e3,S=d;do{if(z=Math.sin(S),A=Math.cos(S),q=Math.sqrt(w*z*(w*z)+(u*R-g*w*A)*(u*R-g*w*A)),q===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;F=g*R+u*w*A,j=Math.atan2(q,F),y=u*w*z/q,G=1-y*y,f=F-2*g*R/G,isNaN(f)&&(f=0),x=p/16*G*(4+p*(4-3*G)),N=S,S=d+(1-x)*p*y*(j+x*q*(f+x*F*(2*f*f-1)))}while(Math.abs(S-N)>1e-12&&--P>0);if(P===0){let ie=o,ae=Math.acos(Math.sin(a)*Math.sin(l)+Math.cos(a)*Math.cos(l)*Math.cos(r-n))*ie,J=r-n,re=Math.sin(J)*Math.cos(l),oe=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(J),ce=Math.atan2(re,oe);return e.azimuth=ce/v,e.distance=ae,e.reverseAzimuth=void 0,e}let k=G*(c*c-h*h)/(h*h),C=k/1024*(256+k*(k*(74-47*k)-128)),O=h*(1+k/16384*(4096+k*(k*(320-175*k)-768)))*(j-C*q*(f+C/4*(F*(2*f*f-1)-C/6*f*(4*q*q-3)*(4*f*f-3)))),ne=Math.atan2(w*Math.sin(S),u*R-g*w*Math.cos(S)),se=Math.atan2(u*Math.sin(S),u*R*Math.cos(S)-g*w);return e.azimuth=ne/v,e.distance=O,e.reverseAzimuth=se/v,e}function be(e,t,s="meters"){if(!e||!t)throw new b("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!e.spatialReference||!t.spatialReference)throw new b("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!Q(e.spatialReference,t.spatialReference))throw new b("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");let{spatialReference:i}=e;if(!I(i))throw new b("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(e.x===t.x&&e.y===t.y)return new D(0,0,0);let n=new D;return H(n,[e.x,e.y],[t.x,t.y],i),n.distance=U(n.distance,"meters",s),n.azimuth=ee(n.azimuth),n.reverseAzimuth=ee(n.reverseAzimuth),n}function qe(e,t,s){if(!e||t==null||s==null)throw new b("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(s<0||s>360)throw new b("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\xB0 to 360\xB0 degrees");if(!e.spatialReference)throw new b("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");let{spatialReference:i}=e;if(!I(i))throw new b("geodesic-distance:not-supported","input geometry spatial reference is not supported");let n=[0,0];return W(n,[e.x,e.y],s,t,i),new X({x:n[0],y:n[1],spatialReference:i})}function xe(e){return I(e)?e:V(e)?B.WGS84:null}export{I as a,Re as b,ze as c,pe as d,D as e,W as f,H as g,be as h,qe as i,xe as j};
