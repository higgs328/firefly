import{a as R,b as O,h as q,m as V}from"./chunk-FKASYKK7.js";import"./chunk-LAAJ7BOG.js";import{$ as E,D as n,E as T,F as g,_ as B,aa as y,ca as M,ja as b,ma as D,na as w,oa as N,pa as L,qa as A,ra as U}from"./chunk-A2QQP5DF.js";import{b as v,c as S}from"./chunk-LTHAIW3V.js";import"./chunk-RRQS6PLL.js";import{K as C}from"./chunk-WFHQTMIY.js";import{a as G}from"./chunk-XAZOVQGA.js";import{a as k,b as d,o as l,pa as P,z as F}from"./chunk-V3KEO7AJ.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-KVM6SHDX.js";import"./chunk-EQZWYK27.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-G4DZJMGT.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import{y as I}from"./chunk-QBWJMFH5.js";import"./chunk-VTHXE323.js";function Z(a){a&&a.checkProgress()}var f=class{getOperatorType(){return 10012}accelerateGeometry(t,e,s){return!1}canAccelerateGeometry(t){return!1}supportsCurves(){return!0}executeMany(t,e,s,o){return new x(t,e,s,o)}},x=class extends v{constructor(t,e,s,o){super(),this.m_shape=null,this.m_topoGraph=null,this.m_curveStitcher=null,this.m_stitchMaxDeviation=0,this.m_chainStack=[],this.m_bitsetToChains=null,this.m_chainsLists=null,this.m_visitedChainsIndex=-1,this.m_index=-1,this.m_geometryIndex=-1,this.m_progressCounter=0,this.m_currentIds=[],this.m_currentEdgeIds=[],t||l(""),this.m_progressTracker=o,this.m_options=s!==0?s:3,(this.m_options<=0||this.m_options>63)&&l("options"),this.m_inputGeometryCursor=t,this.m_sr=e}tock(){return!0}getRank(){return 1}next(){if(this.m_index===-1){this.m_shape=new g;let t=new G;t.setEmpty(),this.m_geometryIndex=this.m_shape.createGeometryUserIndex();for(let i=this.m_inputGeometryCursor.next();i!==null;i=this.m_inputGeometryCursor.next()){F(i);let h=this.m_shape.addGeometry(i);i.getGeometryType()!==d.enumPolygon&&l("Polygon Overlay only supports Polygons"),this.m_shape.setGeometryUserIndex(h,this.m_geometryIndex,this.m_inputGeometryCursor.getGeometryID());let m=this.m_inputGeometryCursor.getRank();m>T&&this.m_shape.assignRankToGeometryVertices(h,m);let p=new G;i.queryLooseEnvelope(p),t.mergeEnvelope2D(p),Z(this.m_progressTracker)}this.m_inputGeometryCursor=null;let e=C(this.m_sr,t,!0),s=C(this.m_sr,t,!1);t.inflate(10*e.total()),this.m_shape.forceSetEnvelope2D(t),this.m_stitchMaxDeviation=0;let o=0;if(this.m_shape.hasCurves()){this.m_curveStitcher=new L;let i=D(e.total(),t);this.m_stitchMaxDeviation=w(e.total()),o=N(i,this.m_stitchMaxDeviation),b(this.m_shape,i,e.total(),12e3,this.m_curveStitcher,null,this.m_progressTracker)}if(U(this.m_shape,s,this.m_progressTracker)){A(this.m_shape,e.add(o),this.m_progressTracker,!0,!1);for(let i=this.m_shape.getFirstGeometry();i!==n;i=this.m_shape.getNextGeometry(i))this.m_shape.getGeometryType(i)===d.enumPolygon&&M(this.m_shape,i,-1,!1,n,this.m_progressTracker)}this.m_topoGraph=new E,this.m_topoGraph.buildGeometryParentageSets(),this.m_topoGraph.setEditShape(this.m_shape,this.m_progressTracker);let r=this.m_topoGraph.getFirstChain();for(let i=this.m_topoGraph.getChainFirstIsland(r);i!==n;i=this.m_topoGraph.getChainNextInParent(i))for(let h=this.m_topoGraph.getChainFirstIsland(i);h!==n;h=this.m_topoGraph.getChainNextInParent(h))this.m_chainStack.push(h);if(16&this.m_options){this.m_visitedChainsIndex=this.m_topoGraph.createUserIndexForChains(),this.m_bitsetToChains=new Map,this.m_chainsLists=new y;let i=[],h=this.m_topoGraph.getFirstChain();for(i.push(h);i.length>0;){let m=i.at(-1);i.pop();for(let p=this.m_topoGraph.getChainFirstIsland(m);p!==n;p=this.m_topoGraph.getChainNextInParent(p))for(let _=this.m_topoGraph.getChainFirstIsland(p);_!==n;_=this.m_topoGraph.getChainNextInParent(_)){let c=this.m_topoGraph.getChainBitSet(_);if(c!==null&&!c.isZero()){let u;this.m_bitsetToChains.has(c)?u=this.m_bitsetToChains.get(c):(u=this.m_chainsLists.createList(),this.m_bitsetToChains.set(c,u)),this.m_chainsLists.addElement(u,_)}i.push(_)}}}}return this.makeNextGeometry()}getGeometryID(){return this.m_index}getGeometryIDs(){return this.m_currentIds.slice()}getBoundaryIDs(){return this.m_currentEdgeIds.slice()}buildIdsFromBitset(t,e){if(!t)return;let s=this.m_topoGraph.getGeometriesFromBits(t);if(s.length>0){for(let o=0,r=s.length;o<r;o++)e.push(this.m_shape.getGeometryUserIndex(s[o],this.m_geometryIndex));P(e)}}makeGeometryFromChainSinglePart(t){this.m_index++;let e=new g;this.m_curveStitcher!==null&&e.setCurveStitcherPointer(this.m_curveStitcher);let s=this.m_topoGraph.extractPolygonFromChainAndIslands(e,n,t,n);return this.m_curveStitcher!==null&&this.m_curveStitcher.stitchCurves(e,s,this.m_stitchMaxDeviation,!1),e.getGeometry(s)}makeGeometryFromChainMultiPart(t,e){this.m_index++;let s=new g;this.m_curveStitcher!==null&&s.setCurveStitcherPointer(this.m_curveStitcher);let o=this.m_bitsetToChains.has(e);k(o);let r=this.m_bitsetToChains.get(e),i=n;for(let h=this.m_chainsLists.getFirst(r);h!==y.st_nullNode();h=this.m_chainsLists.getNext(h)){let m=this.m_chainsLists.getElement(h);i=this.m_topoGraph.extractPolygonFromChainAndIslands(s,i,m,n),this.m_topoGraph.setChainUserIndex(m,this.m_visitedChainsIndex,1)}return this.m_curveStitcher!==null&&this.m_curveStitcher.stitchCurves(s,i,this.m_stitchMaxDeviation,!1),s.getGeometry(i)}makeNextGeometry(){for(Z(this.m_progressTracker);this.m_chainStack.length>0;){this.m_currentIds.length=0,this.m_currentEdgeIds.length=0;let t=this.m_chainStack.at(-1);this.m_chainStack.pop();let e=this.m_topoGraph.getChainArea(t);if(e!==0)if(e<0)for(let s=this.m_topoGraph.getChainFirstIsland(t);s!==n;s=this.m_topoGraph.getChainNextInParent(s))this.m_topoGraph.getChainArea(s)>0&&this.m_chainStack.push(s);else{for(let r=this.m_topoGraph.getChainFirstIsland(t);r!==n;r=this.m_topoGraph.getChainNextInParent(r))this.m_topoGraph.getChainArea(r)<0&&this.m_chainStack.push(r);if(this.m_visitedChainsIndex!==-1&&this.m_topoGraph.getChainUserIndex(t,this.m_visitedChainsIndex)===1)continue;let s=r=>{let i=r.getUnorderedBitIterator(),h=0;for(;i.next()!==B.npos();)if(h++,h>1)return h;return h},o=s(this.m_topoGraph.getChainBitSet(t));if(o>0){if(o===1&&2&this.m_options||o>1&&1&this.m_options){let r=this.m_topoGraph.getChainBitSet(t);return this.buildIdsFromBitset(r,this.m_currentIds),16&this.m_options?this.makeGeometryFromChainMultiPart(t,r):this.makeGeometryFromChainSinglePart(t)}}else{if(!(12&~this.m_options)){if(32&this.m_options){let r=this.m_topoGraph.getChainBoundaryBitSet(t);this.buildIdsFromBitset(r,this.m_currentEdgeIds)}return this.makeGeometryFromChainSinglePart(t)}if(4&this.m_options){let r=this.m_topoGraph.getChainBoundaryBitSet(t);if(s(r)>1)return 32&this.m_options&&this.buildIdsFromBitset(r,this.m_currentEdgeIds),this.makeGeometryFromChainSinglePart(t);continue}if(8&this.m_options){let r=this.m_topoGraph.getChainBoundaryBitSet(t);if(s(r)===1)return 32&this.m_options&&this.buildIdsFromBitset(r,this.m_currentEdgeIds),this.makeGeometryFromChainSinglePart(t);continue}}}}return null}},j=new f;function z(a,t,e){let s=j.executeMany(new S(a),t,e,null);return Array.from(s)}function H(){return j.supportsCurves()}function rt(a,t){let e=0;t&&(t.overlaps&&(e|=1),t.noOverlaps&&(e|=2),t.gaps&&(e|=4),t.holes&&(e|=8),t.multiPart&&(e|=16));let s=a.map(O),o=R(a);return z(s,q(o),e).map(r=>V(r,o)).filter(I)}var ot=H();export{rt as executeMany,ot as supportsCurves};
