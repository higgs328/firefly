import{e as m}from"./chunk-NQ53MXMB.js";import{a as r}from"./chunk-QGVBCWUY.js";import{H as y,r as f}from"./chunk-MYO4NP2N.js";import{e as s}from"./chunk-NFIPKH6V.js";import{l as h}from"./chunk-5QEXLALV.js";import{K as p,z as n}from"./chunk-4PTIEWMT.js";import{f as d}from"./chunk-VTHXE323.js";function c(t,e){let o=t??{},a=e??{},l=new Set(Object.keys(o));f(l,Object.keys(a));for(let u of l){let g=o[u],b=a[u];if(!m(g,b))return!1}return!0}function _(t){return t==null?null:JSON.stringify(t)}var i=class extends y{constructor(t){super(t),this._stagedForDelete=!1,this.feature=null,this.initialFeature=null,this.submittable=!1,this.displayTitle=null,this.isAssociation=!1,this._debouncedRefreshDisplayTitle=p(this._refreshDisplayTitle.bind(this),100)}get attributesModified(){return!c(this.initialFeature?.attributes,this.feature?.attributes)}get geometryModified(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}set timeZone(t){this._set("timeZone",t),n(this._debouncedRefreshDisplayTitle())}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(t=this.feature){this.initialFeature=t?.clone(),n(this._debouncedRefreshDisplayTitle())}updateAttributes(t){let{feature:e}=this;e&&(e.attributes=t,this.notifyChange("attributesModified")),n(this._debouncedRefreshDisplayTitle())}updateGeometry(t){let{feature:e}=this;e&&(e.geometry=t,this.notifyChange("geometryModified"))}_stringifyGeometry(t){let e=t?.geometry;return _(e?.type==="mesh"?{transform:e.transform,vertexSpace:e.vertexSpace}:e)}_refreshDisplayTitle(t){return d(this,null,function*(){let e=this.feature,o=e?.sourceLayer;if(!o||!("getFeatureTitle"in o))return;let a=yield o.getFeatureTitle(e,{fetchMissingFields:!1,timeZone:this.timeZone});t.aborted||(this.displayTitle=a===""?null:a)})}};r([s()],i.prototype,"_stagedForDelete",void 0),r([s()],i.prototype,"attributesModified",null),r([s()],i.prototype,"feature",void 0),r([s()],i.prototype,"geometryModified",null),r([s()],i.prototype,"initialFeature",void 0),r([s()],i.prototype,"modified",null),r([s()],i.prototype,"submittable",void 0),r([s()],i.prototype,"displayTitle",void 0),r([s()],i.prototype,"isAssociation",void 0),r([s()],i.prototype,"timeZone",null),i=r([h("esri.widgets.Editor.Edits")],i);var k=i;export{k as a};
