import{a as ee}from"./chunk-K4Z2LVRX.js";import{a as te}from"./chunk-PSJXKSSD.js";import{a as ne}from"./chunk-UWK3LZKM.js";import{a as ae}from"./chunk-ZVQZT2S3.js";import{a as $}from"./chunk-WWB2PP2I.js";import{b as W,c as q,d as D,e as O,f as k,g as j}from"./chunk-RPYYOCCF.js";import{b as Z,h as F}from"./chunk-LMCM3VZM.js";import{a as Y}from"./chunk-GAVFKWSK.js";import{a as X}from"./chunk-DK4DGLAO.js";import{a as Q}from"./chunk-PE276TWH.js";import{a as z}from"./chunk-FNY6LFKI.js";import{c as H}from"./chunk-QS3EYJPF.js";import{c as E}from"./chunk-UMJIJLDA.js";import{a as L}from"./chunk-HQHD6BMN.js";import{a as _}from"./chunk-AIKKGGPG.js";import{a as N}from"./chunk-RDGG4TVD.js";import{a as V}from"./chunk-BPWNCOXC.js";import{a as y}from"./chunk-6F25LG6O.js";import{a as G,c as K}from"./chunk-E6C7G5SC.js";import{a as A}from"./chunk-E7AX56GD.js";import{ca as U}from"./chunk-NJWTSROP.js";var de=.25,oe=L.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),re=L.fromJSON(Z[0]),ie=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function Ge(e){return e.presetRenderers?.find(({method:t,value:a})=>t==="raster-function-template"?a===e.rasterFunctionName:t==="variable"&&a===e.variableName)}function Ke(e,t){let{attributeTable:a,colormap:n}=e;if(k(e)){let r=Re(e);if(r!=null)return r}if(t?.rasterFunctionColorRamp){let r=le(e,t);return r.colorRamp=t.rasterFunctionColorRamp,r}if(n!=null){let r=ye(e);if(r!=null)return r}if(a!=null){let r=ge(e);if(r!=null)return r}return le(e,t)}function _e(e,t=!1){let a=["raster-stretch"];return D(e,t)&&a.push("raster-colormap"),W(e)&&a.push("unique-value"),O(e,t)&&a.push("class-breaks"),q(e)&&a.push("raster-shaded-relief"),k(e)&&a.push("vector-field"),j(e)&&a.push("flow"),a}function He(e){return e.datasetFormat==="Function"&&e.rasterFunction.functionName==="Colormap"?e.rasterFunction.colorRamp:void 0}function Qe(e,t,a){let n=["nearest","bilinear","cubic","majority"],r=a?.toLowerCase().replace("bicubic","cubic"),l=n.find(s=>s===r);return t==="Map"?l??"bilinear":e.dataType==="standard-time"?l??"nearest":e.dataType==="thematic"||e.attributeTable||e.colormap?l==="nearest"||l==="majority"?l:"nearest":l??"bilinear"}function le(e,t){e=ue(e,t?.variableName);let{bandCount:a}=e,{bandIds:n,stretchType:r}=t||{};n?.some(m=>m>=a)&&(n=null);let l=e.statistics,s=e.histograms;a>1?(n=n?.length?n:pe(e),l=l==null?null:n?.map(m=>l[m]),s=s==null?null:n?.map(m=>s[m])):n=[0],r==null&&(r=he(e)),t?.includeStatisticsInStretch&&(r==="percent-clip"||r==="histogram-equalization")&&e.statistics?.length&&(r="min-max");let o=!1;switch(r){case"none":o=!1;break;case"percent-clip":o=!s?.length;break;default:o=!l?.length}let{dataType:d}=e,p=n?.length===1&&ie.has(d)?oe:null,c=new ne({stretchType:r,dynamicRangeAdjustment:o,colorRamp:p,outputMin:0,outputMax:255,gamma:n?.length===1?[1]:[1,1,1],useGamma:!1});return r==="percent-clip"?c.maxPercent=c.minPercent=de:r==="standard-deviation"&&(c.numberOfStandardDeviations=2),o||e.multidimensionalInfo==null&&!t?.includeStatisticsInStretch||(r==="percent-clip"?c.histograms=s:r!=="min-max"&&r!=="standard-deviation"||(c.statistics=l)),c}function ue(e,t){let{multidimensionalInfo:a}=e;if(!t||!a)return e;let n=a.variables.find(r=>r.name===t);if(!n)return e;if(e=e.clone(),n){let{statistics:r,histograms:l}=n;r?.length&&(e.statistics=r.map(s=>({min:s.min,max:s.max,avg:s.avg,stddev:s.stddev}))),l?.length&&(e.histograms=l)}return e}function pe(e){let t=e.bandCount;if(t===1)return null;if(t===2)return[0];let{bandInfos:a}=e,n;if(a.length===t){let{red:r,green:l,blue:s,nir:o}=be(a);r!=null&&l!=null&&s!=null?n=[r,l,s]:o!=null&&r!=null&&l!=null&&(n=[o,r,l])}return!n&&t>=3&&(n=[0,1,2]),n}function be(e){let t={};for(let a=0;a<e.length;a++){let n=e[a],r=n.name.toLowerCase();if(r==="red")t.red=a;else if(r==="green")t.green=a;else if(r==="blue")t.blue=a;else if(r==="nearinfrared"||r==="nearinfrared_1"||r==="nir")t.nir=a;else if(n.maxWavelength&&n.minWavelength){let l=n.minWavelength,s=n.maxWavelength;t.blue==null&&l>=410&&l<=480&&s>=480&&s<=540?t.blue=a:t.green==null&&l>=490&&l<=560&&s>=560&&s<=610?t.green=a:t.red==null&&l>=595&&l<=670&&s>=660&&s<=730?t.red=a:t.nir==null&&l>=700&&l<=860&&s>=800&&s<=950&&(t.nir=a)}}return t}function he(e){let t="percent-clip",{pixelType:a,dataType:n,histograms:r,statistics:l,multidimensionalInfo:s}=e,o=ie.has(n)||n==="generic"&&s!=null;return a!=="u8"||n!=="processed"&&r!=null&&l!=null?a==="u8"||n==="elevation"||o?t="min-max":r!=null?t="percent-clip":l!=null&&(t="min-max"):t="none",t}function ge(e,t,a,n){if(!W(e,t))return null;let{attributeTable:r,statistics:l}=e,s=me(r,t),o=T(r,"red"),d=T(r,"green"),p=T(r,"blue"),c=new E,m=[],v=new Set,w=!!(o&&d&&p);if(r!=null)r.features.forEach(i=>{let f=i.attributes[s.name];if(!v.has(i.attributes[s.name])&&f!=null){v.add(f);let b=w&&(o.type==="single"||o.type==="double")&&(d.type==="single"||d.type==="double")&&(p.type==="single"||p.type==="double")&&!r.features.some(u=>u.attributes[o.name]>1||u.attributes[d.name]>1||u.attributes[p.name]>1),C=b?255:1;m.push(new z({value:i.attributes[s.name],label:i.attributes[s.name]+"",symbol:new V({style:"solid",outline:null,color:new y(w?[i.attributes[o.name]*C,i.attributes[d.name]*C,i.attributes[p.name]*C,1]:[0,0,0,0])})}))}});else if(l?.[0])for(let i=l[0].min;i<=l[0].max;i++)m.push(new z({value:i,label:i.toString(),symbol:new V({style:"solid",outline:null,color:new y([0,0,0,0])})}));if(m.sort((i,f)=>i.value&&typeof i.value.valueOf()=="string"?0:i.value>f.value?1:-1),!w){let i=F(re,{numColors:m.length});m.forEach((f,b)=>f.symbol.color=new y(i[b].slice(1,4))),c.colorRamp=re}if(a||n){let i=a||F(n,{numColors:m.length}).map(f=>f.slice(1));m.forEach((f,b)=>f.symbol.color=new y(i[b])),c.colorRamp=n}return new Q({field:s.name,uniqueValueInfos:m,authoringInfo:c})}function me(e,t,a){let n;return e!=null?(n=t?e.fields.find(r=>t.toLowerCase()===r.name.toLowerCase()):ve(e.fields),n||(a||(n=e.fields.find(r=>r.type==="string")),n||(n=T(e,"value")))):n=new A({name:"value"}),n}function ve(e){let t;for(let a=0;a<e.length;a++){let n=e[a].name.toLowerCase();if(e[a].type==="string"){if(n.startsWith("class")){t=e[a];break}t==null&&(n.endsWith("name")||n.endsWith("type"))&&(t=e[a])}}return t}function T(e,t){return e==null?null:e.fields.find(a=>a.name.toLowerCase()===t)}function ye(e){if(!D(e))return null;let t,{attributeTable:a,colormap:n}=e;if(a!=null){let r=T(a,"value"),l=me(a,null,!0);l.type==="string"&&(t={},a.features.forEach(s=>{let o=s.attributes;t[o[r.name]]=l?o[l.name]:o[r.name]}))}return ee.createFromColormap(n,t)}function Xe(e,t="traditional"){if(!q(e))return null;let{extent:a}=e,n=a.width*U(a.spatialReference);return new te({hillshadeType:t,scalingType:n>5e6?"adjusted":"none"})}function Ye(e,t){e=ue(e,t?.variableName);let{attributeTable:a}=e;if(!O(e))return null;let n=e.histograms!=null?e.histograms[0]:null,r=t?.numClasses!=null&&isFinite(t?.numClasses)?t.numClasses:5,l=new E({classificationMethod:t?.classificationMethod,colorRamp:t?.colorRamp}),s=t?.field||"value",o=[],d=[],p=1e3,c=a!=null,m=c&&a.fields.find(u=>u.name.toLowerCase()==="count"),v=c?a.fields.find(u=>u.name.toLowerCase()===s.toLowerCase()):void 0;if(v&&c){s=v.name;let u=a.features.length,h=0;a.features.forEach(g=>h+=(m?g.attributes[m.name]:50)/u),a.features.forEach(g=>{let B=g.attributes[v.name],R=m?g.attributes[m.name]:50;if(R>0){d.push(R);let x=Math.max(1,Math.round(R/u/h*p));for(let M=0;M<x;M++)o.push(B)}})}else{let{pixelType:u}=e,h=(n.max-n.min)/n.size,g=u.includes("s")||u.includes("u"),B=g&&h===1?Math.floor(n.min+.5):n.min,R=g&&h===1?Math.floor(n.max-.5):n.max,x=n.size,M,J=0;n.counts.forEach(S=>J+=S/x),n.counts.forEach((S,I)=>{if(S>0){d.push(S);let fe=Math.max(1,Math.round(S/x/J*p));M=c?a.features[I].attributes[v.name]:I===0?B:I===x-1?R:n.min+h*(I+.5);for(let P=0;P<fe;P++)o.push(M)}})}let w=t?.classificationMethod||"natural-breaks",i=t?.definedInterval;w!=="defined-interval"||i||(i=we(e,v,r));let f=K({values:o,valueFrequency:d,normalizationTotal:null,definition:new G({classificationMethod:w,breakCount:r,definedInterval:i})}),b=t?.colors;if(!b){let u=t?.colorRamp||oe;l.colorRamp=u,b=F(u,{numColors:f.classBreaks.length,interpolateAlpha:!0}).map(g=>g.slice(1))}let C=f.classBreaks.map((u,h)=>new X({minValue:u.minValue,maxValue:u.maxValue,label:u.label,symbol:new V({color:b[h]})}));return new Y({field:s,classBreakInfos:C,authoringInfo:l})}function we(e,t,a){let n=0,r=0;if(e.attributeTable!=null){let l=e.attributeTable;n=r=l.features[0].attributes[t.name],l.features.forEach(s=>{let o=s.attributes[t.name];o<n&&(n=o),o>r&&(r=o)})}else if(e.histograms!=null){let l=e.histograms;n=l[0].min,r=l[0].max}return(r-n)/a}var Ce=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function Re(e){if(!k(e))return null;let t;if(e.statistics!=null&&e.statistics.length&&(e.dataType==="vector-magdir"||e.dataType==="vector-uv")){let{minMagnitude:r,maxMagnitude:l}=ce(e.dataType,e.statistics);t=[new H({field:"Magnitude",minSize:10,maxSize:40,minDataValue:r,maxDataValue:l})]}let a=e.multidimensionalInfo!=null?Ce.get(e.multidimensionalInfo.variables[0].unit):void 0,n=new ae({visualVariables:t,inputUnit:a,rotationType:"geographic"});return n.visualVariables=[...n.sizeVariables,...n.rotationVariables],n}function se(e){return{color:e.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function Ze(e){if(e.type==="uniqueValue"){let t=e.uniqueValueInfos;return t?.[0].symbol?.symbolLayers?.length&&(e.uniqueValueInfos=t?.map(n=>({value:n.value,label:n.label,symbol:n.symbol?se(n.symbol):null}))),e}if(e.type==="classBreaks"){let t=e.classBreakInfos;return t[0].symbol?.symbolLayers?.length&&(e.classBreakInfos=t.map(n=>({classMinValue:n.classMinValue,classMaxValue:n.classMaxValue,label:n.label,symbol:n.symbol?se(n.symbol):null}))),e}return e}function $e(e){if(!j(e))return null;let t;if(e.statistics!=null&&e.statistics.length>0&&(e.dataType==="vector-magdir"||e.dataType==="vector-uv")){let{minMagnitude:a,maxMagnitude:n}=ce(e.dataType,e.statistics);t=[new _({field:"Magnitude",stops:[new N({value:a,color:new y("#1020c0")}),new N({value:n,color:new y("#c02010")})]})]}return new $({visualVariables:t})}function ce(e,t){let a,n;if(e==="vector-magdir")a=t[0].min,n=t[0].max;else{let r=t[0].min,l=t[0].max,s=t[1].min,o=t[1].max;a=0,n=Math.max(Math.abs(r),Math.abs(s),Math.abs(l),Math.abs(o))}return{minMagnitude:a,maxMagnitude:n}}export{Ge as a,Ke as b,_e as c,He as d,Qe as e,le as f,ue as g,pe as h,ge as i,me as j,T as k,ye as l,Xe as m,Ye as n,Re as o,Ze as p,$e as q,ce as r};
