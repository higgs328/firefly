import{a as y}from"./chunk-BNOCJUWF.js";import{a as f,b as _,g as b}from"./chunk-LSYBUGGM.js";import{a}from"./chunk-QGVBCWUY.js";import{e as l}from"./chunk-NFIPKH6V.js";import{l as d}from"./chunk-5QEXLALV.js";import{a as c}from"./chunk-VTHXE323.js";var o=class extends y{constructor(t){super(t),this._initialStopValues=[],this._max=null,this._min=null,this.hasTimeData=!1,this.inputFormatFunction=(e,s)=>s==="max"?this.getUnzoomedMax().toString():s==="min"?this.getUnzoomedMin().toString():e.toString(),this.inputParseFunction=null,this.labelFormatFunction=e=>{if(this.hasTimeData)return f(e);let{max:s,min:i,precision:n}=this,h=s-i>10?2:n;return _(parseFloat(e.toFixed(h)))},this.thumbsConstrained=!1,this.zoomingEnabled=!0}set breaks(t){this._set("breaks",t),this.notifyChange("max"),this.notifyChange("min")}set stops(t){if(t?.length){let{max:e,min:s}=this,i=this.getValuesFromStops(t),n={};s!=null&&i.some(h=>h<s)&&(n.min=Math.min(...i)),e!=null&&i.some(h=>h>e)&&(n.max=Math.max(...i)),this.set(c({},n)),this._initialStopValues=i}else this._initialStopValues=null;this._set("stops",t||null),this.notifyChange("values")}get labels(){let{values:t}=this,e=t&&t.length?t.map((n,h)=>this.getLabelForValue(n,"value",h)):[],s=this.getUnzoomedMax(),i=this.getUnzoomedMin();return{max:this.getLabelForValue(s,"max"),min:this.getLabelForValue(i,"min"),values:e}}get max(){let{breaks:t}=this;return t?.length?t[t.length-1].max:this.max}set max(t){let{zoomOptions:e}=this;if(e?.max!=null){let s=this.values,i=e.max;if(t<i&&(i=t,e.max=t),s&&s.length)for(let n=0;n<s.length;n++)t<s[n]&&this.setValue(n,t);this._storeZoomMax(i,t)}else this.updateBreakMax(t),this.setMax(t);this.notifyChange("labels")}get min(){let{breaks:t}=this;return t?.length?t[0].min:this.min}set min(t){let{zoomOptions:e}=this;if(e?.min!=null){let s=this.values,i=e.min;if(t>i&&(i=t,e.min=t),s&&s.length)for(let n=0;n<s.length;n++)t>s[n]&&this.setValue(n,t);this._storeZoomMin(i,t)}else this.updateBreakMin(t),this.setMin(t);this.notifyChange("labels")}get state(){let{max:t,min:e,values:s}=this;return t!=null&&e!=null&&s.length>0?"ready":"disabled"}get values(){let{breaks:t,stops:e}=this;if(!t&&!e)return[];if(t?.length){let i=t.map(n=>n.max);return i.pop(),i}if(e?.length<2)return[];let s=this.getValuesFromStops();return[s[0],s[s.length-1]]}set zoomOptions(t){let{zoomingEnabled:e,zoomOptions:s}=this;if(e){if(s){let i=this._max!=null?this._max:this.max,n=this._min!=null?this._min:this.min;if(t){let{max:h,min:m}=t,u=h!=null,p=m!=null,g=p?t.min:n,r=p?n:null,x=u?t.max:i,M=u?i:null;this._storeZoomMin(g,r),this._storeZoomMax(x,M)}else this.setMax(i),this.setMin(n),this._min=null,this._max=null}else if(t){let{max:i,min:n}=t;n!=null&&this._storeZoomMin(t.min,this.min),i!=null&&this._storeZoomMax(t.max,this.max)}this._set("zoomOptions",t),this.notifyChange("max"),this.notifyChange("min")}}getStopIndexFromValueIndex(t){let{stops:e}=this,s=this.values[t];return t===0?s<=this.values[1]?0:e.length-1:t===1?this.values[0]>=s?0:e.length-1:null}getStopChanges(t,e){let s=this.stops,i=this.getStopIndexFromValueIndex(t),n=this.getValuesFromStops();n[i]=e;let[h,m]=[n[0],n[n.length-1]].sort((g,r)=>g>r?1:-1),u=m-h,p=s.length-1;return n.map((g,r)=>({index:r,value:this.toPrecision(h+r*u/p)}))}setValue(t,e){let{max:s,min:i,values:n}=this,h=n[t];if(isNaN(e)||h===e||e>s||e<i)return;n[t]=this.toPrecision(e),this._set("values",[...n]);let m=n.slice().sort((r,x)=>r>x?1:-1),u=m[0],p=m[m.length-1],g=b(u,p,this._initialStopValues??[]);this.updateStops(g),this.updateBreaks(),this.notifyChange("labels")}getValuesFromStops(t){return(t||this.stops)?.map(s=>s.hasOwnProperty("ratio")?s.ratio:s.value)}updateBreaks(){let{breaks:t,values:e}=this;t?.length&&e.slice().sort((s,i)=>s>i?1:-1).forEach((s,i)=>{t[i].max=s,t[i+1]!=null&&(t[i+1].min=s)})}updateBreakMax(t){let{breaks:e,max:s,min:i}=this;!isNaN(t)&&s!==t&&i!=null&&t>i&&e?.length&&(e[e.length-1].max=t)}updateBreakMin(t){let{breaks:e,max:s,min:i}=this;!isNaN(t)&&i!==t&&s!=null&&t<s&&e?.length&&(e[0].min=t)}updateStops(t){let{stops:e}=this,s=this.getValuesFromStops();if(s?.length){for(let i of t)s[i.index]=i.value;e.forEach((i,n)=>{i.hasOwnProperty("ratio")?i.ratio=s[n]:i.value=s[n]})}}getUnzoomedMax(){return this.zoomOptions&&this._max!=null?this._max:this.max}getUnzoomedMin(){return this.zoomOptions&&this._min!=null?this._min:this.min}_storeZoomMax(t,e){this._max=e,this.setMax(t)}_storeZoomMin(t,e){this._min=e,this.setMin(t)}};a([l()],o.prototype,"breaks",null),a([l()],o.prototype,"stops",null),a([l()],o.prototype,"hasTimeData",void 0),a([l()],o.prototype,"inputFormatFunction",void 0),a([l()],o.prototype,"inputParseFunction",void 0),a([l()],o.prototype,"labelFormatFunction",void 0),a([l({readOnly:!0})],o.prototype,"labels",null),a([l()],o.prototype,"max",null),a([l()],o.prototype,"min",null),a([l({readOnly:!0})],o.prototype,"state",null),a([l()],o.prototype,"thumbsConstrained",void 0),a([l({readOnly:!0})],o.prototype,"values",null),a([l()],o.prototype,"zoomingEnabled",void 0),a([l()],o.prototype,"zoomOptions",null),o=a([d("esri.widgets.smartMapping.SmartMappingSliderViewModel")],o);var Z=o;export{Z as a};
