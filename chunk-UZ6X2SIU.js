import{a as o,b as u,d as x,f as P,h as A}from"./chunk-57VFBGF3.js";import{a as E}from"./chunk-BOVYXYHK.js";import{i as _}from"./chunk-EQZWYK27.js";import{a as p}from"./chunk-ARRCN5K3.js";import{I as m,f as l}from"./chunk-4PTIEWMT.js";var C=class{constructor(n,t){this._textures=n,this.loadPromise=null,this._disposed=!1;let r=this._textures.acquire(t);m(r)?(r.then(s=>{this._disposed?l(s):this._textureRef=s}),this.loadPromise=r):this._textureRef=r}dispose(){this._textureRef=l(this._textureRef),this._disposed=!0}get glTexture(){return this._textureRef!=null?this._textureRef.glTexture:null}};function W(e,n,t,r){if(n==null||r==null)return!1;let s=x(n,r);if(s?.projector==null)return!1;if(s.projector===P)return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!0;let{source:i,dest:c,projector:R}=s;if(c.spatialReferenceId===o.WEB_MERCATOR){let a=u[i.spatialReferenceId][o.WGS84];return a!=null&&(a(e,0,d,0),A(d,0,t,0),t[3]=I(d[1],e[2],e[3],p.radius),!0)}if(i.spatialReferenceId!==o.WGS84&&i.spatialReferenceId!==o.CGCS2000||c.spatialReferenceId!==o.PLATE_CARREE){R(e,0,t,0);let a=i.metersPerUnit??1,f=c.metersPerUnit??1;t[3]=e[3]*a/f}else{let a=u[i.spatialReferenceId][o.SPHERICAL_ECEF],f=u[o.SPHERICAL_ECEF][o.PLATE_CARREE],h=e[3];a!=null&&f!=null&&(h=I(e[1],e[2],e[3],p.radius)),R(e,0,t,0),t[3]=h}return!0}function I(e,n,t,r){let s=r+n;if(s<r/2||t>s)return Number.MAX_VALUE;let i=Math.abs(M*e)+Math.asin(t/s);return i>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(i)}var d=E(),M=_(1);export{W as a,C as b};
