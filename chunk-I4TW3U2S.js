import{a as S}from"./chunk-V7WSVLSI.js";import{B as G,d as I,e as j,w as b,x as f}from"./chunk-ITDLEL4J.js";import{a as g,b as Z}from"./chunk-6RBQSBA2.js";import{a as l}from"./chunk-MIS6QMFE.js";import{a as A}from"./chunk-PEW2PLAN.js";import{a as O}from"./chunk-CX5IFQZJ.js";import{o as c}from"./chunk-AUAZP44J.js";import{W as M}from"./chunk-76ATOSLU.js";import{f as m}from"./chunk-CCJU4DSH.js";import{a as t}from"./chunk-QGVBCWUY.js";import{e as a}from"./chunk-NFIPKH6V.js";import{l as d}from"./chunk-5QEXLALV.js";import{b as N}from"./chunk-YOFFGXOB.js";import{g as L}from"./chunk-XRGPJ3QY.js";import{b as D}from"./chunk-6MRUJ2UW.js";import{f as w}from"./chunk-VTHXE323.js";var p=class extends m{constructor(e){super(e),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};t([a({type:String})],p.prototype,"dataType",void 0),t([l(f,{ignoreUnknown:!1})],p.prototype,"name",void 0),t([a({type:[String]})],p.prototype,"parameterNames",void 0),t([a({type:String})],p.prototype,"restrictionUsageParameterName",void 0),t([l(b,{ignoreUnknown:!1})],p.prototype,"timeNeutralAttributeName",void 0),t([a({type:String})],p.prototype,"trafficSupport",void 0),t([l(j)],p.prototype,"units",void 0),t([l(G)],p.prototype,"usageType",void 0),p=t([d("esri.rest.support.NetworkAttribute")],p);var P=p;var u=class extends m{constructor(e){super(e),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};t([a({type:Number})],u.prototype,"buildTime",void 0),t([a({type:String})],u.prototype,"name",void 0),t([a({type:[P]})],u.prototype,"networkAttributes",void 0),t([a()],u.prototype,"networkSources",void 0),t([a({type:String})],u.prototype,"state",void 0),u=t([d("esri.rest.support.NetworkDataset")],u);var _=u;var s=class extends m{constructor(e){super(e),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(e){return e==null?null:e.map(r=>f.fromJSON(r))}writeAccumulateAttributes(e,r,i){e?.length&&(r[i]=e.map(o=>f.toJSON(o)))}get capabilities(){return{supportsNow:(this.currentVersion??10)>=10.81}}readDefaultTravelMode(e,r){let i=r.supportedTravelModes?.find(({id:o})=>o===r.defaultTravelMode)??r.supportedTravelModes?.find(({itemId:o})=>o===r.defaultTravelMode);return i?S.fromJSON(i):null}};t([a()],s.prototype,"accumulateAttributeNames",void 0),t([A("accumulateAttributeNames")],s.prototype,"readAccumulateAttributes",null),t([O("accumulateAttributeNames")],s.prototype,"writeAccumulateAttributes",null),t([a()],s.prototype,"attributeParameterValues",void 0),t([a()],s.prototype,"capabilities",null),t([a()],s.prototype,"currentVersion",void 0),t([a()],s.prototype,"defaultTravelMode",void 0),t([A("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],s.prototype,"readDefaultTravelMode",null),t([a()],s.prototype,"directionsLanguage",void 0),t([l(I)],s.prototype,"directionsLengthUnits",void 0),t([a()],s.prototype,"directionsSupportedLanguages",void 0),t([l(b,{ignoreUnknown:!1})],s.prototype,"directionsTimeAttribute",void 0),t([a()],s.prototype,"hasZ",void 0),t([l(f,{ignoreUnknown:!1})],s.prototype,"impedance",void 0),t([a({type:_})],s.prototype,"networkDataset",void 0),t([a({type:[S]})],s.prototype,"supportedTravelModes",void 0),s=t([d("esri.rest.support.NetworkServiceDescription")],s);var $=s;var q=()=>L.getLogger("esri.rest.networkService");function Pt(e,r,i,o){o[i]=[r.length,r.length+e.length],e.forEach(n=>{r.push(n.geometry)})}function _t(e,r){for(let i=0;i<r.length;i++){let o=e[r[i]];if(o&&o.length)for(let n of o)n.z=void 0}q().warnOnce(`The remote Network Analysis service is powered by a network dataset which is not Z-aware.
Z-coordinates of the input geometry are ignored.`)}function $t(e,r){for(let i=0;i<r.length;i++){let o=e[r[i]];if(o&&o.length){for(let n of o)if(n!=null&&n.hasZ)return!0}}return!1}function Ct(e,r,i){return w(this,null,function*(){if(!e)throw new N("network-service:missing-url","Url to Network service is missing");let o=g({f:"json",token:r},i),{data:n}=yield c(e,o),v=n.currentVersion>=10.4?H(e,r,i):B(e,i),{defaultTravelMode:y,supportedTravelModes:T}=yield v;return n.defaultTravelMode=y,n.supportedTravelModes=T,$.fromJSON(n)})}function B(e,r){return w(this,null,function*(){let i=g({f:"json"},r),{data:o}=yield c(e.replace(/\/rest\/.*$/i,"/info"),i);if(!o?.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};let{owningSystemUrl:n}=o,v=M(n)+"/sharing/rest/portals/self",{data:y}=yield c(v,i),T=D("helperServices.routingUtilities.url",y);if(!T)return{supportedTravelModes:[],defaultTravelMode:null};let k=Z(n),C=/\/solve$/i.test(k.path)?"Route":/\/solveclosestfacility$/i.test(k.path)?"ClosestFacility":"ServiceAreas",z=g({f:"json",serviceName:C},r),E=M(T)+"/GetTravelModes/execute",U=yield c(E,z),J=[],V=null;if(U?.data?.results?.length){let F=U.data.results;for(let h of F)if(h.paramName==="supportedTravelModes"){if(h.value?.features){for(let{attributes:x}of h.value.features)if(x){let R=JSON.parse(x.TravelMode);J.push(R)}}}else h.paramName==="defaultTravelMode"&&(V=h.value)}return{supportedTravelModes:J,defaultTravelMode:V}})}function H(e,r,i){return w(this,null,function*(){try{let o=g({f:"json",token:r},i),n=M(e)+"/retrieveTravelModes",{data:{supportedTravelModes:v,defaultTravelMode:y}}=yield c(n,o);return{supportedTravelModes:v,defaultTravelMode:y}}catch(o){throw new N("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:o})}})}export{Pt as a,_t as b,$t as c,Ct as d};
