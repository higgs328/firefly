import{a as vt}from"./chunk-LTID3B74.js";import{a as Et}from"./chunk-XUGA7LRM.js";import{a as V,f as L,h as z,m as rt}from"./chunk-FKASYKK7.js";import"./chunk-LAAJ7BOG.js";import{D as et,F as Tt,N as st,b as _t,j as ft,k as gt,n as yt,o as dt,p as xt,v as tt,x as At}from"./chunk-A2QQP5DF.js";import{a as Q,c as M}from"./chunk-LTHAIW3V.js";import{a as j}from"./chunk-RRQS6PLL.js";import{N as ct,ea as pt}from"./chunk-WFHQTMIY.js";import{a as P}from"./chunk-XAZOVQGA.js";import{F as O,G as Z,Ha as T,X as ht,a as C,o as mt,oa as Y,ub as q,za as $}from"./chunk-V3KEO7AJ.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-KVM6SHDX.js";import"./chunk-EQZWYK27.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import{L as J,ca as lt,ia as ut}from"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-G4DZJMGT.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as at}from"./chunk-VTHXE323.js";function St(l,t,e,s,r){return new D(r).findSlicesByArea(l,t,e,s)}function Nt(l,t,e,s,r){return new D(r).sliceIntoStrips(l,t,e,s)}function wt(l,t,e,s){return new D(s).recursiveSliceEqualArea(l,t,e)}function qt(l){this.currentX=this.calcX(l)}function Rt(l){if(this.curve===null){let t=(l-this.y0)/(this.y1-this.y0);return ht(this.x0,this.x1,t)}return this.curve.intersectionOfYMonotonicWithAxisX(l,this.x0)}function Ht(){return{x0:Number.NaN,y0:Number.NaN,x1:Number.NaN,y1:Number.NaN,currentX:Number.NaN,nextAET:null,prevAET:null,startNodeNext:null,nextInChain:null,curve:null,advance:qt,calcX:Rt}}function Ot(l,t){let e=Ht();return e.x0=l.getStartX(),e.y0=l.getStartY(),e.x1=l.getEndX(),e.y1=l.getEndY(),t&&(e.y0=Y(e.x0,e.x0=e.y0),e.y1=Y(e.x1,e.x1=e.y1)),e.y1<e.y0&&(e.y1=Y(e.y0,e.y0=e.y1),e.x1=Y(e.x0,e.x0=e.x1)),e.currentX=Number.NaN,e.nextAET=null,e.prevAET=null,e.startNodeNext=null,e.nextInChain=null,e.curve=null,e}function Bt(l){let t=Ht();return t.x0=l.getStartX(),t.y0=l.getStartY(),t.x1=l.getEndX(),t.y1=l.getEndY(),t.curve=l,t.y1<t.y0&&(t.y1=Y(t.y0,t.y0=t.y1),t.x1=Y(t.x0,t.x0=t.x1)),t.currentX=Number.NaN,t.nextAET=null,t.prevAET=null,t.startNodeNext=null,t.nextInChain=null,t}function Dt(l){if(this.x===l.x&&this.y===l.y){let t=this.endEdge!==null,e=l.startEdge!==null;return t&&e?-1:1}return this.y!==l.y?this.y-l.y:this.x-l.x}function Ct(){return{x:Number.NaN,y:Number.NaN,startEdge:null,endEdge:null,compare:Dt}}function Xt(l,t){return{y:l,startingEdges:t}}var G=class{constructor(t,e,s,r,o,a){this.m_parent=t,this.m_y0=e,this.m_y1=s,this.m_t0=r,this.m_area=a}getMaxDerivative(){return 1}getValue(t,e){return t===1?0:this.getArea(e)-this.m_area}getError(t){return C(0),0}getArea(t){let e=.5*(this.m_parent.m_sumBase-this.m_parent.m_sumA),s=this.m_y1-this.m_y0,r=(this.m_parent.m_sumBase-e*(t+this.m_t0))*s*(t-this.m_t0),o=!1;for(let a=this.m_parent.m_AETHead;a!==null;a=a.nextAET)if(o=!o,o&&(a.curve!==null||a.nextAET.curve!==null)){let i=this.m_y0+s*this.m_t0,n=this.m_y0+s*t;a.curve&&(r+=bt(a.curve,this.m_y0+s*this.m_t0,this.m_y0+s*t)),a.nextAET.curve&&(r-=bt(a.nextAET.curve,this.m_y0+s*this.m_t0,this.m_y0+s*t)),r+=(n-i)*(a.nextAET.calcX(i)-a.calcX(i)+(a.nextAET.calcX(n)-a.calcX(n)))*.5}return r}};function nt(l,t,e){return{polygon:l,from:t,to:e}}function bt(l,t,e){let s=[0,0],r=l.intersectionWithAxis2D(!0,t,null,s);C(r===1);let o=s[0],a=l.intersectionWithAxis2D(!0,e,null,s);C(a===1);let i=s[0],n=$(q,4);yt(l,n,!0);let u=n[3],h=n[2],m=n[1],p=l.getCoordX(o)-l.getStartX(),g=l.getCoordY(o)-l.getStartY(),A=c=>{let f=c*c;return f*c*(10*(h.x*m.y-h.y*m.x)-15*c*(u.y*m.x-u.x*m.y)+6*f*(h.y*u.x-u.y*h.x))/60},d=c=>(-c*(m.y+c*(h.y+u.y*c))*p+c*(m.x+c*(h.x+u.x*c))*g)/2;return A(i)-A(o)-(d(i)-d(o))}var U=class extends Q{constructor(t){super(),this.m_geoms=[],this.m_index=-1,this.m_id=-1,this.m_geoms=t}tock(){return!0}getRank(){return 1}next(){return this.m_index++,this.m_index>=this.m_geoms.length?null:(this.m_id=this.m_geoms[this.m_index].second,this.m_geoms[this.m_index].first)}getGeometryID(){return this.m_id}},D=class l{constructor(t){this.m_edges=[],this.m_curves=[],this.m_sortedNodes=[],this.m_sortHelper=[],this.m_cuts=[],this.m_cutAreas=[],this.m_totalAreaOfTraps=new O(0),this.m_areaTracking=0,this.m_splitArea=0,this.m_sumBase=0,this.m_sumA=0,this.m_numberOfCuts=0,this.m_currentScan=0,this.m_progressCounter=0,this.m_AETHead=null,this.m_bHorizontalSweep=!1,this.m_bPolygonHasCurves=!1,this.m_progressTracker=t}findSlicesByArea(t,e,s,r){r<0&&mt("remainingArea");let o=t,a=null;o.hasNonLinearSegments()&&(this.m_bPolygonHasCurves=!0,a=At(t,1e-16,!0),Mt(a),o=a);let i=Math.abs(o.calculateArea2D());return i===0||s===0||r>=i||s===1&&r===0?[]:(this.m_splitArea=(i-r)/s,this.m_numberOfCuts=s-1,r>0&&this.m_numberOfCuts++,this.m_edges.length=0,this.m_sortedNodes.length=0,this.m_cuts.length=0,this.m_areaTracking=0,this.m_totalAreaOfTraps.reset(),this.m_curves.length=0,this.buildEdges(o),this.buildScanNodes(),this.trapezoidation(),this.m_cuts)}sliceIntoStrips(t,e,s,r){if(r===0)return new M([t]);let o=new P;t.queryLooseEnvelope(o);let a=o.width()+o.height();return new U(this.splitPolygon(t,e,o.xmin-a-1+1,o.xmax+a+1,s,r))}recursiveSliceEqualArea(t,e,s){if(s<=1||t.isEmpty())return new M([t]);{let r=[],o=[];o.push(T(t.clone(),s));let a=0,i=0;for(;o.length>0;){C(i++<2*s);let n=o.at(-1);if(o.pop(),n.second===1){r.push(T(n.first,a++));continue}let u=new P;n.first.queryEnvelope(u);let h=u.width()+u.height(),m=new j;m.setIdentity(),u.width()>u.height()&&(m.setRotateCcw90(),n.first.applyTransformation(m),m.transformEnvInPlace(u));let p=n.first.calculateArea2D(),g=p/n.second,A=p-Math.trunc(n.second/2)*g,d=new l(this.m_progressTracker).findSlicesByArea(n.first,e,1,A),c=new l(this.m_progressTracker).splitPolygon(n.first,e,u.xmin-h-1+1,u.xmax+h+1,d,1),f=c.length;if(C(f>0&&f<=2),!m.isIdentity()){let E=new j;E.setRotateCw90(),c[0].first.applyTransformation(E),f===2&&c[1].first.applyTransformation(E)}f===2?(o.push(T(c[1].first,n.second-Math.trunc(n.second/2))),o.push(T(c[0].first,Math.trunc(n.second/2)))):o.push(T(c[0].first,n.second))}return new U(r)}}recursiveSliceEqualAreaImpl(t,e,s,r){return C(0),{}}processTraps(t,e,s){s?this.processTrapsCurves(t,e):this.processTrapsLinear(t,e)}processTrapsLinear(t,e){let s=0,r=1,o=.5*(this.m_sumBase-this.m_sumA),a=e-t,i=(this.m_sumBase-o*(r+s))*a*(r-s);if(i+this.m_areaTracking<this.m_splitArea)return this.m_totalAreaOfTraps.pe(i),void(this.m_areaTracking+=i);let n=new O(i),u=new Z(0,1),h=!1;for(;s<1;){let m=this.m_splitArea-this.m_areaTracking,p=[Number.NaN,Number.NaN];if(!(gt(-o*a,this.m_sumBase*a,(o*s-this.m_sumBase)*a*s-m,u,!1,p)>0)){h?this.m_areaTracking=n.getResult():this.m_areaTracking+=i;break}{h=!0,r=p[0],this.m_areaTracking=0,s=r,n.me(m);let g=r*a+t;if(this.m_cuts.push(g),this.m_cutAreas.push(this.m_totalAreaOfTraps.getResult()+i-n.getResult()),this.m_cuts.length===this.m_numberOfCuts)return void this.m_totalAreaOfTraps.pe(i-n.getResult())}}this.m_totalAreaOfTraps.pe(i)}processTrapsCurves(t,e){let s=0,r=1,o=new G(this,t,e,0,1,0).getArea(1);if(o+this.m_areaTracking<this.m_splitArea)return this.m_totalAreaOfTraps.pe(o),void(this.m_areaTracking+=o);let a=e-t,i=new O(o),n=!1;for(;s<1;){let u=this.m_splitArea-this.m_areaTracking,h=new G(this,t,e,s,1,u),m=[0],p=new Z(s,1);if(!(ft(h,p,1,m)>0)){n?this.m_areaTracking=i.getResult():this.m_areaTracking+=o;break}{n=!0,r=m[0],this.m_areaTracking=0,s=r,i.me(u);let g=r*a+t;if(this.m_cuts.push(g),this.m_cutAreas.push(this.m_totalAreaOfTraps.getResult()+o-i.getResult()),this.m_cuts.length===this.m_numberOfCuts)return void this.m_totalAreaOfTraps.pe(o-i.getResult())}}this.m_totalAreaOfTraps.pe(o)}advanceAET(){let t=this.m_sortedNodes[this.m_currentScan-1].y,e=this.m_sortedNodes[this.m_currentScan],s=!1,r=!1,o=new O(0);for(let n=this.m_AETHead;n!==null;n=n.nextAET){let u=n.prevAET;s=!s,n.nextAET!==null&&s&&(this.m_bPolygonHasCurves&&(n.curve||n.nextAET.curve)||o.pe(n.nextAET.currentX-n.currentX)),n.advance(e.y),u!==null&&n.currentX<u.currentX&&(r=!0)}this.m_sumBase=o.getResult(),r&&this.sortAET();let a=new O(0);s=!1;let i=!1;for(let n=this.m_AETHead;n!==null;n=n.nextAET)i=i||n.curve!==null,s=!s,n.prevAET!==null&&(s||this.m_bPolygonHasCurves&&(n.curve||n.prevAET.curve)||a.pe(n.currentX-n.prevAET.currentX));this.m_sumA=a.getResult(),this.processTraps(t,e.y,i);for(let n=this.m_AETHead;n!=null;){let u=n.prevAET,h=n.nextAET;if(e.y===n.y1)if(n.prevAET=null,n.nextAET=null,n.nextInChain!==null){let m=n.currentX;n=n.nextInChain,n.currentX=m,n.prevAET=u,u?u.nextAET=n:this.m_AETHead=n,n.nextAET=h,h&&(h.prevAET=n)}else u?u.nextAET=h:this.m_AETHead=h,h&&(h.prevAET=u);n=h}}mergeNewEdgesToAET(){for(let r=this.m_sortedNodes[this.m_currentScan].startingEdges;r!==null;r=r.startNodeNext)Number.isNaN(r.currentX)&&(this.m_sortHelper.push(r),r.currentX=r.x0);if(!this.m_sortHelper.length)return;this.sortHelper();let t=this.m_AETHead,e=0,s=t;for(;t!==null&&e<this.m_sortHelper.length;)t.currentX>this.m_sortHelper[e].currentX?(this.m_sortHelper[e].prevAET=t.prevAET,t.prevAET?t.prevAET.nextAET=this.m_sortHelper[e]:this.m_AETHead=this.m_sortHelper[e],this.m_sortHelper[e].nextAET=t,t.prevAET=this.m_sortHelper[e],e++):(s=t,t=t.nextAET);for(;e<this.m_sortHelper.length;)this.m_sortHelper[e].prevAET=s,s!==null?s.nextAET=this.m_sortHelper[e]:this.m_AETHead=this.m_sortHelper[e],this.m_sortHelper[e].nextAET=null,s=this.m_sortHelper[e],e++;this.m_sortHelper.length=0}sortAET(){for(let e=this.m_AETHead;e!==null;e=e.nextAET)this.m_sortHelper.push(e);this.sortHelper(),this.m_AETHead=null;let t=null;for(let e of this.m_sortHelper)e.prevAET=t,t?t.nextAET=e:this.m_AETHead=e,e.nextAET=null,t=e;this.m_sortHelper.length=0}sortHelper(){this.m_sortHelper.sort((t,e)=>t.currentX-e.currentX)}trapezoidation(){for(this.m_currentScan=0,this.mergeNewEdgesToAET(),this.m_currentScan++;this.m_currentScan<this.m_sortedNodes.length&&(this.progress(),this.advanceAET(),this.m_cuts.length!==this.m_numberOfCuts);)this.mergeNewEdgesToAET(),this.m_currentScan++}buildEdges(t){let e=t.querySegmentIterator();for(e.stripAttributes();e.nextPath();)for(;e.hasNextSegment();){let s=e.nextSegment();if(s.isCurve()){let r=s;if(dt(r),this.m_bHorizontalSweep){let i=$(q,4);r.queryControlPoints(i);for(let n of i)n.y=Y(n.x,n.x=n.y);r.constructPoints(i)}let o=r.getStartY(),a=r.getEndY();if(a===o)continue;a<o&&r.reverse(),this.m_curves.push(r.clone()),this.m_edges.push(Bt(this.m_curves.at(-1)))}else{let r=this.m_bHorizontalSweep?s.getStartX():s.getStartY();if((this.m_bHorizontalSweep?s.getEndX():s.getEndY())===r)continue;this.m_edges.push(Ot(s,this.m_bHorizontalSweep))}}this.m_edges.sort((s,r)=>s.y0===r.y0?s.x0-r.x0:s.y0-r.y0)}buildScanNodes(){let t=[];for(let o of this.m_edges){let a=Ct();a.x=o.x0,a.y=o.y0,a.startEdge=o,a.endEdge=null,t.push(a);let i=Ct();i.x=o.x1,i.y=o.y1,i.startEdge=null,i.endEdge=o,t.push(i)}t.sort((o,a)=>o.compare(a));let e=0,s=t[e].y;this.m_sortedNodes.push(Xt(s,t[e].startEdge));let r=e;for(e++;e!==t.length;++e){t[e].y!==s&&(this.m_sortedNodes.push(Xt(t[e].y,null)),s=t[e].y);let o=t[e].startEdge;if(o){let a=this.m_sortedNodes.at(-1);o.startNodeNext=a.startingEdges,a.startingEdges=o}if(t[r].x!==t[e].x||t[r].y!==t[e].y){if(e-r==2){let a=r;a++,t[r].endEdge!==null&&t[a].startEdge!==null&&(t[r].endEdge.nextInChain=t[a].startEdge)}r=e}}}progress(){}splitPolygonLinear(t,e,s,r,o,a){let i=[];i.push([t,0,a]);let n=[],u=new xt;for(u.startPathCoords(s,0),u.lineToCoords(r,0);i.length>0;){let h=i.at(-1);i.pop();let m=h[0],p=h[1],g=h[2],A=new vt().executeMany(new M([m]),e,this.m_progressTracker);for(let d=A.next();d!==null;d=A.next()){let c=d,f=new P;c.queryLooseEnvelope(f);let E=p,v=g;for(let _=p,w=g-1;_<g;++_,--w)f.ymin>=o[_]&&(E=_+1),f.ymax<=o[w]&&(v=w);if(E!==g)if(v!==p)if(E!==v)if(this.isYMonotone(c))this.splitYMonotone(n,c,e,o,E,v);else{let _=Math.trunc((E+v)/2);u.setXYCoords(0,s,o[_]),u.setXYCoords(1,r,o[_]);let w=new Et().execute(!1,c,u,null,this.m_progressTracker),y=w.next(),k=w.next(),X=w.next();if(y!==null){if(y.isEmpty()||(_===v-1?(n.push(T(y,_)),C(it(n.at(-1).first,e,t,n.at(-1).second,o,a))):i.push([y,_+1,v])),k.isEmpty()||(_===E?(n.push(T(k,_-1)),C(it(n.at(-1).first,e,t,n.at(-1).second,o,a))):i.push([k,E,_])),X!==null&&!X.isEmpty()){let R=new P;X.queryLooseEnvelope(R),R.ymin>=o[_]?i.push([X,_+1,v]):R.ymax<=o[_]?i.push([X,E,_]):i.push([X,E,v])}}else _+1===v?(o[_]-f.ymin<f.ymax-o[_]?n.push(T(c,_)):n.push(T(c,_+1)),C(it(n.at(-1).first,e,t,n.at(-1).second,o,a))):i.push([c,_+1,v])}else n.push(T(d,E-1));else n.push(T(d,p-1));else n.push(T(d,g-1))}}return n}splitPolygon(t,e,s,r,o,a){let i=new P;t.queryLooseEnvelope(i),i.inflateCoords(0,Math.max(i.width(),i.height()));let n=[],u=[];for(u.push(nt(t,0,a));u.length;){let m=at({},u.at(-1));if(u.pop(),m.polygon.hasNonLinearSegments()){let p=Math.trunc((m.to+m.from)/2),g=o[p],A=new P(s,i.ymin,r,g),d=new st().execute(m.polygon,A,e,this.m_progressTracker);d.isEmpty()||(p-m.from==0?n.push(T(d,p-1)):u.push(nt(d,m.from,p)));let c=new P(s,g,r,i.ymax),f=new st().execute(m.polygon,c,e,this.m_progressTracker);f.isEmpty()||(m.to-p==1?n.push(T(f,p)):u.push(nt(f,p+1,m.to)))}else{let p=this.splitPolygonLinear(t,e,s,r,o.slice(m.from),m.to-m.from);n.push(...p)}}n.sort((m,p)=>m.second-p.second);let h=[];return _t(n,(m,p)=>m.second===p.second,(m,p)=>{let g=new tt;for(let A=m;A!==p;++A)g.add(n[A].first,!1);h.push(T(g,n[m].second))}),h}isYMonotone(t){if(t.getPathCount()!==1)return!1;let e=t.getXY(0),s=0,r=0,o=new q;for(let a=1,i=t.getPointCount();a<=i;a++){t.queryXY(a===i?0:a,o);let n=o.y>e.y?1:o.y<e.y?-1:0;if(e.setCoordsPoint2D(o),s!==n&&n!==0){if(s!==0&&(r++,r>2))return!1;s=n}}return!0}splitYMonotone(t,e,s,r,o,a){let i=new Tt;i.addGeometry(e);let n=i.getFirstPath(i.getFirstGeometry()),u=i.getFirstVertex(n),h=new q,m=new q,p=u,g=u;{let x=i.getXY(u);h.setCoordsPoint2D(x),m.setCoordsPoint2D(x)}let A=i.getNextVertex(u),d=new q;for(let x=0,S=i.getPathSize(n);x<S;x++,A=i.getNextVertex(A))i.queryXY(A,d),d.compare(h)<0?(p=A,h.setCoordsPoint2D(d)):d.compare(m)>0&&(g=A,m.setCoordsPoint2D(d));let c=p,f=p,E=c,v=f,_=!1,w=!1,y=o,k=h.y,X=h.y,R=!1;for(;y<a;)if(r[y]<=h.y)y++;else{if(r[y]>=m.y)break;if(!_){let x=i.getNextVertex(c),S=i.getY(x);if(S<k)break;let N=r[y];k<=N&&S>=N?_=!0:(k=S,c=x)}if(!w){let x=i.getPrevVertex(f),S=i.getY(x);if(S<X)break;let N=r[y];X<=N&&S>=N?w=!0:(X=S,f=x)}if(_&&w){R=!0;let x=i.getXY(c),S=i.getNextVertex(c),N=i.getXY(S),b=et;if(N.y===x.y)b=N.x<x.x?c:S;else{let I=(r[y]-x.y)/(N.y-x.y);if(I===0)b=c;else if(I===1)b=S;else{let W=i.splitSegmentAxisAware(c,[I],1,null,-1);C(W===1),b=i.getNextVertex(c),i.getY(b)!==r[y]&&i.setXYCoords(b,i.getX(b),r[y])}}let B=i.getPrevVertex(f);x=i.getXY(B),N=i.getXY(f);let H=et;if(N.y===x.y)H=N.x<x.x?f:B;else{let I=(r[y]-x.y)/(N.y-x.y);if(I===0)H=B;else if(I===1)H=f;else{let W=i.splitSegmentAxisAware(B,[I],1,null,-1);C(W===1),H=i.getNextVertex(B),i.getY(H)!==r[y]&&i.setXYCoords(H,i.getX(H),r[y])}}t.push(T(this.extractTrapezoid(i,E,b,v,H),y-1)),E=b,v=H,c=b,f=H,k=X=r[y],_=!1,w=!1,y++}}R?t.push(T(this.extractTrapezoid(i,E,g,v,g),y-1)):t.push(T(e,y))}extractTrapezoid(t,e,s,r,o){let a=new tt({vd:t.getVertexDescription()}),i=new pt,n=!0;for(let u=e;;u=t.getNextVertex(u)){let h=t.getSegment(u);if(h?a.addSegment(h,n):(t.queryPoint(u,i),n?a.startPathPoint(i):a.lineToPoint(i)),n=!1,u===s)break}s!==o&&(t.queryPoint(o,i),a.lineToPoint(i)),n=!0;for(let u=o;;u=t.getNextVertex(u)){let h=t.getSegment(u);if(h?a.addSegment(h,n):n||u===e||(t.queryPoint(u,i),a.lineToPoint(i)),n=!1,u===r)break}return a}};function Mt(l){return l.getImpl().ensureXYMonotoneSegments()}function it(l,t,e,s,r,o){let a=new P;l.queryEnvelope(a);let i=4*ct(t,e,!0).total();return(!(s>=0)||a.ymin+i>=r[s])&&!(s+1<o&&a.ymax>r[s+1]+i)}var ot=class{getOperatorType(){return 10011}accelerateGeometry(t,e,s){return!1}canAccelerateGeometry(t){return!1}supportsCurves(){return!0}sliceIntoStrips(t,e,s,r,o,a){return new F(0,t,e,s,o,0,a)}findSlicesByArea(t,e,s,r,o,a){if(!o||o.isIdentity())return St(t,e,s,r,a);{let i=t.clone();return i.applyTransformation(o),St(i,e,s,r,a)}}recursiveSliceEqualArea(t,e,s,r,o){return new F(1,t,e,null,r,s,o)}},F=class extends Q{constructor(t,e,s,r,o,a,i){super(),this.m_resultCursor=null,this.m_method=t,this.m_polygon=e,this.m_sr=s,this.m_ySplits=r?.slice()??null,this.m_transform=o,this.m_bReversePaths=o?.isReflective()??!1,this.m_inverseTransform=o?o.clone().invertThis():null,this.m_partCount=a,this.m_tracker=i}tock(){return!0}getRank(){return 1}next(){this.m_resultCursor||(this.m_method?this.recursiveSliceEqualArea():this.sliceIntoStrips());let t=this.m_resultCursor.next();return t&&(this.m_inverseTransform&&!this.m_inverseTransform.isIdentity()&&(t.applyTransformation(this.m_inverseTransform),this.m_bReversePaths&&t.reverseAllPaths()),t)}getGeometryID(){return this.m_resultCursor?this.m_resultCursor.getGeometryID():-1}sliceIntoStrips(){if(!this.m_transform||this.m_transform.isIdentity())this.m_resultCursor=Nt(this.m_polygon,this.m_sr,this.m_ySplits,this.m_ySplits.length,this.m_tracker);else{let t=this.m_polygon.clone();t.applyTransformation(this.m_transform),this.m_bReversePaths&&t.reverseAllPaths(),this.m_resultCursor=Nt(t,this.m_sr,this.m_ySplits,this.m_ySplits.length,this.m_tracker)}}recursiveSliceEqualArea(){if(!this.m_transform||this.m_transform.isIdentity())this.m_resultCursor=wt(this.m_polygon,this.m_sr,this.m_partCount,this.m_tracker);else{let t=this.m_polygon.clone();t.applyTransformation(this.m_transform),this.m_bReversePaths&&t.reverseAllPaths(),this.m_resultCursor=wt(t,this.m_sr,this.m_partCount,this.m_tracker)}}},K=new ot;function Pt(l,t,e,s,r){return K.findSlicesByArea(l,t,e,s,r,null)}function kt(l,t,e,s){let r=K.recursiveSliceEqualArea(l,t,e,s,null);return Array.from(r)}function Yt(l,t,e,s){let r=K.sliceIntoStrips(l,t,e,0,s,null);return Array.from(r)}function It(){return K.supportsCurves()}function se(l,t,e,s={}){let{transform:r,unit:o}=s,a=V(l);if(e&&o){if(a.isGeographic)throw new Error("Unable to convert from an angular area unit to a linear area unit.");let i=ut(a);i!==o&&(i?e=J(e,o,i):(e=J(e,o,"square-meters"),e=Math.sqrt(e),e/=lt(a),e**=2))}return Pt(L(l),z(a),t,e,r?.transform??null)}function re(l,t,e={}){let{transform:s}=e,r=V(l);return kt(L(l),z(r),t,s?.transform??null).map(o=>rt(o,r))}function ne(l,t,e={}){let{transform:s}=e,r=V(l);return Yt(L(l),z(r),t,s?.transform??null).map(o=>rt(o,r))}var ie=It();export{se as findSlicesByArea,re as recursiveSliceEqualArea,ne as sliceIntoStrips,ie as supportsCurves};
