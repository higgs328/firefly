import{a as n}from"./chunk-N57WQHAD.js";import"./chunk-2ARQOMI2.js";import{a as T}from"./chunk-4NWJLPNX.js";import{a as R}from"./chunk-RGY7NTLL.js";import{a as M}from"./chunk-GY62SD4Z.js";import{d}from"./chunk-IAG3AFVL.js";import"./chunk-H5YAFDFO.js";import{a as I}from"./chunk-JYGVIFB2.js";import"./chunk-EMABSAM2.js";import"./chunk-5BRKCXYS.js";import"./chunk-LQEFWCY6.js";import"./chunk-5REY7VVO.js";import"./chunk-4JEZ6E3P.js";import{a as p}from"./chunk-WDTJILD4.js";import{a as A}from"./chunk-GGYZRKBV.js";import{a as L}from"./chunk-37PSR6DC.js";import"./chunk-7VCEHOOE.js";import{a as b}from"./chunk-H25DKJGS.js";import"./chunk-6DALCDDU.js";import"./chunk-PBAMEKFE.js";import"./chunk-XIZ7IH6M.js";import"./chunk-JD66UCS7.js";import"./chunk-FU7RO3AR.js";import"./chunk-4YRY3D3A.js";import"./chunk-ZZ5UYT7M.js";import"./chunk-U4XVPHQU.js";import"./chunk-XR5FT7TQ.js";import"./chunk-LORHDXEB.js";import"./chunk-5BPM64SU.js";import"./chunk-TC77DYTW.js";import"./chunk-F2BQ2GD6.js";import"./chunk-R3XLNYYB.js";import"./chunk-4BZWOF3V.js";import"./chunk-EM35R6FY.js";import"./chunk-DJW5LMRG.js";import"./chunk-DEH76MSI.js";import"./chunk-CKJDDSAD.js";import"./chunk-DQOFEB5P.js";import"./chunk-QXXXCEV5.js";import"./chunk-6B5XFA6F.js";import"./chunk-MPRKSQLC.js";import"./chunk-3JGYBNJA.js";import"./chunk-DA3SDKGO.js";import"./chunk-ZOEPYNM4.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-BJH4F4SM.js";import"./chunk-Z3RBZHAK.js";import"./chunk-ZC6EBRE4.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import{c as _}from"./chunk-7QNKS2X6.js";import{a as E}from"./chunk-VCCMJ6BV.js";import{a as P}from"./chunk-QK56OQGR.js";import"./chunk-FXCL7YYQ.js";import"./chunk-QKO56XO6.js";import"./chunk-JRGT3GTH.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-VV5G7VY5.js";import"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-2GJBUR2F.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import"./chunk-YPMM52MU.js";import"./chunk-BBR7CJCO.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import{a as y}from"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import{a as O}from"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-SLAWDKDA.js";import"./chunk-4N4D2YQX.js";import{a as v}from"./chunk-G4DZJMGT.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import{b as f}from"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as s}from"./chunk-QGVBCWUY.js";import{h as u}from"./chunk-MYO4NP2N.js";import{e as a}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as w}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import{K as S}from"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import{b as l}from"./chunk-YOFFGXOB.js";import{g}from"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as h,f as c}from"./chunk-VTHXE323.js";var o=class extends _(E(A(L(b(P))))){constructor(e){super(e),this.effectiveSource=null,this.georeference=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this._debouncedSaveOperations=S((r,i,t)=>c(this,null,function*(){let{save:m,saveAs:x}=yield import("./chunk-QQ2NFY2Y.js");switch(r){case p.SAVE:return m(this,i);case p.SAVE_AS:return x(this,t,i)}})),this.source=new n}load(e){return this.addResolvingPromise(this._doLoad(e)),Promise.resolve(this)}_doLoad(e){return c(this,null,function*(){yield this.loadFromPortal({supportedTypes:["Media Layer"]},e);let r=this.source;if(!r)throw new l("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer.");let i=this._getSourceOverride(r,this.georeference);i&&(this.setAtOrigin("source",i,"web-map"),this.setAtOrigin("source",i,"web-scene"),r=i);let t=d(r)?new n({elements:new f([r])}):r;this._set("effectiveSource",t),this.spatialReference&&(t.spatialReference=this.spatialReference),yield t.load(e),this.spatialReference=t.spatialReference})}destroy(){this.effectiveSource?.destroy(),this.effectiveSource!==this.source&&this.source?.destroy()}readGeoreference(e,r){return e&&"itemId"in r&&r.itemId?e:void 0}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}get source(){return this._get("source")}set source(e){this.loadStatus!=="loaded"&&this.loadStatus!=="failed"?this._set("source",e):g.getLogger(this).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)?new n({elements:new f(e)}):e instanceof f?new n({elements:e}):e:null}readSource(e,r,i){if("itemId"in r&&r.itemId)return;let t=this._createSource(r);return t?.read(r,i),t}writeSource(e,r,i,t){if(e&&e instanceof n){let m=e.elements.length;if(m!==1)return void(t?.messages&&t.messages.push(new l("media-layer:unsupported-source",`local media element source can only be persisted if it contains exactly one ImageElement, but it has ${m}.`)));e=e.elements.at(0)}d(e)?e.write(r,t):t?.messages&&(e?t.messages.push(new l("media-layer:unsupported-source","only media elements of type 'ImageElement' or 'VideoElement' can be persisted")):t.messages.push(new l("media-layer:unsupported-source","the media layer is missing a source")))}save(e){return c(this,null,function*(){return this._debouncedSaveOperations(p.SAVE,e)})}saveAs(e,r){return c(this,null,function*(){return this._debouncedSaveOperations(p.SAVE_AS,r,e)})}_createSource(e){if("mediaType"in e)switch(e.mediaType){case"image":return new T;case"video":return new R}return null}_getSourceOverride(e,r){if(d(e)&&this.originIdOf("source")===u.PORTAL_ITEM&&r&&(this.originIdOf("georeference")===u.WEB_MAP||this.originIdOf("georeference")===u.WEB_SCENE)){let i=e.toJSON(),t=this._createSource(i);return t.read(h({},i),{origin:"portal-item"}),t.read({georeference:r},{origin:"web-map"}),t.read({georeference:r},{origin:"web-scene"}),t}return null}};s([a({readOnly:!0})],o.prototype,"effectiveSource",void 0),s([a({readOnly:!0,json:{read:!1,write:!1,origins:{"web-document":{read:!0}}}})],o.prototype,"georeference",void 0),s([y("web-document","georeference")],o.prototype,"readGeoreference",null),s([a({type:String})],o.prototype,"copyright",void 0),s([a({readOnly:!0})],o.prototype,"fullExtent",null),s([a({type:["MediaLayer"]})],o.prototype,"operationalLayerType",void 0),s([a({type:["show","hide"]})],o.prototype,"listMode",void 0),s([a({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1,target:{url:{type:String},mediaType:{type:["image","video"]},georeference:{type:I}},overridePolicy(e,r,i){return{enabled:!0,allowNull:!1,ignoreOrigin:M(this,i?.origin)&&d(e)&&!!e.georeference&&e.originIdOf("georeference")>u.PORTAL_ITEM}}}}})],o.prototype,"source",null),s([v("source")],o.prototype,"castSource",null),s([y("source",["url"])],o.prototype,"readSource",null),s([O("source")],o.prototype,"writeSource",null),s([a()],o.prototype,"spatialReference",void 0),s([a({readOnly:!0})],o.prototype,"type",void 0),o=s([w("esri.layers.MediaLayer")],o);var se=o;export{se as default};
