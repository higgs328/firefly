import{b as Z,e as _,f as ee,g as ae}from"./chunk-5HU3NRAY.js";import{a as Y}from"./chunk-ABYD5IZU.js";import"./chunk-HRDVAO34.js";import{a as U,b as j,d as G,e as K,f as Q,g as W,k as X,n as B}from"./chunk-MOUPZWB7.js";import{a as D,l as A,m as L,s as J,t as k}from"./chunk-TVZYM2NN.js";import"./chunk-TI4UXDNK.js";import"./chunk-YYU4WDV7.js";import"./chunk-U445SEXM.js";import"./chunk-TSQO2JBH.js";import"./chunk-U7H5KNVZ.js";import"./chunk-6ZSOJV5L.js";import"./chunk-D7UZS622.js";import{a as P}from"./chunk-47NA5MWW.js";import"./chunk-IXHKDLZL.js";import"./chunk-PWCKLYPC.js";import"./chunk-BN2AMH77.js";import{c as $,d as q,e as N,g as R}from"./chunk-GYQWYHEG.js";import{b as O}from"./chunk-JC4DQSN3.js";import"./chunk-D43YNUSN.js";import"./chunk-QZ7GU4N4.js";import"./chunk-XBSD6EUF.js";import"./chunk-B3VPRADQ.js";import"./chunk-HJQNAAJT.js";import"./chunk-KP75LCOH.js";import"./chunk-ES4WUTEM.js";import"./chunk-BC7GBJHB.js";import"./chunk-WBPLJNRU.js";import"./chunk-EBLTZITF.js";import"./chunk-GUIIGAD3.js";import"./chunk-SFSN6ZUK.js";import{f as E}from"./chunk-5AFOYCWC.js";import"./chunk-Z3MWEX65.js";import"./chunk-YB6RTOHR.js";import"./chunk-H2NTHPNN.js";import"./chunk-E2J2V7JN.js";import"./chunk-GHDQGSQR.js";import"./chunk-A4UG5DHM.js";import"./chunk-XOMCYIPA.js";import"./chunk-N2JUYKXN.js";import"./chunk-7U52UAO2.js";import"./chunk-NIRJWS2D.js";import"./chunk-H3ZWZZ2B.js";import"./chunk-M3TNQKVJ.js";import"./chunk-KLZGQ7M6.js";import"./chunk-N36GL6VL.js";import"./chunk-UX3QUEDM.js";import"./chunk-YZJDOXQC.js";import"./chunk-6ZY36ZHO.js";import"./chunk-6RHGQ4Z5.js";import"./chunk-G23ELQMS.js";import"./chunk-PZOK2JKH.js";import"./chunk-FJUYECJ6.js";import"./chunk-GAVFKWSK.js";import"./chunk-DK4DGLAO.js";import{t as x}from"./chunk-ZM24RY22.js";import"./chunk-7Y6S2GNA.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-PE276TWH.js";import"./chunk-BMZ3PE5Y.js";import"./chunk-EHG7JRYJ.js";import"./chunk-FNY6LFKI.js";import"./chunk-BBB7KLHV.js";import"./chunk-J2AEVBSH.js";import"./chunk-5ODXFRPI.js";import"./chunk-E5QCV5LT.js";import"./chunk-QS3EYJPF.js";import"./chunk-HJJZ2AXH.js";import"./chunk-TPNSUEHH.js";import"./chunk-SMVNQSZ4.js";import"./chunk-Z2QGLRDB.js";import"./chunk-7IDFDPA3.js";import"./chunk-VL2YL74P.js";import"./chunk-P2AJD2R2.js";import{a as M,b as F,c as C}from"./chunk-UMJIJLDA.js";import"./chunk-E5NFS3KN.js";import"./chunk-HQHD6BMN.js";import"./chunk-AIKKGGPG.js";import"./chunk-RDGG4TVD.js";import"./chunk-3IQFPOUU.js";import"./chunk-I4CY6X6S.js";import"./chunk-VQ4QGNRX.js";import"./chunk-GNEAU6X4.js";import"./chunk-4KXJ537H.js";import"./chunk-JIRULGDT.js";import"./chunk-QJGOWIJD.js";import"./chunk-QML26MQC.js";import"./chunk-RNZY2XUD.js";import"./chunk-JXPUHKCT.js";import"./chunk-XR5FT7TQ.js";import"./chunk-4YTM754S.js";import"./chunk-LAX5536Z.js";import"./chunk-N3HRYLNW.js";import"./chunk-4DBMALZW.js";import"./chunk-CVWWHM2V.js";import"./chunk-6OQYVEQJ.js";import"./chunk-YOXOWGT6.js";import"./chunk-EFZOSMYP.js";import"./chunk-WI7F4ZKJ.js";import"./chunk-MJ7M24NH.js";import"./chunk-GJH4QFRX.js";import"./chunk-T63F7663.js";import"./chunk-O4V2VBSK.js";import"./chunk-5TKRKB5E.js";import"./chunk-XAGMDNNR.js";import"./chunk-OP2TLIUN.js";import"./chunk-T2THIR6K.js";import"./chunk-LORHDXEB.js";import"./chunk-BBBPJI4H.js";import"./chunk-45BTW5EG.js";import"./chunk-TPFBHGDM.js";import"./chunk-73NLRHJD.js";import"./chunk-PNFEUBDF.js";import"./chunk-6RCCEJDL.js";import"./chunk-PQ2TNDUX.js";import"./chunk-6X6MKRQ3.js";import"./chunk-FQFHMHYU.js";import"./chunk-SZMEI3WL.js";import"./chunk-KKVGD67U.js";import"./chunk-MYOJWRDU.js";import"./chunk-L7UKJKHG.js";import"./chunk-V2IENAEU.js";import"./chunk-QAGQFNF2.js";import"./chunk-SY7JS2VW.js";import"./chunk-WK57SDN6.js";import"./chunk-AG4V3ZUO.js";import"./chunk-YWLMJ26A.js";import"./chunk-QAWNU3UJ.js";import"./chunk-HRQT4R6X.js";import"./chunk-44BHLWQ4.js";import"./chunk-5BPM64SU.js";import"./chunk-PMVHHMQJ.js";import"./chunk-NAFOM5UA.js";import"./chunk-DO7UF2F2.js";import"./chunk-ZTR6OS44.js";import"./chunk-VRTKAD2J.js";import"./chunk-DBLKLHK2.js";import"./chunk-UTE3ASAZ.js";import"./chunk-2AFEAPEX.js";import"./chunk-GNGXUEWV.js";import"./chunk-QBI5NDCA.js";import"./chunk-NOHW2DKR.js";import"./chunk-HVJAAM3A.js";import"./chunk-ACPEJEHK.js";import"./chunk-I7B3LWNP.js";import"./chunk-YP2E5N4E.js";import"./chunk-QLMNLSCT.js";import"./chunk-P55G5ATK.js";import"./chunk-JT3K52KQ.js";import"./chunk-SPLEGG4R.js";import"./chunk-Y4TJDUGP.js";import"./chunk-6PAFOJ4W.js";import"./chunk-74SDGE57.js";import"./chunk-FRXWHX3T.js";import"./chunk-DTDQ5X42.js";import"./chunk-RX2HFR4X.js";import"./chunk-AZW7YPTQ.js";import"./chunk-NJLJX4X6.js";import"./chunk-DZHFTD24.js";import"./chunk-K57Z4J34.js";import"./chunk-VWG3KVOU.js";import"./chunk-JOEUVLAN.js";import"./chunk-JZQDGIDQ.js";import"./chunk-CZ6CGC7I.js";import"./chunk-7B6U3N62.js";import"./chunk-46WDO5LS.js";import"./chunk-G5EYK5KM.js";import"./chunk-YJKJQU3F.js";import"./chunk-OK4K3OQT.js";import"./chunk-BPWNCOXC.js";import"./chunk-VNS4CQ27.js";import"./chunk-AVMO6LCR.js";import"./chunk-TEGPMVWT.js";import"./chunk-CLQRQC3Y.js";import"./chunk-KSNU73LO.js";import"./chunk-FACEVGRE.js";import"./chunk-5XTCPT52.js";import"./chunk-72MRWGPJ.js";import"./chunk-2GF6YDKP.js";import"./chunk-DDZ3KR2Q.js";import"./chunk-R3XLNYYB.js";import"./chunk-2HYVVLKS.js";import"./chunk-XRTA5GHC.js";import"./chunk-Y6XW36QP.js";import"./chunk-ZXKU6WBY.js";import"./chunk-RBVFFAW6.js";import"./chunk-XQOE7Z4Q.js";import"./chunk-BMYVPMAK.js";import"./chunk-6F25LG6O.js";import"./chunk-6KRFVLII.js";import"./chunk-EDZQZA57.js";import"./chunk-V6AA2XHK.js";import"./chunk-25WBXAEY.js";import"./chunk-7QY3BMVN.js";import"./chunk-Y7GY5YIF.js";import"./chunk-LMGYHZE3.js";import"./chunk-5LG2P6MT.js";import"./chunk-GJ2QRXGN.js";import"./chunk-EM35R6FY.js";import"./chunk-QXXXCEV5.js";import"./chunk-TJ6P6NLD.js";import"./chunk-NX5B6XBR.js";import"./chunk-2JABY6DU.js";import"./chunk-MPRKSQLC.js";import"./chunk-57TARQ4F.js";import"./chunk-6RBQSBA2.js";import"./chunk-Z42K5ECK.js";import"./chunk-NVTU6MJO.js";import"./chunk-56M6LBCJ.js";import"./chunk-HZK6UIET.js";import"./chunk-T2RV3ABV.js";import"./chunk-CSNRCIB5.js";import"./chunk-6FW4T2SJ.js";import"./chunk-4ZVBFHBA.js";import"./chunk-3JGYBNJA.js";import"./chunk-DA3SDKGO.js";import"./chunk-ZOEPYNM4.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-BJH4F4SM.js";import"./chunk-Z3RBZHAK.js";import"./chunk-F4XWARLZ.js";import"./chunk-IO35PPBL.js";import"./chunk-F5AJITOA.js";import"./chunk-IHATPE6U.js";import"./chunk-PU4AK46X.js";import"./chunk-3CLJ5OX5.js";import"./chunk-E6C7G5SC.js";import"./chunk-73K3NWCV.js";import"./chunk-SP2CO3KX.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-FYZRIMPP.js";import"./chunk-ZC6EBRE4.js";import"./chunk-ZAZJB7CV.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-QKO56XO6.js";import"./chunk-JRGT3GTH.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-VV5G7VY5.js";import"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-POX73EYJ.js";import"./chunk-NKUXRYJG.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-O3EGNJTY.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-WTB3O6DJ.js";import"./chunk-7P44K2YD.js";import"./chunk-32OAXCA4.js";import{b as S}from"./chunk-UST6HCE7.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import{b as f}from"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import{b as H}from"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as g,b as I,f as c}from"./chunk-VTHXE323.js";var me=new Set(["equal-interval","natural-breaks","quantile"]),fe=new Set(["HH","HL","LH","LL"]),ue={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]},pe={2:["L","H"],3:["L","M","H"],4:["L","M1","M2","H"]},ie=e=>({minValue:e.minValue,maxValue:e.maxValue});function ne(e){return c(this,null,function*(){if(!(e?.layer&&e.view&&e.field1&&e.field2))throw new f("relationship-renderer:missing-parameters","'layer', 'view', 'field1' and 'field2' parameters are required");e.forBinning&&O(e,"relationship-renderer");let a=I(g({},e),{layer:e.layer,field1:e.field1,field2:e.field2});if(a.symbolType??="2d",a.defaultSymbolEnabled??=!0,a.classificationMethod??="quantile",a.numClasses??=3,a.focus??=null,!me.has(a.classificationMethod))throw new f("relationship-renderer:invalid-parameters",`classification method ${a.classificationMethod} is not supported`);if(a.numClasses<2||a.numClasses>4)throw new f("relationship-renderer:invalid-parameters","'numClasses' must be 2, 3 or 4");if(e.focus&&!fe.has(e.focus))throw new f("relationship-renderer:invalid-parameters","'focus' must be 'HH', 'HL', 'LH', 'LL' or null");let i=e.forBinning?q:$,n=R(a.layer,i,e.forBinning);if(!n)throw new f("relationship-renderer:invalid-parameters","'layer' must be one of these types: "+N(i).join(", "));let l=a.signal!=null?{signal:a.signal}:null;yield n.load(l);let r=n.geometryType,o=a.symbolType.includes("3d");if(a.outlineOptimizationEnabled=r==="polygon"&&a.outlineOptimizationEnabled,a.sizeOptimizationEnabled=(r==="point"||r==="multipoint"||r==="polyline")&&a.sizeOptimizationEnabled,r==="mesh")a.symbolType="3d-volumetric",a.colorMixMode=a.colorMixMode||"replace",a.edgesType=a.edgesType||"none";else{if(a.symbolType==="3d-volumetric-uniform"&&r!=="point")throw new f("relationship-renderer:not-supported","3d-volumetric-uniform symbols are supported for point layers only");if(o&&r==="polygon")throw new f("relationship-renderer:not-supported","3d symbols are not supported for polygon layers");if(a.symbolType.includes("3d-volumetric")&&(!a.view||a.view.type!=="3d"))throw new f("relationship-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or '3d-volumetric-uniform'")}let{field1:t,field2:s}=a,m=[t.field,s.field];t.normalizationField&&m.push(t.normalizationField),s.normalizationField&&m.push(s.normalizationField);let p=A(n,m,"relationship-renderer:invalid-parameters");if(p)throw p;return I(g({},a),{layer:n})})}function ce(e){return c(this,null,function*(){let a="regenerate-relationship-renderer";yield U(e,a);let i=yield j(e),n=G(i);if(!n||!["relationship","relationship-size"].includes(n))throw new f(`${a}:invalid-parameters`,"Renderer is invalid");let{layer:l,forBinning:r,filter:o,view:t,signal:s}=e,m=K(i),p=Q(i),{field1:u,field2:d,classificationMethod:y,focus:z,numClasses:w}=i.authoringInfo,b={field:u.field,normalizationField:u.normalizationField,label:u.label},h={field:d.field,normalizationField:d.normalizationField,label:d.label},V=yield ne({layer:l,field1:b,field2:h,classificationMethod:y,numClasses:w,focus:z,outlineOptimizationEnabled:m,sizeOptimizationEnabled:p,forBinning:r,filter:o,view:t,signal:s});return I(g({},e),{creatorParameters:V,renderer:i})})}function he(e){return c(this,null,function*(){if(!e?.renderer||!e.numClasses)throw new f("update-relationship-renderer:missing-parameters","'renderer' and 'numClasses' parameters are required");let{field1:a,field2:i,renderer:n,numClasses:l,colors:r}=e,o=l**2;if((a||i)&&!(a&&i&&a.field&&i.field))throw new f("update-relationship-renderer:missing-parameters","'field1' and 'field2' parameters are required");if(a&&!a.classBreakInfos||i&&!i.classBreakInfos)throw new f("update-relationship-renderer:missing-parameters","'field1.classBreakInfos' and 'field2.classBreakInfos' are required");if(!n.authoringInfo)throw new f("update-relationship-renderer:missing-parameters","'renderer.authoringInfo' is required");if(n.uniqueValueInfos?.length!==o)throw new f("update-relationship-renderer:invalid-parameters",`Renderer must have ${o} unique value infos to support ${l} classes`);if(r&&r.length!==o)throw new f("update-relationship-renderer:invalid-parameters",`The scheme must have ${o} colors`);return e})}function ye(e){return c(this,null,function*(){let a=e.relationshipScheme,i=null,n=null,l=yield J(e.basemap,e.view);if(i=l.basemapId!=null?l.basemapId:null,n=l.basemapTheme!=null?l.basemapTheme:null,a)return{scheme:_(a),basemapId:i,basemapTheme:n};let r=Z({basemapTheme:n,geometryType:e.geometryType,theme:e.theme,worldScale:e.worldScale,view:e.view});return r&&(a=r.primaryScheme,i=r.basemapId,n=r.basemapTheme),{scheme:a,basemapId:i,basemapTheme:n}})}function le(e,a){let i=H(ue[e]);return ee(i,a)}function we(e,a){return le(e,a).map(i=>({value:i,count:0}))}function re(e,a,i,n){let{field:l,normalizationField:r}=e,{field:o,normalizationField:t}=a,s=i.map(d=>[d.minValue,d.maxValue]),m=n.map(d=>[d.minValue,d.maxValue]),p=s.length,u=pe[p];return`
  var field1 = $feature['${l}'];
  var field2 = $feature['${o}'];
  var hasNormField1 = ${r?"true":"false"};
  var hasNormField2 = ${t?"true":"false"};
  var normField1 = ${r?`$feature['${r}']`:"null"};
  var normField2 = ${t?`$feature['${t}']`:"null"};

  if (
    IsEmpty(field1) ||
    IsEmpty(field2) ||
    (hasNormField1 && (IsEmpty(normField1) || normField1 == 0)) ||
    (hasNormField2 && (IsEmpty(normField2) || normField2 == 0))
  ) {
    return null;
  }

  var value1 = IIf(hasNormField1, (field1 / normField1), field1);
  var value2 = IIf(hasNormField2, (field2 / normField2), field2);

  var breaks1 = ${JSON.stringify(s)};
  var breaks2 = ${JSON.stringify(m)};
  var classCodes = ${JSON.stringify(u)};

  function getClassCode(value, breaks) {
    var code = null;

    for (var i in breaks) {
      var info = breaks[i];
      if (value >= info[0] && value <= info[1]) {
        code = classCodes[i];
        break;
      }
    }

    return code;
  }

  var code1 = getClassCode(value1, breaks1);
  var code2 = getClassCode(value2, breaks2);

  var classValue = IIf(IsEmpty(code1) || IsEmpty(code2), null, code1 + code2);
  return classValue;
  `}function be(e,a,i){return c(this,null,function*(){let n=yield S("esri/smartMapping/t9n/smartMapping"),{basemap:l,classificationMethod:r,field1:o,field2:t,focus:s,numClasses:m,signal:p}=e,u=e.layer,d=a.classBreakInfos,y=i.classBreakInfos;if(m!==d.length||d.length!==y.length)throw new f("relationship-renderer:error","incompatible class breaks");let z=we(m,s),w=re(e.field1,e.field2,d,y),b=(yield ye({basemap:l,geometryType:u.geometryType,theme:"default",relationshipScheme:e.relationshipScheme,worldScale:!!e.symbolType?.includes("3d-volumetric"),view:e.view})).scheme,h=yield Y({layer:u,basemap:l,valueExpression:w,valueExpressionTitle:n.relationship.legendTitle,numTypes:-1,sortEnabled:!1,defaultSymbolEnabled:e.defaultSymbolEnabled,typeScheme:g({colors:ae(b,m,s)},b),statistics:{uniqueValueInfos:z},legendOptions:e.legendOptions,outlineOptimizationEnabled:e.outlineOptimizationEnabled,sizeOptimizationEnabled:e.sizeOptimizationEnabled,symbolType:e.symbolType,colorMixMode:e.colorMixMode,edgesType:e.edgesType,filter:e.filter,view:e.view,signal:p}),V=h.renderer,oe=V.uniqueValueInfos,te=n.relationship;for(let v of oe??[])v.label=te[v.value];let de=new C({type:"relationship",classificationMethod:r,numClasses:m,focus:s,field1:new F({field:o.field,normalizationField:o.normalizationField,label:o.label,classBreakInfos:d.map(({minValue:v,maxValue:T})=>new M({minValue:v,maxValue:T}))}),field2:new F({field:t.field,normalizationField:t.normalizationField,label:t.label,classBreakInfos:y.map(({minValue:v,maxValue:T})=>new M({minValue:v,maxValue:T}))})});return V.authoringInfo=de,{renderer:V,classBreaks:{field1:a,field2:i},uniqueValueInfos:h.uniqueValueInfos,relationshipScheme:b,basemapId:h.basemapId,basemapTheme:h.basemapTheme}})}function ge(e,a,i){let n=le(a,i);e.sort((l,r)=>{let o=n.indexOf(l.value),t=n.indexOf(r.value),s=0;return o<t?s=-1:o>t&&(s=1),s})}function ve(e,a){e.authoringInfo??=new C;let i=e.authoringInfo;i.numClasses=a.numClasses,i.focus=a.focus||null,i.focus||delete i.focus;let{field1:n,field2:l}=a;i.field1=new F({field:n.field,normalizationField:n.normalizationField,label:n.label,classBreakInfos:n.classBreakInfos.map(r=>new M(ie(r)))}),i.field2=new F({field:l.field,normalizationField:l.normalizationField,label:l.label,classBreakInfos:l.classBreakInfos.map(r=>new M(ie(r)))}),e.authoringInfo=i}function se(e){return c(this,null,function*(){let{layer:a,classificationMethod:i,field1:n,field2:l,numClasses:r,filter:o,view:t,signal:s}=e,m={layer:a,classificationMethod:i,field:n.field,normalizationField:n.normalizationField,normalizationType:n.normalizationField?"field":null,minValue:n.minValue,maxValue:n.maxValue,analyzeData:!(n.minValue!=null&&n.maxValue!=null),numClasses:r,filter:o,view:t,signal:s},p={layer:a,classificationMethod:i,field:l.field,normalizationField:l.normalizationField,normalizationType:l.normalizationField?"field":null,minValue:l.minValue,maxValue:l.maxValue,analyzeData:!(l.minValue!=null&&l.maxValue!=null),numClasses:r,filter:o,view:t,signal:s},[u,d]=yield Promise.all([L(m),L(p)]);if(!u||!d)throw new f("relationship-renderer:error","error when calculating class breaks");return{field1:u.result,field2:d.result}})}function Ie(e){return c(this,null,function*(){let a=yield he(e),{field1:i,field2:n,renderer:l,numClasses:r,focus:o,colors:t}=a,s=l.clone();s.valueExpression=re(i,n,i.classBreakInfos,n.classBreakInfos);let m=s.uniqueValueInfos??[];if(ge(m,r,o),t){let p=x(t,t.length);m.forEach((u,d)=>E(u.symbol,p[d]))}return ve(s,a),s})}function Ne(e){return c(this,null,function*(){let a=yield ne(e),{field1:i,field2:n}=yield se(a);return be(a,i,n)})}function Re(e){return c(this,null,function*(){let{creatorParameters:a,view:i,signal:n,filter:l,renderer:r}=yield ce(e),{layer:o,field1:t,field2:s,numClasses:m,focus:p,outlineOptimizationEnabled:u,sizeOptimizationEnabled:d}=a,{field1:y,field2:z}=yield se(a),[w,b,h]=yield Promise.all([Ie({field1:I(g({},t),{classBreakInfos:y.classBreakInfos}),field2:I(g({},s),{classBreakInfos:z.classBreakInfos}),renderer:r,numClasses:m,focus:p}),u?D({layer:o,view:i,signal:n,filter:l}).catch(k):null,d?P({layer:o,view:i,signal:n,filter:l}).catch(k):null]);return B(w,b?.visualVariables,W),B(w,h?.minSize,X),{renderer:w}})}export{Ne as createRenderer,Re as regenerateRenderer,Ie as updateRenderer};
