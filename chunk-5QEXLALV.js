import{o as $}from"./chunk-P6QFA5MM.js";import{c as z,h as k}from"./chunk-LI2SX4T6.js";import{a as D,b as E}from"./chunk-YOFFGXOB.js";import{g as y}from"./chunk-XRGPJ3QY.js";import{c as f}from"./chunk-6MRUJ2UW.js";import{b as M}from"./chunk-2LI2GKBQ.js";import{a as x}from"./chunk-VTHXE323.js";var L=Symbol("Accessor-beforeDestroy");var g;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED",e[e.DESTROYED=3]="DESTROYED"})(g||(g={}));function l(e){let t=e.constructor.__accessorMetadata__,r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){t=Object.create(t);for(let o in t)t[o]=M(t[o]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function Ae(e,t){let r=l(e),o=r[t];return o||(o=r[t]={}),o}function _e(e,t){return z(e,t,Q)}var H=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Q(e){return H.test(e)?"replace":"merge"}var d=class extends D{constructor(t,r,o){super(t,r,o)}};d.prototype.type="warning";function b(e){return!!e&&e.prototype?.declaredClass&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}var A=()=>y.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function _(e,t,r){e&&(!r&&!t.read||t.read?.reader||t.read?.enabled===!1||oe(e)&&f("read.reader",ee(e),t))}function ee(e){let t=e.ndimArray??0;if(t>1)return re(e);if(t===1)return R(e);if("type"in e&&J(e.type)){let r=e.type.prototype?.itemType?.Type,o=R(typeof r=="function"?{type:r}:{types:r});return(n,i,a)=>{let s=o(n,i,a);return s&&new e.type(s)}}return v(e)}function v(e){return"type"in e?te(e.type):ne(e.types)}function te(e){return e.prototype.read?(t,r,o)=>{if(t==null)return t;let n=typeof t;if(n!=="object")return void A().error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${n}'`);let i=new e;return i.read(t,o),i}:e.fromJSON}function U(e,t,r,o){return o!==0&&Array.isArray(t)?t.map(n=>U(e,n,r,o-1)):e(t,void 0,r)}function re(e){let t=v(e),r=U.bind(null,t),o=e.ndimArray??0;return(n,i,a)=>{if(n==null)return n;n=r(n,a,o);let s=o,c=n;for(;s>0&&Array.isArray(c);)s--,c=c[0];if(c!==void 0)for(let p=0;p<s;p++)n=[n];return n}}function R(e){let t=v(e);return(r,o,n)=>{if(r==null)return r;if(Array.isArray(r)){let a=[];for(let s of r){let c=t(s,void 0,n);c!==void 0&&a.push(c)}return a}let i=t(r,void 0,n);return i!==void 0?[i]:void 0}}function J(e){if(!b(e))return!1;let t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?O(t.Type):V(t.Type))}function oe(e){return"types"in e?V(e.types):O(e.type)}function O(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||J(e))}function V(e){for(let t in e.typeMap)if(!O(e.typeMap[t]))return!1;return!0}function ne(e){let t=null,r=e.errorContext??"type",o=e.validate;return(n,i,a)=>{if(n==null)return n;let s=typeof n;if(s!=="object")return void A().error(`Expected JSON value of type 'object' to deserialize, but got '${s}'`);t||(t=ie(e));let c=e.key;if(typeof c!="string")return;let p=n[c],u=p?t[p]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!u){let T=`Type '${p||"unknown"}' is not supported`;return a?.messages&&n&&a.messages.push(new d(`${r}:unsupported`,T,{definition:n,context:a})),void A().error(T)}let j=new u;return j.read(n,a),o?o(j):j}}function ie(e){let t={};for(let r in e.typeMap){let o=e.typeMap[r],n=l(o.prototype);if(typeof e.key=="function")continue;let i=n[e.key];if(!i)continue;if(i.json?.type&&Array.isArray(i.json.type)&&i.json.type.length===1&&typeof i.json.type[0]=="string"){t[i.json.type[0]]=o;continue}let a=i.json?.write;if(!a?.writer){t[r]=o;continue}let s=a.target,c=typeof s=="string"?s:e.key,p={};a.writer(r,p,c),p[c]&&(t[p[c]]=o)}return t}function I(e){if(e.json&&e.json.origins){let t=e.json.origins,r={"web-document":["web-scene","web-map"]};for(let o in r)if(t[o]){let n=t[o];r[o].forEach(i=>{t[i]=n}),delete t[o]}}}function X(e){if(e.json||(e.json={}),B(e.json),K(e.json),G(e.json),e.json.origins)for(let t in e.json.origins)B(e.json.origins[t]),K(e.json.origins[t]),G(e.json.origins[t]);return!0}function G(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function B(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function K(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function h(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;let r=e?.ndimArray??0;e&&(r===1||"type"in e&&b(e.type))?t.write.writer=pe:r>1?t.write.writer=ue(r):t.types?Array.isArray(t.types)?t.write.writer=ae(t.types[0]):t.write.writer=se(t.types):t.write.writer=m}function se(e){return(t,r,o,n)=>t?Y(t,e,n)?m(t,r,o,n):void 0:m(t,r,o,n)}function Y(e,t,r){for(let o in t.typeMap)if(e instanceof t.typeMap[o])return!0;if(r?.messages){let o=t.errorContext??"type",n=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&e&&r.messages.push(new E(`${o}:unsupported`,n,{definition:e,context:r})),y.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function ae(e){return(t,r,o,n)=>!t||!Array.isArray(t)?m(t,r,o,n):m(t.filter(i=>Y(i,e,n)),r,o,n)}function m(e,t,r,o){f(r,w(e,o),t)}function w(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?ce(e):e}function ce(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function pe(e,t,r,o){let n;e===null?n=null:e&&typeof e.map=="function"?(n=e.map(i=>w(i,o)),typeof n.toArray=="function"&&(n=n.toArray())):n=[w(e,o)],f(r,n,t)}function Z(e,t,r){return r!==0&&Array.isArray(e)?e.map(o=>Z(o,t,r-1)):w(e,t)}function ue(e){return(t,r,o,n)=>{let i;if(t===null)i=null;else{i=Z(t,n,e);let a=e,s=i;for(;a>0&&Array.isArray(s);)a--,s=s[0];if(s!==void 0)for(let c=0;c<a;c++)i=[i]}f(o,i,r)}}function Be(e,t){return S(e,"any",t?.origin)}function Ke(e,t){return S(e,"read",t?.origin)}function Xe(e,t){return S(e,"write",t?.origin)}function S(e,t,r){let o=e?.json;if(o?.origins&&r){let n;n=r==="link-chart"?o.origins[r]&&(t==="any"||t in o.origins[r])?o.origins[r]:o.origins["web-map"]:o.origins[r],n&&(t==="any"||t in n)&&(o=n)}return o}function fe(e){let t=ye(e);if(e.json.origins)for(let r in e.json.origins){let o=e.json.origins[r],n=o.types?le(o):t;_(n,o,!1),o.types&&!o.write&&e.json.write?.enabled&&(o.write=x({},e.json.write)),h(n,o)}_(t,e.json,!0),h(t,e.json)}function ye(e){return e.json.types?P(e.json):e.type?W(e):P(e)}function le(e){return e.type?W(e):P(e)}function W(e){if(!e.type)return;let t=0,r=e.type;for(;Array.isArray(r)&&!$(r);)r=r[0],t++;return{type:r,ndimArray:t}}function P(e){if(!e.types)return;let t=0,r=e.types;for(;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}function q(e){X(e)&&(I(e),fe(e))}var N=new Set,C=new Set;function rt(e){return t=>{e??="esri.core.Accessor",t.prototype.declaredClass=e,me(t);let r=[],o=[],n=t.prototype;for(;n;)n.hasOwnProperty("initialize")&&!N.has(n.initialize)&&(N.add(n.initialize),r.push(n.initialize)),n.hasOwnProperty("destroy")&&!C.has(n.destroy)&&(C.add(n.destroy),o.push(n.destroy)),n=Object.getPrototypeOf(n);N.clear(),C.clear();let i=class extends t{constructor(...s){if(super(...s),this.constructor===i&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let c=r.length-1;c>=0;c--)r[c].call(this)}}),o.length){let c=!1,p=this[L];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!c){c=!0,p.call(this);for(let u=0;u<o.length;u++)o[u].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};i.__accessorMetadata__=l(t.prototype),i.prototype.declaredClass=e;let a=(e||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(i,"name",{value:a,configurable:!0}),i}}function de(e,t){return t.get==null?function(){let r=this.__accessor__,o=r.propertiesByName.get(e);if(o===void 0)return;r.mutable&&k(o);let n=r.store;return n.has(e)?n.get(e):o.metadata.value}:function(){let r=this.__accessor__,o=r.propertiesByName.get(e);if(o!==void 0)return o.getComputed(r)}}function me(e){let t=e.prototype,r=l(t),o={};for(let n of Object.getOwnPropertyNames(r)){let i=r[n];q(i),o[n]={enumerable:!0,configurable:!0,get:de(n,i),set(a){let s=this.__accessor__;if(s!==void 0){if(s.mutable)return s.initialized&&i.readOnly?F("read-only",n):s.lifecycle===g.CONSTRUCTED&&i.constructOnly?F("construct-only",n):void s.set(n,a)}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:a})}}}Object.defineProperties(e.prototype,o)}var F=(e,t)=>{y.getLogger("esri.core.Accessor").error(`cannot assign to ${e} property '${t}'`)};export{L as a,g as b,l as c,Ae as d,_e as e,d as f,ee as g,ce as h,Be as i,Ke as j,Xe as k,rt as l,me as m};
