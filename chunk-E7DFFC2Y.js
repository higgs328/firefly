import{d as X}from"./chunk-7T2VXP7X.js";import{c as K,f as N,h as Q}from"./chunk-KP75LCOH.js";import{a as O,b as q,c as C}from"./chunk-ES4WUTEM.js";import{a as J,b as A}from"./chunk-5AFOYCWC.js";import{f as G}from"./chunk-YB6RTOHR.js";import{b as j}from"./chunk-N3HRYLNW.js";import{a as U}from"./chunk-CZ6CGC7I.js";import{a as W}from"./chunk-AVMO6LCR.js";import{a as T}from"./chunk-6F25LG6O.js";import{a as H}from"./chunk-MDSLION2.js";import{f as g}from"./chunk-VTHXE323.js";var Y=30,Z=12,P=24,_=[255,255,255],F=[200,200,200],k=[128,128,128],ne=20,le=5;function oe(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function ie(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function re(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function se(e){return e.declaredClass==="esri.symbols.TextSymbol"}function ae(e,n){let t=e.length-1;return e.map((o,l)=>K(o,l,t,n))}function Ce(e,n,t,o,l,i,s){return g(this,null,function*(){let a=n.legendOptions,u=a?.customValues,c=s||(yield fe(e,t)),p=n.stops,M=!!c,b=!!u,h=n.minSize!=null&&n.maxSize!=null,S=p&&p.length>1,d=!!n.target;if(!M||!b&&!(h||S&&!d))return;let m=A(c),f=!1,r=null,x=null;r=m&&!S?C([n.minDataValue,n.maxDataValue]):u??(yield ye(n,c,o,l?.type));let V=e?.authoringInfo,I=V?.type==="univariate-color-size",D=I&&V?.univariateTheme==="above-and-below",R=!!Q(e);if(!r&&S&&(r=p.map(y=>y.value),f=p.some(y=>!!y.label),e.type==="flow"&&(r=C(r)),f&&(x=p.map(y=>y.label))),m&&r!=null&&r?.length>2&&!D&&(r=[r[0],r[r.length-1]]),!r)return null;I&&r?.length!==5&&(r=te({minSize:r[0],maxSize:r[r.length-1]}));let B=m?ue(e,r):null,w=J(c),z=f?null:ae(r,i);return(yield Promise.all(r.map((y,L)=>g(this,null,function*(){let E=m?B[L]:yield v(n,c,y,o,l?.type);return{value:y,symbol:!R||e.type!=="class-breaks"&&e.type!=="unique-value"?Se(D&&e.type==="class-breaks"?me(e,L):c,E):ce(e,E,n.maxSize,t)??c,label:f?x[L]:z[L],size:R?P:E,outlineSize:w}})))).reverse()})}function ue(e,n){let t=e?.authoringInfo,o=t?.type==="univariate-color-size",l=[Z,Y];if(o){let i=n[0],s=n[n.length-1],a=Z,u=Y;l=n.map(c=>a+(c-i)/(s-i)*(u-a))}return o&&t?.univariateTheme==="below"&&l.reverse(),l}function ce(e,n,t,o){let l=e.type==="class-breaks",i=l?e.classBreakInfos?.[0]?.symbol?.clone():e.uniqueValueInfos?.[0]?.symbol?.clone();return i&&"type"in i&&i.type==="cim"?(X(i,{color:o??(l?null:new T(F)),innerDotSize:n*(P/t)||1,outerRingSize:P}),i):null}function me(e,n){let t=e.classBreakInfos,o=t.length,l=o<2||!(n>=2)?t[0].symbol.clone():t[o-1].symbol.clone();return e.visualVariables?.some(s=>s.type==="color")&&(l.type.includes("3d")?$(l):ee(l)),l}function fe(e,n){return g(this,null,function*(){if(e.type==="flow")return N(e,n);if(e.type==="pie-chart")return new U({color:null,outline:e.outline?.width?e.outline:new W});let t=null,o=null;if(e.type==="simple")t=e.symbol;else if(e.type==="class-breaks"){let l=e.classBreakInfos;t=l&&l[0]&&l[0].symbol,o=l.length>1}else if(e.type==="unique-value"){let l=e.uniqueValueInfos;t=l?.[0]?.symbol,o=l!=null&&l.length>1}return!t||pe(t)?null:(t=t.clone(),(n||o)&&(t.type.includes("3d")?$(t):ee(t)),t)})}function pe(e){return j(e)?e.symbolLayers?.some(n=>n?.type==="fill")??!1:e?.type.includes("fill")??!1}function $(e){e.type==="line-3d"?e.symbolLayers.forEach(n=>{n.material={color:k}}):e.symbolLayers.forEach(n=>{n.type!=="icon"||n.resource?.href?n.material={color:F}:(n.material={color:_},n.outline={color:k,size:1.5})})}function ee(e){let n=H();e.type==="cim"?G(e,new T(F)):e.type.includes("line")?e.color=k:(e.color=n?k:_,e.type==="simple-marker"&&(e.outline?e.outline?.color?.toHex()==="#ffffff"&&(e.outline.color=k):e.outline={color:k,width:1.5}))}function ye(e,n,t,o){return g(this,null,function*(){let l=(yield import("./chunk-R45N3IFT.js")).getSizeRangeAtScale(e,t,o),i=l&&te(l);if(!l||!i)return;let s=i.map(a=>be(a,e,l));s=C(s);for(let a=1;a<s.length-1;a++){let u=yield he(e,n,s[a],s[a-1],t,o);u&&(s[a]=u[0],i[a]=u[1])}return s})}function te(e){let n=e.minSize,t=e.maxSize,o=le,l=(t-n)/(o-1),i=[];for(let s=0;s<o;s++)i.push(n+l*s);return i}function be(e,n,t){let o=t.minSize,l=t.maxSize,i=n.minDataValue,s=n.maxDataValue,a;return e<=o?a=i:e>=l?a=s:a=(e-o)/(l-o)*(s-i)+i,a}function he(e,n,t,o,l,i){return g(this,null,function*(){let s=yield v(e,n,t,l,i),a=yield v(e,n,o,l,i),u=O(t),c=u.fractional,p=ne,M=u.integer,b=null,h=null;t>0&&t<1&&(b=10**c,M=O(t*=b).integer);for(let S=M-1;S>=0;S--){let d=10**S,m=Math.floor(t/d)*d,f=Math.ceil(t/d)*d;b!=null&&(m/=b,f/=b);let r=(m+f)/2;[,r]=C([m,r,f],{indexes:[1]});let x=yield v(e,n,m,l,i),V=yield v(e,n,f,l,i),I=yield v(e,n,r,l,i),D=q(s,x,a,null),R=q(s,V,a,null),B=q(s,I,a,null),w=D.previous<=p,z=R.previous<=p;if(w&&z&&(D.previous<=R.previous?(w=!0,z=!1):(z=!0,w=!1)),w?h=[m,x]:z?h=[f,V]:B.previous<=p&&(h=[r,I]),h)break}return h})}function v(e,n,t,o,l){return g(this,null,function*(){let{getSize:i}=yield import("./chunk-R45N3IFT.js");return i(e,t,{scale:o,view:l,shape:n.type==="simple-marker"?n.style:null})})}function Se(e,n){let t=e.clone();if(j(t))A(t)||t.symbolLayers.forEach(o=>{o.type!=="fill"&&(o.size=n)});else if(oe(t))t.size=n;else if(ie(t)){let o=t.width,l=t.height;t.height=n,t.width=n*(o/l)}else re(t)?t.width=n:se(t)&&t.font&&(t.font.size=n);return t}export{Y as a,Z as b,Ce as c,ce as d};
