import{a as C}from"./chunk-FFIJXUQT.js";import{a as B}from"./chunk-LFMR36ZT.js";import{b as H,c as V,d as q,e as z,f as D,h as G}from"./chunk-KTGZLV6S.js";import{a as k}from"./chunk-V5NOEZNM.js";import"./chunk-VAJSJAV3.js";import{a as F}from"./chunk-QKVTMI24.js";import{d as J}from"./chunk-I76R3PW5.js";import{a as j}from"./chunk-H25DKJGS.js";import{d as R}from"./chunk-PBAMEKFE.js";import"./chunk-XIZ7IH6M.js";import"./chunk-JD66UCS7.js";import"./chunk-FU7RO3AR.js";import"./chunk-4YRY3D3A.js";import"./chunk-ZZ5UYT7M.js";import"./chunk-U4XVPHQU.js";import"./chunk-BBB7KLHV.js";import"./chunk-5BPM64SU.js";import"./chunk-TC77DYTW.js";import"./chunk-F2BQ2GD6.js";import"./chunk-R3XLNYYB.js";import"./chunk-CXOFHVIF.js";import"./chunk-DJW5LMRG.js";import"./chunk-DEH76MSI.js";import"./chunk-6B5XFA6F.js";import{a as v}from"./chunk-3JGYBNJA.js";import"./chunk-57VFBGF3.js";import"./chunk-GWBRHLNH.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import{a as _}from"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import{c as E}from"./chunk-7QNKS2X6.js";import{a as M}from"./chunk-VCCMJ6BV.js";import{a as W}from"./chunk-QK56OQGR.js";import"./chunk-FXCL7YYQ.js";import"./chunk-QKO56XO6.js";import"./chunk-JRGT3GTH.js";import"./chunk-K75TK42V.js";import"./chunk-CELWVZPW.js";import"./chunk-VV5G7VY5.js";import"./chunk-OLOKUDVI.js";import"./chunk-DYTVXYAV.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-KVM6SHDX.js";import"./chunk-HX2VGIR2.js";import"./chunk-ERDKAICI.js";import{b as L}from"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-IR6XCBC4.js";import"./chunk-VU5W7W6Y.js";import{m as b}from"./chunk-ZQIC5NFT.js";import{c as S}from"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import{a as y}from"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import{a as U}from"./chunk-7F5DJLJT.js";import{a as N}from"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-K5T5FD5C.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import{b as I,o as O}from"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import{f}from"./chunk-CCJU4DSH.js";import{a as P,j as w}from"./chunk-TG45K3WR.js";import"./chunk-RAI4DTMT.js";import"./chunk-ACP3S2CH.js";import"./chunk-HVAXZ2NA.js";import"./chunk-T7DXJKX7.js";import"./chunk-TYYVNQUR.js";import{a as t}from"./chunk-QGVBCWUY.js";import{H as x}from"./chunk-MYO4NP2N.js";import{e as r}from"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import{l as s}from"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import{b as g}from"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as m,f as T}from"./chunk-VTHXE323.js";var l=class extends v.ClonableMixin(f){constructor(o){super(o),this.framerate=null,this.containerFormat=null,this.gop=null,this.aspectRatio=null,this.klv=null}};t([r({type:String})],l.prototype,"framerate",void 0),t([r({type:String})],l.prototype,"containerFormat",void 0),t([r({type:Number})],l.prototype,"gop",void 0),t([r({type:String})],l.prototype,"aspectRatio",void 0),t([r({type:Object})],l.prototype,"klv",void 0),l=t([s("esri.layers.support.PlaybackInfo")],l);var Q=l;var c=class extends x{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};function Y(o){return o?.sourcePoint!=null&&o.mapPoint!=null}t([r()],c.prototype,"sourcePoint",void 0),t([r({type:S})],c.prototype,"mapPoint",void 0),c=t([s("esri.layers.support.VideoFrame.ControlPoint")],c);var a=class extends v.ClonableMixin(f){constructor(o){super(o),this.frame=null,this.controlPoints=null}readControlPoints(o){return o.map(i=>({sourcePoint:{x:i.frameX,y:i.frameY},mapPoint:new S(i.point)}))}writeControlPoints(o,i){o!=null&&Y(o[0])&&(i.controlPoints=o.map(n=>{let p=n.sourcePoint,d=n.mapPoint;return{frameX:p.x,frameY:p.y,point:d.toJSON()}}))}};t([r({type:String})],a.prototype,"frame",void 0),t([r({type:[c],json:{write:{allowNull:!1,isRequired:!0}}})],a.prototype,"controlPoints",void 0),t([y("controlPoints")],a.prototype,"readControlPoints",null),t([N("controlPoints")],a.prototype,"writeControlPoints",null),a=t([s("esri.layers.support.VideoFrame")],a);var A=a;var e=class extends E(M(j(F(W)))){constructor(o){super(o),this._trailPoints=[],this.capabilities=null,this.connectionInfo=null,this.controller=new B,this.copyright=null,this.created=null,this.description=null,this.elevationSource=null,this.frame=null,this.frameCount=null,this.fullExtent=null,this.initialExtent=null,this.layerId=null,this.playbackInfo=null,this.posterUrl=null,this.qualities=null,this.serviceItemId=null,this.sourceJSON=null,this.sourceQuality=null,this.sourceType=null,this.spatialReference=U.WGS84,this.telemetryDisplay=null,this.title=null,this.type="video",this.url=null,this.videoLayersInfo=null,this.videoTimeExtent=null}initialize(){this.telemetryDisplay=new C({frame:!1,frameCenter:!1,frameOutline:!0,lineOfSight:!0,sensorLocation:!0,sensorTrail:!0}),this.addHandles([P(()=>this.metadata,()=>{this.notifyChange("telemetry"),this.notifyChange("groundControlPoints"),this.notifyChange("frameHorizonPoints")}),P(()=>this.telemetry?.sensorLocation,o=>this._setSensorTrail(o),w)])}load(o){let i=o!=null?o.signal:null;return this.addResolvingPromise(this._fetchService(i)),Promise.resolve(this)}get buffered(){return this.controller.buffered}readCapabilitiesFromService(o,i){return J(i)}readConnectionInfo(o,i){let n=Object.values(i.connectionUrl);return n?.length&&(this.controller.playerUrl=n[0]),i.connectionUrl}get currentTime(){return this.controller.currentTime}get duration(){return this.controller.duration}get ended(){return this.controller.ended}get frameHorizonPoints(){return D(this.metadata)}get groundControlPoints(){return z(this.metadata)}get loop(){return this.controller.loop}set loop(o){this.controller.loop=o}get metadata(){return this.controller?.currentMetadata}get mimeType(){return this.controller?.mimeType}get muted(){return this.controller.muted}set muted(o){this.controller.muted=o}get playbackRate(){return this.controller.rate}set playbackRate(o){this.controller.rate=o}get playerUrl(){return this.controller.playerUrl}get playing(){return this.controller.playing}get state(){return this.controller.state}get telemetry(){return q(this.metadata)}get videoElement(){return this.controller?.element}get videoHeight(){return this.controller?.videoHeight}readLayerInfosFromService(o,i){return G(i)}get videoWidth(){return this.controller?.videoWidth}get waiting(){return this.controller.waiting}play(){this.controller.play()}pause(){this.controller.pause()}reset(){this.controller.reset()}setCurrentTime(o){if(!this.duration)return;let i=L(o,0,this.duration);this.controller.setCurrentTime(i)}toGround(o,i){return this.controller?.sensorModel?.metadataSupportsTransforms?this.controller.sensorModel.transformImageToGeo(o,i):null}toVideo(o){if(!this.controller?.sensorModel?.metadataSupportsTransforms)return null;let i=this.controller.sensorModel.transformGeoToImage(o.x,o.y,o.z);return{x:i[0],y:i[1]}}_fetchService(o){return T(this,null,function*(){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});let i=I(this.parsedUrl?.path);if(i==null)throw new g("arcgis-layers:url-mismatch","The url is not a valid arcgis resource");let n=null,{data:p,ssl:d}=yield O(i.url.path,{query:m(m({f:"json"},this.parsedUrl.query),this.customParameters),signal:o}),u=p;if(this.url=i.url.path,d&&(this.url=this.url.replace(/^http:/i,"https:")),!u?.currentVersion)return u.currentVersion="11.2",this.sourceJSON=u,void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});let h=i?.sublayer;if(h==null&&u.layers?.length&&(h=u.layers[0].id),h==null)throw new g("arcgis-layers:url-mismatch","The url is not a valid arcgis resource");this.url=`${i.url.path}/${h}`,n=yield O(this.url,{query:m({f:"json"},this.customParameters),signal:o});let X=m(m({},u),n.data);this.sourceJSON=X,this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl})})}_setSensorTrail(o){if(!o)return;let i=V(o,this._trailPoints);this._trailPoints=[...i];let n=this._trailPoints.map(d=>d.toArray()),p=new _({hasZ:o.hasZ,paths:[n]});this.telemetry.sensorTrail=p.clone()}};t([r({readOnly:!0})],e.prototype,"buffered",null),t([r({readOnly:!0,json:{read:!1}})],e.prototype,"capabilities",void 0),t([y("service","capabilities",["supportsAppend","supportsCoverageQuery","supportsExportClip","supportsExportFrameset","supportsMensuration","supportsUpdate"])],e.prototype,"readCapabilitiesFromService",null),t([r({readOnly:!0})],e.prototype,"connectionInfo",void 0),t([y("connectionInfo",["connectionUrl"])],e.prototype,"readConnectionInfo",null),t([r()],e.prototype,"controller",void 0),t([r({type:String})],e.prototype,"copyright",void 0),t([r({readOnly:!0,type:Date})],e.prototype,"created",void 0),t([r({type:Number})],e.prototype,"currentTime",null),t([r({type:String})],e.prototype,"description",void 0),t([r({type:Number})],e.prototype,"duration",null),t([r({readOnly:!0})],e.prototype,"elevationSource",void 0),t([r({type:Boolean})],e.prototype,"ended",null),t([r({type:A})],e.prototype,"frame",void 0),t([r({readOnly:!0,type:Number})],e.prototype,"frameCount",void 0),t([r({type:b})],e.prototype,"fullExtent",void 0),t([r({readOnly:!0})],e.prototype,"frameHorizonPoints",null),t([r({readOnly:!0})],e.prototype,"groundControlPoints",null),t([r({type:b})],e.prototype,"initialExtent",void 0),t([r({readOnly:!0,json:{read:{source:"id"}}})],e.prototype,"layerId",void 0),t([r({type:Boolean})],e.prototype,"loop",null),t([r({readOnly:!0})],e.prototype,"metadata",null),t([r({readOnly:!0})],e.prototype,"mimeType",null),t([r({type:Boolean})],e.prototype,"muted",null),t([r({type:Q})],e.prototype,"playbackInfo",void 0),t([r({type:Number})],e.prototype,"playbackRate",null),t([r({type:String})],e.prototype,"playerUrl",null),t([r({readOnly:!0})],e.prototype,"playing",null),t([r({readOnly:!0,json:{read:{source:"poster"}}})],e.prototype,"posterUrl",void 0),t([r({readOnly:!0})],e.prototype,"qualities",void 0),t([r({readOnly:!0})],e.prototype,"serviceItemId",void 0),t([r()],e.prototype,"sourceJSON",void 0),t([r({readOnly:!0})],e.prototype,"sourceQuality",void 0),t([r({readOnly:!0,json:{name:"serviceType"}})],e.prototype,"sourceType",void 0),t([r()],e.prototype,"spatialReference",void 0),t([r({readOnly:!0,type:String})],e.prototype,"state",null),t([r({readOnly:!0,type:k})],e.prototype,"telemetry",null),t([r({type:C})],e.prototype,"telemetryDisplay",void 0),t([r({readOnly:!1,json:{read:{source:"name"}}})],e.prototype,"title",void 0),t([r({readOnly:!0})],e.prototype,"type",void 0),t([r(R)],e.prototype,"url",void 0),t([r({readOnly:!0})],e.prototype,"videoElement",null),t([r({readOnly:!0})],e.prototype,"videoHeight",null),t([r({readOnly:!0,json:{read:!1}})],e.prototype,"videoLayersInfo",void 0),t([y("service","videoLayersInfo",["id","name","poster","serviceType","type"])],e.prototype,"readLayerInfosFromService",null),t([r({readOnly:!0,nonNullable:!1,json:{read:{reader:H,source:"time"}}})],e.prototype,"videoTimeExtent",void 0),t([r({readOnly:!0})],e.prototype,"videoWidth",null),t([r({readOnly:!0})],e.prototype,"waiting",null),e=t([s("esri.layers.VideoLayer")],e);var Yt=e;export{Yt as default};
