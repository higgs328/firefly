import{B as p,C as Q,a as k,c as z,e as G,f as y,i as N,j,k as q,r as B,v as U,z as W}from"./chunk-WLZCR7R3.js";import{a as C}from"./chunk-O6ZQ6P3W.js";import"./chunk-KRX2B2DE.js";import"./chunk-5OBPPS5Q.js";import"./chunk-GJHYPIDU.js";import"./chunk-VY3DECDW.js";import"./chunk-V4OU5ZYM.js";import{b as f}from"./chunk-QR5K5DGD.js";import{a as c}from"./chunk-N7H6JYYU.js";import"./chunk-ZCXB2W4M.js";import{A as R,B as M,M as Z,t as O,v as J,y as L}from"./chunk-GF36OIHY.js";import"./chunk-EJ2UYJJS.js";import{a as D}from"./chunk-OCNYIIP3.js";import"./chunk-SC4TZEOX.js";import"./chunk-25WBXAEY.js";import"./chunk-7QY3BMVN.js";import"./chunk-Y7GY5YIF.js";import"./chunk-LMGYHZE3.js";import"./chunk-5LG2P6MT.js";import"./chunk-GJ2QRXGN.js";import"./chunk-ZC6EBRE4.js";import"./chunk-ZAZJB7CV.js";import"./chunk-KALOJIUA.js";import"./chunk-KMMTNF7G.js";import"./chunk-43PLGOP7.js";import{a as l,b as u}from"./chunk-OUBCFKOM.js";import"./chunk-E7AX56GD.js";import"./chunk-IDVLLREH.js";import"./chunk-DWLSVYOY.js";import"./chunk-PQGCNP5H.js";import"./chunk-UASS7NJI.js";import"./chunk-WZRAC35O.js";import"./chunk-KUYAWYSS.js";import"./chunk-MIS6QMFE.js";import{a as P}from"./chunk-MDZTV2VL.js";import{h as $}from"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import{a as V}from"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-KVM6SHDX.js";import"./chunk-33RXTDEX.js";import{a as b,d as F}from"./chunk-P33JWG3G.js";import{a as T,c as A,d as _,f as E,i as I}from"./chunk-HX2VGIR2.js";import{d as s}from"./chunk-ERDKAICI.js";import"./chunk-EQZWYK27.js";import"./chunk-JLPLCY2B.js";import"./chunk-DKGGDYJI.js";import"./chunk-5LA3PVK5.js";import"./chunk-IR6XCBC4.js";import"./chunk-C6JPAW54.js";import"./chunk-WD3OPXCN.js";import"./chunk-FA3WGIU4.js";import"./chunk-WWVPA6PE.js";import{m as w}from"./chunk-ZQIC5NFT.js";import{c as S}from"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-SLAWDKDA.js";import"./chunk-4N4D2YQX.js";import"./chunk-G4DZJMGT.js";import"./chunk-MVHHPJM7.js";import"./chunk-VDO6JJ3Y.js";import"./chunk-WFKZLI6F.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import{b as g}from"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import{a as v}from"./chunk-VTHXE323.js";var h="Voxel.Position",m="Voxel.LocalTime";function X(e){let t=e.getAttribute(h);if(typeof t!="string")throw new u(null,l.InvalidParameter,null);let r=JSON.parse(t);if(!Array.isArray(r)||typeof r[0]!="number"||typeof r[1]!="number"||typeof r[2]!="number")throw new u(null,l.InvalidParameter,null);return new D(r)}function Y(e,t){let r=e.getAttribute(m);if(r==null)return null;if(!I(r))throw new u(null,l.InvalidParameter,null);return s.dateJSAndZoneToArcadeDate(r,t)}var x=class{constructor(t,r){this._graphic=t,this._timeZone=r,this.arcadeDeclaredClass="esri.arcade.Voxel",this._layer=t.layer}getPosition(){return this._position!==void 0?this._position:this._position=X(this._graphic)}getLocalTime(){return this._localTime!==void 0?this._localTime:this._localTime=Y(this._graphic,this._timeZone??"system")}keys(){return this._layer.fields.map(t=>t.name).sort()}hasField(t){return this._layer.fieldsIndex.has(t)}field(t){let r=this._layer.fieldsIndex?.get(t)?.name;if(r==null)throw new u(null,l.FieldNotFound,null,{key:t});switch(r){case h:return this.getPosition();case m:return this.getLocalTime()}return this._graphic.attributes[r]??null}castToText(t=!1){let r=v({},this._graphic.attributes);r[h]=this.getPosition(),m in r&&(r[m]=this.getLocalTime());for(let n of Object.keys(r))this._layer.fieldsIndex?.has(n)||delete r[n];return Z(r,{useNumbersForDates:t})}};var ee={vars:{$feature:"any",$view:"any"},spatialReference:null};function te(e){return e.replaceAll(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function De(e){return e==null?null:E(e)||R(e)?"array":M(e)?"date":_(e)?"text":A(e)?"boolean":T(e)?"number":e instanceof c?"dictionary":O(e)?"feature":e instanceof S?"point":e instanceof $?"polygon":e instanceof V?"polyline":e instanceof P?"multipoint":e instanceof w?"extent":e instanceof b?"dateOnly":e instanceof F?"time":J(e)?"featureSet":L(e)?"featureSetCollection":null}function d(e){if(!e)return null;try{return z(e)}catch{}return null}function Pe(e,t){let r=typeof e=="string"?d(e):e;if(!r)return null;try{return t=t||g(ee),k(r,t)}catch{}return null}function $e(e,t,r){return{vars:{$feature:e==null?new f:f.createFromGraphic(e,r),$view:t?.view},spatialReference:t?.sr,timeZone:r??null}}function Ve(e,t,r){return f.createFromGraphicLikeObject(t,e,r,null)}function Oe(e,t){e.vars!=null&&(e.vars.$feature=t)}function Je(e,t){let r;try{r=G(e,t)}catch{r=null}return r}function Le(e,t){let r;try{r=e?e(t):null}catch{r=null}return r}function Re(e,t){try{return e?e(t):Promise.resolve(null)}catch{return Promise.resolve(null)}}var re=new Set(["$feature","$aggregatedFeatures","$voxel"].map(e=>C(e)));function Me(e,t){if(!e)return[];let r=typeof e=="string"?d(e):e;if(!r)return[];let n=N(r).filter(({varId:a})=>re.has(a)).map(({memberNamePattern:a})=>a).flatMap(a=>{if(a.includes("*")){if(t==null)return[];let o=new RegExp(`^${a.split(/\*+/).map(te).join(".*")}$`,"i");return t.filter(i=>o.test(i))}return a.toLowerCase()});return[...new Set(n.sort())]}function Ze(e){return y(e,"$view")}function ke(e,t){return!!e&&y(e,t)}function ze(e){if(!e||e.spatialReference==null&&(e.scale==null||e.viewingMode==null))return;let t,r,{timeProperties:n,timeZone:a}=e;if(n!=null){let{currentStart:o,currentEnd:i}=n;a!=null?(t=o!=null?s.dateJSAndZoneToArcadeDate(o,a):null,r=i!=null?s.dateJSAndZoneToArcadeDate(i,a):null):(t=o!=null?s.dateJSToArcadeDate(o):null,r=i!=null?s.dateJSToArcadeDate(i):null)}return{view:e.viewingMode&&e.scale!=null?new c({viewingMode:e.viewingMode,scale:e.scale,timeProperties:t!=null||r!=null?new c({currentStart:t,currentEnd:r,startIncluded:!0,endIncluded:!0}):null}):null,sr:e.spatialReference}}function Ge({url:e,spatialReference:t,lrucache:r,interceptor:n}){let a=p();return a?a.createFeatureSetCollectionFromService(e,t,r,n):null}function Ne({layer:e,spatialReference:t,outFields:r,returnGeometry:n,lrucache:a,interceptor:o}){if(e===null)return null;let i=p();return i?i.constructFeatureSet(e,t,r,n??!0,a,o):null}function je(e){if(e?.map===null)return null;let t=p();return t?t.createFeatureSetCollectionFromMap(e.map,e.spatialReference,e.lrucache,e.interceptor):null}function qe(e,t){return c.convertJsonToArcade(e,t)}function Be(e,t,r=[]){return U(e,t,r)}function Ue(){return q()}function We(){return B()}function ne(e){return"type"in e&&(e.type==="class-breaks"||e.type==="dictionary"||e.type==="dot-density"||e.type==="pie-chart"||e.type==="simple"||e.type==="unique-value")}function ae(e){return e.declaredClass==="esri.layers.support.LabelClass"}function oe(e){return e.declaredClass==="esri.PopupTemplate"}function K(e,t){if(!e)return!1;if(typeof e=="string")return t(e);let r=e;if(ne(r)){if(r.type==="dot-density"){let o=r.attributes?.some(i=>t(i.valueExpression));if(o)return o}let n=r.visualVariables,a=!!n&&n.some(o=>{let i=t(o.valueExpression);return o.type==="size"&&(H(o.minSize)&&(i=i||t(o.minSize.valueExpression)),H(o.maxSize)&&(i=i||t(o.maxSize.valueExpression))),i});return!(!("valueExpression"in r)||!t(r.valueExpression))||a}if(ae(r)){let n=r.labelExpressionInfo?.expression;return!(!n||!t(n))||!1}return!!oe(r)&&(!!r.expressionInfos&&r.expressionInfos.some(n=>t(n.expression))||Array.isArray(r.content)&&r.content.some(n=>n.type==="expression"&&t(n.expressionInfo?.expression)))}function ie(e){let t=d(e);return!!t&&W(t)}function He(e){return K(e,ie)}function se(e){let t=d(e);return!!t&&j(t)}function Ke(e){return K(e,se)}function H(e){return e&&e.declaredClass==="esri.renderers.visualVariables.SizeVariable"}export{c as Dictionary,x as Voxel,Q as arcade,f as arcadeFeature,Ne as convertFeatureLayerToFeatureSet,qe as convertJsonToArcade,je as convertMapToFeatureSetCollection,Ge as convertServiceUrlToWorkspace,$e as createExecContext,Ve as createFeature,Pe as createFunction,d as createSyntaxTree,Ze as dependsOnView,We as enableFeatureSetOperations,Ue as enableGeometryOperations,Je as evalSyntaxTree,Re as executeAsyncFunction,Le as executeFunction,Me as extractFieldNames,De as getArcadeType,ze as getViewInfo,He as hasGeometryFunctions,Ke as hasGeometryOperations,ke as hasVariable,Be as loadScriptDependencies,Oe as updateExecContext};
