import{a as k,b as N,c as Z,d as A,e as W,f as D}from"./chunk-5HIFMC5M.js";import{a as z}from"./chunk-BRJ4IROM.js";import{c as T,d as R}from"./chunk-VP2YX4L2.js";import{a as j}from"./chunk-LAX5536Z.js";import{h as $}from"./chunk-RNC4P66O.js";import{a as l}from"./chunk-QGVBCWUY.js";import{e as c}from"./chunk-NFIPKH6V.js";import{l as G}from"./chunk-5QEXLALV.js";import{b as I}from"./chunk-2LI2GKBQ.js";import{a as E,f as b}from"./chunk-VTHXE323.js";var H="Single Line Input",J=3e5;function V(t,o){return t.location?O(t,o):Q(t,o)}function B(t,o){if(o.localSearchDisabled)return null;let e=t?.scale;return typeof e=="number"&&e<=J?t?.extent?.center:null}function M(t,o){return b(this,null,function*(){let{source:e,spatialReference:a,view:p,suggestTerm:i,maxSuggestions:u,sourceIndex:g}=t,r=new W,{apiKey:f,url:m}=e,y=P(e,p),h=o?.signal;if(!m)return null;f&&(r.apiKey=f),e.categories&&(r.categories=e.categories),a&&(r.outSpatialReference=a);let d=B(p,e);if(d&&(r.location=d),!i.trim())return null;let{prefix:s="",suffix:x=""}=e,S=`${s}${i}${x}`;return r.text=S,y&&(r.searchExtent=y),r.maxSuggestions=u,e.countryCode&&(r.countryCode=e.countryCode),D(m,r,{signal:h}).then(v=>Y(v,g))})}function ue(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function de(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function pe(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}var me="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";function O(t,o){return b(this,null,function*(){let{source:e,spatialReference:a,location:p,sourceIndex:i,view:u}=t,{apiKey:g,url:r,zoomScale:f,defaultZoomScale:m}=e;if(r==null)return[];let y=u?.scale,h=o?.signal,d=new Z({location:p});g&&(d.apiKey=g),a&&(d.outSpatialReference=a);try{return U([yield A(r,d,{signal:h})],{sourceIndex:i,scale:y,view:u,zoomScale:f,defaultZoomScale:m})}catch{return[]}})}function P(t,o){let{filter:e,withinViewEnabled:a}=t,p=o?.scale,i=o?.extent,u=e?.geometry;return(u?R(u,o??void 0,p):void 0)||(a&&i?i:void 0)}function Q(t,o){return b(this,null,function*(){let{source:e,suggestResult:a,spatialReference:p,view:i,maxResults:u,sourceIndex:g}=t,r=e?.zoomScale,f=e?.defaultZoomScale;if(!a.text?.trim())return null;let y=!a.key&&e.prefix?e.prefix:"",h=!a.key&&e.suffix?e.suffix:"",d=`${y}${a.text}${h}`,s=new k,{apiKey:x,url:S}=e,v=i?.scale,w=P(e,i),_=o?.signal;if(x&&(s.apiKey=x),!S)return null;e.categories&&(s.categories=e.categories),e.locationType&&(s.locationType=e.locationType),p&&(s.outSpatialReference=p);let L=B(i,e);L&&(s.location=L),s.maxLocations=u,w&&(s.searchExtent=w),e.countryCode&&(s.countryCode=e.countryCode);let{key:C}=a,F=`${C}`;return C&&(s.magicKey=F),s.address={},s.address[e.singleLineFieldName||H]=d,e.outFields&&(s.outFields=e.outFields),N(S,s,{signal:_}).then(q=>U(q,{key:F,scale:v,sourceIndex:g,view:i,zoomScale:r,defaultZoomScale:f}))})}function X(t,o){return{text:t.text,key:t.magicKey,sourceIndex:o}}function Y(t,o){return t.map(e=>X(e,o))}function ee(t,o){let{key:e,scale:a,sourceIndex:p,view:i,zoomScale:u,defaultZoomScale:g}=o,{attributes:r,extent:f,location:m,address:y}=t,h=new j({geometry:m,attributes:r}),d=f||m,s=d?R(d,i??void 0,a??void 0):void 0,x=s?typeof u=="number"?T(s,i??void 0,u):typeof g=="number"&&d?.type==="point"?T(s,i??void 0,g):s:null,S=m?`${m.x},${m.y}`:"",v=y||S,w=h.clone();return x!=null&&(w.geometry=$.fromExtent(x)),{extent:x,feature:h,target:w,key:e,name:v,sourceIndex:p}}function U(t,o){return t.filter(Boolean).map(e=>ee(e,o))}var K,n=K=class extends z{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(o,e)=>V(E({source:this},o),e),this.getSuggestions=(o,e)=>M(E({source:this},o),e)}clone(){return new K({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?I(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?I(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};l([c()],n.prototype,"apiKey",void 0),l([c()],n.prototype,"categories",void 0),l([c()],n.prototype,"countryCode",void 0),l([c({json:{write:!0}})],n.prototype,"defaultZoomScale",void 0),l([c()],n.prototype,"localSearchDisabled",void 0),l([c()],n.prototype,"locationType",void 0),l([c({json:{write:!0}})],n.prototype,"name",void 0),l([c({json:{write:!0}})],n.prototype,"placeholder",void 0),l([c()],n.prototype,"searchTemplate",void 0),l([c({json:{write:!0}})],n.prototype,"singleLineFieldName",void 0),l([c({json:{read:{source:"suggest"},write:{target:"suggest"}}})],n.prototype,"suggestionsEnabled",void 0),l([c({json:{write:!0}})],n.prototype,"url",void 0),l([c({json:{write:!0}})],n.prototype,"zoomScale",void 0),n=K=l([G("esri.widgets.Search.LocatorSearchSource")],n);var Ie=n;export{ue as a,de as b,pe as c,me as d,Ie as e};
