import{a as Y}from"./chunk-IQYLT45D.js";import{a as w,b,c as p,d as I,e as S,h as C,i as P}from"./chunk-CR343OBM.js";import{j,l as G}from"./chunk-AFJIRAY7.js";import{b as A}from"./chunk-2CC7WNFC.js";import{h as H}from"./chunk-RNC4P66O.js";import{m as L}from"./chunk-ZQIC5NFT.js";import{o as M}from"./chunk-AUAZP44J.js";import{y as k}from"./chunk-4PTIEWMT.js";import{b as V}from"./chunk-YOFFGXOB.js";import{a as R,f as F}from"./chunk-VTHXE323.js";function E(t){return t.endsWith("?")?t.slice(0,-1):t}function B(t){return t.filter(({coverageSubType:e})=>e==null||e===""||/^rectified(grid|dataset)/i.test(e))}function te(t){let e=p(t,"Service/name"),n=b(t,"Capability"),i=b(n,"GetCapabilities/Get/OnlineResource")?.getAttribute("xlink:href")??"",a=b(n,"DescribeCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",r=b(n,"GetCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",s={getCapabilities:E(i),describeCoverage:E(a),getCoverage:E(r)},o=w(t,"CoverageOfferingBrief"),m=[];for(let l=0;l<o.length;l++){let u=o[l],f=p(u,"name"),c=w(u,"pos"),g=S(c[0]),v=S(c[1]),d=new L({xmin:g[0],ymin:g[1],xmax:v[0],ymax:v[1],spatialReference:{wkid:4326}});m.push({id:f,lonLatEnvelope:d})}return{name:e,onlineResources:s,coverages:m,gridCoverages:B(m),supportedVersions:["1.0.0"],version:"1.0.0"}}function K(t){let e={};for(let n=0;n<t.childNodes.length;n++){let i=t.childNodes[n];if(i.nodeType!==1)continue;let a=P(i).toLowerCase();switch(a){case"title":case"abstract":e[a]=p(i);break;case"identifier":e.id=p(i);break;case"wgs84boundingbox":{let r=S(i,"LowerCorner"),s=S(i,"UpperCorner");e.lonLatEnvelope=new L({xmin:r[0],ymin:r[1],xmax:s[0],ymax:s[1],spatialReference:{wkid:4326}})}break;case"coveragesummary":e.coverageSummaries=e.coverageSummaries||[],e.coverageSummaries.push(K(i))}}return e}function Z(t,e){if(t.coverageSummaries)for(let n=0;n<t.coverageSummaries.length;n++)t.coverageSummaries[n].abstract=t.coverageSummaries[n].abstract||t.abstract,t.coverageSummaries[n].lonLatEnvelope=t.coverageSummaries[n].lonLatEnvelope||t.lonLatEnvelope,t.coverageSummaries[n].title=t.coverageSummaries[n].title||t.title,Z(t.coverageSummaries[n],e);t.id!=null&&e.push(t)}function _(t){let e=b(t.querySelector("Operation[name=GetCapabilities]"),"Get")?.getAttribute("xlink:href")||"",n=b(t.querySelector("Operation[name=DescribeCoverage]"),"Get")?.getAttribute("xlink:href")||"",i=b(t.querySelector("Operation[name=GetCoverage]"),"Get")?.getAttribute("xlink:href")||"";return{getCapabilities:E(e),describeCoverage:E(n),getCoverage:E(i)}}function ne(t){let e=p(t,"ServiceIdentification/Title"),n=I(t,"ServiceIdentification/ServiceTypeVersion"),i=_(b(t,"OperationsMetadata")),a=[],r=b(t,"Contents");for(let o=0;o<r.childNodes.length;o++){let m=r.childNodes[o];m.nodeType===1&&C(m,"CoverageSummary")&&Z(K(m),a)}let s=I(r,"SupportedFormat");return{name:e,onlineResources:i,coverages:a,gridCoverages:B(a),supportedVersions:n,supportedFormats:s,version:"1.1.0"}}function ie(t){let e=b(t,"ServiceIdentification"),n=p(e,"Title"),i=I(e,"ServiceTypeVersion"),a=I(e,"Profile"),r=_(b(t,"OperationsMetadata")),s=w(t,"Contents/CoverageSummary"),o=[];for(let l=0;l<s.length;l++){let u=s[l],f=p(u,"CoverageId"),c=b(u,"WGS84BoundingBox"),g;if(c){let d=S(c,"LowerCorner"),x=S(c,"UpperCorner");g=new L({xmin:d[0],ymin:d[1],xmax:x[0],ymax:x[1],spatialReference:{wkid:4326}})}let v=p(u,"CoverageSubtype")||"RectifiedGridCoverage";o.push({id:f,lonLatEnvelope:g,coverageSubType:v})}let m=b(t,"ServiceMetadata");return{name:n,supportedVersions:i,supportedFormats:I(m,"formatSupported"),supportedInterpolations:I(m,"interpolationSupported").concat(I(m,"InterpolationSupported")),onlineResources:r,profiles:a,coverages:o,gridCoverages:B(o),version:"2.0.1"}}function J(t){let e=null;typeof t=="string"?e=new DOMParser().parseFromString(t,"text/xml"):e=t;let n=e.documentElement.getAttribute("version"),i=n?.slice(0,3);return i!=null&&i<"2.1"}function Q(t,e=null){let n=null;typeof t=="string"?n=new DOMParser().parseFromString(t,"text/xml"):n=t;let i=n.documentElement.getAttribute("version");i==="1.0"?i="1.0.0":i==="1.1"&&(i="1.1.0");let a=i||e||"1.0.0",r=a.slice(0,3),s;if(r==="2.0")s=ie(n);else if(r==="1.1")s=ne(n);else{if(r!=="1.0")throw new V("wcsraster:parsecapabilities","the capabilities version is not supported");s=te(n)}return s.version=a,s}function q(t){t.variables.forEach(e=>e.dimensions.forEach(n=>n.values??=j(n)))}function se(t){return{requestResponseCRSs:I(t,"requestResponseCRSs").map(e=>e.split(":")[1]),nativeCRSs:I(t,"nativeCRSs").map(e=>e.split(":")[1])}}function X(t,e){let n=I(t,e==="1.0.0"?"interpolationMethod":"InterpolationMethod"),i=e==="1.0.0"?t.getAttribute("default"):p(t,"InterpolationMethods/Default");return i!=null?[i].concat(n.filter(a=>a.toLowerCase()!==i.toLowerCase())):n}function $(t){return t==null?["nearest"]:t.map(e=>{let n=e.toLowerCase();return n.includes("nearest")?"nearest":n.includes("linear")?"bilinear":n.includes("cubic")?"cubic":null}).filter(e=>!!e)}function ae(t){let e=w(t,"pos"),n=S(e[0]),i=S(e[1]);return new L({xmin:n[0],ymin:n[1],xmax:i[0],ymax:i[1],spatialReference:{wkid:4326}})}function U(t,e){let n=I(t,e);return n?.length&&n[0]!==""&&!isNaN(Number(n[0]))?n.map(i=>Number(i)):null}function oe(t){let e=S(t,"MinimumValue"),n=S(t,"MaximumValue");return e.length&&n.length?e.map((i,a)=>({min:i,max:n[a],avg:-1,stddev:-1})):null}function W(t){return t==null?null:t.every(e=>e===t[0])?t[0]:t}function re(t){let e=[],n=w(t,"RangeSet"),i=[];for(let a=0;a<n.length;a++){let r=p(n[a],"name"),s=p(n[a],"label"),o=[],m=U(n[a],"nullValues/singleValue"),l=w(n[a],"AxisDescription");for(let u=0;u<l.length;u++){let f=p(l[u],"name"),c=p(l[u],"label"),g=I(l[u],"singleValue");if(g.length===0){let v=p(l[u],"min"),d=p(l[u],"max"),x=Number(p(l[u],"res"))||1;if(v!==null&&d!==null)for(let h=parseInt(v,10);h<=parseInt(d,10);h+=x)g.push(h.toString())}f.toLowerCase()==="band"&&(i=g),o.push({name:f,label:c,values:g})}e.push({name:r,label:s,nullValues:m,axis:o})}return{rangeSet:e,bandNames:i}}function le(t=null){if(!t)return{resolution:null,units:null};let e=t.toUpperCase(),n=["Y","M","D"],i=["H","M","S"],a=["Years","Months","Days","Hours","Minutes","Seconds"],r,s,o;return e.includes("PT")?(e=e.slice(2),o=i.findIndex(m=>e.includes(m)),r=a[3+o],s=parseFloat(e.slice(0,-1))):(e=e.slice(1),o=n.findIndex(m=>e.includes(m)),o>-1&&(r=a[o]),s=parseFloat(e.slice(0,-1))),{resolution:s,units:r}}function O(t){let e=w(t,"timeposition");if(e.length>0){let i=[];for(let a=0;a<e.length;a++)i.push(new Date(p(e[a])));return{begin:i[0],end:i[i.length-1],values:i}}let n=b(t,"timePeriod")||b(t,"TimePeriod");return n?R({begin:new Date(p(n,"beginPosition")||p(n,"BeginPosition")),end:new Date(p(n,"endPosition")||p(n,"EndPosition"))},le(p(n,"timeResolution")||p(n,"TimeResolution"))):null}function ue(t){let e=b(t,"spatialDomain"),n=b(e,"Envelope")||b(e,"EnvelopeWithTimePeriod"),i=n.getAttribute("srsName").split(":"),a=i[i.length-1],r=w(n,"pos"),s=S(r[0]),o=S(r[1]),m=parseInt(a,10),l=isNaN(m)?null:{wkid:m},u=new L({xmin:s[0],ymin:s[1],xmax:o[0],ymax:o[1],spatialReference:l}),f=b(e,"RectifiedGrid"),c=p(f,"low").split(" "),g=p(f,"high").split(" "),v=parseInt(g[0],10)-parseInt(c[0],10)+1,d=parseInt(g[1],10)-parseInt(c[1],10)+1,x=S(e,"origin/pos"),h=w(e,"offsetVector"),y={envelope:u,columns:v,rows:d,offset:{x:parseFloat(p(h[0]).split(" ")[0]),y:parseFloat(p(h[1]).split(" ")[1])},origin:{x:x[0],y:x[1]}},T=b(t,"temporalDomain")||b(t,"TemporalDomain");return{spatialDomain:y,temporalDomain:T?O(T):null}}function me(t){let e={version:"1.0"},n,i=[];for(let v=0;v<t.childNodes.length;v++){let d=t.childNodes[v];if(d.nodeType===1)if(C(d,"description"))e.description=p(d);else if(C(d,"name"))e.name=p(d);else if(C(d,"label"))e.label=p(d);else if(C(d,"supportedFormats"))e.supportedFormats=I(d,"formats");else if(C(d,"supportedCRSs"))e.supportedCRSs=se(d);else if(C(d,"supportedInterpolations"))e.supportedInterpolations=X(d,"1.0.0");else if(C(d,"lonLatEnvelope"))e.lonLatEnvelope=ae(d);else if(C(d,"rangeSet")){let x=re(d);e.rangeSet=x.rangeSet,i=x.bandNames;let h=x.rangeSet[0].nullValues;h?.length&&(n=W(h))}else C(d,"domainSet")&&(e.domainSet=ue(d))}let a=$(e.supportedInterpolations),{name:r,description:s,label:o,lonLatEnvelope:m,supportedFormats:l}=e,{spatialDomain:u}=e.domainSet,f={x:Math.abs(u.offset.x),y:Math.abs(u.offset.y)},c=pe(e.domainSet),g=new A({width:u.columns,height:u.rows,pixelSize:f,pixelType:"unknown",extent:u.envelope,spatialReference:u.envelope.spatialReference,bandCount:i.length||1,noDataValue:n,multidimensionalInfo:c});return{id:r,title:e.name,description:s||o,lonLatEnvelope:m,rasterInfo:g,bandNames:i,supportedFormats:l,supportedInterpolations:a,coverageDescription:e,version:"1.0.0",useEPSGAxis:!1}}function pe(t){if(!t.temporalDomain)return null;let{begin:e,end:n,values:i,units:a,resolution:r}=t.temporalDomain,s={variables:[{name:"default",description:"",dimensions:[{name:"StdTime",description:"",unit:"ISO8601",values:i?.map(o=>o.getTime()),hasRegularIntervals:!i,interval:r,intervalUnit:a,extent:[e.getTime(),n.getTime()]}]}]};return q(s),s}function ce(t,e){let n=[],i=w(t,"Field"),a,r=[];for(let s=0;s<i.length;s++){let o=p(i[s],"Identifier"),m=p(i[s],"Description"),l=p(i[s],"Definition"),u=p(i[s],"Abstract"),f=p(i[s],"Title"),c=U(i[s],"NullValue"),g=b(i[s],"AllowedValues"),v=g?oe(g):null,d=X(i[s],"1.1.0"),x=[],h=w(i[s],"Axis");for(let y=0;y<h.length;y++){let T=h[y].getAttribute("identifier"),D=p(h[y],"UOM"),N=p(h[y],"DataType"),z=I(h[y],"Key");e&&!T.toLowerCase().includes("band")||(r=z,a=c),x.push({identifier:T,uom:D,dataType:N,values:z,bandNoDataValues:a})}n.push({identifier:o,description:m,definition:l,abstract:u,title:f,supportedInterpolations:d,axis:x,nullValues:c,statistics:v})}return{rangeSet:n,bandNames:r,bandNoDataValues:a,statistics:n[0].statistics}}function de(t,e){if(!e.temporalDomain)return null;let n=t.filter(a=>!a.identifier.toLowerCase().includes("field_1")&&!a.axis.some(r=>r.identifier.includes("band"))),i=[];if(n.length&&n.forEach(a=>{let r=a.axis.map(s=>{let o=s.values.map(l=>s.uom==="ISO8601"?(l=l.trim()).toLowerCase().includes("z")?new Date(l).getTime():new Date(l+"Z").getTime():parseFloat(l.trim())),m=[Math.min.apply(null,o),Math.max.apply(null,o)];return{name:s.identifier.trim(),description:"",field:s.identifier.trim(),unit:s.uom?s.uom.trim():"",hasRegularIntervals:!1,values:o,extent:m}});i.push({name:a.identifier.trim(),description:a.description?.trim()??"",unit:"",dimensions:r,statistics:a.statistics})}),e.temporalDomain){let{begin:a,end:r,values:s,units:o,resolution:m}=e.temporalDomain;i.some(l=>l.dimensions.some(u=>u.name.toLowerCase()==="stdtime"))||i.forEach(l=>{l.dimensions.push({name:"StdTime",description:"",unit:"ISO8601",values:s?.map(u=>u.getTime()),hasRegularIntervals:!s,interval:m,intervalUnit:o,extent:[a.getTime(),r.getTime()]})})}if(i.length){let a={variables:i};return q(a),a}return null}function fe(t){let e=b(t,"SpatialDomain"),n=b(e,"GridCRS"),i=p(n,"GridBaseCRS"),a=p(n,"GridOrigin"),r=a?.split(" ").map(h=>parseFloat(h))??[0,0],s=S(n,"GridOffsets"),o=w(e,"BoundingBox"),m,l,u,f;for(let h=0;h<o.length;h++){let y=o[h].getAttribute("crs")?.toLowerCase();if(y!=null){if(y.includes("imagecrs")){let T=S(o[h],"LowerCorner"),D=S(o[h],"UpperCorner");m=D[0]-T[0]+1,l=D[1]-T[1]+1}else if(y.indexOf("epsg")>0){let T=y.split(":");u=parseInt(T[T.length-1],10);let D=S(o[h],"LowerCorner"),N=S(o[h],"UpperCorner");f=new L({xmin:D[0],ymin:D[1],xmax:N[0],ymax:N[1],spatialReference:{wkid:u}})}}}let c=m>l,g=f.xmax-f.xmin>f.ymax-f.ymin,v=!1;Y(u)&&(c===g?v=!1:(v=!0,f=new L({xmin:f.ymin,ymin:f.xmin,xmax:f.ymax,ymax:f.xmax,spatialReference:{wkid:u}})));let d={columns:m,rows:l,origin:{x:r[0],y:r[1]},offset:{x:s[0],y:s[s.length-1]},gridBaseCRS:i,envelope:f,useEPSGAxis:v},x=b(t,"temporalDomain")||b(t,"TemporalDomain");return{spatialDomain:d,temporalDomain:x?O(x):null}}function ge(t,e){let n=[],i=[],a={supportedFormats:n,supportedCRSs:i,version:"1.1"},r,s,o=[];for(let h=0;h<t.childNodes.length;h++){let y=t.childNodes[h];if(y.nodeType!==1)continue;let T=P(y).toLowerCase();switch(T){case"title":case"abstract":case"identifier":a[T]=p(y);break;case"supportedformat":{let D=p(y);n.includes(D)||n.push(D)}break;case"supportedcrs":{let D=p(y);i.includes(D)||i.push(D)}break;case"range":{let D=ce(y,!!a.domain?.temporalDomain);a.range=D.rangeSet,o=D.bandNames;let{bandNoDataValues:N}=D;N?.length&&(r=W(N)),s=D.statistics}break;case"domain":a.domain=fe(y)}}let m=$(a.range[0].supportedInterpolations),{identifier:l,abstract:u,title:f,domain:c,range:g}=a,v={x:Math.abs(c.spatialDomain.offset.x),y:Math.abs(c.spatialDomain.offset.y)},d=de(g,c);d&&(r=g[0].nullValues,r?.length===1&&(r=r[0]));let x=new A({width:c.spatialDomain.columns,height:c.spatialDomain.rows,pixelSize:v,pixelType:"unknown",extent:c.spatialDomain.envelope,spatialReference:c.spatialDomain.envelope.spatialReference,bandCount:o.length||1,noDataValue:r,statistics:s,multidimensionalInfo:d});return{id:l,title:a.title,description:u||f,bandNames:o,rasterInfo:x,supportedFormats:n,supportedInterpolations:m,coverageDescription:a,version:e,useEPSGAxis:c.spatialDomain.useEPSGAxis}}function ve(t){let e=b(t,"Envelope")||b(t,"EnvelopeWithTimePeriod"),n=e.getAttribute("srsName"),i=n.slice(n.lastIndexOf("/")+1),a=e.getAttribute("axisLabels").split(" ").map(d=>d.trim()).filter(d=>d.trim()!==""),r=S(e,"lowerCorner"),s=S(e,"upperCorner"),o=!["y","lat","latitude","north","nor","n","b"].includes(a[0].toLowerCase()),m,l=parseInt(i,10),u=isNaN(l)?null:{wkid:l};m=new L(o?{xmin:r[0],ymin:r[1],xmax:s[0],ymax:s[1],spatialReference:u}:{xmin:r[1],ymin:r[0],xmax:s[1],ymax:s[0],spatialReference:u});let f={mins:r,maxs:s},c=e.getAttribute("uomLabels").trim().split(" "),g,v;if(C(e,"EnvelopeWithTimePeriod")){g=new Date(p(t,"beginPosition")||p(t,"BeginPosition")),v=new Date(p(t,"endPosition")||p(t,"EndPosition"));let d=c?.findIndex(x=>x?.toLowerCase()==="oledatetime");d>-1&&(c[d]="ISO8601")}return{envelope:m,axisLabels:a,uomLabels:c.length?c:null,envelopeAllDims:f,beginPosition:g,endPosition:v,isEastFirst:o}}function he(t,e){let n=[],i=w(t,"DataRecord"),a=[],r,s=[];for(let o=0;o<i.length;o++){let m=w(i[o],"field"),l=[];for(let u=0;u<m.length;u++){let f=m[u].getAttribute("name"),c=p(m[u],"description")||"",g=b(m[u],"uom")?.getAttribute("code")||"",v=S(m[u],"interval"),d=U(m[u],"nilValue")?.[0];e&&!f.toLowerCase().includes("band")||(a.push(f),v?.length&&(r=r||[],r.push({min:v[0],max:v[1],avg:-1,stddev:-1})),s.push(d)),l.push({name:f,description:c,uom:g,allowedValues:v,nilValue:d})}n.push(l)}return s.some(o=>o!=null)||(s=null),{rangeType:n,bandNames:a,bandStats:r,bandNoDataValues:s}}function be(t){let e=1,n="",i=.01;return Math.abs(t-1/24)<1/24*i?n="Hours":Math.abs(t-1)<1*i?n="Days":t<1?(e=Math.round(24*t),n="Hours"):t>28-i&&t<31+i||Math.round(t/30)<12?n="Months":t>365-i&&t<366+i&&(n="Years"),{interval:e,intervalUnit:n}}function xe(t,e,n){if(n.axisLabels.length<=2)return null;let i=[];for(let r=0;r<t.length;r++){let s=t[r];for(let o=0;o<s.length;o++)s[o].name.toLowerCase().includes("band")||i.push(s[o])}let a=[];if(i.length){let r=[];for(let s=2;s<n.axisLabels.length;s++){let o=e.uomLabels?.[s]?.trim()??"",m=n.axisLabels[s].toLowerCase().includes("time")||o.toLowerCase()==="iso8601"||o.toLowerCase()==="oledatetime",l,u;if(m){let c=be(n.offset[s]);l=c.interval,u=c.intervalUnit}else l=n.offset[s],u=o;let f=[];m?(f.push(G(e.envelopeAllDims.mins[s])),f.push(G(e.envelopeAllDims.maxs[s]))):(f.push(e.envelopeAllDims.mins[s]),f.push(e.envelopeAllDims.maxs[s])),r.push({name:n.axisLabels[s].trim(),description:n.axisLabels[s].trim(),unit:m?"ISO8601":o,hasRegularIntervals:!0,extent:f,interval:l,intervalUnit:u})}if(i.forEach(s=>{let{allowedValues:o}=s,m=o?.length===2?[{min:o[0],max:o[1],avg:-1,stddev:-1}]:null;a.push({name:s.name.trim(),description:s.description?.trim()??"",unit:s.uom.trim(),statistics:m,dimensions:[...r]})}),a.length){let s={variables:a};return q(s),s}}return null}function Se(t,e){let n=b(t,"RectifiedGrid"),i=S(n,"low"),a=S(n,"high"),r=[];for(let x=0;x<i.length;x++)r.push(a[x]-i[x]+1);let s=p(n,"axisLabels").split(" "),o=S(n,"origin/pos"),m=w(n,"offsetVector"),l=[];for(let x=0;x<m.length;x++){let h=S(m[x]),y=h.findIndex(T=>T!==0);l[y]=h[y]}let u=["y","lat","latitude","north","nor","n","b"],f=!1;e?.length&&s?.length&&(f=[...e].sort((x,h)=>x<h?-1:1).join(",")===[...s].sort((x,h)=>x<h?-1:1).join(","));let c=f?s:e,g,v,d;return u.includes(c[0].toLowerCase())?(g=r[1],v=r[0],d={y:Math.abs(l[0]),x:Math.abs(l[1])}):(g=r[0],v=r[1],d={x:Math.abs(l[0]),y:Math.abs(l[1])}),{columns:g,rows:v,origin:o,offset:l,resolution:d,gridSamples:r,axisLabels:s,hasSameAxisLabelsAsBoundedBy:f}}function ye(t){let e=b(t,"EarthObservation");if(!e)return null;let n=b(e,"phenomenonTime"),i=n?O(n):null,a=b(e,"phenomenonTime"),r=a?O(a):null,s=p(e,"featureOfInterest/Footprint/multiExtentOf/MultiSurface/surfaceMembers/Polygon/exterior/LinearRing/posList"),o=null;if(s){let m=s.split(" ").map(l=>l.trim()).filter(l=>l!=null&&l!=="").map(Number);if(m.length){let l=[];for(let u=0;u<m.length/2;u+=2)l.push(m[u],m[u+1]);o=new H({rings:[[l]]})}}return{observation:{phenomenonTime:i,resultTime:r,footprint:o,identifier:p(t,"metaDataProperty/EarthObservationMetaData/identifier"),acquisitionType:p(t,"metaDataProperty/EarthObservationMetaData/acquisitionType"),status:p(t,"metaDataProperty/EarthObservationMetaData/status")}}}function we(t){let e={version:"2.0"},n,i,a=[];for(let f=0;f<t.childNodes.length;f++){let c=t.childNodes[f];if(c.nodeType===1){if(C(c,"coverageId"))e.coverageId=p(c);else if(C(c,"ServiceParameters"))e.serviceParameters={supportedFormats:I(c,"nativeFormat")};else if(C(c,"boundedBy"))e.boundedBy=ve(c);else if(C(c,"rangeType")){let g=he(c,e.boundedBy?.axisLabels.length>2||e.domainSet?.axisLabels.length>2);e.rangeType=g.rangeType,a=g.bandNames,n=g.bandStats;let{bandNoDataValues:v}=g;v?.length&&(i=W(v))}else if(C(c,"domainSet"))e.domainSet=Se(c,e.boundedBy?.axisLabels);else if(C(c,"metadata")){let g=b(c,"EOMetadata");e.eoMetadata=g?ye(g):null}}}let{coverageId:r,boundedBy:s,domainSet:o,rangeType:m,serviceParameters:l}=e,u=xe(m,s,o);return!n&&u&&(n=u?.variables[0].statistics),u!=null&&(i=m[0][0].nilValue),{id:r,title:r,description:r,bandNames:a,rasterInfo:new A({width:o.columns,height:o.rows,pixelSize:o.resolution,pixelType:"unknown",extent:s.envelope,spatialReference:s.envelope.spatialReference,bandCount:a.length||1,statistics:n,noDataValue:i,multidimensionalInfo:u}),supportedFormats:l.supportedFormats,coverageDescription:e,version:"2.0.1",useEPSGAxis:!1}}function ee(t,e){let n=null;if(typeof t=="string"?n=new DOMParser().parseFromString(t,"text/xml"):n=t,e==="1.0.0")return w(n,"CoverageOffering").map(a=>me(a));let i=w(n,"CoverageDescription");return e==="1.1.0"||e==="1.1.1"||e==="1.1.2"?i.map(a=>ge(a,e)):i.map(a=>we(a))}function qe(t,e){return F(this,null,function*(){let{version:n,customParameters:i,signal:a}=e??{},r=n?.startsWith("1.0")?"version":"acceptVersions",s=R({service:"WCS",request:"GetCapabilities",[r]:n},i);try{let{data:o}=yield M(t,{query:s,responseType:"xml",signal:a});return e?.version||J(o)||(s[r]="2.0.1",{data:o}=yield M(t,{query:s,responseType:"xml",signal:a})),Q(o)}catch(o){throw k(o)?o:new V("wcslayer:open","wcs capabilities is not valid or supported")}})}function Ue(t,e){return F(this,null,function*(){let{coverageIds:n,version:i,customParameters:a,signal:r}=e,s=i.slice(0,3),o=s==="1.0"?"coverage":s==="1.1"?"identifiers":"coverageId",m=R({service:"WCS",request:"DescribeCoverage",version:i,[o]:n.join(",")},a);try{let{data:l}=yield M(t,{query:m,responseType:"xml",signal:r});return ee(l,i)}catch(l){throw k(l)?l:new V("wcslayer:open","wcs coverage description is not valid or supported")}})}export{$ as a,qe as b,Ue as c};
