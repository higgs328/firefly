import{a as G,b as p,c as V}from"./chunk-E26EFI7P.js";import{ga as P}from"./chunk-A2QQP5DF.js";import{O as q}from"./chunk-WFHQTMIY.js";import{a as A}from"./chunk-XAZOVQGA.js";import{b as i,o as d,t as x,ub as y}from"./chunk-V3KEO7AJ.js";var w=class{getOperatorType(){return 10500}accelerateGeometry(e,t,r){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}getNearestCoordinate(e,t,r,s){if(t.isNAN()&&d("NAN xy coordinates are not allowed"),e.isEmpty())return G();switch(e.getGeometryType()){case i.enumPoint:return this.pointGetNearestVertex(e,t);case i.enumMultiPoint:return this.multiVertexGetNearestVertex(e,t);case i.enumPolyline:case i.enumPolygon:return this.multiPathGetNearestCoordinate(e,t,r,s);default:x("")}}getNearestVertex(e,t){if(t.isNAN()&&d("NAN xy coordinates are not allowed"),e.isEmpty())return G();switch(e.getGeometryType()){case i.enumPoint:return this.pointGetNearestVertex(e,t);case i.enumMultiPoint:case i.enumPolyline:case i.enumPolygon:return this.multiVertexGetNearestVertex(e,t);default:x("")}}getNearestVertices(e,t,r,s){if(s===0&&d(""),t.isNAN()&&d("NAN xy coordinates are not allowed"),e.isEmpty())return[];switch(e.getGeometryType()){case i.enumPoint:return this.pointGetNearestVertices(e,t,r,s);case i.enumMultiPoint:case i.enumPolyline:case i.enumPolygon:return this.multiVertexGetNearestVertices(e,t,r,s);default:x("")}}multiPathGetNearestCoordinate(e,t,r,s){if(e.getGeometryType()===i.enumPolygon&&r){let c=new A;e.queryEnvelope(c);let l=q(null,c,!1),N;if(N=P(e,t,s?0:l),N!==0){let h=p(t,-1,0);return s&&(h.m_bRightSide=!0),h}}let n=e.querySegmentIterator(),g=new y,a=-1,u=-1,o=Number.MAX_VALUE,m=0;for(;n.nextPath();)for(;n.hasNextSegment();){let c=n.nextSegment(),l=c.getClosestCoordinate(t,!1),N=c.getCoord2D(l),h=y.sqrDistance(N,t);h<o?(m=1,g.assign(N),a=n.getStartPointIndex(),u=n.getPathIndex(),o=h):h===o&&m++}a===-1&&d("");let f=p(g,a,Math.sqrt(o));if(s)if(e.getGeometryType()!==i.enumPolygon){let c=!1;if(m>1){let l=V(e,t,a,u);c=l!==0&&l!==3}else{n.resetToVertex(a,u);let l=n.nextSegment();c=V(l,t)!==0}f.m_bRightSide=c}else r||P(e,t,0)!==0&&(f.m_bRightSide=!0);return f}pointGetNearestVertex(e,t){let r=e.getXY(),s=y.distance(r,t);return p(r,0,s)}multiVertexGetNearestVertex(e,t){let r=e.getAttributeStreamRef(0),s=e.getPointCount(),n=-1,g=new y,a=Number.MAX_VALUE,u=new y;for(let o=0;o<s;o++){r.queryPoint2D(2*o,u);let m=y.sqrDistance(u,t);m<a&&(g.assign(u),n=o,a=m)}return p(g,n,Math.sqrt(a))}pointGetNearestVertices(e,t,r,s){let n=[];if(s!==0){let g=r*r,a=e.getXY(),u=y.sqrDistance(a,t);u<=g&&n.push(p(a,0,Math.sqrt(u)))}return n}multiVertexGetNearestVertices(e,t,r,s){let n=[];if(s!==0){let g=e.getAttributeStreamRef(0),a=e.getPointCount();n.length=s+1;let u=r*r;for(let o=0;o<a;o++){let m=g.read(2*o),f=g.read(2*o+1),c=t.x-m,l=t.y-f,N=c*c+l*l;N<=u&&n.push(p(y.construct(m,f),o,Math.sqrt(N)))}n.sort((o,m)=>o.m_distance-m.m_distance)}return n.slice(0,s)}};export{w as a};
