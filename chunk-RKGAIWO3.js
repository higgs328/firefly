import{a as R,g as C,h as j,n as O}from"./chunk-FKASYKK7.js";import"./chunk-LAAJ7BOG.js";import{L as z,h as k}from"./chunk-A2QQP5DF.js";import"./chunk-LTHAIW3V.js";import"./chunk-RRQS6PLL.js";import{K as Y,ea as q,u as F,w as X}from"./chunk-WFHQTMIY.js";import{a as _}from"./chunk-XAZOVQGA.js";import{b as v,o as A,t as b,xa as D,y as w}from"./chunk-V3KEO7AJ.js";import"./chunk-MDZTV2VL.js";import"./chunk-RNC4P66O.js";import"./chunk-7LHOQXZT.js";import"./chunk-BCREO4Q5.js";import"./chunk-U4QEPZJ3.js";import"./chunk-KJUZWSCL.js";import"./chunk-3WO6D7MU.js";import"./chunk-BUZ3SPLE.js";import"./chunk-KVM6SHDX.js";import"./chunk-EQZWYK27.js";import"./chunk-ZQIC5NFT.js";import"./chunk-VIEK2X23.js";import"./chunk-XKIFGPJO.js";import"./chunk-PEW2PLAN.js";import"./chunk-Q6Y4JG7Q.js";import"./chunk-7F5DJLJT.js";import"./chunk-CX5IFQZJ.js";import"./chunk-NJWTSROP.js";import"./chunk-D3R25AF2.js";import"./chunk-ARRCN5K3.js";import"./chunk-G4DZJMGT.js";import"./chunk-X2B63YVS.js";import"./chunk-BAEF3CT6.js";import"./chunk-AUAZP44J.js";import"./chunk-PVDFCTA4.js";import"./chunk-KNVXE32P.js";import"./chunk-76ATOSLU.js";import"./chunk-CCJU4DSH.js";import"./chunk-QGVBCWUY.js";import"./chunk-MYO4NP2N.js";import"./chunk-NFIPKH6V.js";import"./chunk-JPU2PQZC.js";import"./chunk-5QEXLALV.js";import"./chunk-P6QFA5MM.js";import"./chunk-DGTD7Y73.js";import"./chunk-LI2SX4T6.js";import"./chunk-BWO7LS2H.js";import"./chunk-HEVQSRJ2.js";import"./chunk-OVHPPCBL.js";import"./chunk-SNFOAZZQ.js";import"./chunk-AML4XSEF.js";import"./chunk-4PTIEWMT.js";import"./chunk-TG2UTNEO.js";import"./chunk-YOFFGXOB.js";import"./chunk-XRGPJ3QY.js";import"./chunk-6MRUJ2UW.js";import"./chunk-2LI2GKBQ.js";import"./chunk-QBWJMFH5.js";import"./chunk-VTHXE323.js";function K(n,g,s,e,o){if(n.isEmpty()||g.isEmpty()||8&e&&16&e)return null;2&e&&4&e&&A("");let a=new _,r=new _;return n.queryEnvelope(a),g.queryEnvelope(r),a.mergeEnvelope2D(r),M(n,g,Y(s,a,!0).total(),e)}function M(n,g,s,e){w(n),w(g);let o,a=!1,r=n.querySegmentIterator(),y=g.querySegmentIterator(),t=0,m=new z,i=new q({vd:n.getDescription()}),l=new q({vd:n.getDescription()}),S=[],E=[];for(Q(n,S,E);r.nextPath();){let P=!0,d=0;for(;d!==2;){if(d===0)r.nextSegment().getGeometryType()!==v.enumLine&&b(""),d++;else{if(r.resetToLastSegment(),r.previousSegment().getGeometryType()!==v.enumLine&&b(""),a&&P){let c=r.getPathIndex();o.addSegmentsFromPath(n,c,0,n.getSegmentCountPath(c),!0),P=!1}d++}let B=!1;if(t<E.length){let c=E[S[t]],N=r.getPathIndex();if(c.m_path===N){let x=d===1?r.getStartPointIndex():r.getEndPointIndex();c.m_pointIndex===x&&(B=!0,t++)}}if(d===1){if(8&e)continue}else if(16&e)continue;if(!B){d===1?r.previousSegment():r.nextSegment();let c=d===1?r.nextSegment():r.previousSegment(),N=c,x=N.calculateLength2D();y.resetToFirstPath();let T=!1,p=Number.NaN;for(;y.nextPath();){for(;y.hasNextSegment();){let u=y.nextSegment();u.getGeometryType()!==v.enumLine&&b("");let f=u,{bIntersect:I,t1:h,t2:L}=k(N,f);if(I){let V=f.calculateLength2D();if(L*V>=-s&&(1-L)*V>=-s){if(d===1){if(h*x<=-s)(Number.isNaN(p)||h>p)&&(p=h);else if(h*x<=s){p=Number.NaN,T=!0;break}}else if((1-h)*x<=-s)(Number.isNaN(p)||h<p)&&(p=h);else if((1-h)*x<=s){p=Number.NaN,T=!0;break}}}}if(T)break}if(!Number.isNaN(p)){if(!a){o=n.createInstance();for(let u=0;u<r.getPathIndex();u++)o.addPath(n,u,!0)}if(d===1){c.queryCoord(p,i);let u=r.getPathIndex();if(2&e?n.getPointByVal(n.getPathStart(u),l):4&e&&l.setEmpty(),1&e||(m.create(c.getGeometryType()),c.copyTo(m.get()),m.get().setEnd(i),m.get().reverse(),o.addSegment(m.get(),!0),P=!1),o.addSegmentsFromPath(n,u,0,n.getSegmentCountPath(u),P),1&e){let f=o.getPathStart(u);o.setPointByVal(f,i)}if(2&e||4&e){let f=o.getPathStart(u),I=i.getXY();l.setXY(I),o.setPointByVal(f,l)}a=!0,P=!1}else{let u=r.getPathIndex();if(P&&(o.addSegmentsFromPath(n,u,0,n.getSegmentCountPath(u),!0),P=!1),2&e?n.getPointByVal(n.getPathEnd(u)-1,l):4&e&&l.setEmpty(),c.queryCoord(p,i),1&e){let f=o.getPathEnd(u);o.setPointByVal(f-1,i)}else m.create(c.getGeometryType()),c.copyTo(m.get()),m.get().setEnd(i),o.addSegment(m.get(),!1);if(2&e||4&e){let f=o.getPathEnd(u),I=i.getXY();l.setXY(I),o.setPointByVal(f-1,l)}a=!0}}}}}return a?o:null}function H(n,g){return{m_path:n,m_pointIndex:g}}function Q(n,g,s){let e=[],o=[],a=n.querySegmentIterator();for(;a.nextPath();){a.resetToFirstSegment();let t=a.nextSegment().getStartXY(),m=a.getPathIndex(),i=a.getStartPointIndex();e.push(t),o.push(H(m,i)),a.resetToLastSegment();let l=a.previousSegment().getEndXY(),S=a.getPathIndex(),E=a.getEndPointIndex();e.push(l),o.push(H(S,E))}let r=new F(0);for(let t=0;t<e.length;t++)r.add(t);let y={userSort(t,m,i){i.sort(t,m,(l,S)=>e[l].compare(e[S]))},getValue:t=>e[t].y};new X().sort(r,0,r.size(),y);for(let t=0;t<r.size()-1;t++){let m=e[r.read(t)];if(m.equals(e[r.read(t+1)])){do{let i=o[r.read(t)];s.push(i),t++}while(t<r.size()&&m.equals(e[r.read(t)]));t--}}D(g,s.length,0);for(let t=0;t<s.length;t++)g[t]=t;g.sort((t,m)=>{let i=s[t],l=s[m];return i.m_path<l.m_path?-1:i.m_path>l.m_path?1:i.m_pointIndex<l.m_pointIndex?-1:1})}var G=class{getOperatorType(){return 10007}supportsCurves(){return!1}accelerateGeometry(g,s,e){return!1}canAccelerateGeometry(g){return!1}execute(g,s,e,o,a){return K(g,s,e,o)}},J=new G;function ne(n,g,s){let e=0;s&&(s.relocateEnds&&(e|=1),s.keepEndAttributes&&(e|=2),s.noEndAttributes&&(e|=4),s.noExtendAtFrom&&(e|=8),s.noExtendAtTo&&(e|=16));let o=R(n),a=J.execute(C(n),C(g),j(o),e,null);return a?O(a,o):null}var re=J.supportsCurves();export{ne as execute,re as supportsCurves};
