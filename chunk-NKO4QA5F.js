import{a as ve,b as Se,g as _e,h as ke,i as Ie}from"./chunk-JK6BWFR4.js";import{a as we}from"./chunk-CSSRRM4C.js";import{a as ge,b as Te}from"./chunk-JKHGG7T4.js";import{a as x}from"./chunk-6HT3BT3B.js";import{b as me,g as fe,h as Z}from"./chunk-XR5FT7TQ.js";import{c as he}from"./chunk-BMYVPMAK.js";import{f as ye}from"./chunk-ZC6EBRE4.js";import{a as ce}from"./chunk-MIS6QMFE.js";import{a as L}from"./chunk-IR6XCBC4.js";import{c as de}from"./chunk-VIEK2X23.js";import{a as M}from"./chunk-PEW2PLAN.js";import{a as ue}from"./chunk-7F5DJLJT.js";import{a as R}from"./chunk-GHKL3NOH.js";import{a as P}from"./chunk-4N4D2YQX.js";import{a as pe}from"./chunk-BAEF3CT6.js";import{o as ne}from"./chunk-AUAZP44J.js";import{f as E}from"./chunk-CCJU4DSH.js";import{a as le}from"./chunk-TG45K3WR.js";import{a as s}from"./chunk-QGVBCWUY.js";import{H as ae,x as ie}from"./chunk-MYO4NP2N.js";import{e as a}from"./chunk-NFIPKH6V.js";import{l as m}from"./chunk-5QEXLALV.js";import{c as I}from"./chunk-P6QFA5MM.js";import{L as se,e as te,o as oe,p as F,s as re,u as Y}from"./chunk-4PTIEWMT.js";import{a as X}from"./chunk-TG2UTNEO.js";import{b as c}from"./chunk-YOFFGXOB.js";import{a as W,b as Q,f as y}from"./chunk-VTHXE323.js";var U=class extends c{constructor(t,r){super("shared-template-query-failed",`Request to fetch templates failed. templateIds: ${t.join(",")}`,{error:r}),this.templateIds=t}},J=class extends c{constructor(t,r){let o=new Set(r.map(n=>n.templateId)),i=ie(new Set(t),o);super("shared-template-some-templates-missing",`The service failed to return templates for the following 'templateId's: ${Array.from(i).join(",")}`)}},B=class extends c{constructor(){super("shared-template-required-properties-not-set","Values must be specified for the `definition`, `featureService`, `layer`, and `view` properties of a `SharedTemplate` in order to load it")}},j=class extends c{constructor(){super("shared-template-definition-required-properties-not-set","The `featureService`, `makeSharedTemplateFromJSON`, and `view` properties must all be set in order to load a template definition")}},$=class extends c{constructor(t){super("shared-template-unsupported-builder",`This template uses an unsupported builder type, '${t}'`),this.builderType=t}},q=class extends c{constructor(t,r){super("shared-template-layer-resolver-error",`The 'layerResolver' function failed to provide any layers for template with 'templateId: ${t}'`,{error:r}),this.templateId=t}},H=class extends c{constructor(t,r){super("shared-template-utility-network-resolver-error",`The 'utilityNetworkResolver' function threw an error while attempting to find a utility network for template with 'templateId: ${t}'`,{error:r}),this.templateId=t}},V=class extends c{constructor(t){super("shared-template-layer-unavailable",`None of the layers with which the template is associated are present in the view. Layer IDs: [${t.join(",")}]`),this.layerIds=t}},z=class extends c{constructor(t){super("shared-template-relationship-not-found",`Relationship class '${t}' could not be found.`),this.relationshipCatalogId=t}};var b=class extends L.LoadableMixin(P){constructor(e){super(e),this.layerIdToSourceIdLookup=new R,this.sourceIdToLayerIdLookup=new R,this.sourceIdToNetworkInfo=new R,this._rulesBySourceId=new Map,this._terminalConfigurationsBySourceId=new Map}load(e){return y(this,null,function*(){return this.addResolvingPromise(this._load(e)),this})}agatFromRule(e,t){let r;switch(t){case"to":r={networkSource:e.toNetworkSource??null,assetGroup:e.toAssetGroup??null,assetType:e.toAssetType??null};break;case"from":r={networkSource:e.fromNetworkSource??null,assetGroup:e.fromAssetGroup??null,assetType:e.fromAssetType??null};break;case"via":r={networkSource:e.viaNetworkSource??null,assetGroup:e.viaAssetGroup??null,assetType:e.viaAssetType??null}}return r.networkSource===null?null:r}agatToFullDefinition({assetGroup:e,assetType:t,networkSourceId:r}){if(r===null||e===null||t===null)return null;let o={networkSource:null,assetGroup:null,assetType:null},i=this.sourceIdToNetworkInfo.get(r);if(!i)return null;o.networkSource=i;let n=i.assetGroupLookup.get(e);return n?(o.assetGroup=n,o.assetType=n.assetTypeLookup.get(t)??null,o.assetType===null?null:o):null}findAgat(e,t){let r=Z(t)?t.parent:t;if(!r)throw new c("Unable to find asset group/asset type for layer. The given layer is a `SubtypeSublayer` with no parent.");if(this.utilityNetwork.featureServiceUrl!==r.url)return null;let o=this.getNetworkSourceIdForLayer(r);if(o===null)return null;let i=r.fieldsIndex.get("assettype")?.name??"";if(i==="")return null;let n=r.fieldsIndex.get("assetgroup")?.name??"";if(n==="")return null;let l=e.attributes[i],p=e.attributes[n];return l==null||p==null?null:{assetGroup:p,assetType:l,networkSourceId:o}}findAgatFullDefinition(e,t){let r=this.findAgat(e,t);return r?this.agatToFullDefinition(r):null}findRules({networkSourceId:e,assetGroup:t,assetType:r}){let o=[];if(e===null||t===null)return o;let i=this._rulesBySourceId.get(e)?.get(t);if(!i)return o;for(let n of i.generalRules)o.push(n);if(r!=null){let n=i.typeSpecificRules.get(r);if(n)for(let l of n)o.push(l)}return o}getNetworkSourceIdForLayer(e){let t=Z(e)?e.parent:e;return t&&this.utilityNetwork.featureServiceUrl===t.url?this.layerIdToSourceIdLookup.get(t.layerId)??null:null}ruleMatchesAgat(e,t,r){switch(r){case"to":return!(e.toNetworkSource?.sourceId!==t.networkSourceId||e.toAssetGroup&&e.toAssetGroup.assetGroupCode!==t.assetGroup||e.toAssetType&&e.toAssetType.assetTypeCode!==t.assetType);case"from":return!(e.fromNetworkSource?.sourceId!==t.networkSourceId||e.fromAssetGroup&&e.fromAssetGroup.assetGroupCode!==t.assetGroup||e.fromAssetType&&e.fromAssetType.assetTypeCode!==t.assetType);case"via":return!(e.viaNetworkSource?.sourceId!==t.networkSourceId||e.viaAssetGroup&&e.viaAssetGroup.assetGroupCode!==t.assetGroup||e.viaAssetType&&e.viaAssetType.assetTypeCode!==t.assetType)}}ruleMatchesFullDefinitionAgat(e,t,r){switch(r){case"to":return!(e.toNetworkSource?.sourceId!==t.networkSource?.sourceId||e.toAssetGroup&&e.toAssetGroup.assetGroupCode!==t.assetGroup?.assetGroupCode||e.toAssetType&&e.toAssetType.assetTypeCode!==t.assetType?.assetTypeCode);case"from":return!(e.fromNetworkSource?.sourceId!==t.networkSource?.sourceId||e.fromAssetGroup&&e.fromAssetGroup.assetGroupCode!==t.assetGroup?.assetGroupCode||e.fromAssetType&&e.fromAssetType.assetTypeCode!==t.assetType?.assetTypeCode);case"via":return!(e.viaNetworkSource?.sourceId!==t.networkSource?.sourceId||e.viaAssetGroup&&e.viaAssetGroup.assetGroupCode!==t.assetGroup?.assetGroupCode||e.viaAssetType&&e.viaAssetType.assetTypeCode!==t.assetType?.assetTypeCode)}}terminalConfiguration(e,t,r){let o=this._terminalConfigurationsBySourceId.get(e);if(!o)return null;let i=o.get(t);return i&&i.get(r)||null}_load(e){return y(this,null,function*(){yield this.utilityNetwork.load(),F(e);let{dataElement:t}=this.utilityNetwork;if(!t)throw new c("no-data-element","No data element found on utility network");for(let o of t.domainNetworks)for(let i of[...o.edgeSources??[],...o.junctionSources??[]]){this.layerIdToSourceIdLookup.set(i.layerId,i.sourceId),this.sourceIdToLayerIdLookup.set(i.sourceId,i.layerId);let n=(i.assetGroups??[]).map(u=>{let d=new R;for(let f of u.assetTypes??[])d.set(f.assetTypeCode,f);return Q(W({},u),{assetTypeLookup:d})}),l=new R;for(let u of n)l.set(u.assetGroupCode,u);let p=Q(W({},i),{assetGroupLookup:l,assetGroups:n});this.sourceIdToNetworkInfo.set(p.sourceId,p)}let r=yield this.utilityNetwork.getRulesTable();F(e);for(let o of r?.rules??[])switch(o.ruleType){case x.RTAttachment:case x.RTContainment:this._registerRule(o.fromNetworkSource.sourceId,o.fromAssetGroup.assetGroupCode,o.fromAssetType.assetTypeCode,o),this._registerRule(o.toNetworkSource.sourceId,o.toAssetGroup.assetGroupCode,o.toAssetType.assetTypeCode,o);break;case x.RTEdgeJunctionEdgeConnectivity:this._registerRule(o.fromNetworkSource.sourceId,o.fromAssetGroup.assetGroupCode,o.fromAssetType.assetTypeCode,o),this._registerRule(o.toNetworkSource.sourceId,o.toAssetGroup.assetGroupCode,o.toAssetType.assetTypeCode,o),this._registerRule(o.viaNetworkSource.sourceId,o.viaAssetGroup.assetGroupCode,o.viaAssetType.assetTypeCode,o);break;case x.RTJunctionEdgeConnectivity:case x.RTJunctionJunctionConnectivity:this._registerRule(o.fromNetworkSource.sourceId,o.fromAssetGroup.assetGroupCode,o.fromAssetType.assetTypeCode,o),this._registerRule(o.toNetworkSource.sourceId,o.toAssetGroup.assetGroupCode,o.toAssetType.assetTypeCode,o)}this._makeTerminalConfigurationLookups(t)})}_makeTerminalConfigurationLookups(e){let t={};for(let r of e.terminalConfigurations??[])t[r.terminalConfigurationId]=r;for(let r of e.domainNetworks??[])for(let o of r.junctionSources)if(o.utilityNetworkFeatureClassUsageType==="esriUNFCUTJunctionObject"||o.utilityNetworkFeatureClassUsageType==="esriUNFCUTDevice"){for(let i of o.assetGroups??[])for(let n of i.assetTypes??[])if(n.terminalConfigurationId!=null&&n.terminalConfigurationId>=0){let l=t[n.terminalConfigurationId];if(l){let p=I(this._terminalConfigurationsBySourceId,o.sourceId,()=>new Map);I(p,i.assetGroupCode,()=>new Map).set(n.assetTypeCode,l)}}}}_registerRule(e,t,r,o){let i=I(this._rulesBySourceId,e,()=>new Map),n=I(i,t,()=>({generalRules:[],typeSpecificRules:new Map}));r===-1?n.generalRules.push(o):I(n.typeSpecificRules,r,()=>[]).push(o)}};s([a()],b.prototype,"layerIdToSourceIdLookup",void 0),s([a()],b.prototype,"sourceIdToLayerIdLookup",void 0),s([a()],b.prototype,"sourceIdToNetworkInfo",void 0),s([a()],b.prototype,"utilityNetwork",void 0),b=s([m("esri.networks.support.UtilityNetworkLookupHelper")],b);var be=new Map;function Ce(e,t){return I(be,e,()=>{let r=new v({layerResolver:t?.layerResolver??Le(e),makeSharedTemplateFromJSON:t.makeSharedTemplateFromJSON,utilityNetworkResolver:t?.utilityNetworkResolver??xe(e),view:e});return e.addHandles(X(()=>{be.delete(e),r.destroy()})),r})}var v=class extends ae{constructor(e){super(e),this._abortController=null,this._cache=new Map,this._pending=new Map,this._utilityNetworkLookupHelperCache=new Map,this.layerResolver=null,this.makeSharedTemplateFromJSON=null,this.utilityNetworkResolver=null,this.view=null}initialize(){this.addHandles(le(()=>this.view.spatialReference,()=>this._reset()))}destroy(){this._abortController=te(this._abortController)}getTemplates(o){return y(this,arguments,function*({templateIds:e,featureService:t,signal:r}){let i=this._cache,n=this._pending,l=[],p=new Set,u=new Set,d=Symbol();for(let g of new Set(e)){let S=K(t,g);if(i.has(S))l.push(i.get(S));else if(n.has(S)){let G=n.get(S);G.subscribers.add(d),u.add(G)}else p.add(g),n.set(S,Re())}if(l.length===e.length)return l;let f=()=>{for(let{subscribers:g}of u)g.delete(d)},D=Y(r,f);try{let g=yield this._loadTemplates({templateIds:Array.from(p),featureService:t,signal:r}),S=yield Promise.all(Array.from(u).map(({resolver:G})=>G.promise));l.push(...g),l.push(...S)}catch(g){f();for(let S of p){let G=K(t,S);n.get(G)?.resolver.reject(g),n.delete(G)}throw g}finally{D?.remove()}return F(r),l})}_loadTemplates(o){return y(this,arguments,function*({templateIds:e,featureService:t,signal:r}){if(e.length===0)return[];let i=this._cache,n=this._pending,l=this._abortController=new AbortController,p=Y(r,()=>{for(let f of e)if(Ne(n.get(K(t,f))))return;l.abort()}),u=yield Ge({featureService:t,templateIds:e,signal:l.signal,spatialReference:this.view.spatialReference});if(u.length<e.length)throw new J(e,u);let d=yield Promise.all(u.map(f=>this._makeTemplate({json:f,featureService:t})));for(let f of d){let D=K(t,f.templateId),g=n.get(D);!r?.aborted||Ne(g)?(i.set(D,f),g?.resolver.resolve(f)):g?.resolver.reject(oe()),n.delete(D)}return p?.remove(),d})}_makeTemplate(r){return y(this,arguments,function*({json:e,featureService:t}){let{view:o}=this,i=this.makeSharedTemplateFromJSON(e);i.featureService=t,i.view=o;let{layerIds:n,subtypeCode:l}=i;try{i.layer=yield this.layerResolver({featureService:t,layerIds:n,subtypeCode:l})}catch(p){throw new q(i.templateId,p)}if(ke(i)&&i.definition?.createUtilityNetworkAssociations){let p=null;try{p=yield this.utilityNetworkResolver(t)}catch(u){throw new H(i.templateId,u)}if(p){i.definition.utilityNetwork=yield this._getOrCreateUtilityNetworkLookupHelper(p);let u=yield p.loadAssociationsTable();i.definition.utilityNetworkAssociationsTable=u,Se(o).additionalLayers.add(u)}}if(Ie(i)&&i.definition){i.definition.spatialReference=o.spatialReference;for(let p of i.definition.allParts)p.geometry&&(p.geometry.spatialReference=o.spatialReference)}if(_e(i)&&i.definition?.defaultValues){let p=i.definition.defaultValues,u={},{fieldsIndex:d}=i.layer;for(let f in i.definition.defaultValues)u[d.get(f)?.name??f]=p[f];i.definition.defaultValues=u}return i})}_getOrCreateUtilityNetworkLookupHelper(e){return y(this,null,function*(){let t=this._utilityNetworkLookupHelperCache.get(e);if(t)return t;let r=yield new b({utilityNetwork:e}).load();this._utilityNetworkLookupHelperCache.set(e,r);let o=X(()=>{r.destroy(),this._utilityNetworkLookupHelperCache.delete(e)});return e.addHandles(o),this.addHandles(o),r})}_reset(){this._abortController?.abort(),this._cache.clear(),this._pending.clear()}};function Ge(i){return y(this,arguments,function*({templateIds:e,featureService:t,spatialReference:r,signal:o}){let n=`${t.url}/sharedTemplates/templates`;return(yield ne(n,{query:{f:"json",outSR:r,ids:e.join(",")},signal:o}).catch(p=>{throw re(p),new U(e,p)})).data?.templates??[]})}function Ne(e){return e!=null&&e.subscribers.size>0}function Re(){return{resolver:se(),subscribers:new Set}}function K(e,t){return`${e.url}/${t}`}function Pe(e){return me(e)||fe(e)}function Le(e){return o=>y(this,[o],function*({featureService:t,layerIds:r}){let i=new Set(r),{allLayers:n,allTables:l}=e.map,p=n.concat(l).find(u=>u.url===t.url&&Pe(u)&&i.has(u.layerId));if(p==null)throw new V(r);return p})}function xe(e){return t=>y(this,null,function*(){let{map:r}=e;if(!we(r)||!r.utilityNetworks)return null;for(let o of r.utilityNetworks)if(o.featureServiceUrl===t.url)return o.load();return null})}s([a()],v.prototype,"_abortController",void 0),s([a()],v.prototype,"_cache",void 0),s([a()],v.prototype,"_pending",void 0),s([a({constructOnly:!0})],v.prototype,"layerResolver",void 0),s([a({constructOnly:!0})],v.prototype,"makeSharedTemplateFromJSON",void 0),s([a({constructOnly:!0})],v.prototype,"utilityNetworkResolver",void 0),s([a({constructOnly:!0})],v.prototype,"view",void 0),v=s([m("esri.editing.sharedTemplates.SharedTemplateProvider")],v);var h=class extends L.LoadableMixin(P.EsriPromiseMixin(E)){constructor(){super(...arguments),this.excludedTools=[],this.featureService=null,this.makeSharedTemplateFromJSON=null,this.view=null}readExcludedTools(e){return e.map(t=>ge.fromJSON(t))}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}_load(e){return y(this,null,function*(){let t=this.allParts,{featureService:r,makeSharedTemplateFromJSON:o,view:i}=this;if(r==null||o==null||i==null)throw new j;for(let d of t)d.assertIsSupportedPart();let n=Ce(i,{makeSharedTemplateFromJSON:o}),l=t.filter(d=>d.template==null),p=yield n.getTemplates({templateIds:l.map(d=>d.templateId),featureService:r,signal:e?.signal}),u=new Map(p.map(d=>[d.templateId,d]));for(let d of l){let f=u.get(d.templateId);if(f==null)throw new c(`Failed to retrieve template for template ID ${d.templateId}`);d.template=f}yield Promise.all(t.map(d=>d.template?.load(e)))})}};s([a({readOnly:!0})],h.prototype,"type",void 0),s([a({constructOnly:!0})],h.prototype,"excludedTools",void 0),s([M("excludedTools")],h.prototype,"readExcludedTools",null),s([a()],h.prototype,"featureService",void 0),s([a()],h.prototype,"makeSharedTemplateFromJSON",void 0),s([a()],h.prototype,"view",void 0),h=s([m("esri.editing.sharedTemplates.templateDefinitions.TemplateDefinitionBase")],h);var T=class extends E{constructor(e){super(e),this.template=null}};s([a()],T.prototype,"template",void 0),s([a()],T.prototype,"templateGlobalId",void 0),s([a()],T.prototype,"templateId",void 0),s([a({readOnly:!0,json:{read:!1,write:!1}})],T.prototype,"type",void 0),T=s([m("esri.editing.sharedTemplates.templateDefinitions.parts.TemplatePartBase")],T);var N=class extends T{constructor(e){super(e),this.relationshipCatalogId="",this.relationshipMetadata=null,this.template=null,this.type="relationship"}assertIsSupportedPart(){}};s([a({json:{name:"relationshipClassID"}})],N.prototype,"relationshipCatalogId",void 0),s([a()],N.prototype,"relationshipMetadata",void 0),s([a()],N.prototype,"template",void 0),s([a()],N.prototype,"type",void 0),N=s([m("esri.editing.sharedTemplates.templateDefinitions.parts.FeatureTemplateRelationshipPart")],N);var C=class extends h{constructor(e){super(e),this.type="feature",this.defaultValues=null,this.relationships=[]}get allParts(){return this.relationships}initializeRelationshipMetadata(e){for(let t of this.relationships){let{relationshipCatalogId:r}=t,o=t.template?.layer,i=e.relationships?.find(l=>l.catalogId===r),n=o?.relationships?.find(l=>l.catalogId===r);if(!i||!o||!n)throw new z(r);t.relationshipMetadata={destinationField:n.keyField,destinationLayerId:o.layerId,sourceField:i.keyField,sourceLayerId:e.layerId}}}};s([a({readOnly:!0})],C.prototype,"type",void 0),s([a()],C.prototype,"allParts",null),s([a()],C.prototype,"defaultValues",void 0),s([a({constructOnly:!0,type:[N]})],C.prototype,"relationships",void 0),C=s([m("esri.editing.sharedTemplates.templateDefinitions.FeatureTemplateDefinition")],C);var ee=new pe({esri_editing_transformation_bufferLineToPolygon:"buffer-line-to-polygon",esri_editing_transformation_bufferPointToPolygon:"buffer-point-to-polygon",esri_editing_transformation_bufferPolygonToPolygon:"buffer-polygon-to-polygon",esri_editing_transformation_connectionPoint:"connection-point",esri_editing_transformation_equallySpaced:"equally-spaced",esri_editing_transformation_offsetLine:"offset-line",esri_editing_transformation_offsetPrimaryLine:"offset-primary-line",esri_editing_transformation_pointAtAllVerticesOfLine:"point-at-all-vertices-of-line",esri_editing_transformation_pointAtBeginningOfLine:"point-at-beginning-of-line",esri_editing_transformation_pointAtBeginningOfRadial:"point-at-beginning-of-radial",esri_editing_transformation_pointAtEndOfLine:"point-at-end-of-line",esri_editing_transformation_pointAtInteriorVertices:"point-at-interior-vertices",esri_editing_transformation_pointAtIntersectionVerticesOfLine:"point-at-intersection-vertices-of-line",esri_editing_transformation_pointAtNotBeginningOfLine:"point-at-not-beginning-of-line",esri_editing_transformation_pointAtNotEndOfLine:"point-at-not-end-of-line",esri_editing_transformation_pointAtPolygonCentroid:"point-at-polygon-centroid",esri_editing_transformation_pointAtPolygonNotStart:"point-at-polygon-not-start",esri_editing_transformation_pointAtPolygonStart:"point-at-polygon-start",esri_editing_transformation_pointIdentity:"point-identity",esri_editing_transformation_pointPrimaryIdentity:"point-primary-identity",esri_editing_transformation_polygonBoundary:"polygon-boundary",esri_editing_transformation_polygonBoundaryTwoPoint:"polygon-boundary-two-point",esri_editing_transformation_polygonIdentity:"polygon-identity",esri_editing_transformation_polygonPrimaryIdentity:"polygon-primary-identity",esri_editing_transformation_polygonVertices:"polygon-vertices",esri_editing_transformation_radialLines:"radial-lines",esri_editing_transformation_twoPointLines:"two-point-lines"}),Ae={"buffer-line-to-polygon":"polyline","buffer-point-to-polygon":"point","buffer-polygon-to-polygon":"polygon","connection-point":"polyline","equally-spaced":"polyline","offset-line":"polyline","offset-primary-line":"polyline","point-at-all-vertices-of-line":"polyline","point-at-beginning-of-line":"polyline","point-at-beginning-of-radial":"polyline","point-at-end-of-line":"polyline","point-at-interior-vertices":"polyline","point-at-intersection-vertices-of-line":"polyline","point-at-not-beginning-of-line":"polyline","point-at-not-end-of-line":"polyline","point-at-polygon-centroid":"polygon","point-at-polygon-not-start":"polygon","point-at-polygon-start":"polygon","point-identity":"point","point-primary-identity":"point","polygon-boundary":"polygon","polygon-boundary-two-point":"polygon","polygon-identity":"polygon","polygon-primary-identity":"polygon","polygon-vertices":"polygon","radial-lines":"polyline","two-point-lines":"polyline"};var A=class extends T{constructor(e){super(e),this.builderConfig={},this.type="group"}assertIsSupportedPart(){let{builderType:e}=this;if(!ee.apiValues.includes(e))throw new $(e)}};s([ce(ee,{ignoreUnknown:!1,name:"type"})],A.prototype,"builderType",void 0),s([a({json:{name:"options"}})],A.prototype,"builderConfig",void 0),s([a()],A.prototype,"type",void 0),A=s([m("esri.editing.sharedTemplates.templateDefinitions.parts.GroupTemplatePart")],A);var w=class extends h{constructor(e){super(e),this.type="group",this.createUtilityNetworkAssociations=!1,this.parts=[],this.utilityNetwork=null,this.utilityNetworkAssociationsTable=null}get allParts(){return[this.basePart,...this.parts]}get inputGeometryType(){return Ae[this.basePart.builderType]}};s([a({readOnly:!0})],w.prototype,"type",void 0),s([a()],w.prototype,"allParts",null),s([a({constructOnly:!0,type:A})],w.prototype,"basePart",void 0),s([a({constructOnly:!0})],w.prototype,"createUtilityNetworkAssociations",void 0),s([a()],w.prototype,"inputGeometryType",null),s([a({constructOnly:!0,type:[A]})],w.prototype,"parts",void 0),s([a()],w.prototype,"utilityNetwork",void 0),s([a()],w.prototype,"utilityNetworkAssociationsTable",void 0),w=s([m("esri.editing.sharedTemplates.templateDefinitions.GroupTemplateDefinition")],w);var O=class extends T{constructor(e){super(e),this.geometry=null,this.type="preset"}assertIsSupportedPart(){}};s([a({types:he,json:{read:ye}})],O.prototype,"geometry",void 0),s([a()],O.prototype,"type",void 0),O=s([m("esri.editing.sharedTemplates.templateDefinitions.parts.PresetTemplatePart")],O);var _=class extends h{constructor(e){super(e),this.type="preset",this.parts=[]}get allParts(){return this.parts}};s([a({readOnly:!0})],_.prototype,"type",void 0),s([a()],_.prototype,"allParts",null),s([a({constructOnly:!0,type:de})],_.prototype,"origin",void 0),s([a({constructOnly:!0,type:[O],json:{name:"features"}})],_.prototype,"parts",void 0),s([a({type:ue})],_.prototype,"spatialReference",void 0),_=s([m("esri.editing.sharedTemplates.templateDefinitions.PresetTemplateDefinition")],_);var Oe=e=>k.fromJSON(e),k=class extends L.LoadableMixin(P.EsriPromiseMixin(Te)){constructor(e){super(e),this.definition=null,this.layer=null,this.type="feature",this.view=null}readDefinition(e,t){switch(t.type){case"feature":return C.fromJSON(e);case"group":return w.fromJSON(e);case"preset":return _.fromJSON(e);default:throw t.type,new c("shared-template:no-definition","No value for 'definition' provided to 'SharedTemplate' constructor")}}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}_load(e){return y(this,null,function*(){let{definition:t,featureService:r,layer:o,view:i}=this;if(!(t&&r&&o&&i))throw new B;t.featureService=r,t.makeSharedTemplateFromJSON=Oe,t.view=i,yield this.definition?.load(e),ve(t)&&t.initializeRelationshipMetadata(o)})}};s([a()],k.prototype,"definition",void 0),s([M("definition")],k.prototype,"readDefinition",null),s([a()],k.prototype,"layer",void 0),s([a()],k.prototype,"type",void 0),s([a()],k.prototype,"view",void 0),k=s([m("esri.editing.sharedTemplates.SharedTemplate")],k);var Ar=k;export{Ce as a,Ar as b};
